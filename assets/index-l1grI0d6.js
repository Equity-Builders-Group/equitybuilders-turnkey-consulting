var Zm=n=>{throw TypeError(n)};var uu=(n,e,t)=>e.has(n)||Zm("Cannot "+t);var G=(n,e,t)=>(uu(n,e,"read from private field"),t?t.call(n):e.get(n)),he=(n,e,t)=>e.has(n)?Zm("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),oe=(n,e,t,r)=>(uu(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),at=(n,e,t)=>(uu(n,e,"access private method"),t);var pa=(n,e,t,r)=>({set _(s){oe(n,e,s,t)},get _(){return G(n,e,r)}});function a1(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function Iv(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Rv={exports:{}},yc={},Cv={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sa=Symbol.for("react.element"),l1=Symbol.for("react.portal"),c1=Symbol.for("react.fragment"),u1=Symbol.for("react.strict_mode"),d1=Symbol.for("react.profiler"),f1=Symbol.for("react.provider"),h1=Symbol.for("react.context"),m1=Symbol.for("react.forward_ref"),p1=Symbol.for("react.suspense"),g1=Symbol.for("react.memo"),v1=Symbol.for("react.lazy"),Jm=Symbol.iterator;function y1(n){return n===null||typeof n!="object"?null:(n=Jm&&n[Jm]||n["@@iterator"],typeof n=="function"?n:null)}var kv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_v=Object.assign,Pv={};function Gi(n,e,t){this.props=n,this.context=e,this.refs=Pv,this.updater=t||kv}Gi.prototype.isReactComponent={};Gi.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Gi.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function Dv(){}Dv.prototype=Gi.prototype;function Jf(n,e,t){this.props=n,this.context=e,this.refs=Pv,this.updater=t||kv}var eh=Jf.prototype=new Dv;eh.constructor=Jf;_v(eh,Gi.prototype);eh.isPureReactComponent=!0;var ep=Array.isArray,Nv=Object.prototype.hasOwnProperty,th={current:null},Ov={key:!0,ref:!0,__self:!0,__source:!0};function Mv(n,e,t){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Nv.call(e,r)&&!Ov.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:sa,type:n,key:i,ref:o,props:s,_owner:th.current}}function x1(n,e){return{$$typeof:sa,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function nh(n){return typeof n=="object"&&n!==null&&n.$$typeof===sa}function E1(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var tp=/\/+/g;function du(n,e){return typeof n=="object"&&n!==null&&n.key!=null?E1(""+n.key):e.toString(36)}function rl(n,e,t,r,s){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case sa:case l1:o=!0}}if(o)return o=n,s=s(o),n=r===""?"."+du(o,0):r,ep(s)?(t="",n!=null&&(t=n.replace(tp,"$&/")+"/"),rl(s,e,t,"",function(c){return c})):s!=null&&(nh(s)&&(s=x1(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(tp,"$&/")+"/")+n)),e.push(s)),1;if(o=0,r=r===""?".":r+":",ep(n))for(var a=0;a<n.length;a++){i=n[a];var l=r+du(i,a);o+=rl(i,e,t,l,s)}else if(l=y1(n),typeof l=="function")for(n=l.call(n),a=0;!(i=n.next()).done;)i=i.value,l=r+du(i,a++),o+=rl(i,e,t,l,s);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ga(n,e,t){if(n==null)return n;var r=[],s=0;return rl(n,r,"","",function(i){return e.call(t,i,s++)}),r}function S1(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var yt={current:null},sl={transition:null},T1={ReactCurrentDispatcher:yt,ReactCurrentBatchConfig:sl,ReactCurrentOwner:th};function Fv(){throw Error("act(...) is not supported in production builds of React.")}de.Children={map:ga,forEach:function(n,e,t){ga(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return ga(n,function(){e++}),e},toArray:function(n){return ga(n,function(e){return e})||[]},only:function(n){if(!nh(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};de.Component=Gi;de.Fragment=c1;de.Profiler=d1;de.PureComponent=Jf;de.StrictMode=u1;de.Suspense=p1;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T1;de.act=Fv;de.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=_v({},n.props),s=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=th.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)Nv.call(e,l)&&!Ov.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:sa,type:n.type,key:s,ref:i,props:r,_owner:o}};de.createContext=function(n){return n={$$typeof:h1,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:f1,_context:n},n.Consumer=n};de.createElement=Mv;de.createFactory=function(n){var e=Mv.bind(null,n);return e.type=n,e};de.createRef=function(){return{current:null}};de.forwardRef=function(n){return{$$typeof:m1,render:n}};de.isValidElement=nh;de.lazy=function(n){return{$$typeof:v1,_payload:{_status:-1,_result:n},_init:S1}};de.memo=function(n,e){return{$$typeof:g1,type:n,compare:e===void 0?null:e}};de.startTransition=function(n){var e=sl.transition;sl.transition={};try{n()}finally{sl.transition=e}};de.unstable_act=Fv;de.useCallback=function(n,e){return yt.current.useCallback(n,e)};de.useContext=function(n){return yt.current.useContext(n)};de.useDebugValue=function(){};de.useDeferredValue=function(n){return yt.current.useDeferredValue(n)};de.useEffect=function(n,e){return yt.current.useEffect(n,e)};de.useId=function(){return yt.current.useId()};de.useImperativeHandle=function(n,e,t){return yt.current.useImperativeHandle(n,e,t)};de.useInsertionEffect=function(n,e){return yt.current.useInsertionEffect(n,e)};de.useLayoutEffect=function(n,e){return yt.current.useLayoutEffect(n,e)};de.useMemo=function(n,e){return yt.current.useMemo(n,e)};de.useReducer=function(n,e,t){return yt.current.useReducer(n,e,t)};de.useRef=function(n){return yt.current.useRef(n)};de.useState=function(n){return yt.current.useState(n)};de.useSyncExternalStore=function(n,e,t){return yt.current.useSyncExternalStore(n,e,t)};de.useTransition=function(){return yt.current.useTransition()};de.version="18.3.1";Cv.exports=de;var b=Cv.exports;const z=Iv(b),rh=a1({__proto__:null,default:z},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b1=b,w1=Symbol.for("react.element"),A1=Symbol.for("react.fragment"),L1=Object.prototype.hasOwnProperty,I1=b1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,R1={key:!0,ref:!0,__self:!0,__source:!0};function $v(n,e,t){var r,s={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)L1.call(e,r)&&!R1.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:w1,type:n,key:i,ref:o,props:s,_owner:I1.current}}yc.Fragment=A1;yc.jsx=$v;yc.jsxs=$v;Rv.exports=yc;var y=Rv.exports,Bv={exports:{}},Gt={},Uv={exports:{}},jv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(_,k){var M=_.length;_.push(k);e:for(;0<M;){var F=M-1>>>1,$=_[F];if(0<s($,k))_[F]=k,_[M]=$,M=F;else break e}}function t(_){return _.length===0?null:_[0]}function r(_){if(_.length===0)return null;var k=_[0],M=_.pop();if(M!==k){_[0]=M;e:for(var F=0,$=_.length,Y=$>>>1;F<Y;){var Q=2*(F+1)-1,ee=_[Q],te=Q+1,ne=_[te];if(0>s(ee,M))te<$&&0>s(ne,ee)?(_[F]=ne,_[te]=M,F=te):(_[F]=ee,_[Q]=M,F=Q);else if(te<$&&0>s(ne,M))_[F]=ne,_[te]=M,F=te;else break e}}return k}function s(_,k){var M=_.sortIndex-k.sortIndex;return M!==0?M:_.id-k.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,f=3,h=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(_){for(var k=t(c);k!==null;){if(k.callback===null)r(c);else if(k.startTime<=_)r(c),k.sortIndex=k.expirationTime,e(l,k);else break;k=t(c)}}function T(_){if(m=!1,E(_),!p)if(t(l)!==null)p=!0,U(w);else{var k=t(c);k!==null&&H(T,k.startTime-_)}}function w(_,k){p=!1,m&&(m=!1,v(R),R=-1),h=!0;var M=f;try{for(E(k),d=t(l);d!==null&&(!(d.expirationTime>k)||_&&!P());){var F=d.callback;if(typeof F=="function"){d.callback=null,f=d.priorityLevel;var $=F(d.expirationTime<=k);k=n.unstable_now(),typeof $=="function"?d.callback=$:d===t(l)&&r(l),E(k)}else r(l);d=t(l)}if(d!==null)var Y=!0;else{var Q=t(c);Q!==null&&H(T,Q.startTime-k),Y=!1}return Y}finally{d=null,f=M,h=!1}}var L=!1,A=null,R=-1,C=5,I=-1;function P(){return!(n.unstable_now()-I<C)}function O(){if(A!==null){var _=n.unstable_now();I=_;var k=!0;try{k=A(!0,_)}finally{k?V():(L=!1,A=null)}}else L=!1}var V;if(typeof x=="function")V=function(){x(O)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,K=B.port2;B.port1.onmessage=O,V=function(){K.postMessage(null)}}else V=function(){g(O,0)};function U(_){A=_,L||(L=!0,V())}function H(_,k){R=g(function(){_(n.unstable_now())},k)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(_){_.callback=null},n.unstable_continueExecution=function(){p||h||(p=!0,U(w))},n.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<_?Math.floor(1e3/_):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(_){switch(f){case 1:case 2:case 3:var k=3;break;default:k=f}var M=f;f=k;try{return _()}finally{f=M}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(_,k){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var M=f;f=_;try{return k()}finally{f=M}},n.unstable_scheduleCallback=function(_,k,M){var F=n.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?F+M:F):M=F,_){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=M+$,_={id:u++,callback:k,priorityLevel:_,startTime:M,expirationTime:$,sortIndex:-1},M>F?(_.sortIndex=M,e(c,_),t(l)===null&&_===t(c)&&(m?(v(R),R=-1):m=!0,H(T,M-F))):(_.sortIndex=$,e(l,_),p||h||(p=!0,U(w))),_},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(_){var k=f;return function(){var M=f;f=k;try{return _.apply(this,arguments)}finally{f=M}}}})(jv);Uv.exports=jv;var C1=Uv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k1=b,jt=C1;function W(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Gv=new Set,Ro={};function Ms(n,e){_i(n,e),_i(n+"Capture",e)}function _i(n,e){for(Ro[n]=e,n=0;n<e.length;n++)Gv.add(e[n])}var cr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sd=Object.prototype.hasOwnProperty,_1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,np={},rp={};function P1(n){return Sd.call(rp,n)?!0:Sd.call(np,n)?!1:_1.test(n)?rp[n]=!0:(np[n]=!0,!1)}function D1(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function N1(n,e,t,r){if(e===null||typeof e>"u"||D1(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function xt(n,e,t,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var it={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){it[n]=new xt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];it[e]=new xt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){it[n]=new xt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){it[n]=new xt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){it[n]=new xt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){it[n]=new xt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){it[n]=new xt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){it[n]=new xt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){it[n]=new xt(n,5,!1,n.toLowerCase(),null,!1,!1)});var sh=/[\-:]([a-z])/g;function ih(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(sh,ih);it[e]=new xt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(sh,ih);it[e]=new xt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(sh,ih);it[e]=new xt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){it[n]=new xt(n,1,!1,n.toLowerCase(),null,!1,!1)});it.xlinkHref=new xt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){it[n]=new xt(n,1,!1,n.toLowerCase(),null,!0,!0)});function oh(n,e,t,r){var s=it.hasOwnProperty(e)?it[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(N1(e,t,s,r)&&(t=null),r||s===null?P1(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var pr=k1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),Qs=Symbol.for("react.portal"),Xs=Symbol.for("react.fragment"),ah=Symbol.for("react.strict_mode"),Td=Symbol.for("react.profiler"),Vv=Symbol.for("react.provider"),Hv=Symbol.for("react.context"),lh=Symbol.for("react.forward_ref"),bd=Symbol.for("react.suspense"),wd=Symbol.for("react.suspense_list"),ch=Symbol.for("react.memo"),Rr=Symbol.for("react.lazy"),Kv=Symbol.for("react.offscreen"),sp=Symbol.iterator;function Xi(n){return n===null||typeof n!="object"?null:(n=sp&&n[sp]||n["@@iterator"],typeof n=="function"?n:null)}var Ne=Object.assign,fu;function lo(n){if(fu===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);fu=e&&e[1]||""}return`
`+fu+n}var hu=!1;function mu(n,e){if(!n||hu)return"";hu=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{hu=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?lo(n):""}function O1(n){switch(n.tag){case 5:return lo(n.type);case 16:return lo("Lazy");case 13:return lo("Suspense");case 19:return lo("SuspenseList");case 0:case 2:case 15:return n=mu(n.type,!1),n;case 11:return n=mu(n.type.render,!1),n;case 1:return n=mu(n.type,!0),n;default:return""}}function Ad(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Xs:return"Fragment";case Qs:return"Portal";case Td:return"Profiler";case ah:return"StrictMode";case bd:return"Suspense";case wd:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Hv:return(n.displayName||"Context")+".Consumer";case Vv:return(n._context.displayName||"Context")+".Provider";case lh:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case ch:return e=n.displayName||null,e!==null?e:Ad(n.type)||"Memo";case Rr:e=n._payload,n=n._init;try{return Ad(n(e))}catch{}}return null}function M1(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ad(e);case 8:return e===ah?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function zv(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function F1(n){var e=zv(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function ya(n){n._valueTracker||(n._valueTracker=F1(n))}function Wv(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=zv(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Cl(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Ld(n,e){var t=e.checked;return Ne({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function ip(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Xr(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Yv(n,e){e=e.checked,e!=null&&oh(n,"checked",e,!1)}function Id(n,e){Yv(n,e);var t=Xr(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Rd(n,e.type,t):e.hasOwnProperty("defaultValue")&&Rd(n,e.type,Xr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function op(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Rd(n,e,t){(e!=="number"||Cl(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var co=Array.isArray;function ci(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Xr(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function Cd(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return Ne({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function ap(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(W(92));if(co(t)){if(1<t.length)throw Error(W(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Xr(t)}}function qv(n,e){var t=Xr(e.value),r=Xr(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function lp(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Qv(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kd(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Qv(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var xa,Xv=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(xa=xa||document.createElement("div"),xa.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=xa.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Co(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var mo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$1=["Webkit","ms","Moz","O"];Object.keys(mo).forEach(function(n){$1.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),mo[e]=mo[n]})});function Zv(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||mo.hasOwnProperty(n)&&mo[n]?(""+e).trim():e+"px"}function Jv(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=Zv(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var B1=Ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _d(n,e){if(e){if(B1[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function Pd(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dd=null;function uh(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Nd=null,ui=null,di=null;function cp(n){if(n=aa(n)){if(typeof Nd!="function")throw Error(W(280));var e=n.stateNode;e&&(e=bc(e),Nd(n.stateNode,n.type,e))}}function ey(n){ui?di?di.push(n):di=[n]:ui=n}function ty(){if(ui){var n=ui,e=di;if(di=ui=null,cp(n),e)for(n=0;n<e.length;n++)cp(e[n])}}function ny(n,e){return n(e)}function ry(){}var pu=!1;function sy(n,e,t){if(pu)return n(e,t);pu=!0;try{return ny(n,e,t)}finally{pu=!1,(ui!==null||di!==null)&&(ry(),ty())}}function ko(n,e){var t=n.stateNode;if(t===null)return null;var r=bc(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(W(231,e,typeof t));return t}var Od=!1;if(cr)try{var Zi={};Object.defineProperty(Zi,"passive",{get:function(){Od=!0}}),window.addEventListener("test",Zi,Zi),window.removeEventListener("test",Zi,Zi)}catch{Od=!1}function U1(n,e,t,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var po=!1,kl=null,_l=!1,Md=null,j1={onError:function(n){po=!0,kl=n}};function G1(n,e,t,r,s,i,o,a,l){po=!1,kl=null,U1.apply(j1,arguments)}function V1(n,e,t,r,s,i,o,a,l){if(G1.apply(this,arguments),po){if(po){var c=kl;po=!1,kl=null}else throw Error(W(198));_l||(_l=!0,Md=c)}}function Fs(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function iy(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function up(n){if(Fs(n)!==n)throw Error(W(188))}function H1(n){var e=n.alternate;if(!e){if(e=Fs(n),e===null)throw Error(W(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return up(s),n;if(i===r)return up(s),e;i=i.sibling}throw Error(W(188))}if(t.return!==r.return)t=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o)throw Error(W(189))}}if(t.alternate!==r)throw Error(W(190))}if(t.tag!==3)throw Error(W(188));return t.stateNode.current===t?n:e}function oy(n){return n=H1(n),n!==null?ay(n):null}function ay(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=ay(n);if(e!==null)return e;n=n.sibling}return null}var ly=jt.unstable_scheduleCallback,dp=jt.unstable_cancelCallback,K1=jt.unstable_shouldYield,z1=jt.unstable_requestPaint,Ue=jt.unstable_now,W1=jt.unstable_getCurrentPriorityLevel,dh=jt.unstable_ImmediatePriority,cy=jt.unstable_UserBlockingPriority,Pl=jt.unstable_NormalPriority,Y1=jt.unstable_LowPriority,uy=jt.unstable_IdlePriority,xc=null,jn=null;function q1(n){if(jn&&typeof jn.onCommitFiberRoot=="function")try{jn.onCommitFiberRoot(xc,n,void 0,(n.current.flags&128)===128)}catch{}}var yn=Math.clz32?Math.clz32:Z1,Q1=Math.log,X1=Math.LN2;function Z1(n){return n>>>=0,n===0?32:31-(Q1(n)/X1|0)|0}var Ea=64,Sa=4194304;function uo(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Dl(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?r=uo(a):(i&=o,i!==0&&(r=uo(i)))}else o=t&~s,o!==0?r=uo(o):i!==0&&(r=uo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-yn(e),s=1<<t,r|=n[t],e&=~s;return r}function J1(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ew(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-yn(i),a=1<<o,l=s[o];l===-1?(!(a&t)||a&r)&&(s[o]=J1(a,e)):l<=e&&(n.expiredLanes|=a),i&=~a}}function Fd(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function dy(){var n=Ea;return Ea<<=1,!(Ea&4194240)&&(Ea=64),n}function gu(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function ia(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-yn(e),n[e]=t}function tw(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-yn(t),i=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~i}}function fh(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-yn(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var pe=0;function fy(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var hy,hh,my,py,gy,$d=!1,Ta=[],Gr=null,Vr=null,Hr=null,_o=new Map,Po=new Map,Pr=[],nw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fp(n,e){switch(n){case"focusin":case"focusout":Gr=null;break;case"dragenter":case"dragleave":Vr=null;break;case"mouseover":case"mouseout":Hr=null;break;case"pointerover":case"pointerout":_o.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Po.delete(e.pointerId)}}function Ji(n,e,t,r,s,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=aa(e),e!==null&&hh(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function rw(n,e,t,r,s){switch(e){case"focusin":return Gr=Ji(Gr,n,e,t,r,s),!0;case"dragenter":return Vr=Ji(Vr,n,e,t,r,s),!0;case"mouseover":return Hr=Ji(Hr,n,e,t,r,s),!0;case"pointerover":var i=s.pointerId;return _o.set(i,Ji(_o.get(i)||null,n,e,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Po.set(i,Ji(Po.get(i)||null,n,e,t,r,s)),!0}return!1}function vy(n){var e=gs(n.target);if(e!==null){var t=Fs(e);if(t!==null){if(e=t.tag,e===13){if(e=iy(t),e!==null){n.blockedOn=e,gy(n.priority,function(){my(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function il(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Bd(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Dd=r,t.target.dispatchEvent(r),Dd=null}else return e=aa(t),e!==null&&hh(e),n.blockedOn=t,!1;e.shift()}return!0}function hp(n,e,t){il(n)&&t.delete(e)}function sw(){$d=!1,Gr!==null&&il(Gr)&&(Gr=null),Vr!==null&&il(Vr)&&(Vr=null),Hr!==null&&il(Hr)&&(Hr=null),_o.forEach(hp),Po.forEach(hp)}function eo(n,e){n.blockedOn===e&&(n.blockedOn=null,$d||($d=!0,jt.unstable_scheduleCallback(jt.unstable_NormalPriority,sw)))}function Do(n){function e(s){return eo(s,n)}if(0<Ta.length){eo(Ta[0],n);for(var t=1;t<Ta.length;t++){var r=Ta[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Gr!==null&&eo(Gr,n),Vr!==null&&eo(Vr,n),Hr!==null&&eo(Hr,n),_o.forEach(e),Po.forEach(e),t=0;t<Pr.length;t++)r=Pr[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Pr.length&&(t=Pr[0],t.blockedOn===null);)vy(t),t.blockedOn===null&&Pr.shift()}var fi=pr.ReactCurrentBatchConfig,Nl=!0;function iw(n,e,t,r){var s=pe,i=fi.transition;fi.transition=null;try{pe=1,mh(n,e,t,r)}finally{pe=s,fi.transition=i}}function ow(n,e,t,r){var s=pe,i=fi.transition;fi.transition=null;try{pe=4,mh(n,e,t,r)}finally{pe=s,fi.transition=i}}function mh(n,e,t,r){if(Nl){var s=Bd(n,e,t,r);if(s===null)Lu(n,e,r,Ol,t),fp(n,r);else if(rw(s,n,e,t,r))r.stopPropagation();else if(fp(n,r),e&4&&-1<nw.indexOf(n)){for(;s!==null;){var i=aa(s);if(i!==null&&hy(i),i=Bd(n,e,t,r),i===null&&Lu(n,e,r,Ol,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else Lu(n,e,r,null,t)}}var Ol=null;function Bd(n,e,t,r){if(Ol=null,n=uh(r),n=gs(n),n!==null)if(e=Fs(n),e===null)n=null;else if(t=e.tag,t===13){if(n=iy(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Ol=n,null}function yy(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(W1()){case dh:return 1;case cy:return 4;case Pl:case Y1:return 16;case uy:return 536870912;default:return 16}default:return 16}}var Br=null,ph=null,ol=null;function xy(){if(ol)return ol;var n,e=ph,t=e.length,r,s="value"in Br?Br.value:Br.textContent,i=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===s[i-r];r++);return ol=s.slice(n,1<r?1-r:void 0)}function al(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function ba(){return!0}function mp(){return!1}function Vt(n){function e(t,r,s,i,o){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ba:mp,this.isPropagationStopped=mp,this}return Ne(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=ba)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=ba)},persist:function(){},isPersistent:ba}),e}var Vi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gh=Vt(Vi),oa=Ne({},Vi,{view:0,detail:0}),aw=Vt(oa),vu,yu,to,Ec=Ne({},oa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vh,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==to&&(to&&n.type==="mousemove"?(vu=n.screenX-to.screenX,yu=n.screenY-to.screenY):yu=vu=0,to=n),vu)},movementY:function(n){return"movementY"in n?n.movementY:yu}}),pp=Vt(Ec),lw=Ne({},Ec,{dataTransfer:0}),cw=Vt(lw),uw=Ne({},oa,{relatedTarget:0}),xu=Vt(uw),dw=Ne({},Vi,{animationName:0,elapsedTime:0,pseudoElement:0}),fw=Vt(dw),hw=Ne({},Vi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),mw=Vt(hw),pw=Ne({},Vi,{data:0}),gp=Vt(pw),gw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xw(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=yw[n])?!!e[n]:!1}function vh(){return xw}var Ew=Ne({},oa,{key:function(n){if(n.key){var e=gw[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=al(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?vw[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vh,charCode:function(n){return n.type==="keypress"?al(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?al(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Sw=Vt(Ew),Tw=Ne({},Ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vp=Vt(Tw),bw=Ne({},oa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vh}),ww=Vt(bw),Aw=Ne({},Vi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Lw=Vt(Aw),Iw=Ne({},Ec,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Rw=Vt(Iw),Cw=[9,13,27,32],yh=cr&&"CompositionEvent"in window,go=null;cr&&"documentMode"in document&&(go=document.documentMode);var kw=cr&&"TextEvent"in window&&!go,Ey=cr&&(!yh||go&&8<go&&11>=go),yp=" ",xp=!1;function Sy(n,e){switch(n){case"keyup":return Cw.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ty(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Zs=!1;function _w(n,e){switch(n){case"compositionend":return Ty(e);case"keypress":return e.which!==32?null:(xp=!0,yp);case"textInput":return n=e.data,n===yp&&xp?null:n;default:return null}}function Pw(n,e){if(Zs)return n==="compositionend"||!yh&&Sy(n,e)?(n=xy(),ol=ph=Br=null,Zs=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ey&&e.locale!=="ko"?null:e.data;default:return null}}var Dw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ep(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Dw[n.type]:e==="textarea"}function by(n,e,t,r){ey(r),e=Ml(e,"onChange"),0<e.length&&(t=new gh("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var vo=null,No=null;function Nw(n){Ny(n,0)}function Sc(n){var e=ti(n);if(Wv(e))return n}function Ow(n,e){if(n==="change")return e}var wy=!1;if(cr){var Eu;if(cr){var Su="oninput"in document;if(!Su){var Sp=document.createElement("div");Sp.setAttribute("oninput","return;"),Su=typeof Sp.oninput=="function"}Eu=Su}else Eu=!1;wy=Eu&&(!document.documentMode||9<document.documentMode)}function Tp(){vo&&(vo.detachEvent("onpropertychange",Ay),No=vo=null)}function Ay(n){if(n.propertyName==="value"&&Sc(No)){var e=[];by(e,No,n,uh(n)),sy(Nw,e)}}function Mw(n,e,t){n==="focusin"?(Tp(),vo=e,No=t,vo.attachEvent("onpropertychange",Ay)):n==="focusout"&&Tp()}function Fw(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Sc(No)}function $w(n,e){if(n==="click")return Sc(e)}function Bw(n,e){if(n==="input"||n==="change")return Sc(e)}function Uw(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var En=typeof Object.is=="function"?Object.is:Uw;function Oo(n,e){if(En(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!Sd.call(e,s)||!En(n[s],e[s]))return!1}return!0}function bp(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function wp(n,e){var t=bp(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=bp(t)}}function Ly(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Ly(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Iy(){for(var n=window,e=Cl();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Cl(n.document)}return e}function xh(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function jw(n){var e=Iy(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Ly(t.ownerDocument.documentElement,t)){if(r!==null&&xh(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!n.extend&&i>r&&(s=r,r=i,i=s),s=wp(t,i);var o=wp(t,r);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Gw=cr&&"documentMode"in document&&11>=document.documentMode,Js=null,Ud=null,yo=null,jd=!1;function Ap(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;jd||Js==null||Js!==Cl(r)||(r=Js,"selectionStart"in r&&xh(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),yo&&Oo(yo,r)||(yo=r,r=Ml(Ud,"onSelect"),0<r.length&&(e=new gh("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Js)))}function wa(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var ei={animationend:wa("Animation","AnimationEnd"),animationiteration:wa("Animation","AnimationIteration"),animationstart:wa("Animation","AnimationStart"),transitionend:wa("Transition","TransitionEnd")},Tu={},Ry={};cr&&(Ry=document.createElement("div").style,"AnimationEvent"in window||(delete ei.animationend.animation,delete ei.animationiteration.animation,delete ei.animationstart.animation),"TransitionEvent"in window||delete ei.transitionend.transition);function Tc(n){if(Tu[n])return Tu[n];if(!ei[n])return n;var e=ei[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Ry)return Tu[n]=e[t];return n}var Cy=Tc("animationend"),ky=Tc("animationiteration"),_y=Tc("animationstart"),Py=Tc("transitionend"),Dy=new Map,Lp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rs(n,e){Dy.set(n,e),Ms(e,[n])}for(var bu=0;bu<Lp.length;bu++){var wu=Lp[bu],Vw=wu.toLowerCase(),Hw=wu[0].toUpperCase()+wu.slice(1);rs(Vw,"on"+Hw)}rs(Cy,"onAnimationEnd");rs(ky,"onAnimationIteration");rs(_y,"onAnimationStart");rs("dblclick","onDoubleClick");rs("focusin","onFocus");rs("focusout","onBlur");rs(Py,"onTransitionEnd");_i("onMouseEnter",["mouseout","mouseover"]);_i("onMouseLeave",["mouseout","mouseover"]);_i("onPointerEnter",["pointerout","pointerover"]);_i("onPointerLeave",["pointerout","pointerover"]);Ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ms("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Kw=new Set("cancel close invalid load scroll toggle".split(" ").concat(fo));function Ip(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,V1(r,e,void 0,n),n.currentTarget=null}function Ny(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Ip(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Ip(s,a,c),i=l}}}if(_l)throw n=Md,_l=!1,Md=null,n}function Ae(n,e){var t=e[zd];t===void 0&&(t=e[zd]=new Set);var r=n+"__bubble";t.has(r)||(Oy(e,n,2,!1),t.add(r))}function Au(n,e,t){var r=0;e&&(r|=4),Oy(t,n,r,e)}var Aa="_reactListening"+Math.random().toString(36).slice(2);function Mo(n){if(!n[Aa]){n[Aa]=!0,Gv.forEach(function(t){t!=="selectionchange"&&(Kw.has(t)||Au(t,!1,n),Au(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Aa]||(e[Aa]=!0,Au("selectionchange",!1,e))}}function Oy(n,e,t,r){switch(yy(e)){case 1:var s=iw;break;case 4:s=ow;break;default:s=mh}t=s.bind(null,e,t,n),s=void 0,!Od||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function Lu(n,e,t,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=gs(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}sy(function(){var c=i,u=uh(t),d=[];e:{var f=Dy.get(n);if(f!==void 0){var h=gh,p=n;switch(n){case"keypress":if(al(t)===0)break e;case"keydown":case"keyup":h=Sw;break;case"focusin":p="focus",h=xu;break;case"focusout":p="blur",h=xu;break;case"beforeblur":case"afterblur":h=xu;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=pp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=cw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=ww;break;case Cy:case ky:case _y:h=fw;break;case Py:h=Lw;break;case"scroll":h=aw;break;case"wheel":h=Rw;break;case"copy":case"cut":case"paste":h=mw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=vp}var m=(e&4)!==0,g=!m&&n==="scroll",v=m?f!==null?f+"Capture":null:f;m=[];for(var x=c,E;x!==null;){E=x;var T=E.stateNode;if(E.tag===5&&T!==null&&(E=T,v!==null&&(T=ko(x,v),T!=null&&m.push(Fo(x,T,E)))),g)break;x=x.return}0<m.length&&(f=new h(f,p,null,t,u),d.push({event:f,listeners:m}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",h=n==="mouseout"||n==="pointerout",f&&t!==Dd&&(p=t.relatedTarget||t.fromElement)&&(gs(p)||p[ur]))break e;if((h||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=t.relatedTarget||t.toElement,h=c,p=p?gs(p):null,p!==null&&(g=Fs(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=c),h!==p)){if(m=pp,T="onMouseLeave",v="onMouseEnter",x="mouse",(n==="pointerout"||n==="pointerover")&&(m=vp,T="onPointerLeave",v="onPointerEnter",x="pointer"),g=h==null?f:ti(h),E=p==null?f:ti(p),f=new m(T,x+"leave",h,t,u),f.target=g,f.relatedTarget=E,T=null,gs(u)===c&&(m=new m(v,x+"enter",p,t,u),m.target=E,m.relatedTarget=g,T=m),g=T,h&&p)t:{for(m=h,v=p,x=0,E=m;E;E=js(E))x++;for(E=0,T=v;T;T=js(T))E++;for(;0<x-E;)m=js(m),x--;for(;0<E-x;)v=js(v),E--;for(;x--;){if(m===v||v!==null&&m===v.alternate)break t;m=js(m),v=js(v)}m=null}else m=null;h!==null&&Rp(d,f,h,m,!1),p!==null&&g!==null&&Rp(d,g,p,m,!0)}}e:{if(f=c?ti(c):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var w=Ow;else if(Ep(f))if(wy)w=Bw;else{w=Fw;var L=Mw}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(w=$w);if(w&&(w=w(n,c))){by(d,w,t,u);break e}L&&L(n,f,c),n==="focusout"&&(L=f._wrapperState)&&L.controlled&&f.type==="number"&&Rd(f,"number",f.value)}switch(L=c?ti(c):window,n){case"focusin":(Ep(L)||L.contentEditable==="true")&&(Js=L,Ud=c,yo=null);break;case"focusout":yo=Ud=Js=null;break;case"mousedown":jd=!0;break;case"contextmenu":case"mouseup":case"dragend":jd=!1,Ap(d,t,u);break;case"selectionchange":if(Gw)break;case"keydown":case"keyup":Ap(d,t,u)}var A;if(yh)e:{switch(n){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Zs?Sy(n,t)&&(R="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(R="onCompositionStart");R&&(Ey&&t.locale!=="ko"&&(Zs||R!=="onCompositionStart"?R==="onCompositionEnd"&&Zs&&(A=xy()):(Br=u,ph="value"in Br?Br.value:Br.textContent,Zs=!0)),L=Ml(c,R),0<L.length&&(R=new gp(R,n,null,t,u),d.push({event:R,listeners:L}),A?R.data=A:(A=Ty(t),A!==null&&(R.data=A)))),(A=kw?_w(n,t):Pw(n,t))&&(c=Ml(c,"onBeforeInput"),0<c.length&&(u=new gp("onBeforeInput","beforeinput",null,t,u),d.push({event:u,listeners:c}),u.data=A))}Ny(d,e)})}function Fo(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Ml(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ko(n,t),i!=null&&r.unshift(Fo(n,i,s)),i=ko(n,e),i!=null&&r.push(Fo(n,i,s))),n=n.return}return r}function js(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Rp(n,e,t,r,s){for(var i=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=ko(t,i),l!=null&&o.unshift(Fo(t,l,a))):s||(l=ko(t,i),l!=null&&o.push(Fo(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var zw=/\r\n?/g,Ww=/\u0000|\uFFFD/g;function Cp(n){return(typeof n=="string"?n:""+n).replace(zw,`
`).replace(Ww,"")}function La(n,e,t){if(e=Cp(e),Cp(n)!==e&&t)throw Error(W(425))}function Fl(){}var Gd=null,Vd=null;function Hd(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Kd=typeof setTimeout=="function"?setTimeout:void 0,Yw=typeof clearTimeout=="function"?clearTimeout:void 0,kp=typeof Promise=="function"?Promise:void 0,qw=typeof queueMicrotask=="function"?queueMicrotask:typeof kp<"u"?function(n){return kp.resolve(null).then(n).catch(Qw)}:Kd;function Qw(n){setTimeout(function(){throw n})}function Iu(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),Do(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);Do(e)}function Kr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function _p(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Hi=Math.random().toString(36).slice(2),Mn="__reactFiber$"+Hi,$o="__reactProps$"+Hi,ur="__reactContainer$"+Hi,zd="__reactEvents$"+Hi,Xw="__reactListeners$"+Hi,Zw="__reactHandles$"+Hi;function gs(n){var e=n[Mn];if(e)return e;for(var t=n.parentNode;t;){if(e=t[ur]||t[Mn]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=_p(n);n!==null;){if(t=n[Mn])return t;n=_p(n)}return e}n=t,t=n.parentNode}return null}function aa(n){return n=n[Mn]||n[ur],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function ti(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(W(33))}function bc(n){return n[$o]||null}var Wd=[],ni=-1;function ss(n){return{current:n}}function Le(n){0>ni||(n.current=Wd[ni],Wd[ni]=null,ni--)}function Te(n,e){ni++,Wd[ni]=n.current,n.current=e}var Zr={},ft=ss(Zr),Rt=ss(!1),Rs=Zr;function Pi(n,e){var t=n.type.contextTypes;if(!t)return Zr;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function Ct(n){return n=n.childContextTypes,n!=null}function $l(){Le(Rt),Le(ft)}function Pp(n,e,t){if(ft.current!==Zr)throw Error(W(168));Te(ft,e),Te(Rt,t)}function My(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(W(108,M1(n)||"Unknown",s));return Ne({},t,r)}function Bl(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Zr,Rs=ft.current,Te(ft,n),Te(Rt,Rt.current),!0}function Dp(n,e,t){var r=n.stateNode;if(!r)throw Error(W(169));t?(n=My(n,e,Rs),r.__reactInternalMemoizedMergedChildContext=n,Le(Rt),Le(ft),Te(ft,n)):Le(Rt),Te(Rt,t)}var sr=null,wc=!1,Ru=!1;function Fy(n){sr===null?sr=[n]:sr.push(n)}function Jw(n){wc=!0,Fy(n)}function is(){if(!Ru&&sr!==null){Ru=!0;var n=0,e=pe;try{var t=sr;for(pe=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}sr=null,wc=!1}catch(s){throw sr!==null&&(sr=sr.slice(n+1)),ly(dh,is),s}finally{pe=e,Ru=!1}}return null}var ri=[],si=0,Ul=null,jl=0,Yt=[],qt=0,Cs=null,or=1,ar="";function hs(n,e){ri[si++]=jl,ri[si++]=Ul,Ul=n,jl=e}function $y(n,e,t){Yt[qt++]=or,Yt[qt++]=ar,Yt[qt++]=Cs,Cs=n;var r=or;n=ar;var s=32-yn(r)-1;r&=~(1<<s),t+=1;var i=32-yn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,or=1<<32-yn(e)+s|t<<s|r,ar=i+n}else or=1<<i|t<<s|r,ar=n}function Eh(n){n.return!==null&&(hs(n,1),$y(n,1,0))}function Sh(n){for(;n===Ul;)Ul=ri[--si],ri[si]=null,jl=ri[--si],ri[si]=null;for(;n===Cs;)Cs=Yt[--qt],Yt[qt]=null,ar=Yt[--qt],Yt[qt]=null,or=Yt[--qt],Yt[qt]=null}var $t=null,Ft=null,ke=!1,gn=null;function By(n,e){var t=Qt(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function Np(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,$t=n,Ft=Kr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,$t=n,Ft=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Cs!==null?{id:or,overflow:ar}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Qt(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,$t=n,Ft=null,!0):!1;default:return!1}}function Yd(n){return(n.mode&1)!==0&&(n.flags&128)===0}function qd(n){if(ke){var e=Ft;if(e){var t=e;if(!Np(n,e)){if(Yd(n))throw Error(W(418));e=Kr(t.nextSibling);var r=$t;e&&Np(n,e)?By(r,t):(n.flags=n.flags&-4097|2,ke=!1,$t=n)}}else{if(Yd(n))throw Error(W(418));n.flags=n.flags&-4097|2,ke=!1,$t=n}}}function Op(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;$t=n}function Ia(n){if(n!==$t)return!1;if(!ke)return Op(n),ke=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Hd(n.type,n.memoizedProps)),e&&(e=Ft)){if(Yd(n))throw Uy(),Error(W(418));for(;e;)By(n,e),e=Kr(e.nextSibling)}if(Op(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(W(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Ft=Kr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Ft=null}}else Ft=$t?Kr(n.stateNode.nextSibling):null;return!0}function Uy(){for(var n=Ft;n;)n=Kr(n.nextSibling)}function Di(){Ft=$t=null,ke=!1}function Th(n){gn===null?gn=[n]:gn.push(n)}var eA=pr.ReactCurrentBatchConfig;function no(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(W(309));var r=t.stateNode}if(!r)throw Error(W(147,n));var s=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error(W(284));if(!t._owner)throw Error(W(290,n))}return n}function Ra(n,e){throw n=Object.prototype.toString.call(e),Error(W(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Mp(n){var e=n._init;return e(n._payload)}function jy(n){function e(v,x){if(n){var E=v.deletions;E===null?(v.deletions=[x],v.flags|=16):E.push(x)}}function t(v,x){if(!n)return null;for(;x!==null;)e(v,x),x=x.sibling;return null}function r(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function s(v,x){return v=qr(v,x),v.index=0,v.sibling=null,v}function i(v,x,E){return v.index=E,n?(E=v.alternate,E!==null?(E=E.index,E<x?(v.flags|=2,x):E):(v.flags|=2,x)):(v.flags|=1048576,x)}function o(v){return n&&v.alternate===null&&(v.flags|=2),v}function a(v,x,E,T){return x===null||x.tag!==6?(x=Ou(E,v.mode,T),x.return=v,x):(x=s(x,E),x.return=v,x)}function l(v,x,E,T){var w=E.type;return w===Xs?u(v,x,E.props.children,T,E.key):x!==null&&(x.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Rr&&Mp(w)===x.type)?(T=s(x,E.props),T.ref=no(v,x,E),T.return=v,T):(T=ml(E.type,E.key,E.props,null,v.mode,T),T.ref=no(v,x,E),T.return=v,T)}function c(v,x,E,T){return x===null||x.tag!==4||x.stateNode.containerInfo!==E.containerInfo||x.stateNode.implementation!==E.implementation?(x=Mu(E,v.mode,T),x.return=v,x):(x=s(x,E.children||[]),x.return=v,x)}function u(v,x,E,T,w){return x===null||x.tag!==7?(x=Ls(E,v.mode,T,w),x.return=v,x):(x=s(x,E),x.return=v,x)}function d(v,x,E){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Ou(""+x,v.mode,E),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case va:return E=ml(x.type,x.key,x.props,null,v.mode,E),E.ref=no(v,null,x),E.return=v,E;case Qs:return x=Mu(x,v.mode,E),x.return=v,x;case Rr:var T=x._init;return d(v,T(x._payload),E)}if(co(x)||Xi(x))return x=Ls(x,v.mode,E,null),x.return=v,x;Ra(v,x)}return null}function f(v,x,E,T){var w=x!==null?x.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return w!==null?null:a(v,x,""+E,T);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case va:return E.key===w?l(v,x,E,T):null;case Qs:return E.key===w?c(v,x,E,T):null;case Rr:return w=E._init,f(v,x,w(E._payload),T)}if(co(E)||Xi(E))return w!==null?null:u(v,x,E,T,null);Ra(v,E)}return null}function h(v,x,E,T,w){if(typeof T=="string"&&T!==""||typeof T=="number")return v=v.get(E)||null,a(x,v,""+T,w);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case va:return v=v.get(T.key===null?E:T.key)||null,l(x,v,T,w);case Qs:return v=v.get(T.key===null?E:T.key)||null,c(x,v,T,w);case Rr:var L=T._init;return h(v,x,E,L(T._payload),w)}if(co(T)||Xi(T))return v=v.get(E)||null,u(x,v,T,w,null);Ra(x,T)}return null}function p(v,x,E,T){for(var w=null,L=null,A=x,R=x=0,C=null;A!==null&&R<E.length;R++){A.index>R?(C=A,A=null):C=A.sibling;var I=f(v,A,E[R],T);if(I===null){A===null&&(A=C);break}n&&A&&I.alternate===null&&e(v,A),x=i(I,x,R),L===null?w=I:L.sibling=I,L=I,A=C}if(R===E.length)return t(v,A),ke&&hs(v,R),w;if(A===null){for(;R<E.length;R++)A=d(v,E[R],T),A!==null&&(x=i(A,x,R),L===null?w=A:L.sibling=A,L=A);return ke&&hs(v,R),w}for(A=r(v,A);R<E.length;R++)C=h(A,v,R,E[R],T),C!==null&&(n&&C.alternate!==null&&A.delete(C.key===null?R:C.key),x=i(C,x,R),L===null?w=C:L.sibling=C,L=C);return n&&A.forEach(function(P){return e(v,P)}),ke&&hs(v,R),w}function m(v,x,E,T){var w=Xi(E);if(typeof w!="function")throw Error(W(150));if(E=w.call(E),E==null)throw Error(W(151));for(var L=w=null,A=x,R=x=0,C=null,I=E.next();A!==null&&!I.done;R++,I=E.next()){A.index>R?(C=A,A=null):C=A.sibling;var P=f(v,A,I.value,T);if(P===null){A===null&&(A=C);break}n&&A&&P.alternate===null&&e(v,A),x=i(P,x,R),L===null?w=P:L.sibling=P,L=P,A=C}if(I.done)return t(v,A),ke&&hs(v,R),w;if(A===null){for(;!I.done;R++,I=E.next())I=d(v,I.value,T),I!==null&&(x=i(I,x,R),L===null?w=I:L.sibling=I,L=I);return ke&&hs(v,R),w}for(A=r(v,A);!I.done;R++,I=E.next())I=h(A,v,R,I.value,T),I!==null&&(n&&I.alternate!==null&&A.delete(I.key===null?R:I.key),x=i(I,x,R),L===null?w=I:L.sibling=I,L=I);return n&&A.forEach(function(O){return e(v,O)}),ke&&hs(v,R),w}function g(v,x,E,T){if(typeof E=="object"&&E!==null&&E.type===Xs&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case va:e:{for(var w=E.key,L=x;L!==null;){if(L.key===w){if(w=E.type,w===Xs){if(L.tag===7){t(v,L.sibling),x=s(L,E.props.children),x.return=v,v=x;break e}}else if(L.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Rr&&Mp(w)===L.type){t(v,L.sibling),x=s(L,E.props),x.ref=no(v,L,E),x.return=v,v=x;break e}t(v,L);break}else e(v,L);L=L.sibling}E.type===Xs?(x=Ls(E.props.children,v.mode,T,E.key),x.return=v,v=x):(T=ml(E.type,E.key,E.props,null,v.mode,T),T.ref=no(v,x,E),T.return=v,v=T)}return o(v);case Qs:e:{for(L=E.key;x!==null;){if(x.key===L)if(x.tag===4&&x.stateNode.containerInfo===E.containerInfo&&x.stateNode.implementation===E.implementation){t(v,x.sibling),x=s(x,E.children||[]),x.return=v,v=x;break e}else{t(v,x);break}else e(v,x);x=x.sibling}x=Mu(E,v.mode,T),x.return=v,v=x}return o(v);case Rr:return L=E._init,g(v,x,L(E._payload),T)}if(co(E))return p(v,x,E,T);if(Xi(E))return m(v,x,E,T);Ra(v,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,x!==null&&x.tag===6?(t(v,x.sibling),x=s(x,E),x.return=v,v=x):(t(v,x),x=Ou(E,v.mode,T),x.return=v,v=x),o(v)):t(v,x)}return g}var Ni=jy(!0),Gy=jy(!1),Gl=ss(null),Vl=null,ii=null,bh=null;function wh(){bh=ii=Vl=null}function Ah(n){var e=Gl.current;Le(Gl),n._currentValue=e}function Qd(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function hi(n,e){Vl=n,bh=ii=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Lt=!0),n.firstContext=null)}function Zt(n){var e=n._currentValue;if(bh!==n)if(n={context:n,memoizedValue:e,next:null},ii===null){if(Vl===null)throw Error(W(308));ii=n,Vl.dependencies={lanes:0,firstContext:n}}else ii=ii.next=n;return e}var vs=null;function Lh(n){vs===null?vs=[n]:vs.push(n)}function Vy(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,Lh(e)):(t.next=s.next,s.next=t),e.interleaved=t,dr(n,r)}function dr(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Cr=!1;function Ih(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Hy(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function lr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function zr(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,fe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,dr(n,t)}return s=r.interleaved,s===null?(e.next=e,Lh(r)):(e.next=s.next,s.next=e),r.interleaved=e,dr(n,t)}function ll(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,fh(n,t)}}function Fp(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Hl(n,e,t,r){var s=n.updateQueue;Cr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=n.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=s.baseState;o=0,u=c=l=null,a=i;do{var f=a.lane,h=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=n,m=a;switch(f=e,h=t,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Ne({},d,f);break e;case 2:Cr=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=h,l=d):u=u.next=h,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(u===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);_s|=o,n.lanes=o,n.memoizedState=d}}function $p(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var la={},Gn=ss(la),Bo=ss(la),Uo=ss(la);function ys(n){if(n===la)throw Error(W(174));return n}function Rh(n,e){switch(Te(Uo,e),Te(Bo,n),Te(Gn,la),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:kd(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=kd(e,n)}Le(Gn),Te(Gn,e)}function Oi(){Le(Gn),Le(Bo),Le(Uo)}function Ky(n){ys(Uo.current);var e=ys(Gn.current),t=kd(e,n.type);e!==t&&(Te(Bo,n),Te(Gn,t))}function Ch(n){Bo.current===n&&(Le(Gn),Le(Bo))}var Pe=ss(0);function Kl(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Cu=[];function kh(){for(var n=0;n<Cu.length;n++)Cu[n]._workInProgressVersionPrimary=null;Cu.length=0}var cl=pr.ReactCurrentDispatcher,ku=pr.ReactCurrentBatchConfig,ks=0,De=null,Ke=null,Je=null,zl=!1,xo=!1,jo=0,tA=0;function lt(){throw Error(W(321))}function _h(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!En(n[t],e[t]))return!1;return!0}function Ph(n,e,t,r,s,i){if(ks=i,De=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,cl.current=n===null||n.memoizedState===null?iA:oA,n=t(r,s),xo){i=0;do{if(xo=!1,jo=0,25<=i)throw Error(W(301));i+=1,Je=Ke=null,e.updateQueue=null,cl.current=aA,n=t(r,s)}while(xo)}if(cl.current=Wl,e=Ke!==null&&Ke.next!==null,ks=0,Je=Ke=De=null,zl=!1,e)throw Error(W(300));return n}function Dh(){var n=jo!==0;return jo=0,n}function kn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Je===null?De.memoizedState=Je=n:Je=Je.next=n,Je}function Jt(){if(Ke===null){var n=De.alternate;n=n!==null?n.memoizedState:null}else n=Ke.next;var e=Je===null?De.memoizedState:Je.next;if(e!==null)Je=e,Ke=n;else{if(n===null)throw Error(W(310));Ke=n,n={memoizedState:Ke.memoizedState,baseState:Ke.baseState,baseQueue:Ke.baseQueue,queue:Ke.queue,next:null},Je===null?De.memoizedState=Je=n:Je=Je.next=n}return Je}function Go(n,e){return typeof e=="function"?e(n):e}function _u(n){var e=Jt(),t=e.queue;if(t===null)throw Error(W(311));t.lastRenderedReducer=n;var r=Ke,s=r.baseQueue,i=t.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((ks&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,De.lanes|=u,_s|=u}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,En(r,e.memoizedState)||(Lt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do i=s.lane,De.lanes|=i,_s|=i,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Pu(n){var e=Jt(),t=e.queue;if(t===null)throw Error(W(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=n(i,o.action),o=o.next;while(o!==s);En(i,e.memoizedState)||(Lt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function zy(){}function Wy(n,e){var t=De,r=Jt(),s=e(),i=!En(r.memoizedState,s);if(i&&(r.memoizedState=s,Lt=!0),r=r.queue,Nh(Qy.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||Je!==null&&Je.memoizedState.tag&1){if(t.flags|=2048,Vo(9,qy.bind(null,t,r,s,e),void 0,null),et===null)throw Error(W(349));ks&30||Yy(t,e,s)}return s}function Yy(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function qy(n,e,t,r){e.value=t,e.getSnapshot=r,Xy(e)&&Zy(n)}function Qy(n,e,t){return t(function(){Xy(e)&&Zy(n)})}function Xy(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!En(n,t)}catch{return!0}}function Zy(n){var e=dr(n,1);e!==null&&xn(e,n,1,-1)}function Bp(n){var e=kn();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Go,lastRenderedState:n},e.queue=n,n=n.dispatch=sA.bind(null,De,n),[e.memoizedState,n]}function Vo(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function Jy(){return Jt().memoizedState}function ul(n,e,t,r){var s=kn();De.flags|=n,s.memoizedState=Vo(1|e,t,void 0,r===void 0?null:r)}function Ac(n,e,t,r){var s=Jt();r=r===void 0?null:r;var i=void 0;if(Ke!==null){var o=Ke.memoizedState;if(i=o.destroy,r!==null&&_h(r,o.deps)){s.memoizedState=Vo(e,t,i,r);return}}De.flags|=n,s.memoizedState=Vo(1|e,t,i,r)}function Up(n,e){return ul(8390656,8,n,e)}function Nh(n,e){return Ac(2048,8,n,e)}function ex(n,e){return Ac(4,2,n,e)}function tx(n,e){return Ac(4,4,n,e)}function nx(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function rx(n,e,t){return t=t!=null?t.concat([n]):null,Ac(4,4,nx.bind(null,e,n),t)}function Oh(){}function sx(n,e){var t=Jt();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&_h(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function ix(n,e){var t=Jt();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&_h(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function ox(n,e,t){return ks&21?(En(t,e)||(t=dy(),De.lanes|=t,_s|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Lt=!0),n.memoizedState=t)}function nA(n,e){var t=pe;pe=t!==0&&4>t?t:4,n(!0);var r=ku.transition;ku.transition={};try{n(!1),e()}finally{pe=t,ku.transition=r}}function ax(){return Jt().memoizedState}function rA(n,e,t){var r=Yr(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},lx(n))cx(e,t);else if(t=Vy(n,e,t,r),t!==null){var s=vt();xn(t,n,r,s),ux(t,e,r)}}function sA(n,e,t){var r=Yr(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(lx(n))cx(e,s);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(s.hasEagerState=!0,s.eagerState=a,En(a,o)){var l=e.interleaved;l===null?(s.next=s,Lh(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}t=Vy(n,e,s,r),t!==null&&(s=vt(),xn(t,n,r,s),ux(t,e,r))}}function lx(n){var e=n.alternate;return n===De||e!==null&&e===De}function cx(n,e){xo=zl=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function ux(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,fh(n,t)}}var Wl={readContext:Zt,useCallback:lt,useContext:lt,useEffect:lt,useImperativeHandle:lt,useInsertionEffect:lt,useLayoutEffect:lt,useMemo:lt,useReducer:lt,useRef:lt,useState:lt,useDebugValue:lt,useDeferredValue:lt,useTransition:lt,useMutableSource:lt,useSyncExternalStore:lt,useId:lt,unstable_isNewReconciler:!1},iA={readContext:Zt,useCallback:function(n,e){return kn().memoizedState=[n,e===void 0?null:e],n},useContext:Zt,useEffect:Up,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,ul(4194308,4,nx.bind(null,e,n),t)},useLayoutEffect:function(n,e){return ul(4194308,4,n,e)},useInsertionEffect:function(n,e){return ul(4,2,n,e)},useMemo:function(n,e){var t=kn();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=kn();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=rA.bind(null,De,n),[r.memoizedState,n]},useRef:function(n){var e=kn();return n={current:n},e.memoizedState=n},useState:Bp,useDebugValue:Oh,useDeferredValue:function(n){return kn().memoizedState=n},useTransition:function(){var n=Bp(!1),e=n[0];return n=nA.bind(null,n[1]),kn().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=De,s=kn();if(ke){if(t===void 0)throw Error(W(407));t=t()}else{if(t=e(),et===null)throw Error(W(349));ks&30||Yy(r,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,Up(Qy.bind(null,r,i,n),[n]),r.flags|=2048,Vo(9,qy.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=kn(),e=et.identifierPrefix;if(ke){var t=ar,r=or;t=(r&~(1<<32-yn(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=jo++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=tA++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},oA={readContext:Zt,useCallback:sx,useContext:Zt,useEffect:Nh,useImperativeHandle:rx,useInsertionEffect:ex,useLayoutEffect:tx,useMemo:ix,useReducer:_u,useRef:Jy,useState:function(){return _u(Go)},useDebugValue:Oh,useDeferredValue:function(n){var e=Jt();return ox(e,Ke.memoizedState,n)},useTransition:function(){var n=_u(Go)[0],e=Jt().memoizedState;return[n,e]},useMutableSource:zy,useSyncExternalStore:Wy,useId:ax,unstable_isNewReconciler:!1},aA={readContext:Zt,useCallback:sx,useContext:Zt,useEffect:Nh,useImperativeHandle:rx,useInsertionEffect:ex,useLayoutEffect:tx,useMemo:ix,useReducer:Pu,useRef:Jy,useState:function(){return Pu(Go)},useDebugValue:Oh,useDeferredValue:function(n){var e=Jt();return Ke===null?e.memoizedState=n:ox(e,Ke.memoizedState,n)},useTransition:function(){var n=Pu(Go)[0],e=Jt().memoizedState;return[n,e]},useMutableSource:zy,useSyncExternalStore:Wy,useId:ax,unstable_isNewReconciler:!1};function dn(n,e){if(n&&n.defaultProps){e=Ne({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Xd(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Ne({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Lc={isMounted:function(n){return(n=n._reactInternals)?Fs(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=vt(),s=Yr(n),i=lr(r,s);i.payload=e,t!=null&&(i.callback=t),e=zr(n,i,s),e!==null&&(xn(e,n,s,r),ll(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=vt(),s=Yr(n),i=lr(r,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=zr(n,i,s),e!==null&&(xn(e,n,s,r),ll(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=vt(),r=Yr(n),s=lr(t,r);s.tag=2,e!=null&&(s.callback=e),e=zr(n,s,r),e!==null&&(xn(e,n,r,t),ll(e,n,r))}};function jp(n,e,t,r,s,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Oo(t,r)||!Oo(s,i):!0}function dx(n,e,t){var r=!1,s=Zr,i=e.contextType;return typeof i=="object"&&i!==null?i=Zt(i):(s=Ct(e)?Rs:ft.current,r=e.contextTypes,i=(r=r!=null)?Pi(n,s):Zr),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Lc,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=i),e}function Gp(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Lc.enqueueReplaceState(e,e.state,null)}function Zd(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},Ih(n);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Zt(i):(i=Ct(e)?Rs:ft.current,s.context=Pi(n,i)),s.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Xd(n,e,i,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Lc.enqueueReplaceState(s,s.state,null),Hl(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function Mi(n,e){try{var t="",r=e;do t+=O1(r),r=r.return;while(r);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:s,digest:null}}function Du(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Jd(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var lA=typeof WeakMap=="function"?WeakMap:Map;function fx(n,e,t){t=lr(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){ql||(ql=!0,uf=r),Jd(n,e)},t}function hx(n,e,t){t=lr(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){Jd(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){Jd(n,e),typeof r!="function"&&(Wr===null?Wr=new Set([this]):Wr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function Vp(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new lA;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=TA.bind(null,n,e,t),e.then(n,n))}function Hp(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Kp(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=lr(-1,1),e.tag=2,zr(t,e,1))),t.lanes|=1),n)}var cA=pr.ReactCurrentOwner,Lt=!1;function mt(n,e,t,r){e.child=n===null?Gy(e,null,t,r):Ni(e,n.child,t,r)}function zp(n,e,t,r,s){t=t.render;var i=e.ref;return hi(e,s),r=Ph(n,e,t,r,i,s),t=Dh(),n!==null&&!Lt?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,fr(n,e,s)):(ke&&t&&Eh(e),e.flags|=1,mt(n,e,r,s),e.child)}function Wp(n,e,t,r,s){if(n===null){var i=t.type;return typeof i=="function"&&!Vh(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,mx(n,e,i,r,s)):(n=ml(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:Oo,t(o,r)&&n.ref===e.ref)return fr(n,e,s)}return e.flags|=1,n=qr(i,r),n.ref=e.ref,n.return=e,e.child=n}function mx(n,e,t,r,s){if(n!==null){var i=n.memoizedProps;if(Oo(i,r)&&n.ref===e.ref)if(Lt=!1,e.pendingProps=r=i,(n.lanes&s)!==0)n.flags&131072&&(Lt=!0);else return e.lanes=n.lanes,fr(n,e,s)}return ef(n,e,t,r,s)}function px(n,e,t){var r=e.pendingProps,s=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Te(ai,Dt),Dt|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Te(ai,Dt),Dt|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,Te(ai,Dt),Dt|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,Te(ai,Dt),Dt|=r;return mt(n,e,s,t),e.child}function gx(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function ef(n,e,t,r,s){var i=Ct(t)?Rs:ft.current;return i=Pi(e,i),hi(e,s),t=Ph(n,e,t,r,i,s),r=Dh(),n!==null&&!Lt?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,fr(n,e,s)):(ke&&r&&Eh(e),e.flags|=1,mt(n,e,t,s),e.child)}function Yp(n,e,t,r,s){if(Ct(t)){var i=!0;Bl(e)}else i=!1;if(hi(e,s),e.stateNode===null)dl(n,e),dx(e,t,r),Zd(e,t,r,s),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=Zt(c):(c=Ct(t)?Rs:ft.current,c=Pi(e,c));var u=t.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&Gp(e,o,r,c),Cr=!1;var f=e.memoizedState;o.state=f,Hl(e,r,o,s),l=e.memoizedState,a!==r||f!==l||Rt.current||Cr?(typeof u=="function"&&(Xd(e,t,u,r),l=e.memoizedState),(a=Cr||jp(e,t,a,r,f,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Hy(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:dn(e.type,a),o.props=c,d=e.pendingProps,f=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Zt(l):(l=Ct(t)?Rs:ft.current,l=Pi(e,l));var h=t.getDerivedStateFromProps;(u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==l)&&Gp(e,o,r,l),Cr=!1,f=e.memoizedState,o.state=f,Hl(e,r,o,s);var p=e.memoizedState;a!==d||f!==p||Rt.current||Cr?(typeof h=="function"&&(Xd(e,t,h,r),p=e.memoizedState),(c=Cr||jp(e,t,c,r,f,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),r=!1)}return tf(n,e,t,r,i,s)}function tf(n,e,t,r,s,i){gx(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Dp(e,t,!1),fr(n,e,i);r=e.stateNode,cA.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Ni(e,n.child,null,i),e.child=Ni(e,null,a,i)):mt(n,e,a,i),e.memoizedState=r.state,s&&Dp(e,t,!0),e.child}function vx(n){var e=n.stateNode;e.pendingContext?Pp(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Pp(n,e.context,!1),Rh(n,e.containerInfo)}function qp(n,e,t,r,s){return Di(),Th(s),e.flags|=256,mt(n,e,t,r),e.child}var nf={dehydrated:null,treeContext:null,retryLane:0};function rf(n){return{baseLanes:n,cachePool:null,transitions:null}}function yx(n,e,t){var r=e.pendingProps,s=Pe.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),Te(Pe,s&1),n===null)return qd(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Cc(o,r,0,null),n=Ls(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=rf(t),e.memoizedState=nf,n):Mh(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return uA(n,e,o,r,a,s,t);if(i){i=r.fallback,o=e.mode,s=n.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=qr(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=qr(a,i):(i=Ls(i,o,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=n.child.memoizedState,o=o===null?rf(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=nf,r}return i=n.child,n=i.sibling,r=qr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Mh(n,e){return e=Cc({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Ca(n,e,t,r){return r!==null&&Th(r),Ni(e,n.child,null,t),n=Mh(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function uA(n,e,t,r,s,i,o){if(t)return e.flags&256?(e.flags&=-257,r=Du(Error(W(422))),Ca(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Cc({mode:"visible",children:r.children},s,0,null),i=Ls(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ni(e,n.child,null,o),e.child.memoizedState=rf(o),e.memoizedState=nf,i);if(!(e.mode&1))return Ca(n,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(W(419)),r=Du(i,r,void 0),Ca(n,e,o,r)}if(a=(o&n.childLanes)!==0,Lt||a){if(r=et,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,dr(n,s),xn(r,n,s,-1))}return Gh(),r=Du(Error(W(421))),Ca(n,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=bA.bind(null,n),s._reactRetry=e,null):(n=i.treeContext,Ft=Kr(s.nextSibling),$t=e,ke=!0,gn=null,n!==null&&(Yt[qt++]=or,Yt[qt++]=ar,Yt[qt++]=Cs,or=n.id,ar=n.overflow,Cs=e),e=Mh(e,r.children),e.flags|=4096,e)}function Qp(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),Qd(n.return,e,t)}function Nu(n,e,t,r,s){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function xx(n,e,t){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(mt(n,e,r.children,t),r=Pe.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Qp(n,t,e);else if(n.tag===19)Qp(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Te(Pe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&Kl(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),Nu(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&Kl(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}Nu(e,!0,t,null,i);break;case"together":Nu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function dl(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function fr(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),_s|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(W(153));if(e.child!==null){for(n=e.child,t=qr(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=qr(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function dA(n,e,t){switch(e.tag){case 3:vx(e),Di();break;case 5:Ky(e);break;case 1:Ct(e.type)&&Bl(e);break;case 4:Rh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Te(Gl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Te(Pe,Pe.current&1),e.flags|=128,null):t&e.child.childLanes?yx(n,e,t):(Te(Pe,Pe.current&1),n=fr(n,e,t),n!==null?n.sibling:null);Te(Pe,Pe.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return xx(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Te(Pe,Pe.current),r)break;return null;case 22:case 23:return e.lanes=0,px(n,e,t)}return fr(n,e,t)}var Ex,sf,Sx,Tx;Ex=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};sf=function(){};Sx=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,ys(Gn.current);var i=null;switch(t){case"input":s=Ld(n,s),r=Ld(n,r),i=[];break;case"select":s=Ne({},s,{value:void 0}),r=Ne({},r,{value:void 0}),i=[];break;case"textarea":s=Cd(n,s),r=Cd(n,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=Fl)}_d(t,r);var o;t=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ro.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(i||(i=[]),i.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ro.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ae("scroll",n),i||a===l||(i=[])):(i=i||[]).push(c,l))}t&&(i=i||[]).push("style",t);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};Tx=function(n,e,t,r){t!==r&&(e.flags|=4)};function ro(n,e){if(!ke)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function ct(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function fA(n,e,t){var r=e.pendingProps;switch(Sh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ct(e),null;case 1:return Ct(e.type)&&$l(),ct(e),null;case 3:return r=e.stateNode,Oi(),Le(Rt),Le(ft),kh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Ia(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,gn!==null&&(hf(gn),gn=null))),sf(n,e),ct(e),null;case 5:Ch(e);var s=ys(Uo.current);if(t=e.type,n!==null&&e.stateNode!=null)Sx(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return ct(e),null}if(n=ys(Gn.current),Ia(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[Mn]=e,r[$o]=i,n=(e.mode&1)!==0,t){case"dialog":Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":case"embed":Ae("load",r);break;case"video":case"audio":for(s=0;s<fo.length;s++)Ae(fo[s],r);break;case"source":Ae("error",r);break;case"img":case"image":case"link":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"input":ip(r,i),Ae("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ae("invalid",r);break;case"textarea":ap(r,i),Ae("invalid",r)}_d(t,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&La(r.textContent,a,n),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&La(r.textContent,a,n),s=["children",""+a]):Ro.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ae("scroll",r)}switch(t){case"input":ya(r),op(r,i,!0);break;case"textarea":ya(r),lp(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Fl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Qv(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Mn]=e,n[$o]=r,Ex(n,e,!1,!1),e.stateNode=n;e:{switch(o=Pd(t,r),t){case"dialog":Ae("cancel",n),Ae("close",n),s=r;break;case"iframe":case"object":case"embed":Ae("load",n),s=r;break;case"video":case"audio":for(s=0;s<fo.length;s++)Ae(fo[s],n);s=r;break;case"source":Ae("error",n),s=r;break;case"img":case"image":case"link":Ae("error",n),Ae("load",n),s=r;break;case"details":Ae("toggle",n),s=r;break;case"input":ip(n,r),s=Ld(n,r),Ae("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=Ne({},r,{value:void 0}),Ae("invalid",n);break;case"textarea":ap(n,r),s=Cd(n,r),Ae("invalid",n);break;default:s=r}_d(t,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?Jv(n,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Xv(n,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Co(n,l):typeof l=="number"&&Co(n,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ro.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ae("scroll",n):l!=null&&oh(n,i,l,o))}switch(t){case"input":ya(n),op(n,r,!1);break;case"textarea":ya(n),lp(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Xr(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?ci(n,!!r.multiple,i,!1):r.defaultValue!=null&&ci(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=Fl)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ct(e),null;case 6:if(n&&e.stateNode!=null)Tx(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(t=ys(Uo.current),ys(Gn.current),Ia(e)){if(r=e.stateNode,t=e.memoizedProps,r[Mn]=e,(i=r.nodeValue!==t)&&(n=$t,n!==null))switch(n.tag){case 3:La(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&La(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Mn]=e,e.stateNode=r}return ct(e),null;case 13:if(Le(Pe),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(ke&&Ft!==null&&e.mode&1&&!(e.flags&128))Uy(),Di(),e.flags|=98560,i=!1;else if(i=Ia(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error(W(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Mn]=e}else Di(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ct(e),i=!1}else gn!==null&&(hf(gn),gn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Pe.current&1?We===0&&(We=3):Gh())),e.updateQueue!==null&&(e.flags|=4),ct(e),null);case 4:return Oi(),sf(n,e),n===null&&Mo(e.stateNode.containerInfo),ct(e),null;case 10:return Ah(e.type._context),ct(e),null;case 17:return Ct(e.type)&&$l(),ct(e),null;case 19:if(Le(Pe),i=e.memoizedState,i===null)return ct(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)ro(i,!1);else{if(We!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Kl(n),o!==null){for(e.flags|=128,ro(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Te(Pe,Pe.current&1|2),e.child}n=n.sibling}i.tail!==null&&Ue()>Fi&&(e.flags|=128,r=!0,ro(i,!1),e.lanes=4194304)}else{if(!r)if(n=Kl(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),ro(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ke)return ct(e),null}else 2*Ue()-i.renderingStartTime>Fi&&t!==1073741824&&(e.flags|=128,r=!0,ro(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ue(),e.sibling=null,t=Pe.current,Te(Pe,r?t&1|2:t&1),e):(ct(e),null);case 22:case 23:return jh(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Dt&1073741824&&(ct(e),e.subtreeFlags&6&&(e.flags|=8192)):ct(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function hA(n,e){switch(Sh(e),e.tag){case 1:return Ct(e.type)&&$l(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Oi(),Le(Rt),Le(ft),kh(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Ch(e),null;case 13:if(Le(Pe),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(W(340));Di()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Le(Pe),null;case 4:return Oi(),null;case 10:return Ah(e.type._context),null;case 22:case 23:return jh(),null;case 24:return null;default:return null}}var ka=!1,dt=!1,mA=typeof WeakSet=="function"?WeakSet:Set,X=null;function oi(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Fe(n,e,r)}else t.current=null}function of(n,e,t){try{t()}catch(r){Fe(n,e,r)}}var Xp=!1;function pA(n,e){if(Gd=Nl,n=Iy(),xh(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=n,f=null;t:for(;;){for(var h;d!==t||s!==0&&d.nodeType!==3||(a=o+s),d!==i||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===n)break t;if(f===t&&++c===s&&(a=o),f===i&&++u===r&&(l=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Vd={focusedElem:n,selectionRange:t},Nl=!1,X=e;X!==null;)if(e=X,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,X=n;else for(;X!==null;){e=X;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,v=e.stateNode,x=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:dn(e.type,m),g);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(T){Fe(e,e.return,T)}if(n=e.sibling,n!==null){n.return=e.return,X=n;break}X=e.return}return p=Xp,Xp=!1,p}function Eo(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var i=s.destroy;s.destroy=void 0,i!==void 0&&of(e,t,i)}s=s.next}while(s!==r)}}function Ic(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function af(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function bx(n){var e=n.alternate;e!==null&&(n.alternate=null,bx(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Mn],delete e[$o],delete e[zd],delete e[Xw],delete e[Zw])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function wx(n){return n.tag===5||n.tag===3||n.tag===4}function Zp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||wx(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function lf(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Fl));else if(r!==4&&(n=n.child,n!==null))for(lf(n,e,t),n=n.sibling;n!==null;)lf(n,e,t),n=n.sibling}function cf(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(cf(n,e,t),n=n.sibling;n!==null;)cf(n,e,t),n=n.sibling}var nt=null,pn=!1;function Sr(n,e,t){for(t=t.child;t!==null;)Ax(n,e,t),t=t.sibling}function Ax(n,e,t){if(jn&&typeof jn.onCommitFiberUnmount=="function")try{jn.onCommitFiberUnmount(xc,t)}catch{}switch(t.tag){case 5:dt||oi(t,e);case 6:var r=nt,s=pn;nt=null,Sr(n,e,t),nt=r,pn=s,nt!==null&&(pn?(n=nt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):nt.removeChild(t.stateNode));break;case 18:nt!==null&&(pn?(n=nt,t=t.stateNode,n.nodeType===8?Iu(n.parentNode,t):n.nodeType===1&&Iu(n,t),Do(n)):Iu(nt,t.stateNode));break;case 4:r=nt,s=pn,nt=t.stateNode.containerInfo,pn=!0,Sr(n,e,t),nt=r,pn=s;break;case 0:case 11:case 14:case 15:if(!dt&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&of(t,e,o),s=s.next}while(s!==r)}Sr(n,e,t);break;case 1:if(!dt&&(oi(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){Fe(t,e,a)}Sr(n,e,t);break;case 21:Sr(n,e,t);break;case 22:t.mode&1?(dt=(r=dt)||t.memoizedState!==null,Sr(n,e,t),dt=r):Sr(n,e,t);break;default:Sr(n,e,t)}}function Jp(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new mA),e.forEach(function(r){var s=wA.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function on(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var i=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:nt=a.stateNode,pn=!1;break e;case 3:nt=a.stateNode.containerInfo,pn=!0;break e;case 4:nt=a.stateNode.containerInfo,pn=!0;break e}a=a.return}if(nt===null)throw Error(W(160));Ax(i,o,s),nt=null,pn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Fe(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Lx(e,n),e=e.sibling}function Lx(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(on(e,n),In(n),r&4){try{Eo(3,n,n.return),Ic(3,n)}catch(m){Fe(n,n.return,m)}try{Eo(5,n,n.return)}catch(m){Fe(n,n.return,m)}}break;case 1:on(e,n),In(n),r&512&&t!==null&&oi(t,t.return);break;case 5:if(on(e,n),In(n),r&512&&t!==null&&oi(t,t.return),n.flags&32){var s=n.stateNode;try{Co(s,"")}catch(m){Fe(n,n.return,m)}}if(r&4&&(s=n.stateNode,s!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&Yv(s,i),Pd(a,o);var c=Pd(a,i);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?Jv(s,d):u==="dangerouslySetInnerHTML"?Xv(s,d):u==="children"?Co(s,d):oh(s,u,d,c)}switch(a){case"input":Id(s,i);break;case"textarea":qv(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?ci(s,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?ci(s,!!i.multiple,i.defaultValue,!0):ci(s,!!i.multiple,i.multiple?[]:"",!1))}s[$o]=i}catch(m){Fe(n,n.return,m)}}break;case 6:if(on(e,n),In(n),r&4){if(n.stateNode===null)throw Error(W(162));s=n.stateNode,i=n.memoizedProps;try{s.nodeValue=i}catch(m){Fe(n,n.return,m)}}break;case 3:if(on(e,n),In(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Do(e.containerInfo)}catch(m){Fe(n,n.return,m)}break;case 4:on(e,n),In(n);break;case 13:on(e,n),In(n),s=n.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Bh=Ue())),r&4&&Jp(n);break;case 22:if(u=t!==null&&t.memoizedState!==null,n.mode&1?(dt=(c=dt)||u,on(e,n),dt=c):on(e,n),In(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!u&&n.mode&1)for(X=n,u=n.child;u!==null;){for(d=X=u;X!==null;){switch(f=X,h=f.child,f.tag){case 0:case 11:case 14:case 15:Eo(4,f,f.return);break;case 1:oi(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,t=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Fe(r,t,m)}}break;case 5:oi(f,f.return);break;case 22:if(f.memoizedState!==null){tg(d);continue}}h!==null?(h.return=f,X=h):tg(d)}u=u.sibling}e:for(u=null,d=n;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Zv("display",o))}catch(m){Fe(n,n.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Fe(n,n.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:on(e,n),In(n),r&4&&Jp(n);break;case 21:break;default:on(e,n),In(n)}}function In(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(wx(t)){var r=t;break e}t=t.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Co(s,""),r.flags&=-33);var i=Zp(n);cf(n,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Zp(n);lf(n,a,o);break;default:throw Error(W(161))}}catch(l){Fe(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function gA(n,e,t){X=n,Ix(n)}function Ix(n,e,t){for(var r=(n.mode&1)!==0;X!==null;){var s=X,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||ka;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||dt;a=ka;var c=dt;if(ka=o,(dt=l)&&!c)for(X=s;X!==null;)o=X,l=o.child,o.tag===22&&o.memoizedState!==null?ng(s):l!==null?(l.return=o,X=l):ng(s);for(;i!==null;)X=i,Ix(i),i=i.sibling;X=s,ka=a,dt=c}eg(n)}else s.subtreeFlags&8772&&i!==null?(i.return=s,X=i):eg(n)}}function eg(n){for(;X!==null;){var e=X;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:dt||Ic(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!dt)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:dn(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&$p(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}$p(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Do(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}dt||e.flags&512&&af(e)}catch(f){Fe(e,e.return,f)}}if(e===n){X=null;break}if(t=e.sibling,t!==null){t.return=e.return,X=t;break}X=e.return}}function tg(n){for(;X!==null;){var e=X;if(e===n){X=null;break}var t=e.sibling;if(t!==null){t.return=e.return,X=t;break}X=e.return}}function ng(n){for(;X!==null;){var e=X;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Ic(4,e)}catch(l){Fe(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Fe(e,s,l)}}var i=e.return;try{af(e)}catch(l){Fe(e,i,l)}break;case 5:var o=e.return;try{af(e)}catch(l){Fe(e,o,l)}}}catch(l){Fe(e,e.return,l)}if(e===n){X=null;break}var a=e.sibling;if(a!==null){a.return=e.return,X=a;break}X=e.return}}var vA=Math.ceil,Yl=pr.ReactCurrentDispatcher,Fh=pr.ReactCurrentOwner,Xt=pr.ReactCurrentBatchConfig,fe=0,et=null,Ve=null,st=0,Dt=0,ai=ss(0),We=0,Ho=null,_s=0,Rc=0,$h=0,So=null,wt=null,Bh=0,Fi=1/0,tr=null,ql=!1,uf=null,Wr=null,_a=!1,Ur=null,Ql=0,To=0,df=null,fl=-1,hl=0;function vt(){return fe&6?Ue():fl!==-1?fl:fl=Ue()}function Yr(n){return n.mode&1?fe&2&&st!==0?st&-st:eA.transition!==null?(hl===0&&(hl=dy()),hl):(n=pe,n!==0||(n=window.event,n=n===void 0?16:yy(n.type)),n):1}function xn(n,e,t,r){if(50<To)throw To=0,df=null,Error(W(185));ia(n,t,r),(!(fe&2)||n!==et)&&(n===et&&(!(fe&2)&&(Rc|=t),We===4&&Dr(n,st)),kt(n,r),t===1&&fe===0&&!(e.mode&1)&&(Fi=Ue()+500,wc&&is()))}function kt(n,e){var t=n.callbackNode;ew(n,e);var r=Dl(n,n===et?st:0);if(r===0)t!==null&&dp(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&dp(t),e===1)n.tag===0?Jw(rg.bind(null,n)):Fy(rg.bind(null,n)),qw(function(){!(fe&6)&&is()}),t=null;else{switch(fy(r)){case 1:t=dh;break;case 4:t=cy;break;case 16:t=Pl;break;case 536870912:t=uy;break;default:t=Pl}t=Ox(t,Rx.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function Rx(n,e){if(fl=-1,hl=0,fe&6)throw Error(W(327));var t=n.callbackNode;if(mi()&&n.callbackNode!==t)return null;var r=Dl(n,n===et?st:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Xl(n,r);else{e=r;var s=fe;fe|=2;var i=kx();(et!==n||st!==e)&&(tr=null,Fi=Ue()+500,As(n,e));do try{EA();break}catch(a){Cx(n,a)}while(!0);wh(),Yl.current=i,fe=s,Ve!==null?e=0:(et=null,st=0,e=We)}if(e!==0){if(e===2&&(s=Fd(n),s!==0&&(r=s,e=ff(n,s))),e===1)throw t=Ho,As(n,0),Dr(n,r),kt(n,Ue()),t;if(e===6)Dr(n,r);else{if(s=n.current.alternate,!(r&30)&&!yA(s)&&(e=Xl(n,r),e===2&&(i=Fd(n),i!==0&&(r=i,e=ff(n,i))),e===1))throw t=Ho,As(n,0),Dr(n,r),kt(n,Ue()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:ms(n,wt,tr);break;case 3:if(Dr(n,r),(r&130023424)===r&&(e=Bh+500-Ue(),10<e)){if(Dl(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){vt(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=Kd(ms.bind(null,n,wt,tr),e);break}ms(n,wt,tr);break;case 4:if(Dr(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var o=31-yn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ue()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*vA(r/1960))-r,10<r){n.timeoutHandle=Kd(ms.bind(null,n,wt,tr),r);break}ms(n,wt,tr);break;case 5:ms(n,wt,tr);break;default:throw Error(W(329))}}}return kt(n,Ue()),n.callbackNode===t?Rx.bind(null,n):null}function ff(n,e){var t=So;return n.current.memoizedState.isDehydrated&&(As(n,e).flags|=256),n=Xl(n,e),n!==2&&(e=wt,wt=t,e!==null&&hf(e)),n}function hf(n){wt===null?wt=n:wt.push.apply(wt,n)}function yA(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!En(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Dr(n,e){for(e&=~$h,e&=~Rc,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-yn(e),r=1<<t;n[t]=-1,e&=~r}}function rg(n){if(fe&6)throw Error(W(327));mi();var e=Dl(n,0);if(!(e&1))return kt(n,Ue()),null;var t=Xl(n,e);if(n.tag!==0&&t===2){var r=Fd(n);r!==0&&(e=r,t=ff(n,r))}if(t===1)throw t=Ho,As(n,0),Dr(n,e),kt(n,Ue()),t;if(t===6)throw Error(W(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,ms(n,wt,tr),kt(n,Ue()),null}function Uh(n,e){var t=fe;fe|=1;try{return n(e)}finally{fe=t,fe===0&&(Fi=Ue()+500,wc&&is())}}function Ps(n){Ur!==null&&Ur.tag===0&&!(fe&6)&&mi();var e=fe;fe|=1;var t=Xt.transition,r=pe;try{if(Xt.transition=null,pe=1,n)return n()}finally{pe=r,Xt.transition=t,fe=e,!(fe&6)&&is()}}function jh(){Dt=ai.current,Le(ai)}function As(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Yw(t)),Ve!==null)for(t=Ve.return;t!==null;){var r=t;switch(Sh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&$l();break;case 3:Oi(),Le(Rt),Le(ft),kh();break;case 5:Ch(r);break;case 4:Oi();break;case 13:Le(Pe);break;case 19:Le(Pe);break;case 10:Ah(r.type._context);break;case 22:case 23:jh()}t=t.return}if(et=n,Ve=n=qr(n.current,null),st=Dt=e,We=0,Ho=null,$h=Rc=_s=0,wt=So=null,vs!==null){for(e=0;e<vs.length;e++)if(t=vs[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,i=t.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}t.pending=r}vs=null}return n}function Cx(n,e){do{var t=Ve;try{if(wh(),cl.current=Wl,zl){for(var r=De.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}zl=!1}if(ks=0,Je=Ke=De=null,xo=!1,jo=0,Fh.current=null,t===null||t.return===null){We=1,Ho=e,Ve=null;break}e:{var i=n,o=t.return,a=t,l=e;if(e=st,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=Hp(o);if(h!==null){h.flags&=-257,Kp(h,o,a,i,e),h.mode&1&&Vp(i,c,e),e=h,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){Vp(i,c,e),Gh();break e}l=Error(W(426))}}else if(ke&&a.mode&1){var g=Hp(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Kp(g,o,a,i,e),Th(Mi(l,a));break e}}i=l=Mi(l,a),We!==4&&(We=2),So===null?So=[i]:So.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=fx(i,l,e);Fp(i,v);break e;case 1:a=l;var x=i.type,E=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Wr===null||!Wr.has(E)))){i.flags|=65536,e&=-e,i.lanes|=e;var T=hx(i,a,e);Fp(i,T);break e}}i=i.return}while(i!==null)}Px(t)}catch(w){e=w,Ve===t&&t!==null&&(Ve=t=t.return);continue}break}while(!0)}function kx(){var n=Yl.current;return Yl.current=Wl,n===null?Wl:n}function Gh(){(We===0||We===3||We===2)&&(We=4),et===null||!(_s&268435455)&&!(Rc&268435455)||Dr(et,st)}function Xl(n,e){var t=fe;fe|=2;var r=kx();(et!==n||st!==e)&&(tr=null,As(n,e));do try{xA();break}catch(s){Cx(n,s)}while(!0);if(wh(),fe=t,Yl.current=r,Ve!==null)throw Error(W(261));return et=null,st=0,We}function xA(){for(;Ve!==null;)_x(Ve)}function EA(){for(;Ve!==null&&!K1();)_x(Ve)}function _x(n){var e=Nx(n.alternate,n,Dt);n.memoizedProps=n.pendingProps,e===null?Px(n):Ve=e,Fh.current=null}function Px(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=hA(t,e),t!==null){t.flags&=32767,Ve=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{We=6,Ve=null;return}}else if(t=fA(t,e,Dt),t!==null){Ve=t;return}if(e=e.sibling,e!==null){Ve=e;return}Ve=e=n}while(e!==null);We===0&&(We=5)}function ms(n,e,t){var r=pe,s=Xt.transition;try{Xt.transition=null,pe=1,SA(n,e,t,r)}finally{Xt.transition=s,pe=r}return null}function SA(n,e,t,r){do mi();while(Ur!==null);if(fe&6)throw Error(W(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(W(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(tw(n,i),n===et&&(Ve=et=null,st=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||_a||(_a=!0,Ox(Pl,function(){return mi(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=Xt.transition,Xt.transition=null;var o=pe;pe=1;var a=fe;fe|=4,Fh.current=null,pA(n,t),Lx(t,n),jw(Vd),Nl=!!Gd,Vd=Gd=null,n.current=t,gA(t),z1(),fe=a,pe=o,Xt.transition=i}else n.current=t;if(_a&&(_a=!1,Ur=n,Ql=s),i=n.pendingLanes,i===0&&(Wr=null),q1(t.stateNode),kt(n,Ue()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(ql)throw ql=!1,n=uf,uf=null,n;return Ql&1&&n.tag!==0&&mi(),i=n.pendingLanes,i&1?n===df?To++:(To=0,df=n):To=0,is(),null}function mi(){if(Ur!==null){var n=fy(Ql),e=Xt.transition,t=pe;try{if(Xt.transition=null,pe=16>n?16:n,Ur===null)var r=!1;else{if(n=Ur,Ur=null,Ql=0,fe&6)throw Error(W(331));var s=fe;for(fe|=4,X=n.current;X!==null;){var i=X,o=i.child;if(X.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(X=c;X!==null;){var u=X;switch(u.tag){case 0:case 11:case 15:Eo(8,u,i)}var d=u.child;if(d!==null)d.return=u,X=d;else for(;X!==null;){u=X;var f=u.sibling,h=u.return;if(bx(u),u===c){X=null;break}if(f!==null){f.return=h,X=f;break}X=h}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}X=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,X=o;else e:for(;X!==null;){if(i=X,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Eo(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,X=v;break e}X=i.return}}var x=n.current;for(X=x;X!==null;){o=X;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,X=E;else e:for(o=x;X!==null;){if(a=X,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ic(9,a)}}catch(w){Fe(a,a.return,w)}if(a===o){X=null;break e}var T=a.sibling;if(T!==null){T.return=a.return,X=T;break e}X=a.return}}if(fe=s,is(),jn&&typeof jn.onPostCommitFiberRoot=="function")try{jn.onPostCommitFiberRoot(xc,n)}catch{}r=!0}return r}finally{pe=t,Xt.transition=e}}return!1}function sg(n,e,t){e=Mi(t,e),e=fx(n,e,1),n=zr(n,e,1),e=vt(),n!==null&&(ia(n,1,e),kt(n,e))}function Fe(n,e,t){if(n.tag===3)sg(n,n,t);else for(;e!==null;){if(e.tag===3){sg(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Wr===null||!Wr.has(r))){n=Mi(t,n),n=hx(e,n,1),e=zr(e,n,1),n=vt(),e!==null&&(ia(e,1,n),kt(e,n));break}}e=e.return}}function TA(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=vt(),n.pingedLanes|=n.suspendedLanes&t,et===n&&(st&t)===t&&(We===4||We===3&&(st&130023424)===st&&500>Ue()-Bh?As(n,0):$h|=t),kt(n,e)}function Dx(n,e){e===0&&(n.mode&1?(e=Sa,Sa<<=1,!(Sa&130023424)&&(Sa=4194304)):e=1);var t=vt();n=dr(n,e),n!==null&&(ia(n,e,t),kt(n,t))}function bA(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),Dx(n,t)}function wA(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),Dx(n,t)}var Nx;Nx=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Rt.current)Lt=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Lt=!1,dA(n,e,t);Lt=!!(n.flags&131072)}else Lt=!1,ke&&e.flags&1048576&&$y(e,jl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;dl(n,e),n=e.pendingProps;var s=Pi(e,ft.current);hi(e,t),s=Ph(null,e,r,n,s,t);var i=Dh();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ct(r)?(i=!0,Bl(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ih(e),s.updater=Lc,e.stateNode=s,s._reactInternals=e,Zd(e,r,n,t),e=tf(null,e,r,!0,i,t)):(e.tag=0,ke&&i&&Eh(e),mt(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(dl(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=LA(r),n=dn(r,n),s){case 0:e=ef(null,e,r,n,t);break e;case 1:e=Yp(null,e,r,n,t);break e;case 11:e=zp(null,e,r,n,t);break e;case 14:e=Wp(null,e,r,dn(r.type,n),t);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:dn(r,s),ef(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:dn(r,s),Yp(n,e,r,s,t);case 3:e:{if(vx(e),n===null)throw Error(W(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Hy(n,e),Hl(e,r,null,t);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Mi(Error(W(423)),e),e=qp(n,e,r,t,s);break e}else if(r!==s){s=Mi(Error(W(424)),e),e=qp(n,e,r,t,s);break e}else for(Ft=Kr(e.stateNode.containerInfo.firstChild),$t=e,ke=!0,gn=null,t=Gy(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Di(),r===s){e=fr(n,e,t);break e}mt(n,e,r,t)}e=e.child}return e;case 5:return Ky(e),n===null&&qd(e),r=e.type,s=e.pendingProps,i=n!==null?n.memoizedProps:null,o=s.children,Hd(r,s)?o=null:i!==null&&Hd(r,i)&&(e.flags|=32),gx(n,e),mt(n,e,o,t),e.child;case 6:return n===null&&qd(e),null;case 13:return yx(n,e,t);case 4:return Rh(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Ni(e,null,r,t):mt(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:dn(r,s),zp(n,e,r,s,t);case 7:return mt(n,e,e.pendingProps,t),e.child;case 8:return mt(n,e,e.pendingProps.children,t),e.child;case 12:return mt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Te(Gl,r._currentValue),r._currentValue=o,i!==null)if(En(i.value,o)){if(i.children===s.children&&!Rt.current){e=fr(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=lr(-1,t&-t),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),Qd(i.return,t,e),a.lanes|=t;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Qd(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}mt(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,hi(e,t),s=Zt(s),r=r(s),e.flags|=1,mt(n,e,r,t),e.child;case 14:return r=e.type,s=dn(r,e.pendingProps),s=dn(r.type,s),Wp(n,e,r,s,t);case 15:return mx(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:dn(r,s),dl(n,e),e.tag=1,Ct(r)?(n=!0,Bl(e)):n=!1,hi(e,t),dx(e,r,s),Zd(e,r,s,t),tf(null,e,r,!0,n,t);case 19:return xx(n,e,t);case 22:return px(n,e,t)}throw Error(W(156,e.tag))};function Ox(n,e){return ly(n,e)}function AA(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(n,e,t,r){return new AA(n,e,t,r)}function Vh(n){return n=n.prototype,!(!n||!n.isReactComponent)}function LA(n){if(typeof n=="function")return Vh(n)?1:0;if(n!=null){if(n=n.$$typeof,n===lh)return 11;if(n===ch)return 14}return 2}function qr(n,e){var t=n.alternate;return t===null?(t=Qt(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function ml(n,e,t,r,s,i){var o=2;if(r=n,typeof n=="function")Vh(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Xs:return Ls(t.children,s,i,e);case ah:o=8,s|=8;break;case Td:return n=Qt(12,t,e,s|2),n.elementType=Td,n.lanes=i,n;case bd:return n=Qt(13,t,e,s),n.elementType=bd,n.lanes=i,n;case wd:return n=Qt(19,t,e,s),n.elementType=wd,n.lanes=i,n;case Kv:return Cc(t,s,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Vv:o=10;break e;case Hv:o=9;break e;case lh:o=11;break e;case ch:o=14;break e;case Rr:o=16,r=null;break e}throw Error(W(130,n==null?n:typeof n,""))}return e=Qt(o,t,e,s),e.elementType=n,e.type=r,e.lanes=i,e}function Ls(n,e,t,r){return n=Qt(7,n,r,e),n.lanes=t,n}function Cc(n,e,t,r){return n=Qt(22,n,r,e),n.elementType=Kv,n.lanes=t,n.stateNode={isHidden:!1},n}function Ou(n,e,t){return n=Qt(6,n,null,e),n.lanes=t,n}function Mu(n,e,t){return e=Qt(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function IA(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gu(0),this.expirationTimes=gu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Hh(n,e,t,r,s,i,o,a,l){return n=new IA(n,e,t,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Qt(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ih(i),n}function RA(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Qs,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function Mx(n){if(!n)return Zr;n=n._reactInternals;e:{if(Fs(n)!==n||n.tag!==1)throw Error(W(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ct(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(n.tag===1){var t=n.type;if(Ct(t))return My(n,t,e)}return e}function Fx(n,e,t,r,s,i,o,a,l){return n=Hh(t,r,!0,n,s,i,o,a,l),n.context=Mx(null),t=n.current,r=vt(),s=Yr(t),i=lr(r,s),i.callback=e??null,zr(t,i,s),n.current.lanes=s,ia(n,s,r),kt(n,r),n}function kc(n,e,t,r){var s=e.current,i=vt(),o=Yr(s);return t=Mx(t),e.context===null?e.context=t:e.pendingContext=t,e=lr(i,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=zr(s,e,o),n!==null&&(xn(n,s,o,i),ll(n,s,o)),o}function Zl(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function ig(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Kh(n,e){ig(n,e),(n=n.alternate)&&ig(n,e)}function CA(){return null}var $x=typeof reportError=="function"?reportError:function(n){console.error(n)};function zh(n){this._internalRoot=n}_c.prototype.render=zh.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(W(409));kc(n,e,null,null)};_c.prototype.unmount=zh.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Ps(function(){kc(null,n,null,null)}),e[ur]=null}};function _c(n){this._internalRoot=n}_c.prototype.unstable_scheduleHydration=function(n){if(n){var e=py();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Pr.length&&e!==0&&e<Pr[t].priority;t++);Pr.splice(t,0,n),t===0&&vy(n)}};function Wh(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Pc(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function og(){}function kA(n,e,t,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=Zl(o);i.call(c)}}var o=Fx(e,r,n,0,null,!1,!1,"",og);return n._reactRootContainer=o,n[ur]=o.current,Mo(n.nodeType===8?n.parentNode:n),Ps(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=Zl(l);a.call(c)}}var l=Hh(n,0,!1,null,null,!1,!1,"",og);return n._reactRootContainer=l,n[ur]=l.current,Mo(n.nodeType===8?n.parentNode:n),Ps(function(){kc(e,l,t,r)}),l}function Dc(n,e,t,r,s){var i=t._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Zl(o);a.call(l)}}kc(e,o,n,s)}else o=kA(t,e,n,s,r);return Zl(o)}hy=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=uo(e.pendingLanes);t!==0&&(fh(e,t|1),kt(e,Ue()),!(fe&6)&&(Fi=Ue()+500,is()))}break;case 13:Ps(function(){var r=dr(n,1);if(r!==null){var s=vt();xn(r,n,1,s)}}),Kh(n,1)}};hh=function(n){if(n.tag===13){var e=dr(n,134217728);if(e!==null){var t=vt();xn(e,n,134217728,t)}Kh(n,134217728)}};my=function(n){if(n.tag===13){var e=Yr(n),t=dr(n,e);if(t!==null){var r=vt();xn(t,n,e,r)}Kh(n,e)}};py=function(){return pe};gy=function(n,e){var t=pe;try{return pe=n,e()}finally{pe=t}};Nd=function(n,e,t){switch(e){case"input":if(Id(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=bc(r);if(!s)throw Error(W(90));Wv(r),Id(r,s)}}}break;case"textarea":qv(n,t);break;case"select":e=t.value,e!=null&&ci(n,!!t.multiple,e,!1)}};ny=Uh;ry=Ps;var _A={usingClientEntryPoint:!1,Events:[aa,ti,bc,ey,ty,Uh]},so={findFiberByHostInstance:gs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},PA={bundleType:so.bundleType,version:so.version,rendererPackageName:so.rendererPackageName,rendererConfig:so.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pr.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=oy(n),n===null?null:n.stateNode},findFiberByHostInstance:so.findFiberByHostInstance||CA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pa.isDisabled&&Pa.supportsFiber)try{xc=Pa.inject(PA),jn=Pa}catch{}}Gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_A;Gt.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wh(e))throw Error(W(200));return RA(n,e,null,t)};Gt.createRoot=function(n,e){if(!Wh(n))throw Error(W(299));var t=!1,r="",s=$x;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Hh(n,1,!1,null,null,t,!1,r,s),n[ur]=e.current,Mo(n.nodeType===8?n.parentNode:n),new zh(e)};Gt.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(W(188)):(n=Object.keys(n).join(","),Error(W(268,n)));return n=oy(e),n=n===null?null:n.stateNode,n};Gt.flushSync=function(n){return Ps(n)};Gt.hydrate=function(n,e,t){if(!Pc(e))throw Error(W(200));return Dc(null,n,e,!0,t)};Gt.hydrateRoot=function(n,e,t){if(!Wh(n))throw Error(W(405));var r=t!=null&&t.hydratedSources||null,s=!1,i="",o=$x;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=Fx(e,null,n,1,t??null,s,!1,i,o),n[ur]=e.current,Mo(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new _c(e)};Gt.render=function(n,e,t){if(!Pc(e))throw Error(W(200));return Dc(null,n,e,!1,t)};Gt.unmountComponentAtNode=function(n){if(!Pc(n))throw Error(W(40));return n._reactRootContainer?(Ps(function(){Dc(null,null,n,!1,function(){n._reactRootContainer=null,n[ur]=null})}),!0):!1};Gt.unstable_batchedUpdates=Uh;Gt.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Pc(t))throw Error(W(200));if(n==null||n._reactInternals===void 0)throw Error(W(38));return Dc(n,e,t,!1,r)};Gt.version="18.3.1-next-f1338f8080-20240426";function Bx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Bx)}catch(n){console.error(n)}}Bx(),Bv.exports=Gt;var ca=Bv.exports;const Ux=Iv(ca);var jx,ag=ca;jx=ag.createRoot,ag.hydrateRoot;const DA=1,NA=1e6;let Fu=0;function OA(){return Fu=(Fu+1)%Number.MAX_SAFE_INTEGER,Fu.toString()}const $u=new Map,lg=n=>{if($u.has(n))return;const e=setTimeout(()=>{$u.delete(n),bo({type:"REMOVE_TOAST",toastId:n})},NA);$u.set(n,e)},MA=(n,e)=>{switch(e.type){case"ADD_TOAST":return{...n,toasts:[e.toast,...n.toasts].slice(0,DA)};case"UPDATE_TOAST":return{...n,toasts:n.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=e;return t?lg(t):n.toasts.forEach(r=>{lg(r.id)}),{...n,toasts:n.toasts.map(r=>r.id===t||t===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(t=>t.id!==e.toastId)}}},pl=[];let gl={toasts:[]};function bo(n){gl=MA(gl,n),pl.forEach(e=>{e(gl)})}function FA({...n}){const e=OA(),t=s=>bo({type:"UPDATE_TOAST",toast:{...s,id:e}}),r=()=>bo({type:"DISMISS_TOAST",toastId:e});return bo({type:"ADD_TOAST",toast:{...n,id:e,open:!0,onOpenChange:s=>{s||r()}}}),{id:e,dismiss:r,update:t}}function $A(){const[n,e]=b.useState(gl);return b.useEffect(()=>(pl.push(e),()=>{const t=pl.indexOf(e);t>-1&&pl.splice(t,1)}),[n]),{...n,toast:FA,dismiss:t=>bo({type:"DISMISS_TOAST",toastId:t})}}function xe(n,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(n==null||n(s),t===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function cg(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function Gx(...n){return e=>{let t=!1;const r=n.map(s=>{const i=cg(s,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():cg(n[s],null)}}}}function Ye(...n){return b.useCallback(Gx(...n),n)}function BA(n,e){const t=b.createContext(e),r=i=>{const{children:o,...a}=i,l=b.useMemo(()=>a,Object.values(a));return y.jsx(t.Provider,{value:l,children:o})};r.displayName=n+"Provider";function s(i){const o=b.useContext(t);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${n}\``)}return[r,s]}function os(n,e=[]){let t=[];function r(i,o){const a=b.createContext(o),l=t.length;t=[...t,o];const c=d=>{var v;const{scope:f,children:h,...p}=d,m=((v=f==null?void 0:f[n])==null?void 0:v[l])||a,g=b.useMemo(()=>p,Object.values(p));return y.jsx(m.Provider,{value:g,children:h})};c.displayName=i+"Provider";function u(d,f){var m;const h=((m=f==null?void 0:f[n])==null?void 0:m[l])||a,p=b.useContext(h);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=t.map(o=>b.createContext(o));return function(a){const l=(a==null?void 0:a[n])||i;return b.useMemo(()=>({[`__scope${n}`]:{...a,[n]:l}}),[a,l])}};return s.scopeName=n,[r,UA(s,...e)]}function UA(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...a,...d}},{});return b.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}function Ko(n){const e=GA(n),t=b.forwardRef((r,s)=>{const{children:i,...o}=r,a=b.Children.toArray(i),l=a.find(HA);if(l){const c=l.props.children,u=a.map(d=>d===l?b.Children.count(c)>1?b.Children.only(null):b.isValidElement(c)?c.props.children:null:d);return y.jsx(e,{...o,ref:s,children:b.isValidElement(c)?b.cloneElement(c,void 0,u):null})}return y.jsx(e,{...o,ref:s,children:i})});return t.displayName=`${n}.Slot`,t}var jA=Ko("Slot");function GA(n){const e=b.forwardRef((t,r)=>{const{children:s,...i}=t;if(b.isValidElement(s)){const o=zA(s),a=KA(i,s.props);return s.type!==b.Fragment&&(a.ref=r?Gx(r,o):o),b.cloneElement(s,a)}return b.Children.count(s)>1?b.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var Vx=Symbol("radix.slottable");function VA(n){const e=({children:t})=>y.jsx(y.Fragment,{children:t});return e.displayName=`${n}.Slottable`,e.__radixId=Vx,e}function HA(n){return b.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===Vx}function KA(n,e){const t={...e};for(const r in e){const s=n[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?t[r]=(...a)=>{const l=i(...a);return s(...a),l}:s&&(t[r]=s):r==="style"?t[r]={...s,...i}:r==="className"&&(t[r]=[s,i].filter(Boolean).join(" "))}return{...n,...t}}function zA(n){var r,s;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(s=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function Hx(n){const e=n+"CollectionProvider",[t,r]=os(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),o=m=>{const{scope:g,children:v}=m,x=z.useRef(null),E=z.useRef(new Map).current;return y.jsx(s,{scope:g,itemMap:E,collectionRef:x,children:v})};o.displayName=e;const a=n+"CollectionSlot",l=Ko(a),c=z.forwardRef((m,g)=>{const{scope:v,children:x}=m,E=i(a,v),T=Ye(g,E.collectionRef);return y.jsx(l,{ref:T,children:x})});c.displayName=a;const u=n+"CollectionItemSlot",d="data-radix-collection-item",f=Ko(u),h=z.forwardRef((m,g)=>{const{scope:v,children:x,...E}=m,T=z.useRef(null),w=Ye(g,T),L=i(u,v);return z.useEffect(()=>(L.itemMap.set(T,{ref:T,...E}),()=>void L.itemMap.delete(T))),y.jsx(f,{[d]:"",ref:w,children:x})});h.displayName=u;function p(m){const g=i(n+"CollectionConsumer",m);return z.useCallback(()=>{const x=g.collectionRef.current;if(!x)return[];const E=Array.from(x.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((L,A)=>E.indexOf(L.ref.current)-E.indexOf(A.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:o,Slot:c,ItemSlot:h},p,r]}var WA=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ge=WA.reduce((n,e)=>{const t=Ko(`Primitive.${e}`),r=b.forwardRef((s,i)=>{const{asChild:o,...a}=s,l=o?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),y.jsx(l,{...a,ref:i})});return r.displayName=`Primitive.${e}`,{...n,[e]:r}},{});function Kx(n,e){n&&ca.flushSync(()=>n.dispatchEvent(e))}function Hn(n){const e=b.useRef(n);return b.useEffect(()=>{e.current=n}),b.useMemo(()=>(...t)=>{var r;return(r=e.current)==null?void 0:r.call(e,...t)},[])}function YA(n,e=globalThis==null?void 0:globalThis.document){const t=Hn(n);b.useEffect(()=>{const r=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[t,e])}var qA="DismissableLayer",mf="dismissableLayer.update",QA="dismissableLayer.pointerDownOutside",XA="dismissableLayer.focusOutside",ug,zx=b.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Nc=b.forwardRef((n,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=n,c=b.useContext(zx),[u,d]=b.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=b.useState({}),p=Ye(e,A=>d(A)),m=Array.from(c.layers),[g]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),v=m.indexOf(g),x=u?m.indexOf(u):-1,E=c.layersWithOutsidePointerEventsDisabled.size>0,T=x>=v,w=JA(A=>{const R=A.target,C=[...c.branches].some(I=>I.contains(R));!T||C||(s==null||s(A),o==null||o(A),A.defaultPrevented||a==null||a())},f),L=eL(A=>{const R=A.target;[...c.branches].some(I=>I.contains(R))||(i==null||i(A),o==null||o(A),A.defaultPrevented||a==null||a())},f);return YA(A=>{x===c.layers.size-1&&(r==null||r(A),!A.defaultPrevented&&a&&(A.preventDefault(),a()))},f),b.useEffect(()=>{if(u)return t&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(ug=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),dg(),()=>{t&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=ug)}},[u,f,t,c]),b.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),dg())},[u,c]),b.useEffect(()=>{const A=()=>h({});return document.addEventListener(mf,A),()=>document.removeEventListener(mf,A)},[]),y.jsx(ge.div,{...l,ref:p,style:{pointerEvents:E?T?"auto":"none":void 0,...n.style},onFocusCapture:xe(n.onFocusCapture,L.onFocusCapture),onBlurCapture:xe(n.onBlurCapture,L.onBlurCapture),onPointerDownCapture:xe(n.onPointerDownCapture,w.onPointerDownCapture)})});Nc.displayName=qA;var ZA="DismissableLayerBranch",Wx=b.forwardRef((n,e)=>{const t=b.useContext(zx),r=b.useRef(null),s=Ye(e,r);return b.useEffect(()=>{const i=r.current;if(i)return t.branches.add(i),()=>{t.branches.delete(i)}},[t.branches]),y.jsx(ge.div,{...n,ref:s})});Wx.displayName=ZA;function JA(n,e=globalThis==null?void 0:globalThis.document){const t=Hn(n),r=b.useRef(!1),s=b.useRef(()=>{});return b.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let l=function(){Yx(QA,t,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>r.current=!0}}function eL(n,e=globalThis==null?void 0:globalThis.document){const t=Hn(n),r=b.useRef(!1);return b.useEffect(()=>{const s=i=>{i.target&&!r.current&&Yx(XA,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function dg(){const n=new CustomEvent(mf);document.dispatchEvent(n)}function Yx(n,e,t,{discrete:r}){const s=t.originalEvent.target,i=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(n,e,{once:!0}),r?Kx(s,i):s.dispatchEvent(i)}var tL=Nc,nL=Wx,Kn=globalThis!=null&&globalThis.document?b.useLayoutEffect:()=>{},rL="Portal",Yh=b.forwardRef((n,e)=>{var a;const{container:t,...r}=n,[s,i]=b.useState(!1);Kn(()=>i(!0),[]);const o=t||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?Ux.createPortal(y.jsx(ge.div,{...r,ref:e}),o):null});Yh.displayName=rL;function sL(n,e){return b.useReducer((t,r)=>e[t][r]??t,n)}var as=n=>{const{present:e,children:t}=n,r=iL(e),s=typeof t=="function"?t({present:r.isPresent}):b.Children.only(t),i=Ye(r.ref,oL(s));return typeof t=="function"||r.isPresent?b.cloneElement(s,{ref:i}):null};as.displayName="Presence";function iL(n){const[e,t]=b.useState(),r=b.useRef(null),s=b.useRef(n),i=b.useRef("none"),o=n?"mounted":"unmounted",[a,l]=sL(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return b.useEffect(()=>{const c=Da(r.current);i.current=a==="mounted"?c:"none"},[a]),Kn(()=>{const c=r.current,u=s.current;if(u!==n){const f=i.current,h=Da(c);n?l("MOUNT"):h==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&f!==h?"ANIMATION_OUT":"UNMOUNT"),s.current=n}},[n,l]),Kn(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=h=>{const m=Da(r.current).includes(h.animationName);if(h.target===e&&m&&(l("ANIMATION_END"),!s.current)){const g=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=g)})}},f=h=>{h.target===e&&(i.current=Da(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:b.useCallback(c=>{r.current=c?getComputedStyle(c):null,t(c)},[])}}function Da(n){return(n==null?void 0:n.animationName)||"none"}function oL(n){var r,s;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(s=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var aL=rh[" useInsertionEffect ".trim().toString()]||Kn;function Ki({prop:n,defaultProp:e,onChange:t=()=>{},caller:r}){const[s,i,o]=lL({defaultProp:e,onChange:t}),a=n!==void 0,l=a?n:s;{const u=b.useRef(n!==void 0);b.useEffect(()=>{const d=u.current;d!==a&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,r])}const c=b.useCallback(u=>{var d;if(a){const f=cL(u)?u(n):u;f!==n&&((d=o.current)==null||d.call(o,f))}else i(u)},[a,n,i,o]);return[l,c]}function lL({defaultProp:n,onChange:e}){const[t,r]=b.useState(n),s=b.useRef(t),i=b.useRef(e);return aL(()=>{i.current=e},[e]),b.useEffect(()=>{var o;s.current!==t&&((o=i.current)==null||o.call(i,t),s.current=t)},[t,s]),[t,r,i]}function cL(n){return typeof n=="function"}var uL=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),dL="VisuallyHidden",Oc=b.forwardRef((n,e)=>y.jsx(ge.span,{...n,ref:e,style:{...uL,...n.style}}));Oc.displayName=dL;var fL=Oc,qh="ToastProvider",[Qh,hL,mL]=Hx("Toast"),[qx,mF]=os("Toast",[mL]),[pL,Mc]=qx(qh),Qx=n=>{const{__scopeToast:e,label:t="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=n,[a,l]=b.useState(null),[c,u]=b.useState(0),d=b.useRef(!1),f=b.useRef(!1);return t.trim()||console.error(`Invalid prop \`label\` supplied to \`${qh}\`. Expected non-empty \`string\`.`),y.jsx(Qh.Provider,{scope:e,children:y.jsx(pL,{scope:e,label:t,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:b.useCallback(()=>u(h=>h+1),[]),onToastRemove:b.useCallback(()=>u(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:f,children:o})})};Qx.displayName=qh;var Xx="ToastViewport",gL=["F8"],pf="toast.viewportPause",gf="toast.viewportResume",Zx=b.forwardRef((n,e)=>{const{__scopeToast:t,hotkey:r=gL,label:s="Notifications ({hotkey})",...i}=n,o=Mc(Xx,t),a=hL(t),l=b.useRef(null),c=b.useRef(null),u=b.useRef(null),d=b.useRef(null),f=Ye(e,d,o.onViewportChange),h=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=o.toastCount>0;b.useEffect(()=>{const g=v=>{var E;r.length!==0&&r.every(T=>v[T]||v.code===T)&&((E=d.current)==null||E.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[r]),b.useEffect(()=>{const g=l.current,v=d.current;if(p&&g&&v){const x=()=>{if(!o.isClosePausedRef.current){const L=new CustomEvent(pf);v.dispatchEvent(L),o.isClosePausedRef.current=!0}},E=()=>{if(o.isClosePausedRef.current){const L=new CustomEvent(gf);v.dispatchEvent(L),o.isClosePausedRef.current=!1}},T=L=>{!g.contains(L.relatedTarget)&&E()},w=()=>{g.contains(document.activeElement)||E()};return g.addEventListener("focusin",x),g.addEventListener("focusout",T),g.addEventListener("pointermove",x),g.addEventListener("pointerleave",w),window.addEventListener("blur",x),window.addEventListener("focus",E),()=>{g.removeEventListener("focusin",x),g.removeEventListener("focusout",T),g.removeEventListener("pointermove",x),g.removeEventListener("pointerleave",w),window.removeEventListener("blur",x),window.removeEventListener("focus",E)}}},[p,o.isClosePausedRef]);const m=b.useCallback(({tabbingDirection:g})=>{const x=a().map(E=>{const T=E.ref.current,w=[T,...CL(T)];return g==="forwards"?w:w.reverse()});return(g==="forwards"?x.reverse():x).flat()},[a]);return b.useEffect(()=>{const g=d.current;if(g){const v=x=>{var w,L,A;const E=x.altKey||x.ctrlKey||x.metaKey;if(x.key==="Tab"&&!E){const R=document.activeElement,C=x.shiftKey;if(x.target===g&&C){(w=c.current)==null||w.focus();return}const O=m({tabbingDirection:C?"backwards":"forwards"}),V=O.findIndex(B=>B===R);Bu(O.slice(V+1))?x.preventDefault():C?(L=c.current)==null||L.focus():(A=u.current)==null||A.focus()}};return g.addEventListener("keydown",v),()=>g.removeEventListener("keydown",v)}},[a,m]),y.jsxs(nL,{ref:l,role:"region","aria-label":s.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&y.jsx(vf,{ref:c,onFocusFromOutsideViewport:()=>{const g=m({tabbingDirection:"forwards"});Bu(g)}}),y.jsx(Qh.Slot,{scope:t,children:y.jsx(ge.ol,{tabIndex:-1,...i,ref:f})}),p&&y.jsx(vf,{ref:u,onFocusFromOutsideViewport:()=>{const g=m({tabbingDirection:"backwards"});Bu(g)}})]})});Zx.displayName=Xx;var Jx="ToastFocusProxy",vf=b.forwardRef((n,e)=>{const{__scopeToast:t,onFocusFromOutsideViewport:r,...s}=n,i=Mc(Jx,t);return y.jsx(Oc,{"aria-hidden":!0,tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var c;const a=o.relatedTarget;!((c=i.viewport)!=null&&c.contains(a))&&r()}})});vf.displayName=Jx;var ua="Toast",vL="toast.swipeStart",yL="toast.swipeMove",xL="toast.swipeCancel",EL="toast.swipeEnd",eE=b.forwardRef((n,e)=>{const{forceMount:t,open:r,defaultOpen:s,onOpenChange:i,...o}=n,[a,l]=Ki({prop:r,defaultProp:s??!0,onChange:i,caller:ua});return y.jsx(as,{present:t||a,children:y.jsx(bL,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:Hn(n.onPause),onResume:Hn(n.onResume),onSwipeStart:xe(n.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:xe(n.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:xe(n.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:xe(n.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});eE.displayName=ua;var[SL,TL]=qx(ua,{onClose(){}}),bL=b.forwardRef((n,e)=>{const{__scopeToast:t,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:f,onSwipeEnd:h,...p}=n,m=Mc(ua,t),[g,v]=b.useState(null),x=Ye(e,B=>v(B)),E=b.useRef(null),T=b.useRef(null),w=s||m.duration,L=b.useRef(0),A=b.useRef(w),R=b.useRef(0),{onToastAdd:C,onToastRemove:I}=m,P=Hn(()=>{var K;(g==null?void 0:g.contains(document.activeElement))&&((K=m.viewport)==null||K.focus()),o()}),O=b.useCallback(B=>{!B||B===1/0||(window.clearTimeout(R.current),L.current=new Date().getTime(),R.current=window.setTimeout(P,B))},[P]);b.useEffect(()=>{const B=m.viewport;if(B){const K=()=>{O(A.current),c==null||c()},U=()=>{const H=new Date().getTime()-L.current;A.current=A.current-H,window.clearTimeout(R.current),l==null||l()};return B.addEventListener(pf,U),B.addEventListener(gf,K),()=>{B.removeEventListener(pf,U),B.removeEventListener(gf,K)}}},[m.viewport,w,l,c,O]),b.useEffect(()=>{i&&!m.isClosePausedRef.current&&O(w)},[i,w,m.isClosePausedRef,O]),b.useEffect(()=>(C(),()=>I()),[C,I]);const V=b.useMemo(()=>g?aE(g):null,[g]);return m.viewport?y.jsxs(y.Fragment,{children:[V&&y.jsx(wL,{__scopeToast:t,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:V}),y.jsx(SL,{scope:t,onClose:P,children:ca.createPortal(y.jsx(Qh.ItemSlot,{scope:t,children:y.jsx(tL,{asChild:!0,onEscapeKeyDown:xe(a,()=>{m.isFocusedToastEscapeKeyDownRef.current||P(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:y.jsx(ge.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":m.swipeDirection,...p,ref:x,style:{userSelect:"none",touchAction:"none",...n.style},onKeyDown:xe(n.onKeyDown,B=>{B.key==="Escape"&&(a==null||a(B.nativeEvent),B.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,P()))}),onPointerDown:xe(n.onPointerDown,B=>{B.button===0&&(E.current={x:B.clientX,y:B.clientY})}),onPointerMove:xe(n.onPointerMove,B=>{if(!E.current)return;const K=B.clientX-E.current.x,U=B.clientY-E.current.y,H=!!T.current,_=["left","right"].includes(m.swipeDirection),k=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,M=_?k(0,K):0,F=_?0:k(0,U),$=B.pointerType==="touch"?10:2,Y={x:M,y:F},Q={originalEvent:B,delta:Y};H?(T.current=Y,Na(yL,d,Q,{discrete:!1})):fg(Y,m.swipeDirection,$)?(T.current=Y,Na(vL,u,Q,{discrete:!1}),B.target.setPointerCapture(B.pointerId)):(Math.abs(K)>$||Math.abs(U)>$)&&(E.current=null)}),onPointerUp:xe(n.onPointerUp,B=>{const K=T.current,U=B.target;if(U.hasPointerCapture(B.pointerId)&&U.releasePointerCapture(B.pointerId),T.current=null,E.current=null,K){const H=B.currentTarget,_={originalEvent:B,delta:K};fg(K,m.swipeDirection,m.swipeThreshold)?Na(EL,h,_,{discrete:!0}):Na(xL,f,_,{discrete:!0}),H.addEventListener("click",k=>k.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),wL=n=>{const{__scopeToast:e,children:t,...r}=n,s=Mc(ua,e),[i,o]=b.useState(!1),[a,l]=b.useState(!1);return IL(()=>o(!0)),b.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:y.jsx(Yh,{asChild:!0,children:y.jsx(Oc,{...r,children:i&&y.jsxs(y.Fragment,{children:[s.label," ",t]})})})},AL="ToastTitle",tE=b.forwardRef((n,e)=>{const{__scopeToast:t,...r}=n;return y.jsx(ge.div,{...r,ref:e})});tE.displayName=AL;var LL="ToastDescription",nE=b.forwardRef((n,e)=>{const{__scopeToast:t,...r}=n;return y.jsx(ge.div,{...r,ref:e})});nE.displayName=LL;var rE="ToastAction",sE=b.forwardRef((n,e)=>{const{altText:t,...r}=n;return t.trim()?y.jsx(oE,{altText:t,asChild:!0,children:y.jsx(Xh,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${rE}\`. Expected non-empty \`string\`.`),null)});sE.displayName=rE;var iE="ToastClose",Xh=b.forwardRef((n,e)=>{const{__scopeToast:t,...r}=n,s=TL(iE,t);return y.jsx(oE,{asChild:!0,children:y.jsx(ge.button,{type:"button",...r,ref:e,onClick:xe(n.onClick,s.onClose)})})});Xh.displayName=iE;var oE=b.forwardRef((n,e)=>{const{__scopeToast:t,altText:r,...s}=n;return y.jsx(ge.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function aE(n){const e=[];return Array.from(n.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),RL(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...aE(r))}}),e}function Na(n,e,t,{discrete:r}){const s=t.originalEvent.currentTarget,i=new CustomEvent(n,{bubbles:!0,cancelable:!0,detail:t});e&&s.addEventListener(n,e,{once:!0}),r?Kx(s,i):s.dispatchEvent(i)}var fg=(n,e,t=0)=>{const r=Math.abs(n.x),s=Math.abs(n.y),i=r>s;return e==="left"||e==="right"?i&&r>t:!i&&s>t};function IL(n=()=>{}){const e=Hn(n);Kn(()=>{let t=0,r=0;return t=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(r)}},[e])}function RL(n){return n.nodeType===n.ELEMENT_NODE}function CL(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function Bu(n){const e=document.activeElement;return n.some(t=>t===e?!0:(t.focus(),document.activeElement!==e))}var kL=Qx,lE=Zx,cE=eE,uE=tE,dE=nE,fE=sE,hE=Xh;function mE(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=mE(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function pE(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=mE(n))&&(r&&(r+=" "),r+=e);return r}const hg=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,mg=pE,Fc=(n,e)=>t=>{var r;if((e==null?void 0:e.variants)==null)return mg(n,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(c=>{const u=t==null?void 0:t[c],d=i==null?void 0:i[c];if(u===null)return null;const f=hg(u)||hg(d);return s[c][f]}),a=t&&Object.entries(t).reduce((c,u)=>{let[d,f]=u;return f===void 0||(c[d]=f),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:f,...h}=u;return Object.entries(h).every(p=>{let[m,g]=p;return Array.isArray(g)?g.includes({...i,...a}[m]):{...i,...a}[m]===g})?[...c,d,f]:c},[]);return mg(n,o,l,t==null?void 0:t.class,t==null?void 0:t.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _L=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gE=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var PL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DL=b.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...a},l)=>b.createElement("svg",{ref:l,...PL,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:gE("lucide",s),...a},[...o.map(([c,u])=>b.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=(n,e)=>{const t=b.forwardRef(({className:r,...s},i)=>b.createElement(DL,{ref:i,iconNode:e,className:gE(`lucide-${_L(n)}`,r),...s}));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NL=tt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OL=tt("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ML=tt("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FL=tt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=tt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $L=tt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BL=tt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UL=tt("Handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jL=tt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GL=tt("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VL=tt("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HL=tt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KL=tt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pg=tt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gg=tt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zL=tt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WL=tt("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zi=tt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Zh="-",YL=n=>{const e=QL(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=n;return{getClassGroupId:o=>{const a=o.split(Zh);return a[0]===""&&a.length!==1&&a.shift(),vE(a,e)||qL(o)},getConflictingClassGroupIds:(o,a)=>{const l=t[o]||[];return a&&r[o]?[...l,...r[o]]:l}}},vE=(n,e)=>{var o;if(n.length===0)return e.classGroupId;const t=n[0],r=e.nextPart.get(t),s=r?vE(n.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const i=n.join(Zh);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},vg=/^\[(.+)\]$/,qL=n=>{if(vg.test(n)){const e=vg.exec(n)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},QL=n=>{const{theme:e,prefix:t}=n,r={nextPart:new Map,validators:[]};return ZL(Object.entries(n.classGroups),t).forEach(([i,o])=>{xf(o,r,i,e)}),r},xf=(n,e,t,r)=>{n.forEach(s=>{if(typeof s=="string"){const i=s===""?e:yg(e,s);i.classGroupId=t;return}if(typeof s=="function"){if(XL(s)){xf(s(r),e,t,r);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,o])=>{xf(o,yg(e,i),t,r)})})},yg=(n,e)=>{let t=n;return e.split(Zh).forEach(r=>{t.nextPart.has(r)||t.nextPart.set(r,{nextPart:new Map,validators:[]}),t=t.nextPart.get(r)}),t},XL=n=>n.isThemeGetter,ZL=(n,e)=>e?n.map(([t,r])=>{const s=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[t,s]}):n,JL=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,r=new Map;const s=(i,o)=>{t.set(i,o),e++,e>n&&(e=0,r=t,t=new Map)};return{get(i){let o=t.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return s(i,o),o},set(i,o){t.has(i)?t.set(i,o):s(i,o)}}},yE="!",eI=n=>{const{separator:e,experimentalParseClassName:t}=n,r=e.length===1,s=e[0],i=e.length,o=a=>{const l=[];let c=0,u=0,d;for(let g=0;g<a.length;g++){let v=a[g];if(c===0){if(v===s&&(r||a.slice(g,g+i)===e)){l.push(a.slice(u,g)),u=g+i;continue}if(v==="/"){d=g;continue}}v==="["?c++:v==="]"&&c--}const f=l.length===0?a:a.substring(u),h=f.startsWith(yE),p=h?f.substring(1):f,m=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:h,baseClassName:p,maybePostfixModifierPosition:m}};return t?a=>t({className:a,parseClassName:o}):o},tI=n=>{if(n.length<=1)return n;const e=[];let t=[];return n.forEach(r=>{r[0]==="["?(e.push(...t.sort(),r),t=[]):t.push(r)}),e.push(...t.sort()),e},nI=n=>({cache:JL(n.cacheSize),parseClassName:eI(n),...YL(n)}),rI=/\s+/,sI=(n,e)=>{const{parseClassName:t,getClassGroupId:r,getConflictingClassGroupIds:s}=e,i=[],o=n.trim().split(rI);let a="";for(let l=o.length-1;l>=0;l-=1){const c=o[l],{modifiers:u,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:h}=t(c);let p=!!h,m=r(p?f.substring(0,h):f);if(!m){if(!p){a=c+(a.length>0?" "+a:a);continue}if(m=r(f),!m){a=c+(a.length>0?" "+a:a);continue}p=!1}const g=tI(u).join(":"),v=d?g+yE:g,x=v+m;if(i.includes(x))continue;i.push(x);const E=s(m,p);for(let T=0;T<E.length;++T){const w=E[T];i.push(v+w)}a=c+(a.length>0?" "+a:a)}return a};function iI(){let n=0,e,t,r="";for(;n<arguments.length;)(e=arguments[n++])&&(t=xE(e))&&(r&&(r+=" "),r+=t);return r}const xE=n=>{if(typeof n=="string")return n;let e,t="";for(let r=0;r<n.length;r++)n[r]&&(e=xE(n[r]))&&(t&&(t+=" "),t+=e);return t};function oI(n,...e){let t,r,s,i=o;function o(l){const c=e.reduce((u,d)=>d(u),n());return t=nI(c),r=t.cache.get,s=t.cache.set,i=a,a(l)}function a(l){const c=r(l);if(c)return c;const u=sI(l,t);return s(l,u),u}return function(){return i(iI.apply(null,arguments))}}const we=n=>{const e=t=>t[n]||[];return e.isThemeGetter=!0,e},EE=/^\[(?:([a-z-]+):)?(.+)\]$/i,aI=/^\d+\/\d+$/,lI=new Set(["px","full","screen"]),cI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,uI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,dI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,fI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,hI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Xn=n=>pi(n)||lI.has(n)||aI.test(n),Tr=n=>Wi(n,"length",SI),pi=n=>!!n&&!Number.isNaN(Number(n)),Uu=n=>Wi(n,"number",pi),io=n=>!!n&&Number.isInteger(Number(n)),mI=n=>n.endsWith("%")&&pi(n.slice(0,-1)),ae=n=>EE.test(n),br=n=>cI.test(n),pI=new Set(["length","size","percentage"]),gI=n=>Wi(n,pI,SE),vI=n=>Wi(n,"position",SE),yI=new Set(["image","url"]),xI=n=>Wi(n,yI,bI),EI=n=>Wi(n,"",TI),oo=()=>!0,Wi=(n,e,t)=>{const r=EE.exec(n);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):t(r[2]):!1},SI=n=>uI.test(n)&&!dI.test(n),SE=()=>!1,TI=n=>fI.test(n),bI=n=>hI.test(n),wI=()=>{const n=we("colors"),e=we("spacing"),t=we("blur"),r=we("brightness"),s=we("borderColor"),i=we("borderRadius"),o=we("borderSpacing"),a=we("borderWidth"),l=we("contrast"),c=we("grayscale"),u=we("hueRotate"),d=we("invert"),f=we("gap"),h=we("gradientColorStops"),p=we("gradientColorStopPositions"),m=we("inset"),g=we("margin"),v=we("opacity"),x=we("padding"),E=we("saturate"),T=we("scale"),w=we("sepia"),L=we("skew"),A=we("space"),R=we("translate"),C=()=>["auto","contain","none"],I=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto",ae,e],O=()=>[ae,e],V=()=>["",Xn,Tr],B=()=>["auto",pi,ae],K=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],U=()=>["solid","dashed","dotted","double","none"],H=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],_=()=>["start","end","center","between","around","evenly","stretch"],k=()=>["","0",ae],M=()=>["auto","avoid","all","avoid-page","page","left","right","column"],F=()=>[pi,ae];return{cacheSize:500,separator:":",theme:{colors:[oo],spacing:[Xn,Tr],blur:["none","",br,ae],brightness:F(),borderColor:[n],borderRadius:["none","","full",br,ae],borderSpacing:O(),borderWidth:V(),contrast:F(),grayscale:k(),hueRotate:F(),invert:k(),gap:O(),gradientColorStops:[n],gradientColorStopPositions:[mI,Tr],inset:P(),margin:P(),opacity:F(),padding:O(),saturate:F(),scale:F(),sepia:k(),skew:F(),space:O(),translate:O()},classGroups:{aspect:[{aspect:["auto","square","video",ae]}],container:["container"],columns:[{columns:[br]}],"break-after":[{"break-after":M()}],"break-before":[{"break-before":M()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...K(),ae]}],overflow:[{overflow:I()}],"overflow-x":[{"overflow-x":I()}],"overflow-y":[{"overflow-y":I()}],overscroll:[{overscroll:C()}],"overscroll-x":[{"overscroll-x":C()}],"overscroll-y":[{"overscroll-y":C()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",io,ae]}],basis:[{basis:P()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ae]}],grow:[{grow:k()}],shrink:[{shrink:k()}],order:[{order:["first","last","none",io,ae]}],"grid-cols":[{"grid-cols":[oo]}],"col-start-end":[{col:["auto",{span:["full",io,ae]},ae]}],"col-start":[{"col-start":B()}],"col-end":[{"col-end":B()}],"grid-rows":[{"grid-rows":[oo]}],"row-start-end":[{row:["auto",{span:[io,ae]},ae]}],"row-start":[{"row-start":B()}],"row-end":[{"row-end":B()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ae]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ae]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",..._()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",..._(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[..._(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[x]}],px:[{px:[x]}],py:[{py:[x]}],ps:[{ps:[x]}],pe:[{pe:[x]}],pt:[{pt:[x]}],pr:[{pr:[x]}],pb:[{pb:[x]}],pl:[{pl:[x]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[A]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[A]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ae,e]}],"min-w":[{"min-w":[ae,e,"min","max","fit"]}],"max-w":[{"max-w":[ae,e,"none","full","min","max","fit","prose",{screen:[br]},br]}],h:[{h:[ae,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ae,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ae,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ae,e,"auto","min","max","fit"]}],"font-size":[{text:["base",br,Tr]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Uu]}],"font-family":[{font:[oo]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ae]}],"line-clamp":[{"line-clamp":["none",pi,Uu]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Xn,ae]}],"list-image":[{"list-image":["none",ae]}],"list-style-type":[{list:["none","disc","decimal",ae]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...U(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Xn,Tr]}],"underline-offset":[{"underline-offset":["auto",Xn,ae]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:O()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ae]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ae]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...K(),vI]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",gI]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},xI]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...U(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:U()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...U()]}],"outline-offset":[{"outline-offset":[Xn,ae]}],"outline-w":[{outline:[Xn,Tr]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:V()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[Xn,Tr]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",br,EI]}],"shadow-color":[{shadow:[oo]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...H(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":H()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",br,ae]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[E]}],sepia:[{sepia:[w]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[w]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ae]}],duration:[{duration:F()}],ease:[{ease:["linear","in","out","in-out",ae]}],delay:[{delay:F()}],animate:[{animate:["none","spin","ping","pulse","bounce",ae]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[T]}],"scale-x":[{"scale-x":[T]}],"scale-y":[{"scale-y":[T]}],rotate:[{rotate:[io,ae]}],"translate-x":[{"translate-x":[R]}],"translate-y":[{"translate-y":[R]}],"skew-x":[{"skew-x":[L]}],"skew-y":[{"skew-y":[L]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ae]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ae]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":O()}],"scroll-mx":[{"scroll-mx":O()}],"scroll-my":[{"scroll-my":O()}],"scroll-ms":[{"scroll-ms":O()}],"scroll-me":[{"scroll-me":O()}],"scroll-mt":[{"scroll-mt":O()}],"scroll-mr":[{"scroll-mr":O()}],"scroll-mb":[{"scroll-mb":O()}],"scroll-ml":[{"scroll-ml":O()}],"scroll-p":[{"scroll-p":O()}],"scroll-px":[{"scroll-px":O()}],"scroll-py":[{"scroll-py":O()}],"scroll-ps":[{"scroll-ps":O()}],"scroll-pe":[{"scroll-pe":O()}],"scroll-pt":[{"scroll-pt":O()}],"scroll-pr":[{"scroll-pr":O()}],"scroll-pb":[{"scroll-pb":O()}],"scroll-pl":[{"scroll-pl":O()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ae]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[Xn,Tr,Uu]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},AI=oI(wI);function be(...n){return AI(pE(n))}const LI=kL,TE=b.forwardRef(({className:n,...e},t)=>y.jsx(lE,{ref:t,className:be("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",n),...e}));TE.displayName=lE.displayName;const II=Fc("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),bE=b.forwardRef(({className:n,variant:e,...t},r)=>y.jsx(cE,{ref:r,className:be(II({variant:e}),n),...t}));bE.displayName=cE.displayName;const RI=b.forwardRef(({className:n,...e},t)=>y.jsx(fE,{ref:t,className:be("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",n),...e}));RI.displayName=fE.displayName;const wE=b.forwardRef(({className:n,...e},t)=>y.jsx(hE,{ref:t,className:be("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",n),"toast-close":"",...e,children:y.jsx(zi,{className:"h-4 w-4"})}));wE.displayName=hE.displayName;const AE=b.forwardRef(({className:n,...e},t)=>y.jsx(uE,{ref:t,className:be("text-sm font-semibold",n),...e}));AE.displayName=uE.displayName;const LE=b.forwardRef(({className:n,...e},t)=>y.jsx(dE,{ref:t,className:be("text-sm opacity-90",n),...e}));LE.displayName=dE.displayName;function CI(){const{toasts:n}=$A();return y.jsxs(LI,{children:[n.map(function({id:e,title:t,description:r,action:s,...i}){return y.jsxs(bE,{...i,children:[y.jsxs("div",{className:"grid gap-1",children:[t&&y.jsx(AE,{children:t}),r&&y.jsx(LE,{children:r})]}),s,y.jsx(wE,{})]},e)}),y.jsx(TE,{})]})}var xg=["light","dark"],kI="(prefers-color-scheme: dark)",_I=b.createContext(void 0),PI={setTheme:n=>{},themes:[]},DI=()=>{var n;return(n=b.useContext(_I))!=null?n:PI};b.memo(({forcedTheme:n,storageKey:e,attribute:t,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:o,attrs:a,nonce:l})=>{let c=i==="system",u=t==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(p=>`'${p}'`).join(",")})`};`:`var d=document.documentElement,n='${t}',s='setAttribute';`,d=s?xg.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(p,m=!1,g=!0)=>{let v=o?o[p]:p,x=m?p+"|| ''":`'${v}'`,E="";return s&&g&&!m&&xg.includes(p)&&(E+=`d.style.colorScheme = '${p}';`),t==="class"?m||v?E+=`c.add(${x})`:E+="null":v&&(E+=`d[s](n,${x})`),E},h=n?`!function(){${u}${f(n)}}()`:r?`!function(){try{${u}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${c})){var t='${kI}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}${c?"":"else{"+f(i,!1,!1)+"}"}${d}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${e}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${d}}catch(t){}}();`;return b.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:h}})});var NI=n=>{switch(n){case"success":return FI;case"info":return BI;case"warning":return $I;case"error":return UI;default:return null}},OI=Array(12).fill(0),MI=({visible:n,className:e})=>z.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":n},z.createElement("div",{className:"sonner-spinner"},OI.map((t,r)=>z.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),FI=z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},z.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),$I=z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},z.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),BI=z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},z.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),UI=z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},z.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),jI=z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},z.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),z.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),GI=()=>{let[n,e]=z.useState(document.hidden);return z.useEffect(()=>{let t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),n},Ef=1,VI=class{constructor(){this.subscribe=n=>(this.subscribers.push(n),()=>{let e=this.subscribers.indexOf(n);this.subscribers.splice(e,1)}),this.publish=n=>{this.subscribers.forEach(e=>e(n))},this.addToast=n=>{this.publish(n),this.toasts=[...this.toasts,n]},this.create=n=>{var e;let{message:t,...r}=n,s=typeof(n==null?void 0:n.id)=="number"||((e=n.id)==null?void 0:e.length)>0?n.id:Ef++,i=this.toasts.find(a=>a.id===s),o=n.dismissible===void 0?!0:n.dismissible;return this.dismissedToasts.has(s)&&this.dismissedToasts.delete(s),i?this.toasts=this.toasts.map(a=>a.id===s?(this.publish({...a,...n,id:s,title:t}),{...a,...n,id:s,dismissible:o,title:t}):a):this.addToast({title:t,...r,dismissible:o,id:s}),s},this.dismiss=n=>(this.dismissedToasts.add(n),n||this.toasts.forEach(e=>{this.subscribers.forEach(t=>t({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:n,dismiss:!0})),n),this.message=(n,e)=>this.create({...e,message:n}),this.error=(n,e)=>this.create({...e,message:n,type:"error"}),this.success=(n,e)=>this.create({...e,type:"success",message:n}),this.info=(n,e)=>this.create({...e,type:"info",message:n}),this.warning=(n,e)=>this.create({...e,type:"warning",message:n}),this.loading=(n,e)=>this.create({...e,type:"loading",message:n}),this.promise=(n,e)=>{if(!e)return;let t;e.loading!==void 0&&(t=this.create({...e,promise:n,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let r=n instanceof Promise?n:n(),s=t!==void 0,i,o=r.then(async l=>{if(i=["resolve",l],z.isValidElement(l))s=!1,this.create({id:t,type:"default",message:l});else if(KI(l)&&!l.ok){s=!1;let c=typeof e.error=="function"?await e.error(`HTTP error! status: ${l.status}`):e.error,u=typeof e.description=="function"?await e.description(`HTTP error! status: ${l.status}`):e.description;this.create({id:t,type:"error",message:c,description:u})}else if(e.success!==void 0){s=!1;let c=typeof e.success=="function"?await e.success(l):e.success,u=typeof e.description=="function"?await e.description(l):e.description;this.create({id:t,type:"success",message:c,description:u})}}).catch(async l=>{if(i=["reject",l],e.error!==void 0){s=!1;let c=typeof e.error=="function"?await e.error(l):e.error,u=typeof e.description=="function"?await e.description(l):e.description;this.create({id:t,type:"error",message:c,description:u})}}).finally(()=>{var l;s&&(this.dismiss(t),t=void 0),(l=e.finally)==null||l.call(e)}),a=()=>new Promise((l,c)=>o.then(()=>i[0]==="reject"?c(i[1]):l(i[1])).catch(c));return typeof t!="string"&&typeof t!="number"?{unwrap:a}:Object.assign(t,{unwrap:a})},this.custom=(n,e)=>{let t=(e==null?void 0:e.id)||Ef++;return this.create({jsx:n(t),id:t,...e}),t},this.getActiveToasts=()=>this.toasts.filter(n=>!this.dismissedToasts.has(n.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},bt=new VI,HI=(n,e)=>{let t=(e==null?void 0:e.id)||Ef++;return bt.addToast({title:n,...e,id:t}),t},KI=n=>n&&typeof n=="object"&&"ok"in n&&typeof n.ok=="boolean"&&"status"in n&&typeof n.status=="number",zI=HI,WI=()=>bt.toasts,YI=()=>bt.getActiveToasts();Object.assign(zI,{success:bt.success,info:bt.info,warning:bt.warning,error:bt.error,custom:bt.custom,message:bt.message,promise:bt.promise,dismiss:bt.dismiss,loading:bt.loading},{getHistory:WI,getToasts:YI});function qI(n,{insertAt:e}={}){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n))}qI(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Oa(n){return n.label!==void 0}var QI=3,XI="32px",ZI="16px",Eg=4e3,JI=356,eR=14,tR=20,nR=200;function an(...n){return n.filter(Boolean).join(" ")}function rR(n){let[e,t]=n.split("-"),r=[];return e&&r.push(e),t&&r.push(t),r}var sR=n=>{var e,t,r,s,i,o,a,l,c,u,d;let{invert:f,toast:h,unstyled:p,interacting:m,setHeights:g,visibleToasts:v,heights:x,index:E,toasts:T,expanded:w,removeToast:L,defaultRichColors:A,closeButton:R,style:C,cancelButtonStyle:I,actionButtonStyle:P,className:O="",descriptionClassName:V="",duration:B,position:K,gap:U,loadingIcon:H,expandByDefault:_,classNames:k,icons:M,closeButtonAriaLabel:F="Close toast",pauseWhenPageIsHidden:$}=n,[Y,Q]=z.useState(null),[ee,te]=z.useState(null),[ne,Re]=z.useState(!1),[Be,qe]=z.useState(!1),[ot,gr]=z.useState(!1),[Ht,vr]=z.useState(!1),[fa,ue]=z.useState(!1),[je,Qe]=z.useState(0),[Et,St]=z.useState(0),Kt=z.useRef(h.duration||B||Eg),An=z.useRef(null),Ln=z.useRef(null),$s=E===0,ha=E+1<=v,Xe=h.type,Qn=h.dismissible!==!1,au=h.className||"",ma=h.descriptionClassName||"",ls=z.useMemo(()=>x.findIndex(ie=>ie.toastId===h.id)||0,[x,h.id]),cs=z.useMemo(()=>{var ie;return(ie=h.closeButton)!=null?ie:R},[h.closeButton,R]),Ym=z.useMemo(()=>h.duration||B||Eg,[h.duration,B]),lu=z.useRef(0),Bs=z.useRef(0),qm=z.useRef(0),Us=z.useRef(null),[r1,s1]=K.split("-"),Qm=z.useMemo(()=>x.reduce((ie,ve,Ce)=>Ce>=ls?ie:ie+ve.height,0),[x,ls]),Xm=GI(),i1=h.invert||f,cu=Xe==="loading";Bs.current=z.useMemo(()=>ls*U+Qm,[ls,Qm]),z.useEffect(()=>{Kt.current=Ym},[Ym]),z.useEffect(()=>{Re(!0)},[]),z.useEffect(()=>{let ie=Ln.current;if(ie){let ve=ie.getBoundingClientRect().height;return St(ve),g(Ce=>[{toastId:h.id,height:ve,position:h.position},...Ce]),()=>g(Ce=>Ce.filter(nn=>nn.toastId!==h.id))}},[g,h.id]),z.useLayoutEffect(()=>{if(!ne)return;let ie=Ln.current,ve=ie.style.height;ie.style.height="auto";let Ce=ie.getBoundingClientRect().height;ie.style.height=ve,St(Ce),g(nn=>nn.find(rn=>rn.toastId===h.id)?nn.map(rn=>rn.toastId===h.id?{...rn,height:Ce}:rn):[{toastId:h.id,height:Ce,position:h.position},...nn])},[ne,h.title,h.description,g,h.id]);let yr=z.useCallback(()=>{qe(!0),Qe(Bs.current),g(ie=>ie.filter(ve=>ve.toastId!==h.id)),setTimeout(()=>{L(h)},nR)},[h,L,g,Bs]);z.useEffect(()=>{if(h.promise&&Xe==="loading"||h.duration===1/0||h.type==="loading")return;let ie;return w||m||$&&Xm?(()=>{if(qm.current<lu.current){let ve=new Date().getTime()-lu.current;Kt.current=Kt.current-ve}qm.current=new Date().getTime()})():Kt.current!==1/0&&(lu.current=new Date().getTime(),ie=setTimeout(()=>{var ve;(ve=h.onAutoClose)==null||ve.call(h,h),yr()},Kt.current)),()=>clearTimeout(ie)},[w,m,h,Xe,$,Xm,yr]),z.useEffect(()=>{h.delete&&yr()},[yr,h.delete]);function o1(){var ie,ve,Ce;return M!=null&&M.loading?z.createElement("div",{className:an(k==null?void 0:k.loader,(ie=h==null?void 0:h.classNames)==null?void 0:ie.loader,"sonner-loader"),"data-visible":Xe==="loading"},M.loading):H?z.createElement("div",{className:an(k==null?void 0:k.loader,(ve=h==null?void 0:h.classNames)==null?void 0:ve.loader,"sonner-loader"),"data-visible":Xe==="loading"},H):z.createElement(MI,{className:an(k==null?void 0:k.loader,(Ce=h==null?void 0:h.classNames)==null?void 0:Ce.loader),visible:Xe==="loading"})}return z.createElement("li",{tabIndex:0,ref:Ln,className:an(O,au,k==null?void 0:k.toast,(e=h==null?void 0:h.classNames)==null?void 0:e.toast,k==null?void 0:k.default,k==null?void 0:k[Xe],(t=h==null?void 0:h.classNames)==null?void 0:t[Xe]),"data-sonner-toast":"","data-rich-colors":(r=h.richColors)!=null?r:A,"data-styled":!(h.jsx||h.unstyled||p),"data-mounted":ne,"data-promise":!!h.promise,"data-swiped":fa,"data-removed":Be,"data-visible":ha,"data-y-position":r1,"data-x-position":s1,"data-index":E,"data-front":$s,"data-swiping":ot,"data-dismissible":Qn,"data-type":Xe,"data-invert":i1,"data-swipe-out":Ht,"data-swipe-direction":ee,"data-expanded":!!(w||_&&ne),style:{"--index":E,"--toasts-before":E,"--z-index":T.length-E,"--offset":`${Be?je:Bs.current}px`,"--initial-height":_?"auto":`${Et}px`,...C,...h.style},onDragEnd:()=>{gr(!1),Q(null),Us.current=null},onPointerDown:ie=>{cu||!Qn||(An.current=new Date,Qe(Bs.current),ie.target.setPointerCapture(ie.pointerId),ie.target.tagName!=="BUTTON"&&(gr(!0),Us.current={x:ie.clientX,y:ie.clientY}))},onPointerUp:()=>{var ie,ve,Ce,nn;if(Ht||!Qn)return;Us.current=null;let rn=Number(((ie=Ln.current)==null?void 0:ie.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),xr=Number(((ve=Ln.current)==null?void 0:ve.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),us=new Date().getTime()-((Ce=An.current)==null?void 0:Ce.getTime()),sn=Y==="x"?rn:xr,Er=Math.abs(sn)/us;if(Math.abs(sn)>=tR||Er>.11){Qe(Bs.current),(nn=h.onDismiss)==null||nn.call(h,h),te(Y==="x"?rn>0?"right":"left":xr>0?"down":"up"),yr(),vr(!0),ue(!1);return}gr(!1),Q(null)},onPointerMove:ie=>{var ve,Ce,nn,rn;if(!Us.current||!Qn||((ve=window.getSelection())==null?void 0:ve.toString().length)>0)return;let xr=ie.clientY-Us.current.y,us=ie.clientX-Us.current.x,sn=(Ce=n.swipeDirections)!=null?Ce:rR(K);!Y&&(Math.abs(us)>1||Math.abs(xr)>1)&&Q(Math.abs(us)>Math.abs(xr)?"x":"y");let Er={x:0,y:0};Y==="y"?(sn.includes("top")||sn.includes("bottom"))&&(sn.includes("top")&&xr<0||sn.includes("bottom")&&xr>0)&&(Er.y=xr):Y==="x"&&(sn.includes("left")||sn.includes("right"))&&(sn.includes("left")&&us<0||sn.includes("right")&&us>0)&&(Er.x=us),(Math.abs(Er.x)>0||Math.abs(Er.y)>0)&&ue(!0),(nn=Ln.current)==null||nn.style.setProperty("--swipe-amount-x",`${Er.x}px`),(rn=Ln.current)==null||rn.style.setProperty("--swipe-amount-y",`${Er.y}px`)}},cs&&!h.jsx?z.createElement("button",{"aria-label":F,"data-disabled":cu,"data-close-button":!0,onClick:cu||!Qn?()=>{}:()=>{var ie;yr(),(ie=h.onDismiss)==null||ie.call(h,h)},className:an(k==null?void 0:k.closeButton,(s=h==null?void 0:h.classNames)==null?void 0:s.closeButton)},(i=M==null?void 0:M.close)!=null?i:jI):null,h.jsx||b.isValidElement(h.title)?h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title:z.createElement(z.Fragment,null,Xe||h.icon||h.promise?z.createElement("div",{"data-icon":"",className:an(k==null?void 0:k.icon,(o=h==null?void 0:h.classNames)==null?void 0:o.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||o1():null,h.type!=="loading"?h.icon||(M==null?void 0:M[Xe])||NI(Xe):null):null,z.createElement("div",{"data-content":"",className:an(k==null?void 0:k.content,(a=h==null?void 0:h.classNames)==null?void 0:a.content)},z.createElement("div",{"data-title":"",className:an(k==null?void 0:k.title,(l=h==null?void 0:h.classNames)==null?void 0:l.title)},typeof h.title=="function"?h.title():h.title),h.description?z.createElement("div",{"data-description":"",className:an(V,ma,k==null?void 0:k.description,(c=h==null?void 0:h.classNames)==null?void 0:c.description)},typeof h.description=="function"?h.description():h.description):null),b.isValidElement(h.cancel)?h.cancel:h.cancel&&Oa(h.cancel)?z.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||I,onClick:ie=>{var ve,Ce;Oa(h.cancel)&&Qn&&((Ce=(ve=h.cancel).onClick)==null||Ce.call(ve,ie),yr())},className:an(k==null?void 0:k.cancelButton,(u=h==null?void 0:h.classNames)==null?void 0:u.cancelButton)},h.cancel.label):null,b.isValidElement(h.action)?h.action:h.action&&Oa(h.action)?z.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||P,onClick:ie=>{var ve,Ce;Oa(h.action)&&((Ce=(ve=h.action).onClick)==null||Ce.call(ve,ie),!ie.defaultPrevented&&yr())},className:an(k==null?void 0:k.actionButton,(d=h==null?void 0:h.classNames)==null?void 0:d.actionButton)},h.action.label):null))};function Sg(){if(typeof window>"u"||typeof document>"u")return"ltr";let n=document.documentElement.getAttribute("dir");return n==="auto"||!n?window.getComputedStyle(document.documentElement).direction:n}function iR(n,e){let t={};return[n,e].forEach((r,s)=>{let i=s===1,o=i?"--mobile-offset":"--offset",a=i?ZI:XI;function l(c){["top","right","bottom","left"].forEach(u=>{t[`${o}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?t[`${o}-${c}`]=a:t[`${o}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(a)}),t}var oR=b.forwardRef(function(n,e){let{invert:t,position:r="bottom-right",hotkey:s=["altKey","KeyT"],expand:i,closeButton:o,className:a,offset:l,mobileOffset:c,theme:u="light",richColors:d,duration:f,style:h,visibleToasts:p=QI,toastOptions:m,dir:g=Sg(),gap:v=eR,loadingIcon:x,icons:E,containerAriaLabel:T="Notifications",pauseWhenPageIsHidden:w}=n,[L,A]=z.useState([]),R=z.useMemo(()=>Array.from(new Set([r].concat(L.filter($=>$.position).map($=>$.position)))),[L,r]),[C,I]=z.useState([]),[P,O]=z.useState(!1),[V,B]=z.useState(!1),[K,U]=z.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),H=z.useRef(null),_=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),k=z.useRef(null),M=z.useRef(!1),F=z.useCallback($=>{A(Y=>{var Q;return(Q=Y.find(ee=>ee.id===$.id))!=null&&Q.delete||bt.dismiss($.id),Y.filter(({id:ee})=>ee!==$.id)})},[]);return z.useEffect(()=>bt.subscribe($=>{if($.dismiss){A(Y=>Y.map(Q=>Q.id===$.id?{...Q,delete:!0}:Q));return}setTimeout(()=>{Ux.flushSync(()=>{A(Y=>{let Q=Y.findIndex(ee=>ee.id===$.id);return Q!==-1?[...Y.slice(0,Q),{...Y[Q],...$},...Y.slice(Q+1)]:[$,...Y]})})})}),[]),z.useEffect(()=>{if(u!=="system"){U(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?U("dark"):U("light")),typeof window>"u")return;let $=window.matchMedia("(prefers-color-scheme: dark)");try{$.addEventListener("change",({matches:Y})=>{U(Y?"dark":"light")})}catch{$.addListener(({matches:Q})=>{try{U(Q?"dark":"light")}catch(ee){console.error(ee)}})}},[u]),z.useEffect(()=>{L.length<=1&&O(!1)},[L]),z.useEffect(()=>{let $=Y=>{var Q,ee;s.every(te=>Y[te]||Y.code===te)&&(O(!0),(Q=H.current)==null||Q.focus()),Y.code==="Escape"&&(document.activeElement===H.current||(ee=H.current)!=null&&ee.contains(document.activeElement))&&O(!1)};return document.addEventListener("keydown",$),()=>document.removeEventListener("keydown",$)},[s]),z.useEffect(()=>{if(H.current)return()=>{k.current&&(k.current.focus({preventScroll:!0}),k.current=null,M.current=!1)}},[H.current]),z.createElement("section",{ref:e,"aria-label":`${T} ${_}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},R.map(($,Y)=>{var Q;let[ee,te]=$.split("-");return L.length?z.createElement("ol",{key:$,dir:g==="auto"?Sg():g,tabIndex:-1,ref:H,className:a,"data-sonner-toaster":!0,"data-theme":K,"data-y-position":ee,"data-lifted":P&&L.length>1&&!i,"data-x-position":te,style:{"--front-toast-height":`${((Q=C[0])==null?void 0:Q.height)||0}px`,"--width":`${JI}px`,"--gap":`${v}px`,...h,...iR(l,c)},onBlur:ne=>{M.current&&!ne.currentTarget.contains(ne.relatedTarget)&&(M.current=!1,k.current&&(k.current.focus({preventScroll:!0}),k.current=null))},onFocus:ne=>{ne.target instanceof HTMLElement&&ne.target.dataset.dismissible==="false"||M.current||(M.current=!0,k.current=ne.relatedTarget)},onMouseEnter:()=>O(!0),onMouseMove:()=>O(!0),onMouseLeave:()=>{V||O(!1)},onDragEnd:()=>O(!1),onPointerDown:ne=>{ne.target instanceof HTMLElement&&ne.target.dataset.dismissible==="false"||B(!0)},onPointerUp:()=>B(!1)},L.filter(ne=>!ne.position&&Y===0||ne.position===$).map((ne,Re)=>{var Be,qe;return z.createElement(sR,{key:ne.id,icons:E,index:Re,toast:ne,defaultRichColors:d,duration:(Be=m==null?void 0:m.duration)!=null?Be:f,className:m==null?void 0:m.className,descriptionClassName:m==null?void 0:m.descriptionClassName,invert:t,visibleToasts:p,closeButton:(qe=m==null?void 0:m.closeButton)!=null?qe:o,interacting:V,position:$,style:m==null?void 0:m.style,unstyled:m==null?void 0:m.unstyled,classNames:m==null?void 0:m.classNames,cancelButtonStyle:m==null?void 0:m.cancelButtonStyle,actionButtonStyle:m==null?void 0:m.actionButtonStyle,removeToast:F,toasts:L.filter(ot=>ot.position==ne.position),heights:C.filter(ot=>ot.position==ne.position),setHeights:I,expandByDefault:i,gap:v,loadingIcon:x,expanded:P,pauseWhenPageIsHidden:w,swipeDirections:n.swipeDirections})})):null}))});const aR=({...n})=>{const{theme:e="system"}=DI();return y.jsx(oR,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...n})};var lR=rh[" useId ".trim().toString()]||(()=>{}),cR=0;function wo(n){const[e,t]=b.useState(lR());return Kn(()=>{t(r=>r??String(cR++))},[n]),e?`radix-${e}`:""}const uR=["top","right","bottom","left"],Jr=Math.min,Ot=Math.max,Jl=Math.round,Ma=Math.floor,Vn=n=>({x:n,y:n}),dR={left:"right",right:"left",bottom:"top",top:"bottom"},fR={start:"end",end:"start"};function Sf(n,e,t){return Ot(n,Jr(e,t))}function hr(n,e){return typeof n=="function"?n(e):n}function mr(n){return n.split("-")[0]}function Yi(n){return n.split("-")[1]}function Jh(n){return n==="x"?"y":"x"}function em(n){return n==="y"?"height":"width"}const hR=new Set(["top","bottom"]);function $n(n){return hR.has(mr(n))?"y":"x"}function tm(n){return Jh($n(n))}function mR(n,e,t){t===void 0&&(t=!1);const r=Yi(n),s=tm(n),i=em(s);let o=s==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=ec(o)),[o,ec(o)]}function pR(n){const e=ec(n);return[Tf(n),e,Tf(e)]}function Tf(n){return n.replace(/start|end/g,e=>fR[e])}const Tg=["left","right"],bg=["right","left"],gR=["top","bottom"],vR=["bottom","top"];function yR(n,e,t){switch(n){case"top":case"bottom":return t?e?bg:Tg:e?Tg:bg;case"left":case"right":return e?gR:vR;default:return[]}}function xR(n,e,t,r){const s=Yi(n);let i=yR(mr(n),t==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(Tf)))),i}function ec(n){return n.replace(/left|right|bottom|top/g,e=>dR[e])}function ER(n){return{top:0,right:0,bottom:0,left:0,...n}}function IE(n){return typeof n!="number"?ER(n):{top:n,right:n,bottom:n,left:n}}function tc(n){const{x:e,y:t,width:r,height:s}=n;return{width:r,height:s,top:t,left:e,right:e+r,bottom:t+s,x:e,y:t}}function wg(n,e,t){let{reference:r,floating:s}=n;const i=$n(e),o=tm(e),a=em(o),l=mr(e),c=i==="y",u=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,f=r[a]/2-s[a]/2;let h;switch(l){case"top":h={x:u,y:r.y-s.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-s.width,y:d};break;default:h={x:r.x,y:r.y}}switch(Yi(e)){case"start":h[o]-=f*(t&&c?-1:1);break;case"end":h[o]+=f*(t&&c?-1:1);break}return h}const SR=async(n,e,t)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=t,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:n,floating:e,strategy:s}),{x:u,y:d}=wg(c,r,l),f=r,h={},p=0;for(let m=0;m<a.length;m++){const{name:g,fn:v}=a[m],{x,y:E,data:T,reset:w}=await v({x:u,y:d,initialPlacement:r,placement:f,strategy:s,middlewareData:h,rects:c,platform:o,elements:{reference:n,floating:e}});u=x??u,d=E??d,h={...h,[g]:{...h[g],...T}},w&&p<=50&&(p++,typeof w=="object"&&(w.placement&&(f=w.placement),w.rects&&(c=w.rects===!0?await o.getElementRects({reference:n,floating:e,strategy:s}):w.rects),{x:u,y:d}=wg(c,f,l)),m=-1)}return{x:u,y:d,placement:f,strategy:s,middlewareData:h}};async function zo(n,e){var t;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:a,strategy:l}=n,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=hr(e,n),p=IE(h),g=a[f?d==="floating"?"reference":"floating":d],v=tc(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(g)))==null||t?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),x=d==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,E=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),T=await(i.isElement==null?void 0:i.isElement(E))?await(i.getScale==null?void 0:i.getScale(E))||{x:1,y:1}:{x:1,y:1},w=tc(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:x,offsetParent:E,strategy:l}):x);return{top:(v.top-w.top+p.top)/T.y,bottom:(w.bottom-v.bottom+p.bottom)/T.y,left:(v.left-w.left+p.left)/T.x,right:(w.right-v.right+p.right)/T.x}}const TR=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=hr(n,e)||{};if(c==null)return{};const d=IE(u),f={x:t,y:r},h=tm(s),p=em(h),m=await o.getDimensions(c),g=h==="y",v=g?"top":"left",x=g?"bottom":"right",E=g?"clientHeight":"clientWidth",T=i.reference[p]+i.reference[h]-f[h]-i.floating[p],w=f[h]-i.reference[h],L=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let A=L?L[E]:0;(!A||!await(o.isElement==null?void 0:o.isElement(L)))&&(A=a.floating[E]||i.floating[p]);const R=T/2-w/2,C=A/2-m[p]/2-1,I=Jr(d[v],C),P=Jr(d[x],C),O=I,V=A-m[p]-P,B=A/2-m[p]/2+R,K=Sf(O,B,V),U=!l.arrow&&Yi(s)!=null&&B!==K&&i.reference[p]/2-(B<O?I:P)-m[p]/2<0,H=U?B<O?B-O:B-V:0;return{[h]:f[h]+H,data:{[h]:K,centerOffset:B-K-H,...U&&{alignmentOffset:H}},reset:U}}}),bR=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=hr(n,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const v=mr(s),x=$n(a),E=mr(a)===a,T=await(l.isRTL==null?void 0:l.isRTL(c.floating)),w=f||(E||!m?[ec(a)]:pR(a)),L=p!=="none";!f&&L&&w.push(...xR(a,m,p,T));const A=[a,...w],R=await zo(e,g),C=[];let I=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&C.push(R[v]),d){const B=mR(s,o,T);C.push(R[B[0]],R[B[1]])}if(I=[...I,{placement:s,overflows:C}],!C.every(B=>B<=0)){var P,O;const B=(((P=i.flip)==null?void 0:P.index)||0)+1,K=A[B];if(K&&(!(d==="alignment"?x!==$n(K):!1)||I.every(_=>_.overflows[0]>0&&$n(_.placement)===x)))return{data:{index:B,overflows:I},reset:{placement:K}};let U=(O=I.filter(H=>H.overflows[0]<=0).sort((H,_)=>H.overflows[1]-_.overflows[1])[0])==null?void 0:O.placement;if(!U)switch(h){case"bestFit":{var V;const H=(V=I.filter(_=>{if(L){const k=$n(_.placement);return k===x||k==="y"}return!0}).map(_=>[_.placement,_.overflows.filter(k=>k>0).reduce((k,M)=>k+M,0)]).sort((_,k)=>_[1]-k[1])[0])==null?void 0:V[0];H&&(U=H);break}case"initialPlacement":U=a;break}if(s!==U)return{reset:{placement:U}}}return{}}}};function Ag(n,e){return{top:n.top-e.height,right:n.right-e.width,bottom:n.bottom-e.height,left:n.left-e.width}}function Lg(n){return uR.some(e=>n[e]>=0)}const wR=function(n){return n===void 0&&(n={}),{name:"hide",options:n,async fn(e){const{rects:t}=e,{strategy:r="referenceHidden",...s}=hr(n,e);switch(r){case"referenceHidden":{const i=await zo(e,{...s,elementContext:"reference"}),o=Ag(i,t.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Lg(o)}}}case"escaped":{const i=await zo(e,{...s,altBoundary:!0}),o=Ag(i,t.floating);return{data:{escapedOffsets:o,escaped:Lg(o)}}}default:return{}}}}},RE=new Set(["left","top"]);async function AR(n,e){const{placement:t,platform:r,elements:s}=n,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=mr(t),a=Yi(t),l=$n(t)==="y",c=RE.has(o)?-1:1,u=i&&l?-1:1,d=hr(e,n);let{mainAxis:f,crossAxis:h,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),l?{x:h*u,y:f*c}:{x:f*c,y:h*u}}const LR=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await AR(e,n);return o===((t=a.offset)==null?void 0:t.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},IR=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:v,y:x}=g;return{x:v,y:x}}},...l}=hr(n,e),c={x:t,y:r},u=await zo(e,l),d=$n(mr(s)),f=Jh(d);let h=c[f],p=c[d];if(i){const g=f==="y"?"top":"left",v=f==="y"?"bottom":"right",x=h+u[g],E=h-u[v];h=Sf(x,h,E)}if(o){const g=d==="y"?"top":"left",v=d==="y"?"bottom":"right",x=p+u[g],E=p-u[v];p=Sf(x,p,E)}const m=a.fn({...e,[f]:h,[d]:p});return{...m,data:{x:m.x-t,y:m.y-r,enabled:{[f]:i,[d]:o}}}}}},RR=function(n){return n===void 0&&(n={}),{options:n,fn(e){const{x:t,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=hr(n,e),u={x:t,y:r},d=$n(s),f=Jh(d);let h=u[f],p=u[d];const m=hr(a,e),g=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const E=f==="y"?"height":"width",T=i.reference[f]-i.floating[E]+g.mainAxis,w=i.reference[f]+i.reference[E]-g.mainAxis;h<T?h=T:h>w&&(h=w)}if(c){var v,x;const E=f==="y"?"width":"height",T=RE.has(mr(s)),w=i.reference[d]-i.floating[E]+(T&&((v=o.offset)==null?void 0:v[d])||0)+(T?0:g.crossAxis),L=i.reference[d]+i.reference[E]+(T?0:((x=o.offset)==null?void 0:x[d])||0)-(T?g.crossAxis:0);p<w?p=w:p>L&&(p=L)}return{[f]:h,[d]:p}}}},CR=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){var t,r;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=hr(n,e),u=await zo(e,c),d=mr(s),f=Yi(s),h=$n(s)==="y",{width:p,height:m}=i.floating;let g,v;d==="top"||d==="bottom"?(g=d,v=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(v=d,g=f==="end"?"top":"bottom");const x=m-u.top-u.bottom,E=p-u.left-u.right,T=Jr(m-u[g],x),w=Jr(p-u[v],E),L=!e.middlewareData.shift;let A=T,R=w;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(R=E),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(A=x),L&&!f){const I=Ot(u.left,0),P=Ot(u.right,0),O=Ot(u.top,0),V=Ot(u.bottom,0);h?R=p-2*(I!==0||P!==0?I+P:Ot(u.left,u.right)):A=m-2*(O!==0||V!==0?O+V:Ot(u.top,u.bottom))}await l({...e,availableWidth:R,availableHeight:A});const C=await o.getDimensions(a.floating);return p!==C.width||m!==C.height?{reset:{rects:!0}}:{}}}};function $c(){return typeof window<"u"}function qi(n){return CE(n)?(n.nodeName||"").toLowerCase():"#document"}function Bt(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function qn(n){var e;return(e=(CE(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function CE(n){return $c()?n instanceof Node||n instanceof Bt(n).Node:!1}function Sn(n){return $c()?n instanceof Element||n instanceof Bt(n).Element:!1}function zn(n){return $c()?n instanceof HTMLElement||n instanceof Bt(n).HTMLElement:!1}function Ig(n){return!$c()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Bt(n).ShadowRoot}const kR=new Set(["inline","contents"]);function da(n){const{overflow:e,overflowX:t,overflowY:r,display:s}=Tn(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!kR.has(s)}const _R=new Set(["table","td","th"]);function PR(n){return _R.has(qi(n))}const DR=[":popover-open",":modal"];function Bc(n){return DR.some(e=>{try{return n.matches(e)}catch{return!1}})}const NR=["transform","translate","scale","rotate","perspective"],OR=["transform","translate","scale","rotate","perspective","filter"],MR=["paint","layout","strict","content"];function nm(n){const e=rm(),t=Sn(n)?Tn(n):n;return NR.some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||OR.some(r=>(t.willChange||"").includes(r))||MR.some(r=>(t.contain||"").includes(r))}function FR(n){let e=es(n);for(;zn(e)&&!$i(e);){if(nm(e))return e;if(Bc(e))return null;e=es(e)}return null}function rm(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const $R=new Set(["html","body","#document"]);function $i(n){return $R.has(qi(n))}function Tn(n){return Bt(n).getComputedStyle(n)}function Uc(n){return Sn(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function es(n){if(qi(n)==="html")return n;const e=n.assignedSlot||n.parentNode||Ig(n)&&n.host||qn(n);return Ig(e)?e.host:e}function kE(n){const e=es(n);return $i(e)?n.ownerDocument?n.ownerDocument.body:n.body:zn(e)&&da(e)?e:kE(e)}function Wo(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=kE(n),i=s===((r=n.ownerDocument)==null?void 0:r.body),o=Bt(s);if(i){const a=bf(o);return e.concat(o,o.visualViewport||[],da(s)?s:[],a&&t?Wo(a):[])}return e.concat(s,Wo(s,[],t))}function bf(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function _E(n){const e=Tn(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=zn(n),i=s?n.offsetWidth:t,o=s?n.offsetHeight:r,a=Jl(t)!==i||Jl(r)!==o;return a&&(t=i,r=o),{width:t,height:r,$:a}}function sm(n){return Sn(n)?n:n.contextElement}function gi(n){const e=sm(n);if(!zn(e))return Vn(1);const t=e.getBoundingClientRect(),{width:r,height:s,$:i}=_E(e);let o=(i?Jl(t.width):t.width)/r,a=(i?Jl(t.height):t.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const BR=Vn(0);function PE(n){const e=Bt(n);return!rm()||!e.visualViewport?BR:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function UR(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==Bt(n)?!1:e}function Ds(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=n.getBoundingClientRect(),i=sm(n);let o=Vn(1);e&&(r?Sn(r)&&(o=gi(r)):o=gi(n));const a=UR(i,t,r)?PE(i):Vn(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,d=s.height/o.y;if(i){const f=Bt(i),h=r&&Sn(r)?Bt(r):r;let p=f,m=bf(p);for(;m&&r&&h!==p;){const g=gi(m),v=m.getBoundingClientRect(),x=Tn(m),E=v.left+(m.clientLeft+parseFloat(x.paddingLeft))*g.x,T=v.top+(m.clientTop+parseFloat(x.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,d*=g.y,l+=E,c+=T,p=Bt(m),m=bf(p)}}return tc({width:u,height:d,x:l,y:c})}function im(n,e){const t=Uc(n).scrollLeft;return e?e.left+t:Ds(qn(n)).left+t}function DE(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),s=r.left+e.scrollLeft-(t?0:im(n,r)),i=r.top+e.scrollTop;return{x:s,y:i}}function jR(n){let{elements:e,rect:t,offsetParent:r,strategy:s}=n;const i=s==="fixed",o=qn(r),a=e?Bc(e.floating):!1;if(r===o||a&&i)return t;let l={scrollLeft:0,scrollTop:0},c=Vn(1);const u=Vn(0),d=zn(r);if((d||!d&&!i)&&((qi(r)!=="body"||da(o))&&(l=Uc(r)),zn(r))){const h=Ds(r);c=gi(r),u.x=h.x+r.clientLeft,u.y=h.y+r.clientTop}const f=o&&!d&&!i?DE(o,l,!0):Vn(0);return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:t.y*c.y-l.scrollTop*c.y+u.y+f.y}}function GR(n){return Array.from(n.getClientRects())}function VR(n){const e=qn(n),t=Uc(n),r=n.ownerDocument.body,s=Ot(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=Ot(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-t.scrollLeft+im(n);const a=-t.scrollTop;return Tn(r).direction==="rtl"&&(o+=Ot(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:a}}function HR(n,e){const t=Bt(n),r=qn(n),s=t.visualViewport;let i=r.clientWidth,o=r.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const c=rm();(!c||c&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:i,height:o,x:a,y:l}}const KR=new Set(["absolute","fixed"]);function zR(n,e){const t=Ds(n,!0,e==="fixed"),r=t.top+n.clientTop,s=t.left+n.clientLeft,i=zn(n)?gi(n):Vn(1),o=n.clientWidth*i.x,a=n.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:o,height:a,x:l,y:c}}function Rg(n,e,t){let r;if(e==="viewport")r=HR(n,t);else if(e==="document")r=VR(qn(n));else if(Sn(e))r=zR(e,t);else{const s=PE(n);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return tc(r)}function NE(n,e){const t=es(n);return t===e||!Sn(t)||$i(t)?!1:Tn(t).position==="fixed"||NE(t,e)}function WR(n,e){const t=e.get(n);if(t)return t;let r=Wo(n,[],!1).filter(a=>Sn(a)&&qi(a)!=="body"),s=null;const i=Tn(n).position==="fixed";let o=i?es(n):n;for(;Sn(o)&&!$i(o);){const a=Tn(o),l=nm(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&KR.has(s.position)||da(o)&&!l&&NE(n,o))?r=r.filter(u=>u!==o):s=a,o=es(o)}return e.set(n,r),r}function YR(n){let{element:e,boundary:t,rootBoundary:r,strategy:s}=n;const o=[...t==="clippingAncestors"?Bc(e)?[]:WR(e,this._c):[].concat(t),r],a=o[0],l=o.reduce((c,u)=>{const d=Rg(e,u,s);return c.top=Ot(d.top,c.top),c.right=Jr(d.right,c.right),c.bottom=Jr(d.bottom,c.bottom),c.left=Ot(d.left,c.left),c},Rg(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function qR(n){const{width:e,height:t}=_E(n);return{width:e,height:t}}function QR(n,e,t){const r=zn(e),s=qn(e),i=t==="fixed",o=Ds(n,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=Vn(0);function c(){l.x=im(s)}if(r||!r&&!i)if((qi(e)!=="body"||da(s))&&(a=Uc(e)),r){const h=Ds(e,!0,i,e);l.x=h.x+e.clientLeft,l.y=h.y+e.clientTop}else s&&c();i&&!r&&s&&c();const u=s&&!r&&!i?DE(s,a):Vn(0),d=o.left+a.scrollLeft-l.x-u.x,f=o.top+a.scrollTop-l.y-u.y;return{x:d,y:f,width:o.width,height:o.height}}function ju(n){return Tn(n).position==="static"}function Cg(n,e){if(!zn(n)||Tn(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return qn(n)===t&&(t=t.ownerDocument.body),t}function OE(n,e){const t=Bt(n);if(Bc(n))return t;if(!zn(n)){let s=es(n);for(;s&&!$i(s);){if(Sn(s)&&!ju(s))return s;s=es(s)}return t}let r=Cg(n,e);for(;r&&PR(r)&&ju(r);)r=Cg(r,e);return r&&$i(r)&&ju(r)&&!nm(r)?t:r||FR(n)||t}const XR=async function(n){const e=this.getOffsetParent||OE,t=this.getDimensions,r=await t(n.floating);return{reference:QR(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function ZR(n){return Tn(n).direction==="rtl"}const JR={convertOffsetParentRelativeRectToViewportRelativeRect:jR,getDocumentElement:qn,getClippingRect:YR,getOffsetParent:OE,getElementRects:XR,getClientRects:GR,getDimensions:qR,getScale:gi,isElement:Sn,isRTL:ZR};function ME(n,e){return n.x===e.x&&n.y===e.y&&n.width===e.width&&n.height===e.height}function eC(n,e){let t=null,r;const s=qn(n);function i(){var a;clearTimeout(r),(a=t)==null||a.disconnect(),t=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=n.getBoundingClientRect(),{left:u,top:d,width:f,height:h}=c;if(a||e(),!f||!h)return;const p=Ma(d),m=Ma(s.clientWidth-(u+f)),g=Ma(s.clientHeight-(d+h)),v=Ma(u),E={rootMargin:-p+"px "+-m+"px "+-g+"px "+-v+"px",threshold:Ot(0,Jr(1,l))||1};let T=!0;function w(L){const A=L[0].intersectionRatio;if(A!==l){if(!T)return o();A?o(!1,A):r=setTimeout(()=>{o(!1,1e-7)},1e3)}A===1&&!ME(c,n.getBoundingClientRect())&&o(),T=!1}try{t=new IntersectionObserver(w,{...E,root:s.ownerDocument})}catch{t=new IntersectionObserver(w,E)}t.observe(n)}return o(!0),i}function tC(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=sm(n),u=s||i?[...c?Wo(c):[],...Wo(e)]:[];u.forEach(v=>{s&&v.addEventListener("scroll",t,{passive:!0}),i&&v.addEventListener("resize",t)});const d=c&&a?eC(c,t):null;let f=-1,h=null;o&&(h=new ResizeObserver(v=>{let[x]=v;x&&x.target===c&&h&&(h.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var E;(E=h)==null||E.observe(e)})),t()}),c&&!l&&h.observe(c),h.observe(e));let p,m=l?Ds(n):null;l&&g();function g(){const v=Ds(n);m&&!ME(m,v)&&t(),m=v,p=requestAnimationFrame(g)}return t(),()=>{var v;u.forEach(x=>{s&&x.removeEventListener("scroll",t),i&&x.removeEventListener("resize",t)}),d==null||d(),(v=h)==null||v.disconnect(),h=null,l&&cancelAnimationFrame(p)}}const nC=LR,rC=IR,sC=bR,iC=CR,oC=wR,kg=TR,aC=RR,lC=(n,e,t)=>{const r=new Map,s={platform:JR,...t},i={...s.platform,_c:r};return SR(n,e,{...s,platform:i})};var cC=typeof document<"u",uC=function(){},vl=cC?b.useLayoutEffect:uC;function nc(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,s;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!nc(n[r],e[r]))return!1;return!0}if(s=Object.keys(n),t=s.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=t;r--!==0;){const i=s[r];if(!(i==="_owner"&&n.$$typeof)&&!nc(n[i],e[i]))return!1}return!0}return n!==n&&e!==e}function FE(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function _g(n,e){const t=FE(n);return Math.round(e*t)/t}function Gu(n){const e=b.useRef(n);return vl(()=>{e.current=n}),e}function dC(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=n,[u,d]=b.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[f,h]=b.useState(r);nc(f,r)||h(r);const[p,m]=b.useState(null),[g,v]=b.useState(null),x=b.useCallback(_=>{_!==L.current&&(L.current=_,m(_))},[]),E=b.useCallback(_=>{_!==A.current&&(A.current=_,v(_))},[]),T=i||p,w=o||g,L=b.useRef(null),A=b.useRef(null),R=b.useRef(u),C=l!=null,I=Gu(l),P=Gu(s),O=Gu(c),V=b.useCallback(()=>{if(!L.current||!A.current)return;const _={placement:e,strategy:t,middleware:f};P.current&&(_.platform=P.current),lC(L.current,A.current,_).then(k=>{const M={...k,isPositioned:O.current!==!1};B.current&&!nc(R.current,M)&&(R.current=M,ca.flushSync(()=>{d(M)}))})},[f,e,t,P,O]);vl(()=>{c===!1&&R.current.isPositioned&&(R.current.isPositioned=!1,d(_=>({..._,isPositioned:!1})))},[c]);const B=b.useRef(!1);vl(()=>(B.current=!0,()=>{B.current=!1}),[]),vl(()=>{if(T&&(L.current=T),w&&(A.current=w),T&&w){if(I.current)return I.current(T,w,V);V()}},[T,w,V,I,C]);const K=b.useMemo(()=>({reference:L,floating:A,setReference:x,setFloating:E}),[x,E]),U=b.useMemo(()=>({reference:T,floating:w}),[T,w]),H=b.useMemo(()=>{const _={position:t,left:0,top:0};if(!U.floating)return _;const k=_g(U.floating,u.x),M=_g(U.floating,u.y);return a?{..._,transform:"translate("+k+"px, "+M+"px)",...FE(U.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:k,top:M}},[t,a,U.floating,u.x,u.y]);return b.useMemo(()=>({...u,update:V,refs:K,elements:U,floatingStyles:H}),[u,V,K,U,H])}const fC=n=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:r,padding:s}=typeof n=="function"?n(t):n;return r&&e(r)?r.current!=null?kg({element:r.current,padding:s}).fn(t):{}:r?kg({element:r,padding:s}).fn(t):{}}}},hC=(n,e)=>({...nC(n),options:[n,e]}),mC=(n,e)=>({...rC(n),options:[n,e]}),pC=(n,e)=>({...aC(n),options:[n,e]}),gC=(n,e)=>({...sC(n),options:[n,e]}),vC=(n,e)=>({...iC(n),options:[n,e]}),yC=(n,e)=>({...oC(n),options:[n,e]}),xC=(n,e)=>({...fC(n),options:[n,e]});var EC="Arrow",$E=b.forwardRef((n,e)=>{const{children:t,width:r=10,height:s=5,...i}=n;return y.jsx(ge.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:n.asChild?t:y.jsx("polygon",{points:"0,0 30,0 15,10"})})});$E.displayName=EC;var SC=$E;function BE(n){const[e,t]=b.useState(void 0);return Kn(()=>{if(n){t({width:n.offsetWidth,height:n.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=n.offsetWidth,a=n.offsetHeight;t({width:o,height:a})});return r.observe(n,{box:"border-box"}),()=>r.unobserve(n)}else t(void 0)},[n]),e}var UE="Popper",[jE,GE]=os(UE),[pF,VE]=jE(UE),HE="PopperAnchor",KE=b.forwardRef((n,e)=>{const{__scopePopper:t,virtualRef:r,...s}=n,i=VE(HE,t),o=b.useRef(null),a=Ye(e,o);return b.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:y.jsx(ge.div,{...s,ref:a})});KE.displayName=HE;var om="PopperContent",[TC,bC]=jE(om),zE=b.forwardRef((n,e)=>{var ne,Re,Be,qe,ot,gr;const{__scopePopper:t,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:p,...m}=n,g=VE(om,t),[v,x]=b.useState(null),E=Ye(e,Ht=>x(Ht)),[T,w]=b.useState(null),L=BE(T),A=(L==null?void 0:L.width)??0,R=(L==null?void 0:L.height)??0,C=r+(i!=="center"?"-"+i:""),I=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},P=Array.isArray(c)?c:[c],O=P.length>0,V={padding:I,boundary:P.filter(AC),altBoundary:O},{refs:B,floatingStyles:K,placement:U,isPositioned:H,middlewareData:_}=dC({strategy:"fixed",placement:C,whileElementsMounted:(...Ht)=>tC(...Ht,{animationFrame:h==="always"}),elements:{reference:g.anchor},middleware:[hC({mainAxis:s+R,alignmentAxis:o}),l&&mC({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?pC():void 0,...V}),l&&gC({...V}),vC({...V,apply:({elements:Ht,rects:vr,availableWidth:fa,availableHeight:ue})=>{const{width:je,height:Qe}=vr.reference,Et=Ht.floating.style;Et.setProperty("--radix-popper-available-width",`${fa}px`),Et.setProperty("--radix-popper-available-height",`${ue}px`),Et.setProperty("--radix-popper-anchor-width",`${je}px`),Et.setProperty("--radix-popper-anchor-height",`${Qe}px`)}}),T&&xC({element:T,padding:a}),LC({arrowWidth:A,arrowHeight:R}),f&&yC({strategy:"referenceHidden",...V})]}),[k,M]=qE(U),F=Hn(p);Kn(()=>{H&&(F==null||F())},[H,F]);const $=(ne=_.arrow)==null?void 0:ne.x,Y=(Re=_.arrow)==null?void 0:Re.y,Q=((Be=_.arrow)==null?void 0:Be.centerOffset)!==0,[ee,te]=b.useState();return Kn(()=>{v&&te(window.getComputedStyle(v).zIndex)},[v]),y.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:H?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ee,"--radix-popper-transform-origin":[(qe=_.transformOrigin)==null?void 0:qe.x,(ot=_.transformOrigin)==null?void 0:ot.y].join(" "),...((gr=_.hide)==null?void 0:gr.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:n.dir,children:y.jsx(TC,{scope:t,placedSide:k,onArrowChange:w,arrowX:$,arrowY:Y,shouldHideArrow:Q,children:y.jsx(ge.div,{"data-side":k,"data-align":M,...m,ref:E,style:{...m.style,animation:H?void 0:"none"}})})})});zE.displayName=om;var WE="PopperArrow",wC={top:"bottom",right:"left",bottom:"top",left:"right"},YE=b.forwardRef(function(e,t){const{__scopePopper:r,...s}=e,i=bC(WE,r),o=wC[i.placedSide];return y.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:y.jsx(SC,{...s,ref:t,style:{...s.style,display:"block"}})})});YE.displayName=WE;function AC(n){return n!==null}var LC=n=>({name:"transformOrigin",options:n,fn(e){var g,v,x;const{placement:t,rects:r,middlewareData:s}=e,o=((g=s.arrow)==null?void 0:g.centerOffset)!==0,a=o?0:n.arrowWidth,l=o?0:n.arrowHeight,[c,u]=qE(t),d={start:"0%",center:"50%",end:"100%"}[u],f=(((v=s.arrow)==null?void 0:v.x)??0)+a/2,h=(((x=s.arrow)==null?void 0:x.y)??0)+l/2;let p="",m="";return c==="bottom"?(p=o?d:`${f}px`,m=`${-l}px`):c==="top"?(p=o?d:`${f}px`,m=`${r.floating.height+l}px`):c==="right"?(p=`${-l}px`,m=o?d:`${h}px`):c==="left"&&(p=`${r.floating.width+l}px`,m=o?d:`${h}px`),{data:{x:p,y:m}}}});function qE(n){const[e,t="center"]=n.split("-");return[e,t]}var IC=KE,RC=zE,CC=YE,[jc,gF]=os("Tooltip",[GE]),am=GE(),QE="TooltipProvider",kC=700,Pg="tooltip.open",[_C,XE]=jc(QE),ZE=n=>{const{__scopeTooltip:e,delayDuration:t=kC,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=n,o=b.useRef(!0),a=b.useRef(!1),l=b.useRef(0);return b.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),y.jsx(_C,{scope:e,isOpenDelayedRef:o,delayDuration:t,onOpen:b.useCallback(()=>{window.clearTimeout(l.current),o.current=!1},[]),onClose:b.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.current=!0,r)},[r]),isPointerInTransitRef:a,onPointerInTransitChange:b.useCallback(c=>{a.current=c},[]),disableHoverableContent:s,children:i})};ZE.displayName=QE;var JE="Tooltip",[vF,Gc]=jc(JE),wf="TooltipTrigger",PC=b.forwardRef((n,e)=>{const{__scopeTooltip:t,...r}=n,s=Gc(wf,t),i=XE(wf,t),o=am(t),a=b.useRef(null),l=Ye(e,a,s.onTriggerChange),c=b.useRef(!1),u=b.useRef(!1),d=b.useCallback(()=>c.current=!1,[]);return b.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),y.jsx(IC,{asChild:!0,...o,children:y.jsx(ge.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:xe(n.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:xe(n.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:xe(n.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:xe(n.onFocus,()=>{c.current||s.onOpen()}),onBlur:xe(n.onBlur,s.onClose),onClick:xe(n.onClick,s.onClose)})})});PC.displayName=wf;var DC="TooltipPortal",[yF,NC]=jc(DC,{forceMount:void 0}),Bi="TooltipContent",eS=b.forwardRef((n,e)=>{const t=NC(Bi,n.__scopeTooltip),{forceMount:r=t.forceMount,side:s="top",...i}=n,o=Gc(Bi,n.__scopeTooltip);return y.jsx(as,{present:r||o.open,children:o.disableHoverableContent?y.jsx(tS,{side:s,...i,ref:e}):y.jsx(OC,{side:s,...i,ref:e})})}),OC=b.forwardRef((n,e)=>{const t=Gc(Bi,n.__scopeTooltip),r=XE(Bi,n.__scopeTooltip),s=b.useRef(null),i=Ye(e,s),[o,a]=b.useState(null),{trigger:l,onClose:c}=t,u=s.current,{onPointerInTransitChange:d}=r,f=b.useCallback(()=>{a(null),d(!1)},[d]),h=b.useCallback((p,m)=>{const g=p.currentTarget,v={x:p.clientX,y:p.clientY},x=UC(v,g.getBoundingClientRect()),E=jC(v,x),T=GC(m.getBoundingClientRect()),w=HC([...E,...T]);a(w),d(!0)},[d]);return b.useEffect(()=>()=>f(),[f]),b.useEffect(()=>{if(l&&u){const p=g=>h(g,u),m=g=>h(g,l);return l.addEventListener("pointerleave",p),u.addEventListener("pointerleave",m),()=>{l.removeEventListener("pointerleave",p),u.removeEventListener("pointerleave",m)}}},[l,u,h,f]),b.useEffect(()=>{if(o){const p=m=>{const g=m.target,v={x:m.clientX,y:m.clientY},x=(l==null?void 0:l.contains(g))||(u==null?void 0:u.contains(g)),E=!VC(v,o);x?f():E&&(f(),c())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[l,u,o,c,f]),y.jsx(tS,{...n,ref:i})}),[MC,FC]=jc(JE,{isInside:!1}),$C=VA("TooltipContent"),tS=b.forwardRef((n,e)=>{const{__scopeTooltip:t,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=n,l=Gc(Bi,t),c=am(t),{onClose:u}=l;return b.useEffect(()=>(document.addEventListener(Pg,u),()=>document.removeEventListener(Pg,u)),[u]),b.useEffect(()=>{if(l.trigger){const d=f=>{const h=f.target;h!=null&&h.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),y.jsx(Nc,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:y.jsxs(RC,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[y.jsx($C,{children:r}),y.jsx(MC,{scope:t,isInside:!0,children:y.jsx(fL,{id:l.contentId,role:"tooltip",children:s||r})})]})})});eS.displayName=Bi;var nS="TooltipArrow",BC=b.forwardRef((n,e)=>{const{__scopeTooltip:t,...r}=n,s=am(t);return FC(nS,t).isInside?null:y.jsx(CC,{...s,...r,ref:e})});BC.displayName=nS;function UC(n,e){const t=Math.abs(e.top-n.y),r=Math.abs(e.bottom-n.y),s=Math.abs(e.right-n.x),i=Math.abs(e.left-n.x);switch(Math.min(t,r,s,i)){case i:return"left";case s:return"right";case t:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function jC(n,e,t=5){const r=[];switch(e){case"top":r.push({x:n.x-t,y:n.y+t},{x:n.x+t,y:n.y+t});break;case"bottom":r.push({x:n.x-t,y:n.y-t},{x:n.x+t,y:n.y-t});break;case"left":r.push({x:n.x+t,y:n.y-t},{x:n.x+t,y:n.y+t});break;case"right":r.push({x:n.x-t,y:n.y-t},{x:n.x-t,y:n.y+t});break}return r}function GC(n){const{top:e,right:t,bottom:r,left:s}=n;return[{x:s,y:e},{x:t,y:e},{x:t,y:r},{x:s,y:r}]}function VC(n,e){const{x:t,y:r}=n;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],c=a.x,u=a.y,d=l.x,f=l.y;u>r!=f>r&&t<(d-c)*(r-u)/(f-u)+c&&(s=!s)}return s}function HC(n){const e=n.slice();return e.sort((t,r)=>t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0),KC(e)}function KC(n){if(n.length<=1)return n.slice();const e=[];for(let r=0;r<n.length;r++){const s=n[r];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const t=[];for(let r=n.length-1;r>=0;r--){const s=n[r];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))t.pop();else break}t.push(s)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}var zC=ZE,rS=eS;const WC=zC,YC=b.forwardRef(({className:n,sideOffset:e=4,...t},r)=>y.jsx(rS,{ref:r,sideOffset:e,className:be("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...t}));YC.displayName=rS.displayName;var Vc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(n){return this.listeners.add(n),this.onSubscribe(),()=>{this.listeners.delete(n),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Hc=typeof window>"u"||"Deno"in globalThis;function fn(){}function qC(n,e){return typeof n=="function"?n(e):n}function QC(n){return typeof n=="number"&&n>=0&&n!==1/0}function XC(n,e){return Math.max(n+(e||0)-Date.now(),0)}function Af(n,e){return typeof n=="function"?n(e):n}function ZC(n,e){return typeof n=="function"?n(e):n}function Dg(n,e){const{type:t="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:a}=n;if(o){if(r){if(e.queryHash!==lm(o,e.options))return!1}else if(!qo(e.queryKey,o))return!1}if(t!=="all"){const l=e.isActive();if(t==="active"&&!l||t==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||s&&s!==e.state.fetchStatus||i&&!i(e))}function Ng(n,e){const{exact:t,status:r,predicate:s,mutationKey:i}=n;if(i){if(!e.options.mutationKey)return!1;if(t){if(Yo(e.options.mutationKey)!==Yo(i))return!1}else if(!qo(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||s&&!s(e))}function lm(n,e){return((e==null?void 0:e.queryKeyHashFn)||Yo)(n)}function Yo(n){return JSON.stringify(n,(e,t)=>Lf(t)?Object.keys(t).sort().reduce((r,s)=>(r[s]=t[s],r),{}):t)}function qo(n,e){return n===e?!0:typeof n!=typeof e?!1:n&&e&&typeof n=="object"&&typeof e=="object"?Object.keys(e).every(t=>qo(n[t],e[t])):!1}function sS(n,e){if(n===e)return n;const t=Og(n)&&Og(e);if(t||Lf(n)&&Lf(e)){const r=t?n:Object.keys(n),s=r.length,i=t?e:Object.keys(e),o=i.length,a=t?[]:{},l=new Set(r);let c=0;for(let u=0;u<o;u++){const d=t?u:i[u];(!t&&l.has(d)||t)&&n[d]===void 0&&e[d]===void 0?(a[d]=void 0,c++):(a[d]=sS(n[d],e[d]),a[d]===n[d]&&n[d]!==void 0&&c++)}return s===o&&c===s?n:a}return e}function Og(n){return Array.isArray(n)&&n.length===Object.keys(n).length}function Lf(n){if(!Mg(n))return!1;const e=n.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!Mg(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(n)!==Object.prototype)}function Mg(n){return Object.prototype.toString.call(n)==="[object Object]"}function JC(n){return new Promise(e=>{setTimeout(e,n)})}function ek(n,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(n,e):t.structuralSharing!==!1?sS(n,e):e}function tk(n,e,t=0){const r=[...n,e];return t&&r.length>t?r.slice(1):r}function nk(n,e,t=0){const r=[e,...n];return t&&r.length>t?r.slice(0,-1):r}var cm=Symbol();function iS(n,e){return!n.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!n.queryFn||n.queryFn===cm?()=>Promise.reject(new Error(`Missing queryFn: '${n.queryHash}'`)):n.queryFn}var xs,Nr,bi,xv,rk=(xv=class extends Vc{constructor(){super();he(this,xs);he(this,Nr);he(this,bi);oe(this,bi,e=>{if(!Hc&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){G(this,Nr)||this.setEventListener(G(this,bi))}onUnsubscribe(){var e;this.hasListeners()||((e=G(this,Nr))==null||e.call(this),oe(this,Nr,void 0))}setEventListener(e){var t;oe(this,bi,e),(t=G(this,Nr))==null||t.call(this),oe(this,Nr,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){G(this,xs)!==e&&(oe(this,xs,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof G(this,xs)=="boolean"?G(this,xs):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},xs=new WeakMap,Nr=new WeakMap,bi=new WeakMap,xv),oS=new rk,wi,Or,Ai,Ev,sk=(Ev=class extends Vc{constructor(){super();he(this,wi,!0);he(this,Or);he(this,Ai);oe(this,Ai,e=>{if(!Hc&&window.addEventListener){const t=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}}})}onSubscribe(){G(this,Or)||this.setEventListener(G(this,Ai))}onUnsubscribe(){var e;this.hasListeners()||((e=G(this,Or))==null||e.call(this),oe(this,Or,void 0))}setEventListener(e){var t;oe(this,Ai,e),(t=G(this,Or))==null||t.call(this),oe(this,Or,e(this.setOnline.bind(this)))}setOnline(e){G(this,wi)!==e&&(oe(this,wi,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return G(this,wi)}},wi=new WeakMap,Or=new WeakMap,Ai=new WeakMap,Ev),rc=new sk;function ik(){let n,e;const t=new Promise((s,i)=>{n=s,e=i});t.status="pending",t.catch(()=>{});function r(s){Object.assign(t,s),delete t.resolve,delete t.reject}return t.resolve=s=>{r({status:"fulfilled",value:s}),n(s)},t.reject=s=>{r({status:"rejected",reason:s}),e(s)},t}function ok(n){return Math.min(1e3*2**n,3e4)}function aS(n){return(n??"online")==="online"?rc.isOnline():!0}var lS=class extends Error{constructor(n){super("CancelledError"),this.revert=n==null?void 0:n.revert,this.silent=n==null?void 0:n.silent}};function Vu(n){return n instanceof lS}function cS(n){let e=!1,t=0,r=!1,s;const i=ik(),o=m=>{var g;r||(f(new lS(m)),(g=n.abort)==null||g.call(n))},a=()=>{e=!0},l=()=>{e=!1},c=()=>oS.isFocused()&&(n.networkMode==="always"||rc.isOnline())&&n.canRun(),u=()=>aS(n.networkMode)&&n.canRun(),d=m=>{var g;r||(r=!0,(g=n.onSuccess)==null||g.call(n,m),s==null||s(),i.resolve(m))},f=m=>{var g;r||(r=!0,(g=n.onError)==null||g.call(n,m),s==null||s(),i.reject(m))},h=()=>new Promise(m=>{var g;s=v=>{(r||c())&&m(v)},(g=n.onPause)==null||g.call(n)}).then(()=>{var m;s=void 0,r||(m=n.onContinue)==null||m.call(n)}),p=()=>{if(r)return;let m;const g=t===0?n.initialPromise:void 0;try{m=g??n.fn()}catch(v){m=Promise.reject(v)}Promise.resolve(m).then(d).catch(v=>{var L;if(r)return;const x=n.retry??(Hc?0:3),E=n.retryDelay??ok,T=typeof E=="function"?E(t,v):E,w=x===!0||typeof x=="number"&&t<x||typeof x=="function"&&x(t,v);if(e||!w){f(v);return}t++,(L=n.onFail)==null||L.call(n,t,v),JC(T).then(()=>c()?void 0:h()).then(()=>{e?f(v):p()})})};return{promise:i,cancel:o,continue:()=>(s==null||s(),i),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?p():h().then(p),i)}}var ak=n=>setTimeout(n,0);function lk(){let n=[],e=0,t=a=>{a()},r=a=>{a()},s=ak;const i=a=>{e?n.push(a):s(()=>{t(a)})},o=()=>{const a=n;n=[],a.length&&s(()=>{r(()=>{a.forEach(l=>{t(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||o()}return l},batchCalls:a=>(...l)=>{i(()=>{a(...l)})},schedule:i,setNotifyFunction:a=>{t=a},setBatchNotifyFunction:a=>{r=a},setScheduler:a=>{s=a}}}var pt=lk(),Es,Sv,uS=(Sv=class{constructor(){he(this,Es)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),QC(this.gcTime)&&oe(this,Es,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(n){this.gcTime=Math.max(this.gcTime||0,n??(Hc?1/0:5*60*1e3))}clearGcTimeout(){G(this,Es)&&(clearTimeout(G(this,Es)),oe(this,Es,void 0))}},Es=new WeakMap,Sv),Li,Ss,zt,Ts,ut,na,bs,hn,er,Tv,ck=(Tv=class extends uS{constructor(e){super();he(this,hn);he(this,Li);he(this,Ss);he(this,zt);he(this,Ts);he(this,ut);he(this,na);he(this,bs);oe(this,bs,!1),oe(this,na,e.defaultOptions),this.setOptions(e.options),this.observers=[],oe(this,Ts,e.client),oe(this,zt,G(this,Ts).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,oe(this,Li,dk(this.options)),this.state=e.state??G(this,Li),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=G(this,ut))==null?void 0:e.promise}setOptions(e){this.options={...G(this,na),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&G(this,zt).remove(this)}setData(e,t){const r=ek(this.state.data,e,this.options);return at(this,hn,er).call(this,{data:r,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt,manual:t==null?void 0:t.manual}),r}setState(e,t){at(this,hn,er).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var r,s;const t=(r=G(this,ut))==null?void 0:r.promise;return(s=G(this,ut))==null||s.cancel(e),t?t.then(fn).catch(fn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(G(this,Li))}isActive(){return this.observers.some(e=>ZC(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===cm||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Af(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!XC(this.state.dataUpdatedAt,e)}onFocus(){var t;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(t=G(this,ut))==null||t.continue()}onOnline(){var t;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(t=G(this,ut))==null||t.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),G(this,zt).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(G(this,ut)&&(G(this,bs)?G(this,ut).cancel({revert:!0}):G(this,ut).cancelRetry()),this.scheduleGc()),G(this,zt).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||at(this,hn,er).call(this,{type:"invalidate"})}fetch(e,t){var c,u,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(t!=null&&t.cancelRefetch))this.cancel({silent:!0});else if(G(this,ut))return G(this,ut).continueRetry(),G(this,ut).promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(h=>h.options.queryFn);f&&this.setOptions(f.options)}const r=new AbortController,s=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(oe(this,bs,!0),r.signal)})},i=()=>{const f=iS(this.options,t),p=(()=>{const m={client:G(this,Ts),queryKey:this.queryKey,meta:this.meta};return s(m),m})();return oe(this,bs,!1),this.options.persister?this.options.persister(f,p,this):f(p)},a=(()=>{const f={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:G(this,Ts),state:this.state,fetchFn:i};return s(f),f})();(c=this.options.behavior)==null||c.onFetch(a,this),oe(this,Ss,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=a.fetchOptions)==null?void 0:u.meta))&&at(this,hn,er).call(this,{type:"fetch",meta:(d=a.fetchOptions)==null?void 0:d.meta});const l=f=>{var h,p,m,g;Vu(f)&&f.silent||at(this,hn,er).call(this,{type:"error",error:f}),Vu(f)||((p=(h=G(this,zt).config).onError)==null||p.call(h,f,this),(g=(m=G(this,zt).config).onSettled)==null||g.call(m,this.state.data,f,this)),this.scheduleGc()};return oe(this,ut,cS({initialPromise:t==null?void 0:t.initialPromise,fn:a.fetchFn,abort:r.abort.bind(r),onSuccess:f=>{var h,p,m,g;if(f===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(v){l(v);return}(p=(h=G(this,zt).config).onSuccess)==null||p.call(h,f,this),(g=(m=G(this,zt).config).onSettled)==null||g.call(m,f,this.state.error,this),this.scheduleGc()},onError:l,onFail:(f,h)=>{at(this,hn,er).call(this,{type:"failed",failureCount:f,error:h})},onPause:()=>{at(this,hn,er).call(this,{type:"pause"})},onContinue:()=>{at(this,hn,er).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0})),G(this,ut).start()}},Li=new WeakMap,Ss=new WeakMap,zt=new WeakMap,Ts=new WeakMap,ut=new WeakMap,na=new WeakMap,bs=new WeakMap,hn=new WeakSet,er=function(e){const t=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...uk(r.data,this.options),fetchMeta:e.meta??null};case"success":return oe(this,Ss,void 0),{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=e.error;return Vu(s)&&s.revert&&G(this,Ss)?{...G(this,Ss),fetchStatus:"idle"}:{...r,error:s,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=t(this.state),pt.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),G(this,zt).notify({query:this,type:"updated",action:e})})},Tv);function uk(n,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:aS(e.networkMode)?"fetching":"paused",...n===void 0&&{error:null,status:"pending"}}}function dk(n){const e=typeof n.initialData=="function"?n.initialData():n.initialData,t=e!==void 0,r=t?typeof n.initialDataUpdatedAt=="function"?n.initialDataUpdatedAt():n.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var Pn,bv,fk=(bv=class extends Vc{constructor(e={}){super();he(this,Pn);this.config=e,oe(this,Pn,new Map)}build(e,t,r){const s=t.queryKey,i=t.queryHash??lm(s,t);let o=this.get(i);return o||(o=new ck({client:e,queryKey:s,queryHash:i,options:e.defaultQueryOptions(t),state:r,defaultOptions:e.getQueryDefaults(s)}),this.add(o)),o}add(e){G(this,Pn).has(e.queryHash)||(G(this,Pn).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=G(this,Pn).get(e.queryHash);t&&(e.destroy(),t===e&&G(this,Pn).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){pt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return G(this,Pn).get(e)}getAll(){return[...G(this,Pn).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(r=>Dg(t,r))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(r=>Dg(e,r)):t}notify(e){pt.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){pt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){pt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Pn=new WeakMap,bv),Dn,ht,ws,Nn,Lr,wv,hk=(wv=class extends uS{constructor(e){super();he(this,Nn);he(this,Dn);he(this,ht);he(this,ws);this.mutationId=e.mutationId,oe(this,ht,e.mutationCache),oe(this,Dn,[]),this.state=e.state||mk(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){G(this,Dn).includes(e)||(G(this,Dn).push(e),this.clearGcTimeout(),G(this,ht).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){oe(this,Dn,G(this,Dn).filter(t=>t!==e)),this.scheduleGc(),G(this,ht).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){G(this,Dn).length||(this.state.status==="pending"?this.scheduleGc():G(this,ht).remove(this))}continue(){var e;return((e=G(this,ws))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var i,o,a,l,c,u,d,f,h,p,m,g,v,x,E,T,w,L,A,R;const t=()=>{at(this,Nn,Lr).call(this,{type:"continue"})};oe(this,ws,cS({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(C,I)=>{at(this,Nn,Lr).call(this,{type:"failed",failureCount:C,error:I})},onPause:()=>{at(this,Nn,Lr).call(this,{type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>G(this,ht).canRun(this)}));const r=this.state.status==="pending",s=!G(this,ws).canStart();try{if(r)t();else{at(this,Nn,Lr).call(this,{type:"pending",variables:e,isPaused:s}),await((o=(i=G(this,ht).config).onMutate)==null?void 0:o.call(i,e,this));const I=await((l=(a=this.options).onMutate)==null?void 0:l.call(a,e));I!==this.state.context&&at(this,Nn,Lr).call(this,{type:"pending",context:I,variables:e,isPaused:s})}const C=await G(this,ws).start();return await((u=(c=G(this,ht).config).onSuccess)==null?void 0:u.call(c,C,e,this.state.context,this)),await((f=(d=this.options).onSuccess)==null?void 0:f.call(d,C,e,this.state.context)),await((p=(h=G(this,ht).config).onSettled)==null?void 0:p.call(h,C,null,this.state.variables,this.state.context,this)),await((g=(m=this.options).onSettled)==null?void 0:g.call(m,C,null,e,this.state.context)),at(this,Nn,Lr).call(this,{type:"success",data:C}),C}catch(C){try{throw await((x=(v=G(this,ht).config).onError)==null?void 0:x.call(v,C,e,this.state.context,this)),await((T=(E=this.options).onError)==null?void 0:T.call(E,C,e,this.state.context)),await((L=(w=G(this,ht).config).onSettled)==null?void 0:L.call(w,void 0,C,this.state.variables,this.state.context,this)),await((R=(A=this.options).onSettled)==null?void 0:R.call(A,void 0,C,e,this.state.context)),C}finally{at(this,Nn,Lr).call(this,{type:"error",error:C})}}finally{G(this,ht).runNext(this)}}},Dn=new WeakMap,ht=new WeakMap,ws=new WeakMap,Nn=new WeakSet,Lr=function(e){const t=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),pt.batch(()=>{G(this,Dn).forEach(r=>{r.onMutationUpdate(e)}),G(this,ht).notify({mutation:this,type:"updated",action:e})})},wv);function mk(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ir,mn,ra,Av,pk=(Av=class extends Vc{constructor(e={}){super();he(this,ir);he(this,mn);he(this,ra);this.config=e,oe(this,ir,new Set),oe(this,mn,new Map),oe(this,ra,0)}build(e,t,r){const s=new hk({mutationCache:this,mutationId:++pa(this,ra)._,options:e.defaultMutationOptions(t),state:r});return this.add(s),s}add(e){G(this,ir).add(e);const t=Fa(e);if(typeof t=="string"){const r=G(this,mn).get(t);r?r.push(e):G(this,mn).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(G(this,ir).delete(e)){const t=Fa(e);if(typeof t=="string"){const r=G(this,mn).get(t);if(r)if(r.length>1){const s=r.indexOf(e);s!==-1&&r.splice(s,1)}else r[0]===e&&G(this,mn).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=Fa(e);if(typeof t=="string"){const r=G(this,mn).get(t),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===e}else return!0}runNext(e){var r;const t=Fa(e);if(typeof t=="string"){const s=(r=G(this,mn).get(t))==null?void 0:r.find(i=>i!==e&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){pt.batch(()=>{G(this,ir).forEach(e=>{this.notify({type:"removed",mutation:e})}),G(this,ir).clear(),G(this,mn).clear()})}getAll(){return Array.from(G(this,ir))}find(e){const t={exact:!0,...e};return this.getAll().find(r=>Ng(t,r))}findAll(e={}){return this.getAll().filter(t=>Ng(e,t))}notify(e){pt.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return pt.batch(()=>Promise.all(e.map(t=>t.continue().catch(fn))))}},ir=new WeakMap,mn=new WeakMap,ra=new WeakMap,Av);function Fa(n){var e;return(e=n.options.scope)==null?void 0:e.id}function Fg(n){return{onFetch:(e,t)=>{var u,d,f,h,p;const r=e.options,s=(f=(d=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:d.fetchMore)==null?void 0:f.direction,i=((h=e.state.data)==null?void 0:h.pages)||[],o=((p=e.state.data)==null?void 0:p.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let m=!1;const g=E=>{Object.defineProperty(E,"signal",{enumerable:!0,get:()=>(e.signal.aborted?m=!0:e.signal.addEventListener("abort",()=>{m=!0}),e.signal)})},v=iS(e.options,e.fetchOptions),x=async(E,T,w)=>{if(m)return Promise.reject();if(T==null&&E.pages.length)return Promise.resolve(E);const A=(()=>{const P={client:e.client,queryKey:e.queryKey,pageParam:T,direction:w?"backward":"forward",meta:e.options.meta};return g(P),P})(),R=await v(A),{maxPages:C}=e.options,I=w?nk:tk;return{pages:I(E.pages,R,C),pageParams:I(E.pageParams,T,C)}};if(s&&i.length){const E=s==="backward",T=E?gk:$g,w={pages:i,pageParams:o},L=T(r,w);a=await x(w,L,E)}else{const E=n??i.length;do{const T=l===0?o[0]??r.initialPageParam:$g(r,a);if(l>0&&T==null)break;a=await x(a,T),l++}while(l<E)}return a};e.options.persister?e.fetchFn=()=>{var m,g;return(g=(m=e.options).persister)==null?void 0:g.call(m,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=c}}}function $g(n,{pages:e,pageParams:t}){const r=e.length-1;return e.length>0?n.getNextPageParam(e[r],e,t[r],t):void 0}function gk(n,{pages:e,pageParams:t}){var r;return e.length>0?(r=n.getPreviousPageParam)==null?void 0:r.call(n,e[0],e,t[0],t):void 0}var Me,Mr,Fr,Ii,Ri,$r,Ci,ki,Lv,vk=(Lv=class{constructor(n={}){he(this,Me);he(this,Mr);he(this,Fr);he(this,Ii);he(this,Ri);he(this,$r);he(this,Ci);he(this,ki);oe(this,Me,n.queryCache||new fk),oe(this,Mr,n.mutationCache||new pk),oe(this,Fr,n.defaultOptions||{}),oe(this,Ii,new Map),oe(this,Ri,new Map),oe(this,$r,0)}mount(){pa(this,$r)._++,G(this,$r)===1&&(oe(this,Ci,oS.subscribe(async n=>{n&&(await this.resumePausedMutations(),G(this,Me).onFocus())})),oe(this,ki,rc.subscribe(async n=>{n&&(await this.resumePausedMutations(),G(this,Me).onOnline())})))}unmount(){var n,e;pa(this,$r)._--,G(this,$r)===0&&((n=G(this,Ci))==null||n.call(this),oe(this,Ci,void 0),(e=G(this,ki))==null||e.call(this),oe(this,ki,void 0))}isFetching(n){return G(this,Me).findAll({...n,fetchStatus:"fetching"}).length}isMutating(n){return G(this,Mr).findAll({...n,status:"pending"}).length}getQueryData(n){var t;const e=this.defaultQueryOptions({queryKey:n});return(t=G(this,Me).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(n){const e=this.defaultQueryOptions(n),t=G(this,Me).build(this,e),r=t.state.data;return r===void 0?this.fetchQuery(n):(n.revalidateIfStale&&t.isStaleByTime(Af(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(n){return G(this,Me).findAll(n).map(({queryKey:e,state:t})=>{const r=t.data;return[e,r]})}setQueryData(n,e,t){const r=this.defaultQueryOptions({queryKey:n}),s=G(this,Me).get(r.queryHash),i=s==null?void 0:s.state.data,o=qC(e,i);if(o!==void 0)return G(this,Me).build(this,r).setData(o,{...t,manual:!0})}setQueriesData(n,e,t){return pt.batch(()=>G(this,Me).findAll(n).map(({queryKey:r})=>[r,this.setQueryData(r,e,t)]))}getQueryState(n){var t;const e=this.defaultQueryOptions({queryKey:n});return(t=G(this,Me).get(e.queryHash))==null?void 0:t.state}removeQueries(n){const e=G(this,Me);pt.batch(()=>{e.findAll(n).forEach(t=>{e.remove(t)})})}resetQueries(n,e){const t=G(this,Me);return pt.batch(()=>(t.findAll(n).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...n},e)))}cancelQueries(n,e={}){const t={revert:!0,...e},r=pt.batch(()=>G(this,Me).findAll(n).map(s=>s.cancel(t)));return Promise.all(r).then(fn).catch(fn)}invalidateQueries(n,e={}){return pt.batch(()=>(G(this,Me).findAll(n).forEach(t=>{t.invalidate()}),(n==null?void 0:n.refetchType)==="none"?Promise.resolve():this.refetchQueries({...n,type:(n==null?void 0:n.refetchType)??(n==null?void 0:n.type)??"active"},e)))}refetchQueries(n,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},r=pt.batch(()=>G(this,Me).findAll(n).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,t);return t.throwOnError||(i=i.catch(fn)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(fn)}fetchQuery(n){const e=this.defaultQueryOptions(n);e.retry===void 0&&(e.retry=!1);const t=G(this,Me).build(this,e);return t.isStaleByTime(Af(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(n){return this.fetchQuery(n).then(fn).catch(fn)}fetchInfiniteQuery(n){return n.behavior=Fg(n.pages),this.fetchQuery(n)}prefetchInfiniteQuery(n){return this.fetchInfiniteQuery(n).then(fn).catch(fn)}ensureInfiniteQueryData(n){return n.behavior=Fg(n.pages),this.ensureQueryData(n)}resumePausedMutations(){return rc.isOnline()?G(this,Mr).resumePausedMutations():Promise.resolve()}getQueryCache(){return G(this,Me)}getMutationCache(){return G(this,Mr)}getDefaultOptions(){return G(this,Fr)}setDefaultOptions(n){oe(this,Fr,n)}setQueryDefaults(n,e){G(this,Ii).set(Yo(n),{queryKey:n,defaultOptions:e})}getQueryDefaults(n){const e=[...G(this,Ii).values()],t={};return e.forEach(r=>{qo(n,r.queryKey)&&Object.assign(t,r.defaultOptions)}),t}setMutationDefaults(n,e){G(this,Ri).set(Yo(n),{mutationKey:n,defaultOptions:e})}getMutationDefaults(n){const e=[...G(this,Ri).values()],t={};return e.forEach(r=>{qo(n,r.mutationKey)&&Object.assign(t,r.defaultOptions)}),t}defaultQueryOptions(n){if(n._defaulted)return n;const e={...G(this,Fr).queries,...this.getQueryDefaults(n.queryKey),...n,_defaulted:!0};return e.queryHash||(e.queryHash=lm(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===cm&&(e.enabled=!1),e}defaultMutationOptions(n){return n!=null&&n._defaulted?n:{...G(this,Fr).mutations,...(n==null?void 0:n.mutationKey)&&this.getMutationDefaults(n.mutationKey),...n,_defaulted:!0}}clear(){G(this,Me).clear(),G(this,Mr).clear()}},Me=new WeakMap,Mr=new WeakMap,Fr=new WeakMap,Ii=new WeakMap,Ri=new WeakMap,$r=new WeakMap,Ci=new WeakMap,ki=new WeakMap,Lv),yk=b.createContext(void 0),xk=({client:n,children:e})=>(b.useEffect(()=>(n.mount(),()=>{n.unmount()}),[n]),y.jsx(yk.Provider,{value:n,children:e}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sc(){return sc=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},sc.apply(this,arguments)}var jr;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(jr||(jr={}));const Bg="popstate";function Ek(n){n===void 0&&(n={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return If("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:fS(s)}return Tk(e,t,null,n)}function _t(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function dS(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Sk(){return Math.random().toString(36).substr(2,8)}function Ug(n,e){return{usr:n.state,key:n.key,idx:e}}function If(n,e,t,r){return t===void 0&&(t=null),sc({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Kc(e):e,{state:t,key:e&&e.key||r||Sk()})}function fS(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Kc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function Tk(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=jr.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(sc({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=jr.Pop;let g=u(),v=g==null?null:g-c;c=g,l&&l({action:a,location:m.location,delta:v})}function f(g,v){a=jr.Push;let x=If(m.location,g,v);c=u()+1;let E=Ug(x,c),T=m.createHref(x);try{o.pushState(E,"",T)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;s.location.assign(T)}i&&l&&l({action:a,location:m.location,delta:1})}function h(g,v){a=jr.Replace;let x=If(m.location,g,v);c=u();let E=Ug(x,c),T=m.createHref(x);o.replaceState(E,"",T),i&&l&&l({action:a,location:m.location,delta:0})}function p(g){let v=s.location.origin!=="null"?s.location.origin:s.location.href,x=typeof g=="string"?g:fS(g);return x=x.replace(/ $/,"%20"),_t(v,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,v)}let m={get action(){return a},get location(){return n(s,o)},listen(g){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Bg,d),l=g,()=>{s.removeEventListener(Bg,d),l=null}},createHref(g){return e(s,g)},createURL:p,encodeLocation(g){let v=p(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:h,go(g){return o.go(g)}};return m}var jg;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(jg||(jg={}));function bk(n,e,t){return t===void 0&&(t="/"),wk(n,e,t,!1)}function wk(n,e,t,r){let s=typeof e=="string"?Kc(e):e,i=pS(s.pathname||"/",t);if(i==null)return null;let o=hS(n);Ak(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=Mk(i);a=Nk(o[l],c,r)}return a}function hS(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(_t(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=vi([r,l.relativePath]),u=t.concat(l);i.children&&i.children.length>0&&(_t(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),hS(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:Pk(c,i.index),routesMeta:u})};return n.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of mS(i.path))s(i,o,l)}),e}function mS(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=mS(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function Ak(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Dk(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const Lk=/^:[\w-]+$/,Ik=3,Rk=2,Ck=1,kk=10,_k=-2,Gg=n=>n==="*";function Pk(n,e){let t=n.split("/"),r=t.length;return t.some(Gg)&&(r+=_k),e&&(r+=Rk),t.filter(s=>!Gg(s)).reduce((s,i)=>s+(Lk.test(i)?Ik:i===""?Ck:kk),r)}function Dk(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function Nk(n,e,t){let{routesMeta:r}=n,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",d=Vg({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),f=l.route;if(!d&&c&&t&&!r[r.length-1].route.index&&(d=Vg({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(s,d.params),o.push({params:s,pathname:vi([i,d.pathname]),pathnameBase:Fk(vi([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=vi([i,d.pathnameBase]))}return o}function Vg(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=Ok(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((c,u,d)=>{let{paramName:f,isOptional:h}=u;if(f==="*"){let m=a[d]||"";o=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[d];return h&&!p?c[f]=void 0:c[f]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:n}}function Ok(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),dS(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function Mk(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return dS(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function pS(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}const vi=n=>n.join("/").replace(/\/\/+/g,"/"),Fk=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/");function $k(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const gS=["post","put","patch","delete"];new Set(gS);const Bk=["get",...gS];new Set(Bk);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ic(){return ic=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ic.apply(this,arguments)}const Uk=b.createContext(null),jk=b.createContext(null),vS=b.createContext(null),zc=b.createContext(null),Wc=b.createContext({outlet:null,matches:[],isDataRoute:!1}),yS=b.createContext(null);function um(){return b.useContext(zc)!=null}function xS(){return um()||_t(!1),b.useContext(zc).location}function Gk(n,e){return Vk(n,e)}function Vk(n,e,t,r){um()||_t(!1);let{navigator:s}=b.useContext(vS),{matches:i}=b.useContext(Wc),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=xS(),u;if(e){var d;let g=typeof e=="string"?Kc(e):e;l==="/"||(d=g.pathname)!=null&&d.startsWith(l)||_t(!1),u=g}else u=c;let f=u.pathname||"/",h=f;if(l!=="/"){let g=l.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(g.length).join("/")}let p=bk(n,{pathname:h}),m=Yk(p&&p.map(g=>Object.assign({},g,{params:Object.assign({},a,g.params),pathname:vi([l,s.encodeLocation?s.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:vi([l,s.encodeLocation?s.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,t,r);return e&&m?b.createElement(zc.Provider,{value:{location:ic({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:jr.Pop}},m):m}function Hk(){let n=Zk(),e=$k(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),t?b.createElement("pre",{style:s},t):null,null)}const Kk=b.createElement(Hk,null);class zk extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?b.createElement(Wc.Provider,{value:this.props.routeContext},b.createElement(yS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Wk(n){let{routeContext:e,match:t,children:r}=n,s=b.useContext(Uk);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),b.createElement(Wc.Provider,{value:e},r)}function Yk(n,e,t,r){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var i;if(!t)return null;if(t.errors)n=t.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,a=(s=t)==null?void 0:s.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||_t(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(t&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:f,errors:h}=t,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,d,f)=>{let h,p=!1,m=null,g=null;t&&(h=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||Kk,l&&(c<0&&f===0?(p=!0,g=null):c===f&&(p=!0,g=d.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,f+1)),x=()=>{let E;return h?E=m:p?E=g:d.route.Component?E=b.createElement(d.route.Component,null):d.route.element?E=d.route.element:E=u,b.createElement(Wk,{match:d,routeContext:{outlet:u,matches:v,isDataRoute:t!=null},children:E})};return t&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?b.createElement(zk,{location:t.location,revalidation:t.revalidation,component:m,error:h,children:x(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):x()},null)}var Rf=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(Rf||{});function qk(n){let e=b.useContext(jk);return e||_t(!1),e}function Qk(n){let e=b.useContext(Wc);return e||_t(!1),e}function Xk(n){let e=Qk(),t=e.matches[e.matches.length-1];return t.route.id||_t(!1),t.route.id}function Zk(){var n;let e=b.useContext(yS),t=qk(Rf.UseRouteError),r=Xk(Rf.UseRouteError);return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function Jk(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Cf(n){_t(!1)}function e_(n){let{basename:e="/",children:t=null,location:r,navigationType:s=jr.Pop,navigator:i,static:o=!1,future:a}=n;um()&&_t(!1);let l=e.replace(/^\/*/,"/"),c=b.useMemo(()=>({basename:l,navigator:i,static:o,future:ic({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=Kc(r));let{pathname:u="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,m=b.useMemo(()=>{let g=pS(u,l);return g==null?null:{location:{pathname:g,search:d,hash:f,state:h,key:p},navigationType:s}},[l,u,d,f,h,p,s]);return m==null?null:b.createElement(vS.Provider,{value:c},b.createElement(zc.Provider,{children:t,value:m}))}function t_(n){let{children:e,location:t}=n;return Gk(kf(e),t)}new Promise(()=>{});function kf(n,e){e===void 0&&(e=[]);let t=[];return b.Children.forEach(n,(r,s)=>{if(!b.isValidElement(r))return;let i=[...e,s];if(r.type===b.Fragment){t.push.apply(t,kf(r.props.children,i));return}r.type!==Cf&&_t(!1),!r.props.index||!r.props.children||_t(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=kf(r.props.children,i)),t.push(o)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const n_="6";try{window.__reactRouterVersion=n_}catch{}const r_="startTransition",Hg=rh[r_];function s_(n){let{basename:e,children:t,future:r,window:s}=n,i=b.useRef();i.current==null&&(i.current=Ek({window:s,v5Compat:!0}));let o=i.current,[a,l]=b.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},u=b.useCallback(d=>{c&&Hg?Hg(()=>l(d)):l(d)},[l,c]);return b.useLayoutEffect(()=>o.listen(u),[o,u]),b.useEffect(()=>Jk(r),[r]),b.createElement(e_,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:o,future:r})}var Kg;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Kg||(Kg={}));var zg;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(zg||(zg={}));const i_=Fc("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Qi=b.forwardRef(({className:n,variant:e,size:t,asChild:r=!1,...s},i)=>{const o=r?jA:"button";return y.jsx(o,{className:be(i_({variant:e,size:t,className:n})),ref:i,...s})});Qi.displayName="Button";const q=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)},o_=Number.isSafeInteger||function(n){return typeof n=="number"&&Math.abs(n)<=a_},a_=Number.MAX_SAFE_INTEGER||9007199254740991;let J=function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n}({}),N=function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",n.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",n.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.ASSET_LIST_LOAD_ERROR="assetListLoadError",n.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",n.ASSET_LIST_PARSING_ERROR="assetListParsingError",n.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.ATTACH_MEDIA_ERROR="attachMediaError",n.UNKNOWN="unknown",n}({}),S=function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.MEDIA_ENDED="hlsMediaEnded",n.STALL_RESOLVED="hlsStallResolved",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFERED_TO_END="hlsBufferedToEnd",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",n.ASSET_LIST_LOADING="hlsAssetListLoading",n.ASSET_LIST_LOADED="hlsAssetListLoaded",n.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",n.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",n.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",n.INTERSTITIAL_STARTED="hlsInterstitialStarted",n.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",n.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",n.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",n.INTERSTITIAL_ENDED="hlsInterstitialEnded",n.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",n.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",n.EVENT_CUE_ENTER="hlsEventCueEnter",n}({});var ce={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Z={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Gs{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){const r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class l_{constructor(e,t,r,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Gs(e),this.fast_=new Gs(t),this.defaultTTFB_=s,this.ttfb_=new Gs(e)}update(e,t){const{slow_:r,fast_:s,ttfb_:i}=this;r.halfLife!==e&&(this.slow_=new Gs(e,r.getEstimate(),r.getTotalWeight())),s.halfLife!==t&&(this.fast_=new Gs(t,s.getEstimate(),s.getTotalWeight())),i.halfLife!==e&&(this.ttfb_=new Gs(e,i.getEstimate(),i.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const r=8*t,s=e/1e3,i=r/s;this.fast_.sample(s,i),this.slow_.sample(s,i)}sampleTTFB(e){const t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function c_(n,e,t){return(e=d_(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ee(){return Ee=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Ee.apply(null,arguments)}function Wg(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function ye(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Wg(Object(t),!0).forEach(function(r){c_(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Wg(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function u_(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function d_(n){var e=u_(n,"string");return typeof e=="symbol"?e:e+""}class tn{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const r=`[${e}]:`;this.trace=kr,this.debug=t.debug.bind(null,r),this.log=t.log.bind(null,r),this.warn=t.warn.bind(null,r),this.info=t.info.bind(null,r),this.error=t.error.bind(null,r)}}const kr=function(){},f_={trace:kr,debug:kr,log:kr,warn:kr,info:kr,error:kr};function _f(){return Ee({},f_)}function h_(n,e){const t=self.console[n];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${n}] >`):kr}function Yg(n,e,t){return e[n]?e[n].bind(e):h_(n,t)}const Pf=_f();function m_(n,e,t){const r=_f();if(typeof console=="object"&&n===!0||typeof n=="object"){const s=["debug","log","info","warn","error"];s.forEach(i=>{r[i]=Yg(i,n,t)});try{r.log(`Debug logs enabled for "${e}" in hls.js version 1.6.11`)}catch{return _f()}s.forEach(i=>{Pf[i]=Yg(i,n)})}else Ee(Pf,r);return r}const me=Pf;function ts(n=!0){return typeof self>"u"?void 0:(n||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function p_(n){return typeof self<"u"&&n===self.ManagedMediaSource}function ES(n,e){const t=Object.keys(n),r=Object.keys(e),s=t.length,i=r.length;return!s||!i||s===i&&!t.some(o=>r.indexOf(o)===-1)}function Ut(n,e=!1){if(typeof TextDecoder<"u"){const c=new TextDecoder("utf-8").decode(n);if(e){const u=c.indexOf("\0");return u!==-1?c.substring(0,u):c}return c.replace(/\0/g,"")}const t=n.length;let r,s,i,o="",a=0;for(;a<t;){if(r=n[a++],r===0&&e)return o;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:s=n[a++],o+=String.fromCharCode((r&31)<<6|s&63);break;case 14:s=n[a++],i=n[a++],o+=String.fromCharCode((r&15)<<12|(s&63)<<6|(i&63)<<0);break}}return o}function Nt(n){let e="";for(let t=0;t<n.length;t++){let r=n[t].toString(16);r.length<2&&(r="0"+r),e+=r}return e}function SS(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function g_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Hu={exports:{}},qg;function v_(){return qg||(qg=1,function(n,e){(function(t){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(l,c,u){if(u=u||{},l=l.trim(),c=c.trim(),!c){if(!u.alwaysNormalize)return l;var d=a.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");return d.path=a.normalizePath(d.path),a.buildURLFromParts(d)}var f=a.parseURL(c);if(!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return u.alwaysNormalize?(f.path=a.normalizePath(f.path),a.buildURLFromParts(f)):c;var h=a.parseURL(l);if(!h)throw new Error("Error trying to parse base URL.");if(!h.netLoc&&h.path&&h.path[0]!=="/"){var p=s.exec(h.path);h.netLoc=p[1],h.path=p[2]}h.netLoc&&!h.path&&(h.path="/");var m={scheme:h.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment};if(!f.netLoc&&(m.netLoc=h.netLoc,f.path[0]!=="/"))if(!f.path)m.path=h.path,f.params||(m.params=h.params,f.query||(m.query=h.query));else{var g=h.path,v=g.substring(0,g.lastIndexOf("/")+1)+f.path;m.path=a.normalizePath(v)}return m.path===null&&(m.path=u.alwaysNormalize?a.normalizePath(f.path):f.path),a.buildURLFromParts(m)},parseURL:function(l){var c=r.exec(l);return c?{scheme:c[1]||"",netLoc:c[2]||"",path:c[3]||"",params:c[4]||"",query:c[5]||"",fragment:c[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(i,"");l.length!==(l=l.replace(o,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};n.exports=a})()}(Hu)),Hu.exports}var dm=v_();class fm{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Se={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class TS{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,x_(this,"stats")}setByteRange(e,t){const r=e.split("@",2);let s;r.length===1?s=(t==null?void 0:t.byteRangeEndOffset)||0:s=parseInt(r[1]),this._byteRange=[s,parseInt(r[0])+s]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[Se.AUDIO]:null,[Se.VIDEO]:null,[Se.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new fm),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=dm.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Se.AUDIO]=null,e[Se.VIDEO]=null,e[Se.AUDIOVIDEO]=null}}function Ge(n){return n.sn!=="initSegment"}class Ku extends TS{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(q(e)&&q(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const r=Object.keys(this.levelkeys);if(r.length===1){const s=this._decryptdata=this.levelkeys[r[0]]||null;if(s)return s.getDecryptData(this.sn)}}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=q(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var t;const r=Object.keys(this.levelkeys),s=r.length;if(s>1||s===1&&(t=this.levelkeys[r[0]])!=null&&t.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!q(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return Ge(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,r,s,i,o=!1){const{elementaryStreams:a}=this,l=a[e];if(!l){a[e]={startPTS:t,endPTS:r,startDTS:s,endDTS:i,partial:o};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,r),l.startDTS=Math.min(l.startDTS,s),l.endDTS=Math.max(l.endDTS,i)}}class y_ extends TS{constructor(e,t,r,s,i){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=s;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,i),i&&(this.fragOffset=i.fragOffset+i.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function bS(n,e){const t=Object.getPrototypeOf(n);if(t){const r=Object.getOwnPropertyDescriptor(t,e);return r||bS(t,e)}}function x_(n,e){const t=bS(n,e);t&&(t.enumerable=!0,Object.defineProperty(n,e,t))}const Qg=Math.pow(2,32)-1,E_=[].push,wS={video:1,audio:2,id3:3,text:4};function He(n){return String.fromCharCode.apply(null,n)}function AS(n,e){const t=n[e]<<8|n[e+1];return t<0?65536+t:t}function re(n,e){const t=LS(n,e);return t<0?4294967296+t:t}function Xg(n,e){let t=re(n,e);return t*=Math.pow(2,32),t+=re(n,e+4),t}function LS(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}function S_(n){const e=n.byteLength;for(let t=0;t<e;){const r=re(n,t);if(r>8&&n[t+4]===109&&n[t+5]===111&&n[t+6]===111&&n[t+7]===102)return!0;t=r>1?t+r:e}return!1}function le(n,e){const t=[];if(!e.length)return t;const r=n.byteLength;for(let s=0;s<r;){const i=re(n,s),o=He(n.subarray(s+4,s+8)),a=i>1?s+i:r;if(o===e[0])if(e.length===1)t.push(n.subarray(s+8,a));else{const l=le(n.subarray(s+8,a),e.slice(1));l.length&&E_.apply(t,l)}s=a}return t}function T_(n){const e=[],t=n[0];let r=8;const s=re(n,r);r+=4;let i=0,o=0;t===0?(i=re(n,r),o=re(n,r+4),r+=8):(i=Xg(n,r),o=Xg(n,r+8),r+=16),r+=2;let a=n.length+o;const l=AS(n,r);r+=2;for(let c=0;c<l;c++){let u=r;const d=re(n,u);u+=4;const f=d&2147483647;if((d&2147483648)>>>31===1)return me.warn("SIDX has hierarchical references (not supported)"),null;const p=re(n,u);u+=4,e.push({referenceSize:f,subsegmentDuration:p,info:{duration:p/s,start:a,end:a+f-1}}),a+=f,u+=4,r=u}return{earliestPresentationTime:i,timescale:s,version:t,referencesCount:l,references:e}}function IS(n){const e=[],t=le(n,["moov","trak"]);for(let s=0;s<t.length;s++){const i=t[s],o=le(i,["tkhd"])[0];if(o){let a=o[0];const l=re(o,a===0?12:20),c=le(i,["mdia","mdhd"])[0];if(c){a=c[0];const u=re(c,a===0?12:20),d=le(i,["mdia","hdlr"])[0];if(d){const f=He(d.subarray(8,12)),h={soun:Se.AUDIO,vide:Se.VIDEO}[f],p=le(i,["mdia","minf","stbl","stsd"])[0],m=b_(p);h?(e[l]={timescale:u,type:h,stsd:m},e[h]=ye({timescale:u,id:l},m)):e[l]={timescale:u,type:f,stsd:m}}}}}return le(n,["moov","mvex","trex"]).forEach(s=>{const i=re(s,4),o=e[i];o&&(o.default={duration:re(s,12),flags:re(s,20)})}),e}function b_(n){const e=n.subarray(8),t=e.subarray(86),r=He(e.subarray(4,8));let s=r,i;const o=r==="enca"||r==="encv";if(o){const c=le(e,[r])[0].subarray(r==="enca"?28:78);le(c,["sinf"]).forEach(d=>{const f=le(d,["schm"])[0];if(f){const h=He(f.subarray(4,8));if(h==="cbcs"||h==="cenc"){const p=le(d,["frma"])[0];p&&(s=He(p))}}})}const a=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const l=le(t,["avcC"])[0];l&&l.length>3&&(s+="."+Ba(l[1])+Ba(l[2])+Ba(l[3]),i=$a(a==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const l=le(e,[r])[0],c=le(l.subarray(28),["esds"])[0];if(c&&c.length>7){let u=4;if(c[u++]!==3)break;u=zu(c,u),u+=2;const d=c[u++];if(d&128&&(u+=2),d&64&&(u+=c[u++]),c[u++]!==4)break;u=zu(c,u);const f=c[u++];if(f===64)s+="."+Ba(f);else break;if(u+=12,c[u++]!==5)break;u=zu(c,u);const h=c[u++];let p=(h&248)>>3;p===31&&(p+=1+((h&7)<<3)+((c[u]&224)>>5)),s+="."+p}break}case"hvc1":case"hev1":{const l=le(t,["hvcC"])[0];if(l&&l.length>12){const c=l[1],u=["","A","B","C"][c>>6],d=c&31,f=re(l,2),h=(c&32)>>5?"H":"L",p=l[12],m=l.subarray(6,12);s+="."+u+d,s+="."+w_(f).toString(16).toUpperCase(),s+="."+h+p;let g="";for(let v=m.length;v--;){const x=m[v];(x||g)&&(g="."+x.toString(16).toUpperCase()+g)}s+=g}i=$a(a=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{s=$a(s,t)||s;break}case"vp09":{const l=le(t,["vpcC"])[0];if(l&&l.length>6){const c=l[4],u=l[5],d=l[6]>>4&15;s+="."+_n(c)+"."+_n(u)+"."+_n(d)}break}case"av01":{const l=le(t,["av1C"])[0];if(l&&l.length>2){const c=l[1]>>>5,u=l[1]&31,d=l[2]>>>7?"H":"M",f=(l[2]&64)>>6,h=(l[2]&32)>>5,p=c===2&&f?h?12:10:f?10:8,m=(l[2]&16)>>4,g=(l[2]&8)>>3,v=(l[2]&4)>>2,x=l[2]&3;s+="."+c+"."+_n(u)+d+"."+_n(p)+"."+m+"."+g+v+x+"."+_n(1)+"."+_n(1)+"."+_n(1)+"."+0,i=$a("dav1",t)}break}}return{codec:s,encrypted:o,supplemental:i}}function $a(n,e){const t=le(e,["dvvC"]),r=t.length?t[0]:le(e,["dvcC"])[0];if(r){const s=r[2]>>1&127,i=r[2]<<5&32|r[3]>>3&31;return n+"."+_n(s)+"."+_n(i)}}function w_(n){let e=0;for(let t=0;t<32;t++)e|=(n>>t&1)<<31-t;return e>>>0}function zu(n,e){const t=e+5;for(;n[e++]&128&&e<t;);return e}function Ba(n){return("0"+n.toString(16).toUpperCase()).slice(-2)}function _n(n){return(n<10?"0":"")+n}function A_(n,e){if(!n||!e)return;const t=e.keyId;t&&e.isCommonEncryption&&le(n,["moov","trak"]).forEach(s=>{const o=le(s,["mdia","minf","stbl","stsd"])[0].subarray(8);let a=le(o,["enca"]);const l=a.length>0;l||(a=le(o,["encv"])),a.forEach(c=>{const u=l?c.subarray(28):c.subarray(78);le(u,["sinf"]).forEach(f=>{const h=RS(f);if(h){const p=h.subarray(8,24);p.some(m=>m!==0)||(me.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${Nt(p)} -> ${Nt(t)}`),h.set(t,8))}})})})}function RS(n){const e=le(n,["schm"])[0];if(e){const t=He(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return le(n,["schi","tenc"])[0]}return null}function L_(n,e,t){const r={},s=le(n,["moof","traf"]);for(let i=0;i<s.length;i++){const o=s[i],a=le(o,["tfhd"])[0],l=re(a,4),c=e[l];if(!c)continue;r[l]||(r[l]={start:NaN,duration:0,sampleCount:0,timescale:c.timescale,type:c.type});const u=r[l],d=le(o,["tfdt"])[0];if(d){const E=d[0];let T=re(d,4);E===1&&(T===Qg?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(T*=Qg+1,T+=re(d,8))),q(T)&&(!q(u.start)||T<u.start)&&(u.start=T)}const f=c.default,h=re(a,0)|(f==null?void 0:f.flags);let p=(f==null?void 0:f.duration)||0;h&8&&(h&2?p=re(a,12):p=re(a,8));const m=le(o,["trun"]);let g=u.start||0,v=0,x=p;for(let E=0;E<m.length;E++){const T=m[E],w=re(T,4),L=u.sampleCount;u.sampleCount+=w;const A=T[3]&1,R=T[3]&4,C=T[2]&1,I=T[2]&2,P=T[2]&4,O=T[2]&8;let V=8,B=w;for(A&&(V+=4),R&&w&&(!(T[V+1]&1)&&u.keyFrameIndex===void 0&&(u.keyFrameIndex=L),V+=4,C?(x=re(T,V),V+=4):x=p,I&&(V+=4),O&&(V+=4),g+=x,v+=x,B--);B--;)C?(x=re(T,V),V+=4):x=p,I&&(V+=4),P&&(T[V+1]&1||u.keyFrameIndex===void 0&&(u.keyFrameIndex=u.sampleCount-(B+1),u.keyFrameStart=g),V+=4),O&&(V+=4),g+=x,v+=x;!v&&p&&(v+=p*w)}u.duration+=v}if(!Object.keys(r).some(i=>r[i].duration)){let i=1/0,o=0;const a=le(n,["sidx"]);for(let l=0;l<a.length;l++){const c=T_(a[l]);if(c!=null&&c.references){i=Math.min(i,c.earliestPresentationTime/c.timescale);const u=c.references.reduce((d,f)=>d+f.info.duration||0,0);o=Math.max(o,u+c.earliestPresentationTime/c.timescale)}}o&&q(o)&&Object.keys(r).forEach(l=>{r[l].duration||(r[l].duration=o*r[l].timescale-r[l].start)})}return r}function I_(n){const e={valid:null,remainder:null},t=le(n,["moof"]);if(t.length<2)return e.remainder=n,e;const r=t[t.length-1];return e.valid=n.slice(0,r.byteOffset-8),e.remainder=n.slice(r.byteOffset-8),e}function en(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function Zg(n,e){const t=[],r=e.samples,s=e.timescale,i=e.id;let o=!1;return le(r,["moof"]).map(l=>{const c=l.byteOffset-8;le(l,["traf"]).map(d=>{const f=le(d,["tfdt"]).map(h=>{const p=h[0];let m=re(h,4);return p===1&&(m*=Math.pow(2,32),m+=re(h,8)),m/s})[0];return f!==void 0&&(n=f),le(d,["tfhd"]).map(h=>{const p=re(h,4),m=re(h,0)&16777215,g=(m&1)!==0,v=(m&2)!==0,x=(m&8)!==0;let E=0;const T=(m&16)!==0;let w=0;const L=(m&32)!==0;let A=8;p===i&&(g&&(A+=8),v&&(A+=4),x&&(E=re(h,A),A+=4),T&&(w=re(h,A),A+=4),L&&(A+=4),e.type==="video"&&(o=Yc(e.codec)),le(d,["trun"]).map(R=>{const C=R[0],I=re(R,0)&16777215,P=(I&1)!==0;let O=0;const V=(I&4)!==0,B=(I&256)!==0;let K=0;const U=(I&512)!==0;let H=0;const _=(I&1024)!==0,k=(I&2048)!==0;let M=0;const F=re(R,4);let $=8;P&&(O=re(R,$),$+=4),V&&($+=4);let Y=O+c;for(let Q=0;Q<F;Q++){if(B?(K=re(R,$),$+=4):K=E,U?(H=re(R,$),$+=4):H=w,_&&($+=4),k&&(C===0?M=re(R,$):M=LS(R,$),$+=4),e.type===Se.VIDEO){let ee=0;for(;ee<H;){const te=re(r,Y);if(Y+=4,R_(o,r[Y])){const ne=r.subarray(Y,Y+te);hm(ne,o?2:1,n+M/s,t)}Y+=te,ee+=te+4}}n+=K/s}}))})})}),t}function Yc(n){if(!n)return!1;const e=n.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function R_(n,e){if(n){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function hm(n,e,t,r){const s=CS(n);let i=0;i+=e;let o=0,a=0,l=0;for(;i<s.length;){o=0;do{if(i>=s.length)break;l=s[i++],o+=l}while(l===255);a=0;do{if(i>=s.length)break;l=s[i++],a+=l}while(l===255);const c=s.length-i;let u=i;if(a<c)i+=a;else if(a>c){me.error(`Malformed SEI payload. ${a} is too small, only ${c} bytes left to parse.`);break}if(o===4){if(s[u++]===181){const f=AS(s,u);if(u+=2,f===49){const h=re(s,u);if(u+=4,h===1195456820){const p=s[u++];if(p===3){const m=s[u++],g=31&m,v=64&m,x=v?2+g*3:0,E=new Uint8Array(x);if(v){E[0]=m;for(let T=1;T<x;T++)E[T]=s[u++]}r.push({type:p,payloadType:o,pts:t,bytes:E})}}}}}else if(o===5&&a>16){const d=[];for(let p=0;p<16;p++){const m=s[u++].toString(16);d.push(m.length==1?"0"+m:m),(p===3||p===5||p===7||p===9)&&d.push("-")}const f=a-16,h=new Uint8Array(f);for(let p=0;p<f;p++)h[p]=s[u++];r.push({payloadType:o,pts:t,uuid:d.join(""),userData:Ut(h),userDataBytes:h})}}}function CS(n){const e=n.byteLength,t=[];let r=1;for(;r<e-2;)n[r]===0&&n[r+1]===0&&n[r+2]===3?(t.push(r+2),r+=2):r++;if(t.length===0)return n;const s=e-t.length,i=new Uint8Array(s);let o=0;for(r=0;r<s;o++,r++)o===t[0]&&(o++,t.shift()),i[r]=n[o];return i}function C_(n){const e=n[0];let t="",r="",s=0,i=0,o=0,a=0,l=0,c=0;if(e===0){for(;He(n.subarray(c,c+1))!=="\0";)t+=He(n.subarray(c,c+1)),c+=1;for(t+=He(n.subarray(c,c+1)),c+=1;He(n.subarray(c,c+1))!=="\0";)r+=He(n.subarray(c,c+1)),c+=1;r+=He(n.subarray(c,c+1)),c+=1,s=re(n,12),i=re(n,16),a=re(n,20),l=re(n,24),c=28}else if(e===1){c+=4,s=re(n,c),c+=4;const d=re(n,c);c+=4;const f=re(n,c);for(c+=4,o=2**32*d+f,o_(o)||(o=Number.MAX_SAFE_INTEGER,me.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),a=re(n,c),c+=4,l=re(n,c),c+=4;He(n.subarray(c,c+1))!=="\0";)t+=He(n.subarray(c,c+1)),c+=1;for(t+=He(n.subarray(c,c+1)),c+=1;He(n.subarray(c,c+1))!=="\0";)r+=He(n.subarray(c,c+1)),c+=1;r+=He(n.subarray(c,c+1)),c+=1}const u=n.subarray(c,n.byteLength);return{schemeIdUri:t,value:r,timeScale:s,presentationTime:o,presentationTimeDelta:i,eventDuration:a,id:l,payload:u}}function k_(n,...e){const t=e.length;let r=8,s=t;for(;s--;)r+=e[s].byteLength;const i=new Uint8Array(r);for(i[0]=r>>24&255,i[1]=r>>16&255,i[2]=r>>8&255,i[3]=r&255,i.set(n,4),s=0,r=8;s<t;s++)i.set(e[s],r),r+=e[s].byteLength;return i}function __(n,e,t){if(n.byteLength!==16)throw new RangeError("Invalid system id");let r,s;r=0,s=new Uint8Array;let i;r>0?(i=new Uint8Array(4),e.length>0&&new DataView(i.buffer).setUint32(0,e.length,!1)):i=new Uint8Array;const o=new Uint8Array(4);return t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),k_([112,115,115,104],new Uint8Array([r,0,0,0]),n,i,s,o,t)}const kS=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Ui={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function mm(n,e){const t=Ui[e];return!!t&&!!t[n.slice(0,4)]}function Df(n,e,t=!0){return!n.split(",").some(r=>!pm(r,e,t))}function pm(n,e,t=!0){var r;const s=ts(t);return(r=s==null?void 0:s.isTypeSupported(Qo(n,e)))!=null?r:!1}function Qo(n,e){return`${e}/mp4;codecs=${n}`}function Jg(n){if(n){const e=n.substring(0,4);return Ui.video[e]}return 2}function oc(n){const e=kS();return n.split(",").reduce((t,r)=>{const i=e&&Yc(r)?9:Ui.video[r];return i?(i*2+t)/(t?3:2):(Ui.audio[r]+t)/(t?2:1)},0)}const Wu={};function P_(n,e=!0){if(Wu[n])return Wu[n];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[n];for(let s=0;s<t.length;s++){var r;if(pm(t[s],"audio",e))return Wu[n]=t[s],t[s];if(t[s]==="mp3"&&(r=ts(e))!=null&&r.isTypeSupported("audio/mpeg"))return""}return n}const D_=/flac|opus|mp4a\.40\.34/i;function ac(n,e=!0){return n.replace(D_,t=>P_(t.toLowerCase(),e))}function N_(n,e){const t=[];if(n){const r=n.split(",");for(let s=0;s<r.length;s++)mm(r[s],"video")||t.push(r[s])}return e&&t.push(e),t.join(",")}function yl(n,e){if(n&&(n.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(n)!==-1)&&(e0(n,"audio")||e0(n,"video")))return n;if(e){const t=e.split(",");if(t.length>1){if(n){for(let r=t.length;r--;)if(t[r].substring(0,4)===n.substring(0,4))return t[r]}return t[0]}}return e||n}function e0(n,e){return mm(n,e)&&pm(n,e)}function O_(n){const e=n.split(",");for(let t=0;t<e.length;t++){const r=e[t].split(".");r.length>2&&r[0]==="avc1"&&(e[t]=`avc1.${parseInt(r[1]).toString(16)}${("000"+parseInt(r[2]).toString(16)).slice(-4)}`)}return e.join(",")}function M_(n){if(n.startsWith("av01.")){const e=n.split("."),t=["0","111","01","01","01","0"];for(let r=e.length;r>4&&r<10;r++)e[r]=t[r-4];return e.join(".")}return n}function t0(n){const e=ts(n)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Nf(n){return n.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const F_={supported:!0,powerEfficient:!0,smooth:!0},$_={supported:!1,smooth:!1,powerEfficient:!1},_S={supported:!0,configurations:[],decodingInfoResults:[F_]};function PS(n,e){return{supported:!1,configurations:e,decodingInfoResults:[$_],error:n}}function B_(n,e,t,r,s,i){const o=n.videoCodec,a=n.audioCodec?n.audioGroups:null,l=i==null?void 0:i.audioCodec,c=i==null?void 0:i.channels,u=c?parseInt(c):l?1/0:2;let d=null;if(a!=null&&a.length)try{a.length===1&&a[0]?d=e.groups[a[0]].channels:d=a.reduce((f,h)=>{if(h){const p=e.groups[h];if(!p)throw new Error(`Audio track group ${h} not found`);Object.keys(p.channels).forEach(m=>{f[m]=(f[m]||0)+p.channels[m]})}return f},{2:0})}catch{return!0}return o!==void 0&&(o.split(",").some(f=>Yc(f))||n.width>1920&&n.height>1088||n.height>1920&&n.width>1088||n.frameRate>Math.max(r,30)||n.videoRange!=="SDR"&&n.videoRange!==t||n.bitrate>Math.max(s,8e6))||!!d&&q(u)&&Object.keys(d).some(f=>parseInt(f)>u)}function DS(n,e,t,r={}){const s=n.videoCodec;if(!s&&!n.audioCodec||!t)return Promise.resolve(_S);const i=[],o=U_(n),a=o.length,l=j_(n,e,a>0),c=l.length;for(let u=a||1*c||1;u--;){const d={type:"media-source"};if(a&&(d.video=o[u%a]),c){d.audio=l[u%c];const f=d.audio.bitrate;d.video&&f&&(d.video.bitrate-=f)}i.push(d)}if(s){const u=navigator.userAgent;if(s.split(",").some(d=>Yc(d))&&kS())return Promise.resolve(PS(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${u})`),i))}return Promise.all(i.map(u=>{const d=V_(u);return r[d]||(r[d]=t.decodingInfo(u))})).then(u=>({supported:!u.some(d=>!d.supported),configurations:i,decodingInfoResults:u})).catch(u=>({supported:!1,configurations:i,decodingInfoResults:[],error:u}))}function U_(n){var e;const t=(e=n.videoCodec)==null?void 0:e.split(","),r=NS(n),s=n.width||640,i=n.height||480,o=n.frameRate||30,a=n.videoRange.toLowerCase();return t?t.map(l=>{const c={contentType:Qo(M_(l),"video"),width:s,height:i,bitrate:r,framerate:o};return a!=="sdr"&&(c.transferFunction=a),c}):[]}function j_(n,e,t){var r;const s=(r=n.audioCodec)==null?void 0:r.split(","),i=NS(n);return s&&n.audioGroups?n.audioGroups.reduce((o,a)=>{var l;const c=a?(l=e.groups[a])==null?void 0:l.tracks:null;return c?c.reduce((u,d)=>{if(d.groupId===a){const f=parseFloat(d.channels||"");s.forEach(h=>{const p={contentType:Qo(h,"audio"),bitrate:t?G_(h,i):i};f&&(p.channels=""+f),u.push(p)})}return u},o):o},[]):[]}function G_(n,e){if(e<=1)return 1;let t=128e3;return n==="ec-3"?t=768e3:n==="ac-3"&&(t=64e4),Math.min(e/2,t)}function NS(n){return Math.ceil(Math.max(n.bitrate*.9,n.averageBitrate)/1e3)*1e3||1}function V_(n){let e="";const{audio:t,video:r}=n;if(r){const s=Nf(r.contentType);e+=`${s}_r${r.height}x${r.width}f${Math.ceil(r.framerate)}${r.transferFunction||"sd"}_${Math.ceil(r.bitrate/1e5)}`}if(t){const s=Nf(t.contentType);e+=`${r?"_":""}${s}_c${t.channels}`}return e}const Of=["NONE","TYPE-0","TYPE-1",null];function H_(n){return Of.indexOf(n)>-1}const lc=["SDR","PQ","HLG"];function K_(n){return!!n&&lc.indexOf(n)>-1}var xl={No:"",Yes:"YES",v2:"v2"};function n0(n){const{canSkipUntil:e,canSkipDateRanges:t,age:r}=n,s=r<e/2;return e&&s?t?xl.v2:xl.Yes:xl.No}class r0{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Xo{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(r=>!!r).map(r=>r.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const r=(t=e.supplemental)==null?void 0:t.videoCodec;r&&r!==e.videoCodec&&(this.codecSet+=`,${r.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return s0(this._audioGroups,e)}hasSubtitleGroup(e){return s0(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let r=this._audioGroups;r||(r=this._audioGroups=[]),r.indexOf(t)===-1&&r.push(t)}else if(e==="text"){let r=this._subtitleGroups;r||(r=this._subtitleGroups=[]),r.indexOf(t)===-1&&r.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function s0(n,e){return!e||!n?!1:n.indexOf(e)!==-1}function z_(){if(typeof matchMedia=="function"){const n=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(n.media!==e.media)return n.matches===!0}return!1}function W_(n,e){let t=!1,r=[];if(n&&(t=n!=="SDR",r=[n]),e){r=e.allowedVideoRanges||lc.slice(0);const s=r.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:s&&z_(),t||(r=["SDR"])}return{preferHDR:t,allowedVideoRanges:r}}const Y_=n=>{const e=new WeakSet;return(t,r)=>{if(n&&(r=n(t,r)),typeof r=="object"&&r!==null){if(e.has(r))return;e.add(r)}return r}},Ie=(n,e)=>JSON.stringify(n,Y_(e));function q_(n,e,t,r,s){const i=Object.keys(n),o=r==null?void 0:r.channels,a=r==null?void 0:r.audioCodec,l=s==null?void 0:s.videoCodec,c=o&&parseInt(o)===2;let u=!1,d=!1,f=1/0,h=1/0,p=1/0,m=1/0,g=0,v=[];const{preferHDR:x,allowedVideoRanges:E}=W_(e,s);for(let R=i.length;R--;){const C=n[i[R]];u||(u=C.channels[2]>0),f=Math.min(f,C.minHeight),h=Math.min(h,C.minFramerate),p=Math.min(p,C.minBitrate),E.filter(P=>C.videoRanges[P]>0).length>0&&(d=!0)}f=q(f)?f:0,h=q(h)?h:0;const T=Math.max(1080,f),w=Math.max(30,h);p=q(p)?p:t,t=Math.max(p,t),d||(e=void 0);const L=i.length>1;return{codecSet:i.reduce((R,C)=>{const I=n[C];if(C===R)return R;if(v=d?E.filter(P=>I.videoRanges[P]>0):[],L){if(I.minBitrate>t)return Rn(C,`min bitrate of ${I.minBitrate} > current estimate of ${t}`),R;if(!I.hasDefaultAudio)return Rn(C,"no renditions with default or auto-select sound found"),R;if(a&&C.indexOf(a.substring(0,4))%5!==0)return Rn(C,`audio codec preference "${a}" not found`),R;if(o&&!c){if(!I.channels[o])return Rn(C,`no renditions with ${o} channel sound found (channels options: ${Object.keys(I.channels)})`),R}else if((!a||c)&&u&&I.channels[2]===0)return Rn(C,"no renditions with stereo sound found"),R;if(I.minHeight>T)return Rn(C,`min resolution of ${I.minHeight} > maximum of ${T}`),R;if(I.minFramerate>w)return Rn(C,`min framerate of ${I.minFramerate} > maximum of ${w}`),R;if(!v.some(P=>I.videoRanges[P]>0))return Rn(C,`no variants with VIDEO-RANGE of ${Ie(v)} found`),R;if(l&&C.indexOf(l.substring(0,4))%5!==0)return Rn(C,`video codec preference "${l}" not found`),R;if(I.maxScore<g)return Rn(C,`max score of ${I.maxScore} < selected max of ${g}`),R}return R&&(oc(C)>=oc(R)||I.fragmentError>n[R].fragmentError)?R:(m=I.minIndex,g=I.maxScore,C)},void 0),videoRanges:v,preferHDR:x,minFramerate:h,minBitrate:p,minIndex:m}}function Rn(n,e){me.log(`[abr] start candidates with "${n}" ignored because ${e}`)}function OS(n){return n.reduce((e,t)=>{let r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);const s=t.channels||"2";return r.channels[s]=(r.channels[s]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function Q_(n,e,t,r){return n.slice(t,r+1).reduce((s,i,o)=>{if(!i.codecSet)return s;const a=i.audioGroups;let l=s[i.codecSet];l||(s[i.codecSet]=l={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:o,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!a,fragmentError:0}),l.minBitrate=Math.min(l.minBitrate,i.bitrate);const c=Math.min(i.height,i.width);return l.minHeight=Math.min(l.minHeight,c),l.minFramerate=Math.min(l.minFramerate,i.frameRate),l.minIndex=Math.min(l.minIndex,o),l.maxScore=Math.max(l.maxScore,i.score),l.fragmentError+=i.fragmentError,l.videoRanges[i.videoRange]=(l.videoRanges[i.videoRange]||0)+1,a&&a.forEach(u=>{if(!u)return;const d=e.groups[u];d&&(l.hasDefaultAudio=l.hasDefaultAudio||e.hasDefaultAudio?d.hasDefault:d.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(d.channels).forEach(f=>{l.channels[f]=(l.channels[f]||0)+d.channels[f]}))}),s},{})}function i0(n){if(!n)return n;const{lang:e,assocLang:t,characteristics:r,channels:s,audioCodec:i}=n;return{lang:e,assocLang:t,characteristics:r,channels:s,audioCodec:i}}function Bn(n,e,t){if("attrs"in n){const r=e.indexOf(n);if(r!==-1)return r}for(let r=0;r<e.length;r++){const s=e[r];if(Is(n,s,t))return r}return-1}function Is(n,e,t){const{groupId:r,name:s,lang:i,assocLang:o,default:a}=n,l=n.forced;return(r===void 0||e.groupId===r)&&(s===void 0||e.name===s)&&(i===void 0||X_(i,e.lang))&&(i===void 0||e.assocLang===o)&&(a===void 0||e.default===a)&&(l===void 0||e.forced===l)&&(!("characteristics"in n)||Z_(n.characteristics||"",e.characteristics))&&(t===void 0||t(n,e))}function X_(n,e="--"){return n.length===e.length?n===e:n.startsWith(e)||e.startsWith(n)}function Z_(n,e=""){const t=n.split(","),r=e.split(",");return t.length===r.length&&!t.some(s=>r.indexOf(s)===-1)}function ps(n,e){const{audioCodec:t,channels:r}=n;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(r===void 0||r===(e.channels||"2"))}function J_(n,e,t,r,s){const i=e[r],a=e.reduce((f,h,p)=>{const m=h.uri;return(f[m]||(f[m]=[])).push(p),f},{})[i.uri];a.length>1&&(r=Math.max.apply(Math,a));const l=i.videoRange,c=i.frameRate,u=i.codecSet.substring(0,4),d=o0(e,r,f=>{if(f.videoRange!==l||f.frameRate!==c||f.codecSet.substring(0,4)!==u)return!1;const h=f.audioGroups,p=t.filter(m=>!h||h.indexOf(m.groupId)!==-1);return Bn(n,p,s)>-1});return d>-1?d:o0(e,r,f=>{const h=f.audioGroups,p=t.filter(m=>!h||h.indexOf(m.groupId)!==-1);return Bn(n,p,s)>-1})}function o0(n,e,t){for(let r=e;r>-1;r--)if(t(n[r]))return r;for(let r=e+1;r<n.length;r++)if(t(n[r]))return r;return-1}function cc(n,e){var t;return!!n&&n!==((t=e.loadLevelObj)==null?void 0:t.uri)}class eP extends tn{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var r;const{fragCurrent:s,partCurrent:i,hls:o}=this,{autoLevelEnabled:a,media:l}=o;if(!s||!l)return;const c=performance.now(),u=i?i.stats:s.stats,d=i?i.duration:s.duration,f=c-u.loading.start,h=o.minAutoLevel,p=s.level,m=this._nextAutoLevel;if(u.aborted||u.loaded&&u.loaded===u.total||p<=h){this.clearTimer(),this._nextAutoLevel=-1;return}if(!a)return;const g=m>-1&&m!==p,v=!!t||g;if(!v&&(l.paused||!l.playbackRate||!l.readyState))return;const x=o.mainForwardBufferInfo;if(!v&&x===null)return;const E=this.bwEstimator.getEstimateTTFB(),T=Math.abs(l.playbackRate);if(f<=Math.max(E,1e3*(d/(T*2))))return;const w=x?x.len/T:0,L=u.loading.first?u.loading.first-u.loading.start:-1,A=u.loaded&&L>-1,R=this.getBwEstimate(),C=o.levels,I=C[p],P=Math.max(u.loaded,Math.round(d*(s.bitrate||I.averageBitrate)/8));let O=A?f-L:f;O<1&&A&&(O=Math.min(f,u.loaded*8/R));const V=A?u.loaded*1e3/O:0,B=E/1e3,K=V?(P-u.loaded)/V:P*8/R+B;if(K<=w)return;const U=V?V*8:R,H=((r=(t==null?void 0:t.details)||this.hls.latestLevelDetails)==null?void 0:r.live)===!0,_=this.hls.config.abrBandWidthUpFactor;let k=Number.POSITIVE_INFINITY,M;for(M=p-1;M>h;M--){const Q=C[M].maxBitrate,ee=!C[M].details||H;if(k=this.getTimeToLoadFrag(B,U,d*Q,ee),k<Math.min(w,d+B))break}if(k>=K||k>d*10)return;A?this.bwEstimator.sample(f-Math.min(E,L),u.loaded):this.bwEstimator.sampleTTFB(f);const F=C[M].maxBitrate;this.getBwEstimate()*_>F&&this.resetEstimator(F);const $=this.findBestLevel(F,h,M,0,w,1,1);$>-1&&(M=$),this.warn(`Fragment ${s.sn}${i?" part "+i.index:""} of level ${p} is loading too slowly;
      Fragment duration: ${s.duration.toFixed(3)}
      Time to underbuffer: ${w.toFixed(3)} s
      Estimated load time for current fragment: ${K.toFixed(3)} s
      Estimated load time for down switch fragment: ${k.toFixed(3)} s
      TTFB estimate: ${L|0} ms
      Current BW estimate: ${q(R)?R|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${M} @ ${F|0} bps`),o.nextLoadLevel=o.nextAutoLevel=M,this.clearTimer();const Y=()=>{if(this.clearTimer(),this.fragCurrent===s&&this.hls.loadLevel===M&&M>0){const Q=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${M>0?"and switching down":""}
      Fragment duration: ${s.duration.toFixed(3)} s
      Time to underbuffer: ${Q.toFixed(3)} s`),s.abortRequests(),this.fragCurrent=this.partCurrent=null,M>h){let ee=this.findBestLevel(this.hls.levels[h].bitrate,h,M,0,Q,1,1);ee===-1&&(ee=h),this.hls.nextLoadLevel=this.hls.nextAutoLevel=ee,this.resetEstimator(this.hls.levels[ee].bitrate)}}};g||K>k*2?Y():this.timer=self.setInterval(Y,k*1e3),o.trigger(S.FRAG_LOAD_EMERGENCY_ABORTED,{frag:s,part:i,stats:u})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new l_(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.FRAG_LOADING,this.onFragLoading,this),e.on(S.FRAG_LOADED,this.onFragLoaded,this),e.on(S.FRAG_BUFFERED,this.onFragBuffered,this),e.on(S.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(S.LEVEL_LOADED,this.onLevelLoaded,this),e.on(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(S.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(S.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.FRAG_LOADING,this.onFragLoading,this),e.off(S.FRAG_LOADED,this.onFragLoaded,this),e.off(S.FRAG_BUFFERED,this.onFragBuffered,this),e.off(S.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(S.LEVEL_LOADED,this.onLevelLoaded,this),e.off(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(S.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(S.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const r=t.frag;if(!this.ignoreFragment(r)){if(!r.bitrateTest){var s;this.fragCurrent=r,this.partCurrent=(s=t.part)!=null?s:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case N.BUFFER_ADD_CODEC_ERROR:case N.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case N.FRAG_LOAD_TIMEOUT:{const r=t.frag,{fragCurrent:s,partCurrent:i}=this;if(r&&s&&r.sn===s.sn&&r.level===s.level){const o=performance.now(),a=i?i.stats:r.stats,l=o-a.loading.start,c=a.loading.first?a.loading.first-a.loading.start:-1;if(a.loaded&&c>-1){const d=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(d,c),a.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,t,r,s){const i=e+r/t,o=s?e+this.lastLevelLoadSec:0;return i+o}onLevelLoaded(e,t){const r=this.hls.config,{loading:s}=t.stats,i=s.end-s.first;q(i)&&(this.lastLevelLoadSec=i/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:r}){const s=r?r.stats:t.stats;if(t.type===Z.MAIN&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const i=r?r.duration:t.duration,o=this.hls.levels[t.level],a=(o.loaded?o.loaded.bytes:0)+s.loaded,l=(o.loaded?o.loaded.duration:0)+i;o.loaded={bytes:a,duration:l},o.realBitrate=Math.round(8*a/l)}if(t.bitrateTest){const i={stats:s,frag:t,part:r,id:t.type};this.onFragBuffered(S.FRAG_BUFFERED,i),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:r,part:s}=t,i=s!=null&&s.stats.loaded?s.stats:r.stats;if(i.aborted||this.ignoreFragment(r))return;const o=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,i.loaded),i.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Z.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,r=this.getBwEstimate(),s=this.hls.config.maxStarvationDelay,i=this.findBestLevel(r,t,e,0,s,1,1);if(i>-1)return i;const o=this.hls.firstLevel,a=Math.min(Math.max(o,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,r=this.bwEstimator.canEstimate(),s=this.lastLoadedFragLevel>-1;if(e!==-1&&(!r||!s||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const i=r&&s?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,i)&&o[e].loadError<=o[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:r}=this;if(r.levels.length<=1)return r.loadLevel;const{maxAutoLevel:s,config:i,minAutoLevel:o}=r,a=t?t.duration:e?e.duration:0,l=this.getBwEstimate(),c=this.getStarvationDelay();let u=i.abrBandWidthFactor,d=i.abrBandWidthUpFactor;if(c){const g=this.findBestLevel(l,o,s,c,0,u,d);if(g>=0)return this.rebufferNotice=-1,g}let f=a?Math.min(a,i.maxStarvationDelay):i.maxStarvationDelay;if(!c){const g=this.bitrateTestDelay;g&&(f=(a?Math.min(a,i.maxLoadingDelay):i.maxLoadingDelay)-g,this.info(`bitrate test took ${Math.round(1e3*g)}ms, set first fragment max fetchDuration to ${Math.round(1e3*f)} ms`),u=d=1)}const h=this.findBestLevel(l,o,s,c,f,u,d);if(this.rebufferNotice!==h&&(this.rebufferNotice=h,this.info(`${c?"rebuffering expected":"buffer is empty"}, optimal quality level ${h}`)),h>-1)return h;const p=r.levels[o],m=r.loadLevelObj;return m&&(p==null?void 0:p.bitrate)<m.bitrate?o:r.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const r=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,s=e.mainForwardBufferInfo;return(s?s.len:0)/r}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,r,s,i,o,a){var l;const c=s+i,u=this.lastLoadedFragLevel,d=u===-1?this.hls.firstLevel:u,{fragCurrent:f,partCurrent:h}=this,{levels:p,allAudioTracks:m,loadLevel:g,config:v}=this.hls;if(p.length===1)return 0;const x=p[d],E=!!((l=this.hls.latestLevelDetails)!=null&&l.live),T=g===-1||u===-1;let w,L="SDR",A=(x==null?void 0:x.frameRate)||0;const{audioPreference:R,videoPreference:C}=v,I=this.audioTracksByGroup||(this.audioTracksByGroup=OS(m));let P=-1;if(T){if(this.firstSelection!==-1)return this.firstSelection;const U=this.codecTiers||(this.codecTiers=Q_(p,I,t,r)),H=q_(U,L,e,R,C),{codecSet:_,videoRanges:k,minFramerate:M,minBitrate:F,minIndex:$,preferHDR:Y}=H;P=$,w=_,L=Y?k[k.length-1]:k[0],A=M,e=Math.max(e,F),this.log(`picked start tier ${Ie(H)}`)}else w=x==null?void 0:x.codecSet,L=x==null?void 0:x.videoRange;const O=h?h.duration:f?f.duration:0,V=this.bwEstimator.getEstimateTTFB()/1e3,B=[];for(let U=r;U>=t;U--){var K;const H=p[U],_=U>d;if(!H)continue;if(v.useMediaCapabilities&&!H.supportedResult&&!H.supportedPromise){const ee=navigator.mediaCapabilities;typeof(ee==null?void 0:ee.decodingInfo)=="function"&&B_(H,I,L,A,e,R)?(H.supportedPromise=DS(H,I,ee,this.supportedCache),H.supportedPromise.then(te=>{if(!this.hls)return;H.supportedResult=te;const ne=this.hls.levels,Re=ne.indexOf(H);te.error?this.warn(`MediaCapabilities decodingInfo error: "${te.error}" for level ${Re} ${Ie(te)}`):te.supported?te.decodingInfoResults.some(Be=>Be.smooth===!1||Be.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Re} not smooth or powerEfficient: ${Ie(te)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Re} ${Ie(te)}`),Re>-1&&ne.length>1&&(this.log(`Removing unsupported level ${Re}`),this.hls.removeLevel(Re),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(te=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${te}`)})):H.supportedResult=_S}if((w&&H.codecSet!==w||L&&H.videoRange!==L||_&&A>H.frameRate||!_&&A>0&&A<H.frameRate||(K=H.supportedResult)!=null&&(K=K.decodingInfoResults)!=null&&K.some(ee=>ee.smooth===!1))&&(!T||U!==P)){B.push(U);continue}const k=H.details,M=(h?k==null?void 0:k.partTarget:k==null?void 0:k.averagetargetduration)||O;let F;_?F=a*e:F=o*e;const $=O&&s>=O*2&&i===0?H.averageBitrate:H.maxBitrate,Y=this.getTimeToLoadFrag(V,F,$*M,k===void 0);if(F>=$&&(U===u||H.loadError===0&&H.fragmentError===0)&&(Y<=V||!q(Y)||E&&!this.bitrateTestDelay||Y<c)){const ee=this.forcedAutoLevel;return U!==g&&(ee===-1||ee!==g)&&(B.length&&this.trace(`Skipped level(s) ${B.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${p[B[0]].codecs}" ${p[B[0]].videoRange}; not compatible with "${w}" ${L}`),this.info(`switch candidate:${d}->${U} adjustedbw(${Math.round(F)})-bitrate=${Math.round(F-$)} ttfb:${V.toFixed(1)} avgDuration:${M.toFixed(1)} maxFetchDuration:${c.toFixed(1)} fetchDuration:${Y.toFixed(1)} firstSelection:${T} codecSet:${H.codecSet} videoRange:${H.videoRange} hls.loadLevel:${g}`)),T&&(this.firstSelection=U),U}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:r}=this.hls;return Math.min(Math.max(e,r),t)}}const MS={search:function(n,e){let t=0,r=n.length-1,s=null,i=null;for(;t<=r;){s=(t+r)/2|0,i=n[s];const o=e(i);if(o>0)t=s+1;else if(o<0)r=s-1;else return i}return null}};function tP(n,e,t){if(e===null||!Array.isArray(n)||!n.length||!q(e))return null;const r=n[0].programDateTime;if(e<(r||0))return null;const s=n[n.length-1].endProgramDateTime;if(e>=(s||0))return null;for(let i=0;i<n.length;++i){const o=n[i];if(rP(e,t,o))return o}return null}function Ns(n,e,t=0,r=0,s=.005){let i=null;if(n){i=e[1+n.sn-e[0].sn]||null;const a=n.endDTS-t;a>0&&a<15e-7&&(t+=15e-7),i&&n.level!==i.level&&i.end<=n.end&&(i=e[2+n.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(i=e[0]);if(i&&((!n||n.level===i.level)&&a0(t,r,i)===0||nP(i,n,Math.min(s,r))))return i;const o=MS.search(e,a0.bind(null,t,r));return o&&(o!==n||!i)?o:i}function nP(n,e,t){if(e&&e.start===0&&e.level<n.level&&(e.endPTS||0)>0){const r=e.tagList.reduce((s,i)=>(i[0]==="INF"&&(s+=parseFloat(i[1])),s),t);return n.start<=r}return!1}function a0(n=0,e=0,t){if(t.start<=n&&t.start+t.duration>n)return 0;const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=n?1:t.start-r>n&&t.start?-1:0}function rP(n,e,t){const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-r>n}function FS(n,e,t){if(n&&n.startCC<=e&&n.endCC>=e){let r=n.fragments;const{fragmentHint:s}=n;s&&(r=r.concat(s));let i;return MS.search(r,o=>o.cc<e?1:o.cc>e?-1:(i=o,o.end<=t?1:o.start>t?-1:0)),i||null}return null}function uc(n){switch(n.details){case N.FRAG_LOAD_TIMEOUT:case N.KEY_LOAD_TIMEOUT:case N.LEVEL_LOAD_TIMEOUT:case N.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function l0(n,e){const t=uc(e);return n.default[`${t?"timeout":"error"}Retry`]}function gm(n,e){const t=n.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*n.retryDelayMs,n.maxRetryDelayMs)}function c0(n){return ye(ye({},n),{errorRetry:null,timeoutRetry:null})}function dc(n,e,t,r){if(!n)return!1;const s=r==null?void 0:r.code,i=e<n.maxNumRetry&&(sP(s)||!!t);return n.shouldRetry?n.shouldRetry(n,e,t,r,i):i}function sP(n){return Mf(n)||!!n&&(n<400||n>499)}function Mf(n){return n===0&&navigator.onLine===!1}var rt={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},Pt={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4,SwitchToSDR:8};class iP extends tn{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(S.ERROR,this.onError,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(S.ERROR,this.onError,this),e.off(S.ERROR,this.onErrorOut,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Z.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,r=t.currentLevel;return(e=t.loadLevelObj)!=null&&e.details||r===-1?t.loadLevel:r}variantHasKey(e,t){if(e){var r;if((r=e.details)!=null&&r.hasKey(t))return!0;const s=e.audioGroups;if(s)return this.hls.allAudioTracks.filter(o=>s.indexOf(o.groupId)>=0).some(o=>{var a;return(a=o.details)==null?void 0:a.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var r;if(t.fatal)return;const s=this.hls,i=t.context;switch(t.details){case N.FRAG_LOAD_ERROR:case N.FRAG_LOAD_TIMEOUT:case N.KEY_LOAD_ERROR:case N.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case N.FRAG_PARSING_ERROR:if((r=t.frag)!=null&&r.gap){t.errorAction=yi();return}case N.FRAG_GAP:case N.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=rt.SendAlternateToPenaltyBox;return}case N.LEVEL_EMPTY_ERROR:case N.LEVEL_PARSING_ERROR:{var o;const l=t.parent===Z.MAIN?t.level:s.loadLevel;t.details===N.LEVEL_EMPTY_ERROR&&((o=t.context)!=null&&(o=o.levelDetails)!=null&&o.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,l):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,l))}return;case N.LEVEL_LOAD_ERROR:case N.LEVEL_LOAD_TIMEOUT:typeof(i==null?void 0:i.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.level));return;case N.AUDIO_TRACK_LOAD_ERROR:case N.AUDIO_TRACK_LOAD_TIMEOUT:case N.SUBTITLE_LOAD_ERROR:case N.SUBTITLE_TRACK_LOAD_TIMEOUT:if(i){const l=s.loadLevelObj;if(l&&(i.type===ce.AUDIO_TRACK&&l.hasAudioGroup(i.groupId)||i.type===ce.SUBTITLE_TRACK&&l.hasSubtitleGroup(i.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=rt.SendAlternateToPenaltyBox,t.errorAction.flags=Pt.MoveAllAlternatesMatchingHost;return}}return;case N.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:t.errorAction={action:rt.SendAlternateToPenaltyBox,flags:Pt.MoveAllAlternatesMatchingHDCP};return;case N.KEY_SYSTEM_SESSION_UPDATE_FAILED:case N.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case N.KEY_SYSTEM_NO_SESSION:t.errorAction={action:rt.SendAlternateToPenaltyBox,flags:Pt.MoveAllAlternatesMatchingKey};return;case N.BUFFER_ADD_CODEC_ERROR:case N.REMUX_ALLOC_ERROR:case N.BUFFER_APPEND_ERROR:if(!t.errorAction){var a;t.errorAction=this.getLevelSwitchAction(t,(a=t.level)!=null?a:s.loadLevel)}return;case N.INTERNAL_EXCEPTION:case N.BUFFER_APPENDING_ERROR:case N.BUFFER_FULL_ERROR:case N.LEVEL_SWITCH_ERROR:case N.BUFFER_STALLED_ERROR:case N.BUFFER_SEEK_OVER_HOLE:case N.BUFFER_NUDGE_ON_STALL:t.errorAction=yi();return}t.type===J.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=yi())}getPlaylistRetryOrSwitchAction(e,t){const r=this.hls,s=l0(r.config.playlistLoadPolicy,e),i=this.playlistError++;if(dc(s,i,uc(e),e.response))return{action:rt.RetryRequest,flags:Pt.None,retryConfig:s,retryCount:i};const a=this.getLevelSwitchAction(e,t);return s&&(a.retryConfig=s,a.retryCount=i),a}getFragRetryOrSwitchAction(e){const t=this.hls,r=this.getVariantLevelIndex(e.frag),s=t.levels[r],{fragLoadPolicy:i,keyLoadPolicy:o}=t.config,a=l0(e.details.startsWith("key")?o:i,e),l=t.levels.reduce((u,d)=>u+d.fragmentError,0);if(s&&(e.details!==N.FRAG_GAP&&s.fragmentError++,dc(a,l,uc(e),e.response)))return{action:rt.RetryRequest,flags:Pt.None,retryConfig:a,retryCount:l};const c=this.getLevelSwitchAction(e,r);return a&&(c.retryConfig=a,c.retryCount=l),c}getLevelSwitchAction(e,t){const r=this.hls;t==null&&(t=r.loadLevel);const s=this.hls.levels[t];if(s){var i,o;const c=e.details;s.loadError++,c===N.BUFFER_APPEND_ERROR&&s.fragmentError++;let u=-1;const{levels:d,loadLevel:f,minAutoLevel:h,maxAutoLevel:p}=r;!r.autoLevelEnabled&&!r.config.preserveManualLevelOnError&&(r.loadLevel=-1);const m=(i=e.frag)==null?void 0:i.type,v=(m===Z.AUDIO&&c===N.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(c===N.BUFFER_ADD_CODEC_ERROR||c===N.BUFFER_APPEND_ERROR))&&d.some(({audioCodec:L})=>s.audioCodec!==L),E=e.sourceBufferName==="video"&&(c===N.BUFFER_ADD_CODEC_ERROR||c===N.BUFFER_APPEND_ERROR)&&d.some(({codecSet:L,audioCodec:A})=>s.codecSet!==L&&s.audioCodec===A),{type:T,groupId:w}=(o=e.context)!=null?o:{};for(let L=d.length;L--;){const A=(L+f)%d.length;if(A!==f&&A>=h&&A<=p&&d[A].loadError===0){var a,l;const R=d[A];if(c===N.FRAG_GAP&&m===Z.MAIN&&e.frag){const C=d[A].details;if(C){const I=Ns(e.frag,C.fragments,e.frag.start);if(I!=null&&I.gap)continue}}else{if(T===ce.AUDIO_TRACK&&R.hasAudioGroup(w)||T===ce.SUBTITLE_TRACK&&R.hasSubtitleGroup(w))continue;if(m===Z.AUDIO&&(a=s.audioGroups)!=null&&a.some(C=>R.hasAudioGroup(C))||m===Z.SUBTITLE&&(l=s.subtitleGroups)!=null&&l.some(C=>R.hasSubtitleGroup(C))||v&&s.audioCodec===R.audioCodec||E&&s.codecSet===R.codecSet||!v&&s.codecSet!==R.codecSet)continue}u=A;break}}if(u>-1&&r.loadLevel!==u)return e.levelRetry=!0,this.playlistError=0,{action:rt.SendAlternateToPenaltyBox,flags:Pt.None,nextAutoLevel:u}}return{action:rt.SendAlternateToPenaltyBox,flags:Pt.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var r;switch((r=t.errorAction)==null?void 0:r.action){case rt.DoNothing:break;case rt.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==N.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,r=e.errorAction;if(!r)return;const{flags:s}=r,i=r.nextAutoLevel;switch(s){case Pt.None:this.switchLevel(e,i);break;case Pt.MoveAllAlternatesMatchingHDCP:{const l=this.getVariantLevelIndex(e.frag),c=t.levels[l],u=c==null?void 0:c.attrs["HDCP-LEVEL"];if(r.hdcpLevel=u,u){t.maxHdcpLevel=Of[Of.indexOf(u)-1],r.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case Pt.MoveAllAlternatesMatchingKey:{const l=e.decryptdata;if(l){const c=this.hls.levels;for(let u=c.length;u--;)if(this.variantHasKey(c[u],l)){var o,a;this.log(`Banned key found in level ${u} (${c[u].bitrate}bps) or audio group "${(o=c[u].audioGroups)==null?void 0:o.join(",")}" (${(a=e.frag)==null?void 0:a.type} fragment) ${Nt(l.keyId||[])}`),c[u].fragmentError++,c[u].loadError++,this.log(`Removing level ${u} with key error (${e.error})`),this.hls.removeLevel(u)}c.length&&(r.resolved=!0)}break}}r.resolved||this.switchLevel(e,i)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===N.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const r=Nf(e.mimeType),s=this.hls.levels;for(let i=s.length;i--;)s[i][`${e.sourceBufferName}Codec`]===r&&(this.log(`Removing level ${i} for ${e.details} ("${r}" not supported)`),this.hls.removeLevel(i))}}}function yi(n){const e={action:rt.DoNothing,flags:Pt.None};return n&&(e.resolved=!0),e}var ze={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class oP{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.BUFFER_APPENDED,this.onBufferAppended,this),e.on(S.FRAG_BUFFERED,this.onFragBuffered,this),e.on(S.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.BUFFER_APPENDED,this.onBufferAppended,this),e.off(S.FRAG_BUFFERED,this.onFragBuffered,this),e.off(S.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const r=this.activePartLists[t];if(r)for(let s=r.length;s--;){const i=r[s];if(!i)break;if(i.start<=e&&e<=i.end&&i.loaded)return i}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,r){const{fragments:s}=this,i=Object.keys(s);for(let o=i.length;o--;){const a=s[i[o]];if((a==null?void 0:a.body.type)===t&&(!r||a.buffered)){const l=a.body;if(l.start<=e&&e<=l.end)return l}}return null}detectEvictedFragments(e,t,r,s,i){this.timeRanges&&(this.timeRanges[e]=t);const o=(s==null?void 0:s.fragment.sn)||-1;Object.keys(this.fragments).forEach(a=>{const l=this.fragments[a];if(!l||o>=l.body.sn)return;if(!l.buffered&&(!l.loaded||i)){l.body.type===r&&this.removeFragment(l.body);return}const c=l.range[e];if(c){if(c.time.length===0){this.removeFragment(l.body);return}c.time.some(u=>{const d=!this.isTimeBuffered(u.startPTS,u.endPTS,t);return d&&this.removeFragment(l.body),d})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const r=e.frag,s=Vs(r),i=this.fragments[s];if(!i||i.buffered&&r.gap)return;const o=!r.relurl;Object.keys(t).forEach(a=>{const l=r.elementaryStreams[a];if(!l)return;const c=t[a],u=o||l.partial===!0;i.range[a]=this.getBufferedTimes(r,e.part,u,c)}),i.loaded=null,Object.keys(i.range).length?(i.buffered=!0,(i.body.endList=r.endList||i.body.endList)&&(this.endListFragments[i.body.type]=i),Ua(i)||this.removeParts(r.sn-1,r.type)):this.removeFragment(i.body)}removeParts(e,t){const r=this.activePartLists[t];r&&(this.activePartLists[t]=u0(r,s=>s.fragment.sn>=e))}fragBuffered(e,t){const r=Vs(e);let s=this.fragments[r];!s&&t&&(s=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,s.buffered=!0)}getBufferedTimes(e,t,r,s){const i={time:[],partial:r},o=e.start,a=e.end,l=e.minEndPTS||a,c=e.maxStartPTS||o;for(let u=0;u<s.length;u++){const d=s.start(u)-this.bufferPadding,f=s.end(u)+this.bufferPadding;if(c>=d&&l<=f){i.time.push({startPTS:Math.max(o,s.start(u)),endPTS:Math.min(a,s.end(u))});break}else if(o<f&&a>d){const h=Math.max(o,s.start(u)),p=Math.min(a,s.end(u));p>h&&(i.partial=!0,i.time.push({startPTS:h,endPTS:p}))}else if(a<=d)break}return i}getPartialFragment(e){let t=null,r,s,i,o=0;const{bufferPadding:a,fragments:l}=this;return Object.keys(l).forEach(c=>{const u=l[c];u&&Ua(u)&&(s=u.body.start-a,i=u.body.end+a,e>=s&&e<=i&&(r=Math.min(e-s,i-e),o<=r&&(t=u.body,o=r)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Ua(t))}getState(e){const t=Vs(e),r=this.fragments[t];return r?r.buffered?Ua(r)?ze.PARTIAL:ze.OK:ze.APPENDING:ze.NOT_LOADED}isTimeBuffered(e,t,r){let s,i;for(let o=0;o<r.length;o++){if(s=r.start(o)-this.bufferPadding,i=r.end(o)+this.bufferPadding,e>=s&&t<=i)return!0;if(t<=s)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const r=t.frag,s=t.part?null:t,i=Vs(r);this.fragments[i]={body:r,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:r,part:s,timeRanges:i,type:o}=t;if(r.sn==="initSegment")return;const a=r.type;if(s){let c=this.activePartLists[a];c||(this.activePartLists[a]=c=[]),c.push(s)}this.timeRanges=i;const l=i[o];this.detectEvictedFragments(o,l,a,s)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Vs(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,r=Object.keys(t);if(!e)return r.length>0;for(let s=r.length;s--;){const i=t[r[s]];if((i==null?void 0:i.body.type)===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,r,s,i){s&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a)return;const l=a.body;l.type!==r||s&&!l.gap||l.start<t&&l.end>e&&(a.buffered||i)&&this.removeFragment(l)})}removeFragment(e){const t=Vs(e);e.clearElementaryStreamInfo();const r=this.activePartLists[e.type];if(r){const s=e.sn;this.activePartLists[e.type]=u0(r,i=>i.fragment.sn!==s)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;t&&t.forEach(r=>r.clearElementaryStreamInfo())}}function Ua(n){var e,t,r;return n.buffered&&!!(n.body.gap||(e=n.range.video)!=null&&e.partial||(t=n.range.audio)!=null&&t.partial||(r=n.range.audiovideo)!=null&&r.partial)}function Vs(n){return`${n.type}_${n.level}_${n.sn}`}function u0(n,e){return n.filter(t=>{const r=e(t);return r||t.clearElementaryStreamInfo(),r})}var ns={cbc:0,ctr:1};class aP{constructor(e,t,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=r}decrypt(e,t){switch(this.aesMode){case ns.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case ns.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function lP(n){const e=n.byteLength,t=e&&new DataView(n.buffer).getUint8(e-1);return t?n.slice(0,e-t):n}class cP{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),r=new Uint32Array(4);for(let s=0;s<4;s++)r[s]=t.getUint32(s*4);return r}initTable(){const e=this.sBox,t=this.invSBox,r=this.subMix,s=r[0],i=r[1],o=r[2],a=r[3],l=this.invSubMix,c=l[0],u=l[1],d=l[2],f=l[3],h=new Uint32Array(256);let p=0,m=0,g=0;for(g=0;g<256;g++)g<128?h[g]=g<<1:h[g]=g<<1^283;for(g=0;g<256;g++){let v=m^m<<1^m<<2^m<<3^m<<4;v=v>>>8^v&255^99,e[p]=v,t[v]=p;const x=h[p],E=h[x],T=h[E];let w=h[v]*257^v*16843008;s[p]=w<<24|w>>>8,i[p]=w<<16|w>>>16,o[p]=w<<8|w>>>24,a[p]=w,w=T*16843009^E*65537^x*257^p*16843008,c[v]=w<<24|w>>>8,u[v]=w<<16|w>>>16,d[v]=w<<8|w>>>24,f[v]=w,p?(p=x^h[h[h[T^x]]],m^=h[h[m]]):p=m=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let r=!0,s=0;for(;s<t.length&&r;)r=t[s]===this.key[s],s++;if(r)return;this.key=t;const i=this.keySize=t.length;if(i!==4&&i!==6&&i!==8)throw new Error("Invalid aes key size="+i);const o=this.ksRows=(i+6+1)*4;let a,l;const c=this.keySchedule=new Uint32Array(o),u=this.invKeySchedule=new Uint32Array(o),d=this.sBox,f=this.rcon,h=this.invSubMix,p=h[0],m=h[1],g=h[2],v=h[3];let x,E;for(a=0;a<o;a++){if(a<i){x=c[a]=t[a];continue}E=x,a%i===0?(E=E<<8|E>>>24,E=d[E>>>24]<<24|d[E>>>16&255]<<16|d[E>>>8&255]<<8|d[E&255],E^=f[a/i|0]<<24):i>6&&a%i===4&&(E=d[E>>>24]<<24|d[E>>>16&255]<<16|d[E>>>8&255]<<8|d[E&255]),c[a]=x=(c[a-i]^E)>>>0}for(l=0;l<o;l++)a=o-l,l&3?E=c[a]:E=c[a-4],l<4||a<=4?u[l]=E:u[l]=p[d[E>>>24]]^m[d[E>>>16&255]]^g[d[E>>>8&255]]^v[d[E&255]],u[l]=u[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,r){const s=this.keySize+6,i=this.invKeySchedule,o=this.invSBox,a=this.invSubMix,l=a[0],c=a[1],u=a[2],d=a[3],f=this.uint8ArrayToUint32Array_(r);let h=f[0],p=f[1],m=f[2],g=f[3];const v=new Int32Array(e),x=new Int32Array(v.length);let E,T,w,L,A,R,C,I,P,O,V,B,K,U;const H=this.networkToHostOrderSwap;for(;t<v.length;){for(P=H(v[t]),O=H(v[t+1]),V=H(v[t+2]),B=H(v[t+3]),A=P^i[0],R=B^i[1],C=V^i[2],I=O^i[3],K=4,U=1;U<s;U++)E=l[A>>>24]^c[R>>16&255]^u[C>>8&255]^d[I&255]^i[K],T=l[R>>>24]^c[C>>16&255]^u[I>>8&255]^d[A&255]^i[K+1],w=l[C>>>24]^c[I>>16&255]^u[A>>8&255]^d[R&255]^i[K+2],L=l[I>>>24]^c[A>>16&255]^u[R>>8&255]^d[C&255]^i[K+3],A=E,R=T,C=w,I=L,K=K+4;E=o[A>>>24]<<24^o[R>>16&255]<<16^o[C>>8&255]<<8^o[I&255]^i[K],T=o[R>>>24]<<24^o[C>>16&255]<<16^o[I>>8&255]<<8^o[A&255]^i[K+1],w=o[C>>>24]<<24^o[I>>16&255]<<16^o[A>>8&255]<<8^o[R&255]^i[K+2],L=o[I>>>24]<<24^o[A>>16&255]<<16^o[R>>8&255]<<8^o[C&255]^i[K+3],x[t]=H(E^h),x[t+1]=H(L^p),x[t+2]=H(w^m),x[t+3]=H(T^g),h=P,p=O,m=V,g=B,t=t+4}return x.buffer}}class uP{constructor(e,t,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=r}expandKey(){const e=dP(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function dP(n){switch(n){case ns.cbc:return"AES-CBC";case ns.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${n}`)}}const fP=16;class vm{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?lP(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r,s){return this.useSoftware?new Promise((i,o)=>{const a=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(a,t,r,s);const l=this.flush();l?i(l.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,r,s)}softwareDecrypt(e,t,r,s){const{currentIV:i,currentResult:o,remainderData:a}=this;if(s!==ns.cbc||t.byteLength!==16)return me.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),a&&(e=en(a,e),this.remainderData=null);const l=this.getValidChunk(e);if(!l.length)return null;i&&(r=i);let c=this.softwareDecrypter;c||(c=this.softwareDecrypter=new cP),c.expandKey(t);const u=o;return this.currentResult=c.decrypt(l.buffer,0,r),this.currentIV=l.slice(-16).buffer,u||null}webCryptoDecrypt(e,t,r,s){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r,s));this.key=t,this.fastAesKey=new uP(this.subtle,t,s)}return this.fastAesKey.expandKey().then(i=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new aP(this.subtle,new Uint8Array(r),s).decrypt(e.buffer,i)):Promise.reject(new Error("web crypto not initialized"))).catch(i=>(me.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,t,r,s)))}onWebCryptoError(e,t,r,s){const i=this.enableSoftwareAES;if(i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r,s);const o=this.flush();if(o)return o.buffer}throw new Error("WebCrypto"+(i?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const r=e.length-e.length%fP;return r!==e.length&&(t=e.slice(0,r),this.remainderData=e.slice(r)),t}logOnce(e){this.logEnabled&&(me.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const d0=Math.pow(2,17);class hP{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const r=e.url;if(!r)return Promise.reject(new nr({type:J.NETWORK_ERROR,details:N.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();const s=this.config,i=s.fLoader,o=s.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(p=>p[0]==="GAP")){l(h0(e));return}else e.gap=!1;const c=this.loader=i?new i(s):new o(s),u=f0(e);e.loader=c;const d=c0(s.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:d0};e.stats=c.stats;const h={onSuccess:(p,m,g,v)=>{this.resetLoader(e,c);let x=p.data;g.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(x.slice(0,16)),x=x.slice(16)),a({frag:e,part:null,payload:x,networkDetails:v})},onError:(p,m,g,v)=>{this.resetLoader(e,c),l(new nr({type:J.NETWORK_ERROR,details:N.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:ye({url:r,data:void 0},p),error:new Error(`HTTP Error ${p.code} ${p.text}`),networkDetails:g,stats:v}))},onAbort:(p,m,g)=>{this.resetLoader(e,c),l(new nr({type:J.NETWORK_ERROR,details:N.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:g,stats:p}))},onTimeout:(p,m,g)=>{this.resetLoader(e,c),l(new nr({type:J.NETWORK_ERROR,details:N.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:g,stats:p}))}};t&&(h.onProgress=(p,m,g,v)=>t({frag:e,part:null,payload:g,networkDetails:v})),c.load(u,f,h)})}loadPart(e,t,r){this.abort();const s=this.config,i=s.fLoader,o=s.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(h0(e,t));return}const c=this.loader=i?new i(s):new o(s),u=f0(e,t);e.loader=c;const d=c0(s.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:d0};t.stats=c.stats,c.load(u,f,{onSuccess:(h,p,m,g)=>{this.resetLoader(e,c),this.updateStatsFromPart(e,t);const v={frag:e,part:t,payload:h.data,networkDetails:g};r(v),a(v)},onError:(h,p,m,g)=>{this.resetLoader(e,c),l(new nr({type:J.NETWORK_ERROR,details:N.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:ye({url:u.url,data:void 0},h),error:new Error(`HTTP Error ${h.code} ${h.text}`),networkDetails:m,stats:g}))},onAbort:(h,p,m)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,c),l(new nr({type:J.NETWORK_ERROR,details:N.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:m,stats:h}))},onTimeout:(h,p,m)=>{this.resetLoader(e,c),l(new nr({type:J.NETWORK_ERROR,details:N.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:m,stats:h}))}})})}updateStatsFromPart(e,t){const r=e.stats,s=t.stats,i=s.total;if(r.loaded+=s.loaded,i){const l=Math.round(e.duration/t.duration),c=Math.min(Math.round(r.loaded/i),l),d=(l-c)*Math.round(r.loaded/c);r.total=r.loaded+d}else r.total=Math.max(r.loaded,r.total);const o=r.loading,a=s.loading;o.start?o.first+=a.first-a.start:(o.start=a.start,o.first=a.first),o.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function f0(n,e=null){const t=e||n,r={frag:n,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},s=t.byteRangeStartOffset,i=t.byteRangeEndOffset;if(q(s)&&q(i)){var o;let a=s,l=i;if(n.sn==="initSegment"&&mP((o=n.decryptdata)==null?void 0:o.method)){const c=i-s;c%16&&(l=i+(16-c%16)),s!==0&&(r.resetIV=!0,a=s-16)}r.rangeStart=a,r.rangeEnd=l}return r}function h0(n,e){const t=new Error(`GAP ${n.gap?"tag":"attribute"} found`),r={type:J.MEDIA_ERROR,details:N.FRAG_GAP,fatal:!1,frag:n,error:t,networkDetails:null};return e&&(r.part=e),(e||n).stats.aborted=!0,new nr(r)}function mP(n){return n==="AES-128"||n==="AES-256"}class nr extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class $S extends tn{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class ym{constructor(e,t,r,s=0,i=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=ja(),this.buffering={audio:ja(),video:ja(),audiovideo:ja()},this.level=e,this.sn=t,this.id=r,this.size=s,this.part=i,this.partial=o}}function ja(){return{start:0,executeStart:0,executeEnd:0,end:0}}const m0={length:0,start:()=>0,end:()=>0};class se{static isBuffered(e,t){if(e){const r=se.getBuffered(e);for(let s=r.length;s--;)if(t>=r.start(s)&&t<=r.end(s))return!0}return!1}static bufferedRanges(e){if(e){const t=se.getBuffered(e);return se.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}static bufferInfo(e,t,r){if(e){const s=se.bufferedRanges(e);if(s.length)return se.bufferedInfo(s,t,r)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,r){t=Math.max(0,t),e.length>1&&e.sort((u,d)=>u.start-d.start||d.end-u.end);let s=-1,i=[];if(r)for(let u=0;u<e.length;u++){t>=e[u].start&&t<=e[u].end&&(s=u);const d=i.length;if(d){const f=i[d-1].end;e[u].start-f<r?e[u].end>f&&(i[d-1].end=e[u].end):i.push(e[u])}else i.push(e[u])}else i=e;let o=0,a,l=t,c=t;for(let u=0;u<i.length;u++){const d=i[u].start,f=i[u].end;if(s===-1&&t>=d&&t<=f&&(s=u),t+r>=d&&t<f)l=d,c=f,o=c-t;else if(t+r<d){a=d;break}}return{len:o,start:l||0,end:c||0,nextStart:a,buffered:e,bufferedIndex:s}}static getBuffered(e){try{return e.buffered||m0}catch(t){return me.log("failed to get media.buffered",t),m0}}}const BS=/\{\$([a-zA-Z0-9-_]+)\}/g;function p0(n){return BS.test(n)}function Ff(n,e){if(n.variableList!==null||n.hasVariableRefs){const t=n.variableList;return e.replace(BS,r=>{const s=r.substring(2,r.length-1),i=t==null?void 0:t[s];return i===void 0?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),r):i})}return e}function g0(n,e,t){let r=n.variableList;r||(n.variableList=r={});let s,i;if("QUERYPARAM"in e){s=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(s))i=o.get(s);else throw new Error(`"${s}" does not match any query parameter in URI: "${t}"`)}catch(o){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else s=e.NAME,i=e.VALUE;s in r?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):r[s]=i||""}function pP(n,e,t){const r=e.IMPORT;if(t&&r in t){let s=n.variableList;s||(n.variableList=s={}),s[r]=t[r]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}const gP=/^(\d+)x(\d+)$/,v0=/(.+?)=(".*?"|.*?)(?:,|$)/g;class _e{constructor(e,t){typeof e=="string"&&(e=_e.parseAttrList(e,t)),Ee(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const r=new Uint8Array(t.length/2);for(let s=0;s<t.length/2;s++)r[s]=parseInt(t.slice(s*2,s*2+2),16);return r}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const r=this[e];return(r?r.split(/[ ,]+/):[]).reduce((s,i)=>(s[i.toLowerCase()]=!0,s),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=gP.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let r;const s={},i='"';for(v0.lastIndex=0;(r=v0.exec(e))!==null;){const o=r[1].trim();let a=r[2];const l=a.indexOf(i)===0&&a.lastIndexOf(i)===a.length-1;let c=!1;if(l)a=a.slice(1,-1);else switch(o){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":c=!0}if(t&&(l||c))a=Ff(t,a);else if(!c&&!l)switch(o){case"CLOSED-CAPTIONS":if(a==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":me.warn(`${e}: attribute ${o} is missing quotes`)}s[o]=a}return s}}const vP="com.apple.hls.interstitial";function yP(n){return n!=="ID"&&n!=="CLASS"&&n!=="CUE"&&n!=="START-DATE"&&n!=="DURATION"&&n!=="END-DATE"&&n!=="END-ON-NEXT"}function xP(n){return n==="SCTE35-OUT"||n==="SCTE35-IN"||n==="SCTE35-CMD"}class US{constructor(e,t,r=0){var s;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(t==null?void 0:t.tagAnchor)||null,this.tagOrder=(s=t==null?void 0:t.tagOrder)!=null?s:r,t){const i=t.attr;for(const o in i)if(Object.prototype.hasOwnProperty.call(e,o)&&e[o]!==i[o]){me.warn(`DATERANGE tag attribute: "${o}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=o;break}e=Ee(new _e({}),i,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const i=(t==null?void 0:t.endDate)||new Date(this.attr["END-DATE"]);q(i.getTime())&&(this._endDate=i)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(me.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(q(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===vP}get isValid(){return!!this.id&&!this._badValueForSameId&&q(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const EP=10;class SP{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&r>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let r=t.decryptdata;return r||(t.setKeyFormat(e.keyFormat),r=t.decryptdata),!!r&&e.matches(r)})}get hasProgramDateTime(){return this.fragments.length?q(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||EP}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let r=e.length;r--;)if(e[r].index>t)return e[r].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function jS(n,e){return n.length===e.length?!n.some((t,r)=>t!==e[r]):!1}function y0(n,e){return!n&&!e?!0:!n||!e?!1:jS(n,e)}function xi(n){return n==="AES-128"||n==="AES-256"||n==="AES-256-CTR"}function xm(n){switch(n){case"AES-128":case"AES-256":return ns.cbc;case"AES-256-CTR":return ns.ctr;default:throw new Error(`invalid full segment method ${n}`)}}function Em(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0))}function $f(n){return Uint8Array.from(unescape(encodeURIComponent(n)),e=>e.charCodeAt(0))}function TP(n){const e=$f(n).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function bP(n){const e=function(r,s,i){const o=r[s];r[s]=r[i],r[i]=o};e(n,0,3),e(n,1,2),e(n,4,5),e(n,6,7)}function wP(n){const e=n.split(":");let t=null;if(e[0]==="data"&&e.length===2){const r=e[1].split(";"),s=r[r.length-1].split(",");if(s.length===2){const i=s[0]==="base64",o=s[1];i?(r.splice(-1,1),t=Em(o)):t=TP(o)}}return t}const fc=typeof self<"u"?self:void 0;var $e={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},At={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function El(n){switch(n){case At.FAIRPLAY:return $e.FAIRPLAY;case At.PLAYREADY:return $e.PLAYREADY;case At.WIDEVINE:return $e.WIDEVINE;case At.CLEARKEY:return $e.CLEARKEY}}function Yu(n){switch(n){case $e.FAIRPLAY:return At.FAIRPLAY;case $e.PLAYREADY:return At.PLAYREADY;case $e.WIDEVINE:return At.WIDEVINE;case $e.CLEARKEY:return At.CLEARKEY}}function ho(n){const{drmSystems:e,widevineLicenseUrl:t}=n,r=e?[$e.FAIRPLAY,$e.WIDEVINE,$e.PLAYREADY,$e.CLEARKEY].filter(s=>!!e[s]):[];return!r[$e.WIDEVINE]&&t&&r.push($e.WIDEVINE),r}const GS=function(n){return fc!=null&&(n=fc.navigator)!=null&&n.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function AP(n,e,t,r){let s;switch(n){case $e.FAIRPLAY:s=["cenc","sinf"];break;case $e.WIDEVINE:case $e.PLAYREADY:s=["cenc"];break;case $e.CLEARKEY:s=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return LP(s,e,t,r)}function LP(n,e,t,r){return[{initDataTypes:n,persistentState:r.persistentState||"optional",distinctiveIdentifier:r.distinctiveIdentifier||"optional",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:e.map(i=>({contentType:`audio/mp4; codecs=${i}`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:t.map(i=>({contentType:`video/mp4; codecs=${i}`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))}]}function IP(n){var e;return!!n&&(n.sessionType==="persistent-license"||!!((e=n.sessionTypes)!=null&&e.some(t=>t==="persistent-license")))}function RP(n){const e=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),r=t.substring(t.indexOf("<"),t.length),o=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(o){const a=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(a){const l=Em(a).subarray(0,16);return bP(l),l}}return null}let Ga={};class qc{static clearKeyUriToKeyIdMap(){Ga={}}constructor(e,t,r,s=[1],i=null,o){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=s,this.iv=i,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!xi(e),o!=null&&o.startsWith("0x")&&(this.keyId=new Uint8Array(SS(o)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&jS(e.keyFormatVersions,this.keyFormatVersions)&&y0(e.iv,this.iv)&&y0(e.keyId,this.keyId)}isSupported(){if(this.method){if(xi(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case At.FAIRPLAY:case At.WIDEVINE:case At.PLAYREADY:case At.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(xi(this.method)&&this.uri&&!this.iv){typeof e!="number"&&(me.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const r=CP(e);return new qc(this.method,this.uri,"identity",this.keyFormatVersions,r)}if(this.pssh&&this.keyId)return this;const t=wP(this.uri);if(t)switch(this.keyFormat){case At.WIDEVINE:if(this.pssh=t,!this.keyId&&t.length>=22){const r=t.length-22;this.keyId=t.subarray(r,r+16)}break;case At.PLAYREADY:{const r=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=__(r,null,t),this.keyId=RP(t);break}default:{let r=t.subarray(0,16);if(r.length!==16){const s=new Uint8Array(16);s.set(r,16-r.length),r=s}this.keyId=r;break}}if(!this.keyId||this.keyId.byteLength!==16){let r=Ga[this.uri];if(!r){const s=Object.keys(Ga).length%Number.MAX_SAFE_INTEGER;r=new Uint8Array(16),new DataView(r.buffer,12,4).setUint32(0,s),Ga[this.uri]=r}this.keyId=r}return this}}function CP(n){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=n>>8*(15-t)&255;return e}const x0=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,E0=/#EXT-X-MEDIA:(.*)/g,kP=/^#EXT(?:INF|-X-TARGETDURATION):/m,qu=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),_P=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Un{static findGroup(e,t){for(let r=0;r<e.length;r++){const s=e[r];if(s.id===t)return s}}static resolve(e,t){return dm.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return kP.test(e)}static parseMasterPlaylist(e,t){const r=p0(e),s={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:r},i=[];x0.lastIndex=0;let o;for(;(o=x0.exec(e))!=null;)if(o[1]){var a;const c=new _e(o[1],s),u=Ff(s,o[2]),d={attrs:c,bitrate:c.decimalInteger("BANDWIDTH")||c.decimalInteger("AVERAGE-BANDWIDTH"),name:c.NAME,url:Un.resolve(u,t)},f=c.decimalResolution("RESOLUTION");f&&(d.width=f.width,d.height=f.height),b0(c.CODECS,d);const h=c["SUPPLEMENTAL-CODECS"];h&&(d.supplemental={},b0(h,d.supplemental)),(a=d.unknownCodecs)!=null&&a.length||i.push(d),s.levels.push(d)}else if(o[3]){const c=o[3],u=o[4];switch(c){case"SESSION-DATA":{const d=new _e(u,s),f=d["DATA-ID"];f&&(s.sessionData===null&&(s.sessionData={}),s.sessionData[f]=d);break}case"SESSION-KEY":{const d=S0(u,t,s);d.encrypted&&d.isSupported()?(s.sessionKeys===null&&(s.sessionKeys=[]),s.sessionKeys.push(d)):me.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${u}"`);break}case"DEFINE":{{const d=new _e(u,s);g0(s,d,t)}break}case"CONTENT-STEERING":{const d=new _e(u,s);s.contentSteering={uri:Un.resolve(d["SERVER-URI"],t),pathwayId:d["PATHWAY-ID"]||"."};break}case"START":{s.startTimeOffset=T0(u);break}}}const l=i.length>0&&i.length<s.levels.length;return s.levels=l?i:s.levels,s.levels.length===0&&(s.playlistParsingError=new Error("no levels found in manifest")),s}static parseMasterPlaylistMedia(e,t,r){let s;const i={},o=r.levels,a={AUDIO:o.map(c=>({id:c.attrs.AUDIO,audioCodec:c.audioCodec})),SUBTITLES:o.map(c=>({id:c.attrs.SUBTITLES,textCodec:c.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(E0.lastIndex=0;(s=E0.exec(e))!==null;){const c=new _e(s[1],r),u=c.TYPE;if(u){const d=a[u],f=i[u]||[];i[u]=f;const h=c.LANGUAGE,p=c["ASSOC-LANGUAGE"],m=c.CHANNELS,g=c.CHARACTERISTICS,v=c["INSTREAM-ID"],x={attrs:c,bitrate:0,id:l++,groupId:c["GROUP-ID"]||"",name:c.NAME||h||"",type:u,default:c.bool("DEFAULT"),autoselect:c.bool("AUTOSELECT"),forced:c.bool("FORCED"),lang:h,url:c.URI?Un.resolve(c.URI,t):""};if(p&&(x.assocLang=p),m&&(x.channels=m),g&&(x.characteristics=g),v&&(x.instreamId=v),d!=null&&d.length){const E=Un.findGroup(d,x.groupId)||d[0];w0(x,E,"audioCodec"),w0(x,E,"textCodec")}f.push(x)}}return i}static parseLevelPlaylist(e,t,r,s,i,o){var a;const l={url:t},c=new SP(t),u=c.fragments,d=[];let f=null,h=0,p=0,m=0,g=0,v=0,x=null,E=new Ku(s,l),T,w,L,A=-1,R=!1,C=null,I;if(qu.lastIndex=0,c.m3u8=e,c.hasVariableRefs=p0(e),((a=qu.exec(e))==null?void 0:a[0])!=="#EXTM3U")return c.playlistParsingError=new Error("Missing format identifier #EXTM3U"),c;for(;(T=qu.exec(e))!==null;){R&&(R=!1,E=new Ku(s,l),E.playlistOffset=m,E.setStart(m),E.sn=h,E.cc=g,v&&(E.bitrate=v),E.level=r,f&&(E.initSegment=f,f.rawProgramDateTime&&(E.rawProgramDateTime=f.rawProgramDateTime,f.rawProgramDateTime=null),C&&(E.setByteRange(C),C=null)));const B=T[1];if(B){E.duration=parseFloat(B);const K=(" "+T[2]).slice(1);E.title=K||null,E.tagList.push(K?["INF",B,K]:["INF",B])}else if(T[3]){if(q(E.duration)){E.playlistOffset=m,E.setStart(m),L&&L0(E,L,c),E.sn=h,E.level=r,E.cc=g,u.push(E);const K=(" "+T[3]).slice(1);E.relurl=Ff(c,K),Bf(E,x,d),x=E,m+=E.duration,h++,p=0,R=!0}}else{if(T=T[0].match(_P),!T){me.warn("No matches on slow regex match for level playlist!");continue}for(w=1;w<T.length&&T[w]===void 0;w++);const K=(" "+T[w]).slice(1),U=(" "+T[w+1]).slice(1),H=T[w+2]?(" "+T[w+2]).slice(1):null;switch(K){case"BYTERANGE":x?E.setByteRange(U,x):E.setByteRange(U);break;case"PROGRAM-DATE-TIME":E.rawProgramDateTime=U,E.tagList.push(["PROGRAM-DATE-TIME",U]),A===-1&&(A=u.length);break;case"PLAYLIST-TYPE":c.type&&Zn(c,K,T),c.type=U.toUpperCase();break;case"MEDIA-SEQUENCE":c.startSN!==0?Zn(c,K,T):u.length>0&&I0(c,K,T),h=c.startSN=parseInt(U);break;case"SKIP":{c.skippedSegments&&Zn(c,K,T);const _=new _e(U,c),k=_.decimalInteger("SKIPPED-SEGMENTS");if(q(k)){c.skippedSegments+=k;for(let F=k;F--;)u.push(null);h+=k}const M=_.enumeratedString("RECENTLY-REMOVED-DATERANGES");M&&(c.recentlyRemovedDateranges=(c.recentlyRemovedDateranges||[]).concat(M.split("	")));break}case"TARGETDURATION":c.targetduration!==0&&Zn(c,K,T),c.targetduration=Math.max(parseInt(U),1);break;case"VERSION":c.version!==null&&Zn(c,K,T),c.version=parseInt(U);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":c.live||Zn(c,K,T),c.live=!1;break;case"#":(U||H)&&E.tagList.push(H?[U,H]:[U]);break;case"DISCONTINUITY":g++,E.tagList.push(["DIS"]);break;case"GAP":E.gap=!0,E.tagList.push([K]);break;case"BITRATE":E.tagList.push([K,U]),v=parseInt(U)*1e3,q(v)?E.bitrate=v:v=0;break;case"DATERANGE":{const _=new _e(U,c),k=new US(_,c.dateRanges[_.ID],c.dateRangeTagCount);c.dateRangeTagCount++,k.isValid||c.skippedSegments?c.dateRanges[k.id]=k:me.warn(`Ignoring invalid DATERANGE tag: "${U}"`),E.tagList.push(["EXT-X-DATERANGE",U]);break}case"DEFINE":{{const _=new _e(U,c);"IMPORT"in _?pP(c,_,o):g0(c,_,t)}break}case"DISCONTINUITY-SEQUENCE":c.startCC!==0?Zn(c,K,T):u.length>0&&I0(c,K,T),c.startCC=g=parseInt(U);break;case"KEY":{const _=S0(U,t,c);if(_.isSupported()){if(_.method==="NONE"){L=void 0;break}L||(L={});const k=L[_.keyFormat];k!=null&&k.matches(_)||(k&&(L=Ee({},L)),L[_.keyFormat]=_)}else me.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${U}"`);break}case"START":c.startTimeOffset=T0(U);break;case"MAP":{const _=new _e(U,c);if(E.duration){const k=new Ku(s,l);A0(k,_,r,L),f=k,E.initSegment=f,f.rawProgramDateTime&&!E.rawProgramDateTime&&(E.rawProgramDateTime=f.rawProgramDateTime)}else{const k=E.byteRangeEndOffset;if(k){const M=E.byteRangeStartOffset;C=`${k-M}@${M}`}else C=null;A0(E,_,r,L),f=E,R=!0}f.cc=g;break}case"SERVER-CONTROL":{I&&Zn(c,K,T),I=new _e(U),c.canBlockReload=I.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=I.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&I.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=I.optionalFloat("PART-HOLD-BACK",0),c.holdBack=I.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{c.partTarget&&Zn(c,K,T);const _=new _e(U);c.partTarget=_.decimalFloatingPoint("PART-TARGET");break}case"PART":{let _=c.partList;_||(_=c.partList=[]);const k=p>0?_[_.length-1]:void 0,M=p++,F=new _e(U,c),$=new y_(F,E,l,M,k);_.push($),E.duration+=$.duration;break}case"PRELOAD-HINT":{const _=new _e(U,c);c.preloadHint=_;break}case"RENDITION-REPORT":{const _=new _e(U,c);c.renditionReports=c.renditionReports||[],c.renditionReports.push(_);break}default:me.warn(`line parsed but not handled: ${T}`);break}}}x&&!x.relurl?(u.pop(),m-=x.duration,c.partList&&(c.fragmentHint=x)):c.partList&&(Bf(E,x,d),E.cc=g,c.fragmentHint=E,L&&L0(E,L,c)),c.targetduration||(c.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const P=u.length,O=u[0],V=u[P-1];if(m+=c.skippedSegments*c.targetduration,m>0&&P&&V){c.averagetargetduration=m/P;const B=V.sn;c.endSN=B!=="initSegment"?B:0,c.live||(V.endList=!0),A>0&&(DP(u,A),O&&d.unshift(O))}return c.fragmentHint&&(m+=c.fragmentHint.duration),c.totalduration=m,d.length&&c.dateRangeTagCount&&O&&VS(d,c),c.endCC=g,c}}function VS(n,e){let t=n.length;if(!t)if(e.hasProgramDateTime){const a=e.fragments[e.fragments.length-1];n.push(a),t++}else return;const r=n[t-1],s=e.live?1/0:e.totalduration,i=Object.keys(e.dateRanges);for(let a=i.length;a--;){const l=e.dateRanges[i[a]],c=l.startDate.getTime();l.tagAnchor=r.ref;for(let u=t;u--;){var o;if(((o=n[u])==null?void 0:o.sn)<e.startSN)break;const d=PP(e,c,n,u,s);if(d!==-1){l.tagAnchor=e.fragments[d].ref;break}}}}function PP(n,e,t,r,s){const i=t[r];if(i){const a=i.programDateTime;if(e>=a||r===0){var o;const l=(((o=t[r+1])==null?void 0:o.start)||s)-i.start;if(e<=a+l*1e3){const c=t[r].sn-n.startSN;if(c<0)return-1;const u=n.fragments;if(u.length>t.length){const f=(t[r+1]||u[u.length-1]).sn-n.startSN;for(let h=f;h>c;h--){const p=u[h].programDateTime;if(e>=p&&e<p+u[h].duration*1e3)return h}}return c}}}return-1}function S0(n,e,t){var r,s;const i=new _e(n,t),o=(r=i.METHOD)!=null?r:"",a=i.URI,l=i.hexadecimalInteger("IV"),c=i.KEYFORMATVERSIONS,u=(s=i.KEYFORMAT)!=null?s:"identity";a&&i.IV&&!l&&me.error(`Invalid IV: ${i.IV}`);const d=a?Un.resolve(a,e):"",f=(c||"1").split("/").map(Number).filter(Number.isFinite);return new qc(o,d,u,f,l,i.KEYID)}function T0(n){const t=new _e(n).decimalFloatingPoint("TIME-OFFSET");return q(t)?t:null}function b0(n,e){let t=(n||"").split(/[ ,]+/).filter(r=>r);["video","audio","text"].forEach(r=>{const s=t.filter(i=>mm(i,r));s.length&&(e[`${r}Codec`]=s.map(i=>i.split("/")[0]).join(","),t=t.filter(i=>s.indexOf(i)===-1))}),e.unknownCodecs=t}function w0(n,e,t){const r=e[t];r&&(n[t]=r)}function DP(n,e){let t=n[e];for(let r=e;r--;){const s=n[r];if(!s)return;s.programDateTime=t.programDateTime-s.duration*1e3,t=s}}function Bf(n,e,t){n.rawProgramDateTime?t.push(n):e!=null&&e.programDateTime&&(n.programDateTime=e.endProgramDateTime)}function A0(n,e,t,r){n.relurl=e.URI,e.BYTERANGE&&n.setByteRange(e.BYTERANGE),n.level=t,n.sn="initSegment",r&&(n.levelkeys=r),n.initSegment=null}function L0(n,e,t){n.levelkeys=e;const{encryptedFragments:r}=t;(!r.length||r[r.length-1].levelkeys!==e)&&Object.keys(e).some(s=>e[s].isCommonEncryption)&&r.push(n)}function Zn(n,e,t){n.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function I0(n,e,t){n.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function Qu(n,e){const t=e.startPTS;if(q(t)){let r=0,s;e.sn>n.sn?(r=t-n.start,s=n):(r=n.start-t,s=e),s.duration!==r&&s.setDuration(r)}else e.sn>n.sn?n.cc===e.cc&&n.minEndPTS?e.setStart(n.start+(n.minEndPTS-n.start)):e.setStart(n.start+n.duration):e.setStart(Math.max(n.start-e.duration,0))}function HS(n,e,t,r,s,i,o){r-t<=0&&(o.warn("Fragment should have a positive duration",e),r=t+e.duration,i=s+e.duration);let l=t,c=r;const u=e.startPTS,d=e.endPTS;if(q(u)){const v=Math.abs(u-t);n&&v>n.totalduration?o.warn(`media timestamps and playlist times differ by ${v}s for level ${e.level} ${n.url}`):q(e.deltaPTS)?e.deltaPTS=Math.max(v,e.deltaPTS):e.deltaPTS=v,l=Math.max(t,u),t=Math.min(t,u),s=e.startDTS!==void 0?Math.min(s,e.startDTS):s,c=Math.min(r,d),r=Math.max(r,d),i=e.endDTS!==void 0?Math.max(i,e.endDTS):i}const f=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(r-e.start),e.startPTS=t,e.maxStartPTS=l,e.startDTS=s,e.endPTS=r,e.minEndPTS=c,e.endDTS=i;const h=e.sn;if(!n||h<n.startSN||h>n.endSN)return 0;let p;const m=h-n.startSN,g=n.fragments;for(g[m]=e,p=m;p>0;p--)Qu(g[p],g[p-1]);for(p=m;p<g.length-1;p++)Qu(g[p],g[p+1]);return n.fragmentHint&&Qu(g[g.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,f}function NP(n,e,t){if(n===e)return;let r=null;const s=n.fragments;for(let u=s.length-1;u>=0;u--){const d=s[u].initSegment;if(d){r=d;break}}n.fragmentHint&&delete n.fragmentHint.endPTS;let i;FP(n,e,(u,d,f,h)=>{if((!e.startCC||e.skippedSegments)&&d.cc!==u.cc){const p=u.cc-d.cc;for(let m=f;m<h.length;m++)h[m].cc+=p;e.endCC=h[h.length-1].cc}q(u.startPTS)&&q(u.endPTS)&&(d.setStart(d.startPTS=u.startPTS),d.startDTS=u.startDTS,d.maxStartPTS=u.maxStartPTS,d.endPTS=u.endPTS,d.endDTS=u.endDTS,d.minEndPTS=u.minEndPTS,d.setDuration(u.endPTS-u.startPTS),d.duration&&(i=d),e.PTSKnown=e.alignedSliding=!0),u.hasStreams&&(d.elementaryStreams=u.elementaryStreams),d.loader=u.loader,u.hasStats&&(d.stats=u.stats),u.initSegment&&(d.initSegment=u.initSegment,r=u.initSegment)});const o=e.fragments,a=e.fragmentHint?o.concat(e.fragmentHint):o;if(r&&a.forEach(u=>{var d;u&&(!u.initSegment||u.initSegment.relurl===((d=r)==null?void 0:d.relurl))&&(u.initSegment=r)}),e.skippedSegments){if(e.deltaUpdateFailed=o.some(u=>!u),e.deltaUpdateFailed){t.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let u=e.skippedSegments;u--;)o.shift();e.startSN=o[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=OP(n.dateRanges,e,t));const u=n.fragments.filter(d=>d.rawProgramDateTime);if(n.hasProgramDateTime&&!e.hasProgramDateTime)for(let d=1;d<a.length;d++)a[d].programDateTime===null&&Bf(a[d],a[d-1],u);VS(u,e)}e.endCC=o[o.length-1].cc}if(!e.startCC){var l;const u=WS(n,e.startSN-1);e.startCC=(l=u==null?void 0:u.cc)!=null?l:o[0].cc}MP(n.partList,e.partList,(u,d)=>{d.elementaryStreams=u.elementaryStreams,d.stats=u.stats}),i?HS(e,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS,t):KS(n,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=n.driftStartTime,e.driftStart=n.driftStart;const c=e.advancedDateTime;if(e.advanced&&c){const u=e.edge;e.driftStart||(e.driftStartTime=c,e.driftStart=u),e.driftEndTime=c,e.driftEnd=u}else e.driftEndTime=n.driftEndTime,e.driftEnd=n.driftEnd,e.advancedDateTime=n.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=n.requestScheduled)}function OP(n,e,t){const{dateRanges:r,recentlyRemovedDateranges:s}=e,i=Ee({},n);s&&s.forEach(l=>{delete i[l]});const a=Object.keys(i).length;return a?(Object.keys(r).forEach(l=>{const c=i[l],u=new US(r[l].attr,c);u.isValid?(i[l]=u,c||(u.tagOrder+=a)):t.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${Ie(r[l].attr)}"`)}),i):r}function MP(n,e,t){if(n&&e){let r=0;for(let s=0,i=n.length;s<=i;s++){const o=n[s],a=e[s+r];o&&a&&o.index===a.index&&o.fragment.sn===a.fragment.sn?t(o,a):r--}}}function FP(n,e,t){const r=e.skippedSegments,s=Math.max(n.startSN,e.startSN)-e.startSN,i=(n.fragmentHint?1:0)+(r?e.endSN:Math.min(n.endSN,e.endSN))-e.startSN,o=e.startSN-n.startSN,a=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let c=s;c<=i;c++){const u=l[o+c];let d=a[c];if(r&&!d&&u&&(d=e.fragments[c]=u),u&&d){t(u,d,c,a);const f=u.relurl,h=d.relurl;if(f&&$P(f,h)){e.playlistParsingError=R0(`media sequence mismatch ${d.sn}:`,n,e,u,d);return}else if(u.cc!==d.cc){e.playlistParsingError=R0(`discontinuity sequence mismatch (${u.cc}!=${d.cc})`,n,e,u,d);return}}}}function R0(n,e,t,r,s){return new Error(`${n} ${s.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function KS(n,e,t=!0){const r=e.startSN+e.skippedSegments-n.startSN,s=n.fragments,i=r>=0;let o=0;if(i&&r<s.length)o=s[r].start;else if(i&&e.startSN===n.endSN+1)o=n.fragmentEnd;else if(i&&t)o=n.fragmentStart+r*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)o=n.fragmentStart;else return;Uf(e,o)}function Uf(n,e){if(e){const t=n.fragments;for(let r=n.skippedSegments;r<t.length;r++)t[r].addStart(e);n.fragmentHint&&n.fragmentHint.addStart(e)}}function zS(n,e=1/0){let t=1e3*n.targetduration;if(n.updated){const r=n.fragments;if(r.length&&t*4>e){const i=r[r.length-1].duration*1e3;i<t&&(t=i)}}else t/=2;return Math.round(t)}function WS(n,e,t){if(!n)return null;let r=n.fragments[e-n.startSN];return r||(r=n.fragmentHint,r&&r.sn===e)?r:e<n.startSN&&t&&t.sn===e?t:null}function C0(n,e,t){return n?YS(n.partList,e,t):null}function YS(n,e,t){if(n)for(let r=n.length;r--;){const s=n[r];if(s.index===t&&s.fragment.sn===e)return s}return null}function qS(n){n.forEach((e,t)=>{var r;(r=e.details)==null||r.fragments.forEach(s=>{s.level=t,s.initSegment&&(s.initSegment.level=t)})})}function $P(n,e){return n!==e&&e?k0(n)!==k0(e):!1}function k0(n){return n.replace(/\?[^?]*$/,"")}function Ao(n,e){for(let r=0,s=n.length;r<s;r++){var t;if(((t=n[r])==null?void 0:t.cc)===e)return n[r]}return null}function BP(n,e){return!!(n&&e.startCC<n.endCC&&e.endCC>n.startCC)}function _0(n,e){const t=n.start+e;n.startPTS=t,n.setStart(t),n.endPTS=t+n.duration}function QS(n,e){const t=e.fragments;for(let r=0,s=t.length;r<s;r++)_0(t[r],n);e.fragmentHint&&_0(e.fragmentHint,n),e.alignedSliding=!0}function UP(n,e){n&&(XS(e,n),e.alignedSliding||hc(e,n),!e.alignedSliding&&!e.skippedSegments&&KS(n,e,!1))}function XS(n,e){if(!BP(e,n))return;const t=Math.min(e.endCC,n.endCC),r=Ao(e.fragments,t),s=Ao(n.fragments,t);if(!r||!s)return;me.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const i=r.start-s.start;QS(i,n)}function hc(n,e){if(!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=n.fragments,r=e.fragments;if(!t.length||!r.length)return;let s,i;const o=Math.min(e.endCC,n.endCC);e.startCC<o&&n.startCC<o&&(s=Ao(r,o),i=Ao(t,o)),(!s||!i)&&(s=r[Math.floor(r.length/2)],i=Ao(t,s.cc)||t[Math.floor(t.length/2)]);const a=s.programDateTime,l=i.programDateTime;if(!a||!l)return;const c=(l-a)/1e3-(i.start-s.start);QS(c,n)}function gt(n,e,t){It(n,e,t),n.addEventListener(e,t)}function It(n,e,t){n.removeEventListener(e,t)}const jP={toString:function(n){let e="";const t=n.length;for(let r=0;r<t;r++)e+=`[${n.start(r).toFixed(3)}-${n.end(r).toFixed(3)}]`;return e}},j={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Sm extends $S{constructor(e,t,r,s,i){super(s,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=j.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:o,fragCurrent:a,media:l,mediaBuffer:c,state:u}=this,d=l?l.currentTime:0,f=se.bufferInfo(c||l,d,o.maxBufferHole),h=!f.len;if(this.log(`Media seeking to ${q(d)?d.toFixed(3):d}, state: ${u}, ${h?"out of":"in"} buffer`),this.state===j.ENDED)this.resetLoadingState();else if(a){const p=o.maxFragLookUpTolerance,m=a.start-p,g=a.start+a.duration+p;if(h||g<f.start||m>f.end){const v=d>g;(d<m||v)&&(v&&a.loader&&(this.log(`Cancelling fragment load for seek (sn: ${a.sn})`),a.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(l){this.fragmentTracker.removeFragmentsInRange(d,1/0,this.playlistType,!0);const p=this.lastCurrentTime;if(d>p&&(this.lastCurrentTime=d),!this.loadingParts){const m=Math.max(f.end,d),g=this.shouldLoadParts(this.getLevelDetails(),m);g&&(this.log(`LL-Part loading ON after seeking to ${d.toFixed(2)} with buffer @${m.toFixed(2)}`),this.loadingParts=g)}}this.hls.hasEnoughToStart||(this.log(`Setting ${h?"startPosition":"nextLoadPosition"} to ${d} for seek without enough to start`),this.nextLoadPosition=d,h&&(this.startPosition=d)),h&&this.state===j.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=i,this.hls=e,this.fragmentLoader=new hP(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new vm(e.config)}registerListeners(){const{hls:e}=this;e.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(S.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(S.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===j.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=j.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const r=e.end||0,s=this.config.timelineOffset||0;if(r<=s)return!1;const i=e.buffered;this.config.maxBufferHole&&i&&i.length>1&&(e=se.bufferedInfo(i,e.start,0));const o=e.nextStart;if(o&&o>s&&o<t.edge||this.media.currentTime<e.start)return!1;const l=t.partList;if(l!=null&&l.length){const u=l[l.length-1];return se.isBuffered(this.media,u.start+u.duration/2)}const c=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(c)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const r=this.media=this.mediaBuffer=t.media;gt(r,"seeking",this.onMediaSeeking),gt(r,"ended",this.onMediaEnded);const s=this.config;this.levels&&s.autoStartLoad&&this.state===j.STOPPED&&this.startLoad(s.startPosition)}onMediaDetaching(e,t){const r=!!t.transferMedia,s=this.media;if(s!==null){if(s.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),It(s,"seeking",this.onMediaSeeking),It(s,"ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=j.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this.startFragRequested=!0,this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){const s=i=>{const o=i.frag;if(this.fragContextChanged(o)){this.warn(`${o.type} sn: ${o.sn}${i.part?" part: "+i.part.index:""} of ${this.fragInfo(o,!1,i.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(o);return}o.stats.chunkCount++,this._handleFragmentLoadProgress(i)};this._doFragLoad(e,t,r,s).then(i=>{if(!i)return;const o=this.state,a=i.frag;if(this.fragContextChanged(a)){(o===j.FRAG_LOADING||!this.fragCurrent&&o===j.PARSING)&&(this.fragmentTracker.removeFragment(a),this.state=j.IDLE);return}"payload"in i&&(this.log(`Loaded ${a.type} sn: ${a.sn} of ${this.playlistLabel()} ${a.level}`),this.hls.trigger(S.FRAG_LOADED,i)),this._handleFragmentLoadComplete(i)}).catch(i=>{this.state===j.STOPPED||this.state===j.ERROR||(this.warn(`Frag error: ${(i==null?void 0:i.message)||i}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:r}=this;if(r.getState(e)===ze.APPENDING){const i=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,i),a=Math.max(e.duration,o?o.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(a,e.duration))&&r.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===ze.PARTIAL&&r.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(t==null?void 0:t.live)&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,r=null){if(!(e-t))return;const s={startOffset:e,endOffset:t,type:r};this.hls.trigger(S.BUFFER_FLUSHING,s)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(r=>{const s=r==null?void 0:r.frag;if(!s||this.fragContextChanged(s)||!this.levels)throw new Error("init load aborted");return r}).then(r=>{const{hls:s}=this,{frag:i,payload:o}=r,a=i.decryptdata;if(o&&o.byteLength>0&&a!=null&&a.key&&a.iv&&xi(a.method)){const l=self.performance.now();return this.decrypter.decrypt(new Uint8Array(o),a.key.buffer,a.iv.buffer,xm(a.method)).catch(c=>{throw s.trigger(S.ERROR,{type:J.MEDIA_ERROR,details:N.FRAG_DECRYPT_ERROR,fatal:!1,error:c,reason:c.message,frag:i}),c}).then(c=>{const u=self.performance.now();return s.trigger(S.FRAG_DECRYPTED,{frag:i,payload:c,stats:{tstart:l,tdecrypt:u}}),r.payload=c,this.completeInitSegmentLoad(r)})}return this.completeInitSegmentLoad(r)}).catch(r=>{this.state===j.STOPPED||this.state===j.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const r=e.frag.stats;this.state!==j.STOPPED&&(this.state=j.IDLE),e.frag.data=new Uint8Array(e.payload),r.parsing.start=r.buffering.start=self.performance.now(),r.parsing.end=r.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var r,s;const i=e.tracks;if(i&&!t.encrypted&&((r=i.audio)!=null&&r.encrypted||(s=i.video)!=null&&s.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const o=this.media,a=new Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${o?"attached mediaKeys: "+o.mediaKeys:"detached"})`);return this.warn(a.message),!o||o.mediaKeys?!1:(this.hls.trigger(S.ERROR,{type:J.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_NO_KEYS,fatal:!1,error:a,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${r?jP.toString(se.getBuffered(r)):"(detached)"})`),Ge(e)){var s;if(e.type!==Z.SUBTITLE){const o=e.elementaryStreams;if(!Object.keys(o).some(a=>!!o[a])){this.state=j.IDLE;return}}const i=(s=this.levels)==null?void 0:s[e.level];i!=null&&i.fragmentError&&(this.log(`Resetting level fragment error count of ${i.fragmentError} on frag buffered`),i.fragmentError=0)}this.state=j.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:r,part:s,partsLoaded:i}=e,o=!i||i.length===0||i.some(l=>!l),a=new ym(r.level,r.sn,r.stats.chunkCount+1,0,s?s.index:-1,!o);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,s){var i;this.fragCurrent=e;const o=t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;if(e.encrypted&&!((i=e.decryptdata)!=null&&i.key)){if(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=j.KEY_LOADING,this.fragCurrent=e,a=this.keyLoader.load(e).then(f=>{if(!this.fragContextChanged(f.frag))return this.hls.trigger(S.KEY_LOADED,f),this.state===j.KEY_LOADING&&(this.state=j.IDLE),f}),this.hls.trigger(S.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(a=this.keyLoader.loadClear(e,o.encryptedFragments,this.startFragRequested),a&&this.log("[eme] blocking frag load until media-keys acquired"));const l=this.fragPrevious;if(Ge(e)&&(!l||e.sn!==l.sn)){const f=this.shouldLoadParts(t.details,e.end);f!==this.loadingParts&&(this.log(`LL-Part loading ${f?"ON":"OFF"} loading sn ${l==null?void 0:l.sn}->${e.sn}`),this.loadingParts=f)}if(r=Math.max(e.start,r||0),this.loadingParts&&Ge(e)){const f=o.partList;if(f&&s){r>o.fragmentEnd&&o.fragmentHint&&(e=o.fragmentHint);const h=this.getNextPart(f,e,r);if(h>-1){const p=f[h];e=this.fragCurrent=p.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${p.index} (${h}/${f.length-1}) of ${this.fragInfo(e,!1,p)}) cc: ${e.cc} [${o.startSN}-${o.endSN}], target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=p.start+p.duration,this.state=j.FRAG_LOADING;let m;return a?m=a.then(g=>!g||this.fragContextChanged(g.frag)?null:this.doFragPartsLoad(e,p,t,s)).catch(g=>this.handleFragLoadError(g)):m=this.doFragPartsLoad(e,p,t,s).catch(g=>this.handleFragLoadError(g)),this.hls.trigger(S.FRAG_LOADING,{frag:e,part:p,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):m}else if(!e.url||this.loadedEndOfParts(f,r))return Promise.resolve(null)}}if(Ge(e)&&this.loadingParts){var c;this.log(`LL-Part loading OFF after next part miss @${r.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(c=o.partList)==null?void 0:c.filter(f=>f.loaded).map(f=>`[${f.start}-${f.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+o.startSN+"-"+o.endSN+"]"}, target: ${parseFloat(r.toFixed(3))}`),q(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=j.FRAG_LOADING;const u=this.config.progressive;let d;return u&&a?d=a.then(f=>!f||this.fragContextChanged(f.frag)?null:this.fragmentLoader.load(e,s)).catch(f=>this.handleFragLoadError(f)):d=Promise.all([this.fragmentLoader.load(e,u?s:void 0),a]).then(([f])=>(!u&&s&&s(f),f)).catch(f=>this.handleFragLoadError(f)),this.hls.trigger(S.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):d}doFragPartsLoad(e,t,r,s){return new Promise((i,o)=>{var a;const l=[],c=(a=r.details)==null?void 0:a.partList,u=d=>{this.fragmentLoader.loadPart(e,d,s).then(f=>{l[d.index]=f;const h=f.part;this.hls.trigger(S.FRAG_LOADED,f);const p=C0(r.details,e.sn,d.index+1)||YS(c,e.sn,d.index+1);if(p)u(p);else return i({frag:e,part:h,partsLoaded:l})}).catch(o)};u(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===N.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===J.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetFragmentLoading(t.frag)):this.hls.trigger(S.ERROR,t)}else this.hls.trigger(S.ERROR,{type:J.OTHER_ERROR,details:N.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==j.PARSING){!this.fragCurrent&&this.state!==j.STOPPED&&this.state!==j.ERROR&&(this.state=j.IDLE);return}const{frag:r,part:s,level:i}=t,o=self.performance.now();r.stats.parsing.end=o,s&&(s.stats.parsing.end=o);const a=this.getLevelDetails(),c=a&&r.sn>a.endSN||this.shouldLoadParts(a,r.end);c!==this.loadingParts&&(this.log(`LL-Part loading ${c?"ON":"OFF"} after parsing segment ending @${r.end.toFixed(2)}`),this.loadingParts=c),this.updateLevelTiming(r,s,i,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var r;const i=e.partList[0];if(i.fragment.type===Z.SUBTITLE)return!1;const o=i.end+(((r=e.fragmentHint)==null?void 0:r.duration)||0);if(t>=o){var s;if((this.hls.hasEnoughToStart?((s=this.media)==null?void 0:s.currentTime)||this.lastCurrentTime:this.getLoadPosition())>i.start-i.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:r}=this,{level:s,sn:i,part:o}=e;if(!(t!=null&&t[s]))return this.warn(`Levels object was unset while buffering fragment ${i} of ${this.playlistLabel()} ${s}. The current chunk will not be buffered.`),null;const a=t[s],l=a.details,c=o>-1?C0(l,i,o):null,u=c?c.fragment:WS(l,i,r);return u?(r&&r!==u&&(u.stats=r.stats),{frag:u,part:c,level:a}):null}bufferFragmentData(e,t,r,s,i){if(this.state!==j.PARSING)return;const{data1:o,data2:a}=e;let l=o;if(a&&(l=en(o,a)),!l.length)return;const c=this.initPTS[t.cc],u=c?-c.baseTime/c.timescale:void 0,d={type:e.type,frag:t,part:r,chunkMeta:s,offset:u,parent:t.type,data:l};if(this.hls.trigger(S.BUFFER_APPENDING,d),e.dropped&&e.independent&&!r){if(i)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!se.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const r=t.currentTime,s=se.bufferInfo(t,r,0),i=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,i*.25),a=Math.max(Math.min(e.start-o,s.end-o),r+o);e.start-a>o&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){var r;const s=this.getLoadPosition();if(!q(s))return null;const o=this.lastCurrentTime>s||(r=this.media)!=null&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,s,t,o)}getFwdBufferInfoAtPos(e,t,r,s){const i=se.bufferInfo(e,t,s);if(i.len===0&&i.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,r);if(o&&(i.nextStart<=o.end||o.gap)){const a=Math.max(Math.min(i.nextStart,o.end)-t,s);return se.bufferInfo(e,t,a)}}return i}getMaxBufferLength(e){const{config:t}=this;let r;return e?r=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):r=t.maxBufferLength,Math.min(r,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const r=this.config,s=Math.max(Math.min(e-t,r.maxBufferLength),t),i=Math.max(e-t*3,r.maxMaxBufferLength/2,s);return i>=s?(r.maxMaxBufferLength=i,this.warn(`Reduce max buffer length to ${i}s`),!0):!1}getAppendedFrag(e,t=Z.MAIN){const r=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return r&&"fragment"in r?r.fragment:r}getNextFragment(e,t){const r=t.fragments,s=r.length;if(!s)return null;const{config:i}=this,o=r[0].start,a=i.lowLatencyMode&&!!t.partList;let l=null;if(t.live){const d=i.initialLiveManifestSize;if(s<d)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${d})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o){var c;a&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),l=this.getInitialLiveFragment(t);const f=this.hls.startPosition,h=this.hls.liveSyncPosition,p=l?(f!==-1&&f>=o?f:h)||l.start:e;this.log(`Setting startPosition to ${p} to match start frag at live edge. mainStart: ${f} liveSyncPosition: ${h} frag.start: ${(c=l)==null?void 0:c.start}`),this.startPosition=this.nextLoadPosition=p}}else e<=o&&(l=r[0]);if(!l){const d=this.loadingParts?t.partEnd:t.fragmentEnd;l=this.getFragmentAtPosition(e,d,t)}let u=this.filterReplacedPrimary(l,t);if(!u&&l){const d=l.sn-t.startSN;u=this.filterReplacedPrimary(r[d+1]||null,t)}return this.mapToInitFragWhenRequired(u)}isLoopLoading(e,t){const r=this.fragmentTracker.getState(e);return(r===ze.OK||r===ze.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,s,i){let o=null;if(e.gap&&(o=this.getNextFragment(this.nextLoadPosition,t),o&&!o.gap&&r.nextStart)){const a=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,s,0);if(a!==null&&r.len+a.len>=i){const l=o.sn;return this.loopSn!==l&&(this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${l}`),this.loopSn=l),null}}return this.loopSn=void 0,o}get primaryPrefetch(){if(P0(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(P0(this.config)&&e.type!==Z.SUBTITLE){const r=this.hls.interstitialsManager,s=r==null?void 0:r.bufferingItem;if(s){const o=s.event;if(o){if(o.appendInPlace||Math.abs(e.start-s.start)>1||s.start===0)return null}else if(e.end<=s.start&&(t==null?void 0:t.live)===!1||e.start>s.end&&s.nextEvent&&(s.nextEvent.appendInPlace||e.start-s.end>1))return null}const i=r==null?void 0:r.playerQueue;if(i)for(let o=i.length;o--;){const a=i[o].interstitial;if(a.appendInPlace&&e.start>=a.startTime&&e.end<=a.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,r){let s=-1,i=!1,o=!0;for(let a=0,l=e.length;a<l;a++){const c=e[a];if(o=o&&!c.independent,s>-1&&r<c.start)break;const u=c.loaded;u?s=-1:(i||(c.independent||o)&&c.fragment===t)&&(c.fragment!==t&&this.warn(`Need buffer at ${r} but next unloaded part starts at ${c.start}`),s=a),i=u}return s}loadedEndOfParts(e,t){let r;for(let s=e.length;s--;){if(r=e[s],!r.loaded)return!1;if(t>r.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,r=this.fragPrevious;let s=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),s=tP(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const i=r.sn+1;if(i>=e.startSN&&i<=e.endSN){const o=t[i-e.startSN];r.cc===o.cc&&(s=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=FS(e,r.cc,r.end),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const i=this.hls.liveSyncPosition;i!==null&&(s=this.getFragmentAtPosition(i,this.bitrateTest?e.fragmentEnd:e.edge,e))}return s}getFragmentAtPosition(e,t,r){const{config:s}=this;let{fragPrevious:i}=this,{fragments:o,endSN:a}=r;const{fragmentHint:l}=r,{maxFragLookUpTolerance:c}=s,u=r.partList,d=!!(this.loadingParts&&u!=null&&u.length&&l);d&&!this.bitrateTest&&u[u.length-1].fragment.sn===l.sn&&(o=o.concat(l),a=l.sn);let f;if(e<t){var h;const m=e<this.lastCurrentTime||e>t-c||(h=this.media)!=null&&h.paused||!this.startFragRequested?0:c;f=Ns(i,o,e,m)}else f=o[o.length-1];if(f){const p=f.sn-r.startSN,m=this.fragmentTracker.getState(f);if((m===ze.OK||m===ze.PARTIAL&&f.gap)&&(i=f),i&&f.sn===i.sn&&(!d||u[0].fragment.sn>f.sn||!r.live)&&f.level===i.level){const v=o[p+1];f.sn<a&&this.fragmentTracker.getState(v)!==ze.OK?f=v:f=null}}return f}alignPlaylists(e,t,r){const s=e.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;const i=e.fragmentStart,o=!t,a=e.alignedSliding&&q(i);if(o||!a&&!i){UP(r,e);const l=e.fragmentStart;return this.log(`Live playlist sliding: ${l.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${s}`),l}return i}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let r=this.startPosition;r<t&&(r=-1);const s=this.timelineOffset;if(r===-1){const i=this.startTimeOffset!==null,o=i?this.startTimeOffset:e.startTimeOffset;o!==null&&q(o)?(r=t+o,o<0&&(r+=e.edge),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Setting startPosition to ${r} for start time offset ${o} found in ${i?"multivariant":"media"} playlist`),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${r}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+s}this.nextLoadPosition=r+s}getLoadPosition(){var e;const{media:t}=this;let r=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?r=t.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&Ge(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==j.FRAG_LOADING_WAITING_RETRY)&&(this.state=j.IDLE)}onFragmentOrKeyLoadError(e,t){var r;if(t.chunkMeta&&!t.frag){const v=this.getCurrentContext(t.chunkMeta);v&&(t.frag=v.frag)}const s=t.frag;if(!s||s.type!==e||!this.levels)return;if(this.fragContextChanged(s)){var i;this.warn(`Frag load error must match current frag to retry ${s.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const o=t.details===N.FRAG_GAP;o&&this.fragmentTracker.fragBuffered(s,!0);const a=t.errorAction;if(!a){this.state=j.ERROR;return}const{action:l,flags:c,retryCount:u=0,retryConfig:d}=a,f=!!d,h=f&&l===rt.RetryRequest,p=f&&!a.resolved&&c===Pt.MoveAllAlternatesMatchingHost,m=(r=this.hls.latestLevelDetails)==null?void 0:r.live;if(!h&&p&&Ge(s)&&!s.endList&&m)this.resetFragmentErrors(e),this.treatAsGap(s),a.resolved=!0;else if((h||p)&&u<d.maxNumRetry){var g;const v=Mf((g=t.response)==null?void 0:g.code),x=gm(d,u);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+x,this.state=j.FRAG_LOADING_WAITING_RETRY,a.resolved=!0,v){this.log("Waiting for connection (offline)"),this.retryDate=1/0,t.reason="offline";return}this.warn(`Fragment ${s.sn} of ${e} ${s.level} errored with ${t.details}, retrying loading ${u+1}/${d.maxNumRetry} in ${x}ms`)}else if(d)if(this.resetFragmentErrors(e),u<d.maxNumRetry)!o&&l!==rt.RemoveAlternatePermanently&&(a.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${u})`);return}else l===rt.SendAlternateToPenaltyBox?this.state=j.WAITING_LEVEL:this.state=j.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,r=t===1/0;(!t||e>=t||r&&!Mf(0))&&(r&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=j.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===j.PARSING||this.state===j.PARSED){const t=e.frag,r=e.parent,s=this.getFwdBufferInfo(this.mediaBuffer,r),i=s&&s.len>.5;i&&this.reduceMaxBufferLength(s.len,(t==null?void 0:t.duration)||10);const o=!i;return o&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${r} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===Z.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==j.STOPPED&&(this.state=j.IDLE)}afterBufferFlushed(e,t,r){if(!e)return;const s=se.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,s,r),this.state===j.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==j.STOPPED&&(this.state=j.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,s){const i=r.details;if(!i){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,c)=>{const u=e.elementaryStreams[c];if(u){const d=u.endPTS-u.startPTS;if(d<=0)return this.warn(`Could not parse fragment ${e.sn} ${c} duration reliably (${d})`),l||!1;const f=s?0:HS(i,e,u.startPTS,u.endPTS,u.startDTS,u.endDTS,this);return this.hls.trigger(S.LEVEL_PTS_UPDATED,{details:i,level:r,drift:f,type:c,frag:e,start:u.startPTS,end:u.endPTS}),!0}return l},!1)){var a;if(r.fragmentError===0&&this.treatAsGap(e,r),((a=this.transmuxer)==null?void 0:a.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(S.ERROR,{type:J.MEDIA_ERROR,details:N.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=j.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(S.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===Z.MAIN?"level":"track"}fragInfo(e,t=!0,r){var s,i;return`${this.playlistLabel()} ${e.level} (${r?"part":"frag"}:[${((s=t&&!r?e.startPTS:(r||e).start)!=null?s:NaN).toFixed(3)}-${((i=t&&!r?e.endPTS:(r||e).end)!=null?i:NaN).toFixed(3)}]${r&&e.type==="main"?"INDEPENDENT="+(r.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function P0(n){return!!n.interstitialsController&&n.enableInterstitialPlayback!==!1}class ZS{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let r;if(e.length)e.length===1?r=e[0]:r=GP(e,t);else return new Uint8Array(0);return this.reset(),r}reset(){this.chunks.length=0,this.dataLength=0}}function GP(n,e){const t=new Uint8Array(e);let r=0;for(let s=0;s<n.length;s++){const i=n[s];t.set(i,r),r+=i.length}return t}var Xu={exports:{}},D0;function VP(){return D0||(D0=1,function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new s(u,d||l,f),p=t?t+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],h]:l._events[p].push(h):(l._events[p]=h,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=t?t+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},a.prototype.listenerCount=function(c){var u=t?t+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,f,h,p){var m=t?t+c:c;if(!this._events[m])return!1;var g=this._events[m],v=arguments.length,x,E;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),v){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,d),!0;case 4:return g.fn.call(g.context,u,d,f),!0;case 5:return g.fn.call(g.context,u,d,f,h),!0;case 6:return g.fn.call(g.context,u,d,f,h,p),!0}for(E=1,x=new Array(v-1);E<v;E++)x[E-1]=arguments[E];g.fn.apply(g.context,x)}else{var T=g.length,w;for(E=0;E<T;E++)switch(g[E].once&&this.removeListener(c,g[E].fn,void 0,!0),v){case 1:g[E].fn.call(g[E].context);break;case 2:g[E].fn.call(g[E].context,u);break;case 3:g[E].fn.call(g[E].context,u,d);break;case 4:g[E].fn.call(g[E].context,u,d,f);break;default:if(!x)for(w=1,x=new Array(v-1);w<v;w++)x[w-1]=arguments[w];g[E].fn.apply(g[E].context,x)}}return!0},a.prototype.on=function(c,u,d){return i(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return i(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,f){var h=t?t+c:c;if(!this._events[h])return this;if(!u)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===u&&(!f||p.once)&&(!d||p.context===d)&&o(this,h);else{for(var m=0,g=[],v=p.length;m<v;m++)(p[m].fn!==u||f&&!p[m].once||d&&p[m].context!==d)&&g.push(p[m]);g.length?this._events[h]=g.length===1?g[0]:g:o(this,h)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=t?t+c:c,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,n.exports=a}(Xu)),Xu.exports}var HP=VP(),Tm=g_(HP);const Zo="1.6.11",ji={};function KP(){return typeof __HLS_WORKER_BUNDLE__=="function"}function zP(){const n=ji[Zo];if(n)return n.clientCount++,n;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),s={worker:new self.Worker(t),objectURL:t,clientCount:1};return ji[Zo]=s,s}function WP(n){const e=ji[n];if(e)return e.clientCount++,e;const t=new self.URL(n,self.location.href).href,s={worker:new self.Worker(t),scriptURL:t,clientCount:1};return ji[n]=s,s}function YP(n){const e=ji[n||Zo];if(e&&e.clientCount--===1){const{worker:r,objectURL:s}=e;delete ji[n||Zo],s&&self.URL.revokeObjectURL(s),r.terminate()}}function JS(n,e){return e+10<=n.length&&n[e]===51&&n[e+1]===68&&n[e+2]===73&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128}function bm(n,e){return e+10<=n.length&&n[e]===73&&n[e+1]===68&&n[e+2]===51&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128}function Qc(n,e){let t=0;return t=(n[e]&127)<<21,t|=(n[e+1]&127)<<14,t|=(n[e+2]&127)<<7,t|=n[e+3]&127,t}function Jo(n,e){const t=e;let r=0;for(;bm(n,e);){r+=10;const s=Qc(n,e+6);r+=s,JS(n,e+10)&&(r+=10),e+=r}if(r>0)return n.subarray(t,t+r)}function qP(n,e,t,r){const s=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=e[t+2],o=i>>2&15;if(o>12){const h=new Error(`invalid ADTS sampling index:${o}`);n.emit(S.ERROR,S.ERROR,{type:J.MEDIA_ERROR,details:N.FRAG_PARSING_ERROR,fatal:!0,error:h,reason:h.message});return}const a=(i>>6&3)+1,l=e[t+3]>>6&3|(i&1)<<2,c="mp4a.40."+a,u=s[o];let d=o;(a===5||a===29)&&(d-=3);const f=[a<<3|(d&14)>>1,(d&1)<<7|l<<3];return me.log(`manifest codec:${r}, parsed codec:${c}, channels:${l}, rate:${u} (ADTS object type:${a} sampling index:${o})`),{config:f,samplerate:u,channelCount:l,codec:c,parsedCodec:c,manifestCodec:r}}function eT(n,e){return n[e]===255&&(n[e+1]&246)===240}function tT(n,e){return n[e+1]&1?7:9}function wm(n,e){return(n[e+3]&3)<<11|n[e+4]<<3|(n[e+5]&224)>>>5}function QP(n,e){return e+5<n.length}function mc(n,e){return e+1<n.length&&eT(n,e)}function XP(n,e){return QP(n,e)&&eT(n,e)&&wm(n,e)<=n.length-e}function ZP(n,e){if(mc(n,e)){const t=tT(n,e);if(e+t>=n.length)return!1;const r=wm(n,e);if(r<=t)return!1;const s=e+r;return s===n.length||mc(n,s)}return!1}function nT(n,e,t,r,s){if(!n.samplerate){const i=qP(e,t,r,s);if(!i)return;Ee(n,i)}}function rT(n){return 1024*9e4/n}function JP(n,e){const t=tT(n,e);if(e+t<=n.length){const r=wm(n,e)-t;if(r>0)return{headerLength:t,frameLength:r}}}function sT(n,e,t,r,s){const i=rT(n.samplerate),o=r+s*i,a=JP(e,t);let l;if(a){const{frameLength:d,headerLength:f}=a,h=f+d,p=Math.max(0,t+h-e.length);p?(l=new Uint8Array(h-f),l.set(e.subarray(t+f,e.length),0)):l=e.subarray(t+f,t+h);const m={unit:l,pts:o};return p||n.samples.push(m),{sample:m,length:h,missing:p}}const c=e.length-t;return l=new Uint8Array(c),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:o},length:c,missing:-1}}function eD(n,e){return bm(n,e)&&Qc(n,e+6)+10<=n.length-e}function tD(n){return n instanceof ArrayBuffer?n:n.byteOffset==0&&n.byteLength==n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer}function Zu(n,e=0,t=1/0){return nD(n,e,t,Uint8Array)}function nD(n,e,t,r){const s=rD(n);let i=1;"BYTES_PER_ELEMENT"in r&&(i=r.BYTES_PER_ELEMENT);const o=sD(n)?n.byteOffset:0,a=(o+n.byteLength)/i,l=(o+e)/i,c=Math.floor(Math.max(0,Math.min(l,a))),u=Math.floor(Math.min(c+Math.max(t,0),a));return new r(s,c,u-c)}function rD(n){return n instanceof ArrayBuffer?n:n.buffer}function sD(n){return n&&n.buffer instanceof ArrayBuffer&&n.byteLength!==void 0&&n.byteOffset!==void 0}function iD(n){const e={key:n.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(n.size<2)return;if(n.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const r=n.data.subarray(1).indexOf(0);if(r===-1)return;const s=Ut(Zu(n.data,1,r)),i=n.data[2+r],o=n.data.subarray(3+r).indexOf(0);if(o===-1)return;const a=Ut(Zu(n.data,3+r,o));let l;return s==="-->"?l=Ut(Zu(n.data,4+r+o)):l=tD(n.data.subarray(4+r+o)),e.mimeType=s,e.pictureType=i,e.description=a,e.data=l,e}function oD(n){if(n.size<2)return;const e=Ut(n.data,!0),t=new Uint8Array(n.data.subarray(e.length+1));return{key:n.type,info:e,data:t.buffer}}function aD(n){if(n.size<2)return;if(n.type==="TXXX"){let t=1;const r=Ut(n.data.subarray(t),!0);t+=r.length+1;const s=Ut(n.data.subarray(t));return{key:n.type,info:r,data:s}}const e=Ut(n.data.subarray(1));return{key:n.type,info:"",data:e}}function lD(n){if(n.type==="WXXX"){if(n.size<2)return;let t=1;const r=Ut(n.data.subarray(t),!0);t+=r.length+1;const s=Ut(n.data.subarray(t));return{key:n.type,info:r,data:s}}const e=Ut(n.data);return{key:n.type,info:"",data:e}}function cD(n){return n.type==="PRIV"?oD(n):n.type[0]==="W"?lD(n):n.type==="APIC"?iD(n):aD(n)}function uD(n){const e=String.fromCharCode(n[0],n[1],n[2],n[3]),t=Qc(n,4),r=10;return{type:e,size:t,data:n.subarray(r,r+t)}}const Va=10,dD=10;function iT(n){let e=0;const t=[];for(;bm(n,e);){const r=Qc(n,e+6);n[e+5]>>6&1&&(e+=Va),e+=Va;const s=e+r;for(;e+dD<s;){const i=uD(n.subarray(e)),o=cD(i);o&&t.push(o),e+=i.size+Va}JS(n,e)&&(e+=Va)}return t}function oT(n){return n&&n.key==="PRIV"&&n.info==="com.apple.streaming.transportStreamTimestamp"}function fD(n){if(n.data.byteLength===8){const e=new Uint8Array(n.data),t=e[3]&1;let r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,t&&(r+=4772185884e-2),Math.round(r)}}function Am(n){const e=iT(n);for(let t=0;t<e.length;t++){const r=e[t];if(oT(r))return fD(r)}}let Mt=function(n){return n.audioId3="org.id3",n.dateRange="com.apple.quicktime.HLS",n.emsg="https://aomedia.org/emsg/ID3",n.misbklv="urn:misb:KLV:bin:1910.1",n}({});function On(n="",e=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Lm{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){this.cachedData&&(e=en(this.cachedData,e),this.cachedData=null);let r=Jo(e,0),s=r?r.length:0,i;const o=this._audioTrack,a=this._id3Track,l=r?Am(r):void 0,c=e.length;for((this.basePTS===null||this.frameIndex===0&&q(l))&&(this.basePTS=hD(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Mt.audioId3,duration:Number.POSITIVE_INFINITY});s<c;){if(this.canParse(e,s)){const u=this.appendFrame(o,e,s);u?(this.frameIndex++,this.lastPTS=u.sample.pts,s+=u.length,i=s):s=c}else eD(e,s)?(r=Jo(e,s),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Mt.audioId3,duration:Number.POSITIVE_INFINITY}),s+=r.length,i=s):s++;if(s===c&&i!==c){const u=e.slice(i);this.cachedData?this.cachedData=en(this.cachedData,u):this.cachedData=u}}return{audioTrack:o,videoTrack:On(),id3Track:a,textTrack:On()}}demuxSampleAes(e,t,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:On(),id3Track:this._id3Track,textTrack:On()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const hD=(n,e,t)=>{if(q(n))return n*90;const r=t?t.baseTime*9e4/t.timescale:0;return e*9e4+r};let Ha=null;const mD=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],pD=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],gD=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],vD=[0,1,1,4];function aT(n,e,t,r,s){if(t+24>e.length)return;const i=lT(e,t);if(i&&t+i.frameLength<=e.length){const o=i.samplesPerFrame*9e4/i.sampleRate,a=r+s*o,l={unit:e.subarray(t,t+i.frameLength),pts:a,dts:a};return n.config=[],n.channelCount=i.channelCount,n.samplerate=i.sampleRate,n.samples.push(l),{sample:l,length:i.frameLength,missing:0}}}function lT(n,e){const t=n[e+1]>>3&3,r=n[e+1]>>1&3,s=n[e+2]>>4&15,i=n[e+2]>>2&3;if(t!==1&&s!==0&&s!==15&&i!==3){const o=n[e+2]>>1&1,a=n[e+3]>>6,l=t===3?3-r:r===3?3:4,c=mD[l*14+s-1]*1e3,d=pD[(t===3?0:t===2?1:2)*3+i],f=a===3?1:2,h=gD[t][r],p=vD[r],m=h*8*p,g=Math.floor(h*c/d+o)*p;if(Ha===null){const E=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ha=E?parseInt(E[1]):0}return!!Ha&&Ha<=87&&r===2&&c>=224e3&&a===0&&(n[e+3]=n[e+3]|128),{sampleRate:d,channelCount:f,frameLength:g,samplesPerFrame:m}}}function Im(n,e){return n[e]===255&&(n[e+1]&224)===224&&(n[e+1]&6)!==0}function cT(n,e){return e+1<n.length&&Im(n,e)}function yD(n,e){return Im(n,e)&&4<=n.length-e}function uT(n,e){if(e+1<n.length&&Im(n,e)){const r=lT(n,e);let s=4;r!=null&&r.frameLength&&(s=r.frameLength);const i=e+s;return i===n.length||cT(n,i)}return!1}class xD extends Lm{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const r=Jo(e,0);let s=(r==null?void 0:r.length)||0;if(uT(e,s))return!1;for(let i=e.length;s<i;s++)if(ZP(e,s))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return XP(e,t)}appendFrame(e,t,r){nT(e,this.observer,t,r,e.manifestCodec);const s=sT(e,t,r,this.basePTS,this.frameIndex);if(s&&s.missing===0)return s}}const dT=(n,e)=>{let t=0,r=5;e+=r;const s=new Uint32Array(1),i=new Uint32Array(1),o=new Uint8Array(1);for(;r>0;){o[0]=n[e];const a=Math.min(r,8),l=8-a;i[0]=4278190080>>>24+l<<l,s[0]=(o[0]&i[0])>>l,t=t?t<<a|s[0]:s[0],e+=1,r-=a}return t};class ED extends Lm{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,r){const s=fT(e,t,r,this.basePTS,this.frameIndex);if(s!==-1)return{sample:e.samples[e.samples.length-1],length:s,missing:0}}static probe(e){if(!e)return!1;const t=Jo(e,0);if(!t)return!1;const r=t.length;return e[r]===11&&e[r+1]===119&&Am(t)!==void 0&&dT(e,r)<16}}function fT(n,e,t,r,s){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const i=e[t+4]>>6;if(i>=3)return-1;const a=[48e3,44100,32e3][i],l=e[t+4]&63,u=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+i]*2;if(t+u>e.length)return-1;const d=e[t+6]>>5;let f=0;d===2?f+=2:(d&1&&d!==1&&(f+=2),d&4&&(f+=2));const h=(e[t+6]<<8|e[t+7])>>12-f&1,m=[2,1,2,3,3,4,4,5][d]+h,g=e[t+5]>>3,v=e[t+5]&7,x=new Uint8Array([i<<6|g<<1|v>>2,(v&3)<<6|d<<3|h<<2|l>>4,l<<4&224]),E=1536/a*9e4,T=r+s*E,w=e.subarray(t,t+u);return n.config=x,n.channelCount=m,n.samplerate=a,n.samples.push({unit:w,pts:T}),u}class SD extends Lm{resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Jo(e,0);let r=(t==null?void 0:t.length)||0;if(t&&e[r]===11&&e[r+1]===119&&Am(t)!==void 0&&dT(e,r)<=16)return!1;for(let s=e.length;r<s;r++)if(uT(e,r))return me.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return yD(e,t)}appendFrame(e,t,r){if(this.basePTS!==null)return aT(e,t,r,this.basePTS,this.frameIndex)}}const TD=/\/emsg[-/]ID3/i;class bD{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,s){const i=this.videoTrack=On("video",1),o=this.audioTrack=On("audio",1),a=this.txtTrack=On("text",1);if(this.id3Track=On("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=IS(e);if(l.video){const{id:c,timescale:u,codec:d,supplemental:f}=l.video;i.id=c,i.timescale=a.timescale=u,i.codec=d,i.supplemental=f}if(l.audio){const{id:c,timescale:u,codec:d}=l.audio;o.id=c,o.timescale=u,o.codec=d}a.id=wS.text,i.sampleDuration=0,i.duration=o.duration=s}resetContiguity(){this.remainderData=null}static probe(e){return S_(e)}demux(e,t){this.timeOffset=t;let r=e;const s=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=en(this.remainderData,e));const a=I_(r);this.remainderData=a.remainder,s.samples=a.valid||new Uint8Array}else s.samples=r;const o=this.extractID3Track(s,t);return i.samples=Zg(t,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(t,this.timeOffset);return r.samples=Zg(e,t),{videoTrack:t,audioTrack:On(),id3Track:s,textTrack:On()}}extractID3Track(e,t){const r=this.id3Track;if(e.samples.length){const s=le(e.samples,["emsg"]);s&&s.forEach(i=>{const o=C_(i);if(TD.test(o.schemeIdUri)){const a=N0(o,t);let l=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const c=o.payload;r.samples.push({data:c,len:c.byteLength,dts:a,pts:a,type:Mt.emsg,duration:l})}else if(this.config.enableEmsgKLVMetadata&&o.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const a=N0(o,t);r.samples.push({data:o.payload,len:o.payload.byteLength,dts:a,pts:a,type:Mt.misbklv,duration:Number.POSITIVE_INFINITY})}})}return r}demuxSampleAes(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function N0(n,e){return q(n.presentationTime)?n.presentationTime/n.timeScale:e+n.presentationTimeDelta/n.timeScale}class wD{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new vm(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,ns.cbc)}decryptAacSample(e,t,r){const s=e[t].unit;if(s.length<=16)return;const i=s.subarray(16,s.length-s.length%16),o=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(o).then(a=>{const l=new Uint8Array(a);s.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)}).catch(r)}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length){r();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,r=new Int8Array(t);let s=0;for(let i=32;i<e.length-16;i+=160,s+=16)r.set(e.subarray(i,i+16),s);return r}getAvcDecryptedUnit(e,t){const r=new Uint8Array(t);let s=0;for(let i=32;i<e.length-16;i+=160,s+=16)e.set(r.subarray(s,s+16),i);return e}decryptAvcSample(e,t,r,s,i){const o=CS(i.data),a=this.getAvcEncryptedData(o);this.decryptBuffer(a.buffer).then(l=>{i.data=this.getAvcDecryptedUnit(o,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,s)}).catch(s)}decryptAvcSamples(e,t,r,s){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length){s();return}const i=e[t].units;for(;!(r>=i.length);r++){const o=i[r];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,r,s,o),!this.decrypter.isSync()))return}}}}class hT{constructor(){this.VideoSample=null}createVideoSample(e,t,r){return{key:e,frame:!1,pts:t,dts:r,units:[],length:0}}getLastNalUnit(e){var t;let r=this.VideoSample,s;if((!r||r.units.length===0)&&(r=e[e.length-1]),(t=r)!=null&&t.units){const i=r.units;s=i[i.length-1]}return s}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const r=t.samples,s=r.length;if(s){const i=r[s-1];e.pts=i.pts,e.dts=i.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,r){const s=t.byteLength;let i=e.naluState||0;const o=i,a=[];let l=0,c,u,d,f=-1,h=0;for(i===-1&&(f=0,h=this.getNALuType(t,0),i=0,l=1);l<s;){if(c=t[l++],!i){i=c?0:1;continue}if(i===1){i=c?0:2;continue}if(!c)i=3;else if(c===1){if(u=l-i-1,f>=0){const p={data:t.subarray(f,u),type:h};a.push(p)}else{const p=this.getLastNalUnit(e.samples);p&&(o&&l<=4-o&&p.state&&(p.data=p.data.subarray(0,p.data.byteLength-o)),u>0&&(p.data=en(p.data,t.subarray(0,u)),p.state=0))}l<s?(d=this.getNALuType(t,l),f=l,h=d,i=0):i=-1}else i=0}if(f>=0&&i>=0){const p={data:t.subarray(f,s),type:h,state:i};a.push(p)}if(a.length===0){const p=this.getLastNalUnit(e.samples);p&&(p.data=en(p.data,t))}return e.naluState=i,a}}class Lo{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,s=new Uint8Array(4),i=Math.min(4,t);if(i===0)throw new Error("no bytes available");s.set(e.subarray(r,r+i)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=i*8,this.bytesAvailable-=i}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32&&me.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class AD extends hT{parsePES(e,t,r,s){const i=this.parseNALu(e,r.data,s);let o=this.VideoSample,a,l=!1;r.data=null,o&&i.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),i.forEach(c=>{var u,d;switch(c.type){case 1:{let m=!1;a=!0;const g=c.data;if(l&&g.length>4){const v=this.readSliceType(g);(v===2||v===4||v===7||v===9)&&(m=!0)}if(m){var f;(f=o)!=null&&f.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.frame=!0,o.key=m;break}case 5:a=!0,(u=o)!=null&&u.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.key=!0,o.frame=!0;break;case 6:{a=!0,hm(c.data,1,r.pts,t.samples);break}case 7:{var h,p;a=!0,l=!0;const m=c.data,g=this.readSPS(m);if(!e.sps||e.width!==g.width||e.height!==g.height||((h=e.pixelRatio)==null?void 0:h[0])!==g.pixelRatio[0]||((p=e.pixelRatio)==null?void 0:p[1])!==g.pixelRatio[1]){e.width=g.width,e.height=g.height,e.pixelRatio=g.pixelRatio,e.sps=[m];const v=m.subarray(1,4);let x="avc1.";for(let E=0;E<3;E++){let T=v[E].toString(16);T.length<2&&(T="0"+T),x+=T}e.codec=x}break}case 8:a=!0,e.pps=[c.data];break;case 9:a=!0,e.audFound=!0,(d=o)!=null&&d.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;case 12:a=!0;break;default:a=!1;break}o&&a&&o.units.push(c)}),s&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new Lo(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let r=8,s=8,i;for(let o=0;o<e;o++)s!==0&&(i=t.readEG(),s=(r+i+256)%256),r=s===0?r:s}readSPS(e){const t=new Lo(e);let r=0,s=0,i=0,o=0,a,l,c;const u=t.readUByte.bind(t),d=t.readBits.bind(t),f=t.readUEG.bind(t),h=t.readBoolean.bind(t),p=t.skipBits.bind(t),m=t.skipEG.bind(t),g=t.skipUEG.bind(t),v=this.skipScalingList.bind(this);u();const x=u();if(d(5),p(3),u(),g(),x===100||x===110||x===122||x===244||x===44||x===83||x===86||x===118||x===128){const R=f();if(R===3&&p(1),g(),g(),p(1),h())for(l=R!==3?8:12,c=0;c<l;c++)h()&&(c<6?v(16,t):v(64,t))}g();const E=f();if(E===0)f();else if(E===1)for(p(1),m(),m(),a=f(),c=0;c<a;c++)m();g(),p(1);const T=f(),w=f(),L=d(1);L===0&&p(1),p(1),h()&&(r=f(),s=f(),i=f(),o=f());let A=[1,1];if(h()&&h())switch(u()){case 1:A=[1,1];break;case 2:A=[12,11];break;case 3:A=[10,11];break;case 4:A=[16,11];break;case 5:A=[40,33];break;case 6:A=[24,11];break;case 7:A=[20,11];break;case 8:A=[32,11];break;case 9:A=[80,33];break;case 10:A=[18,11];break;case 11:A=[15,11];break;case 12:A=[64,33];break;case 13:A=[160,99];break;case 14:A=[4,3];break;case 15:A=[3,2];break;case 16:A=[2,1];break;case 255:{A=[u()<<8|u(),u()<<8|u()];break}}return{width:Math.ceil((T+1)*16-r*2-s*2),height:(2-L)*(w+1)*16-(L?2:4)*(i+o),pixelRatio:A}}}class LD extends hT{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,r,s){const i=this.parseNALu(e,r.data,s);let o=this.VideoSample,a,l=!1;r.data=null,o&&i.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),i.forEach(c=>{var u,d;switch(c.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:o||(o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),o.frame=!0,a=!0;break;case 16:case 17:case 18:case 21:if(a=!0,l){var f;(f=o)!=null&&f.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.key=!0,o.frame=!0;break;case 19:case 20:a=!0,(u=o)!=null&&u.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.key=!0,o.frame=!0;break;case 39:a=!0,hm(c.data,2,r.pts,t.samples);break;case 32:a=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Ee(e.params,this.readVPS(c.data)),this.initVPS=c.data),e.vps=[c.data];break;case 33:if(a=!0,l=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],c.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const h=this.readSPS(c.data);e.width=h.width,e.height=h.height,e.pixelRatio=h.pixelRatio,e.codec=h.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const p in h.params)e.params[p]=h.params[p]}this.pushParameterSet(e.sps,c.data,e.vps),o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.key=!0;break;case 34:if(a=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const h=this.readPPS(c.data);for(const p in h)e.params[p]=h[p]}this.pushParameterSet(e.pps,c.data,e.vps)}break;case 35:a=!0,e.audFound=!0,(d=o)!=null&&d.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;default:a=!1;break}o&&a&&o.units.push(c)}),s&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}pushParameterSet(e,t,r){(r&&r[0]===this.initVPS||!r&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let r=0;for(let s=0;s<e.byteLength;s++)s>=2&&e[s]===3&&e[s-1]===0&&e[s-2]===0||(t[r]=e[s],r++);return new Uint8Array(t.buffer,0,r)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new Lo(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const r=t.readBits(3),s=t.readBoolean();return{numTemporalLayers:r+1,temporalIdNested:s}}readSPS(e){const t=new Lo(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const r=t.readBits(3);t.readBoolean();const s=t.readBits(2),i=t.readBoolean(),o=t.readBits(5),a=t.readUByte(),l=t.readUByte(),c=t.readUByte(),u=t.readUByte(),d=t.readUByte(),f=t.readUByte(),h=t.readUByte(),p=t.readUByte(),m=t.readUByte(),g=t.readUByte(),v=t.readUByte(),x=[],E=[];for(let ue=0;ue<r;ue++)x.push(t.readBoolean()),E.push(t.readBoolean());if(r>0)for(let ue=r;ue<8;ue++)t.readBits(2);for(let ue=0;ue<r;ue++)x[ue]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),E[ue]&&t.readUByte();t.readUEG();const T=t.readUEG();T==3&&t.skipBits(1);const w=t.readUEG(),L=t.readUEG(),A=t.readBoolean();let R=0,C=0,I=0,P=0;A&&(R+=t.readUEG(),C+=t.readUEG(),I+=t.readUEG(),P+=t.readUEG());const O=t.readUEG(),V=t.readUEG(),B=t.readUEG(),K=t.readBoolean();for(let ue=K?0:r;ue<=r;ue++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let je=0;je<4;je++)for(let Qe=0;Qe<(je===3?2:6);Qe++)if(!t.readBoolean())t.readUEG();else{const St=Math.min(64,1<<4+(je<<1));je>1&&t.readEG();for(let Kt=0;Kt<St;Kt++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const _=t.readUEG();let k=0;for(let ue=0;ue<_;ue++){let je=!1;if(ue!==0&&(je=t.readBoolean()),je){ue===_&&t.readUEG(),t.readBoolean(),t.readUEG();let Qe=0;for(let Et=0;Et<=k;Et++){const St=t.readBoolean();let Kt=!1;St||(Kt=t.readBoolean()),(St||Kt)&&Qe++}k=Qe}else{const Qe=t.readUEG(),Et=t.readUEG();k=Qe+Et;for(let St=0;St<Qe;St++)t.readUEG(),t.readBoolean();for(let St=0;St<Et;St++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const ue=t.readUEG();for(let je=0;je<ue;je++){for(let Qe=0;Qe<B+4;Qe++)t.readBits(1);t.readBits(1)}}let F=0,$=1,Y=1,Q=!0,ee=1,te=0;t.readBoolean(),t.readBoolean();let ne=!1;if(t.readBoolean()){if(t.readBoolean()){const An=t.readUByte(),Ln=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],$s=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];An>0&&An<16?($=Ln[An-1],Y=$s[An-1]):An===255&&($=t.readBits(16),Y=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),ne=t.readBoolean(),ne&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(ee=t.readBits(32),te=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const $s=t.readBoolean(),ha=t.readBoolean();let Xe=!1;($s||ha)&&(Xe=t.readBoolean(),Xe&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),Xe&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let Qn=0;Qn<=r;Qn++){Q=t.readBoolean();const au=Q||t.readBoolean();let ma=!1;au?t.readEG():ma=t.readBoolean();const ls=ma?1:t.readUEG()+1;if($s)for(let cs=0;cs<ls;cs++)t.readUEG(),t.readUEG(),Xe&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(ha)for(let cs=0;cs<ls;cs++)t.readUEG(),t.readUEG(),Xe&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),F=t.readUEG())}let Be=w,qe=L;if(A){let ue=1,je=1;T===1?ue=je=2:T==2&&(ue=2),Be=w-ue*C-ue*R,qe=L-je*P-je*I}const ot=s?["A","B","C"][s]:"",gr=a<<24|l<<16|c<<8|u;let Ht=0;for(let ue=0;ue<32;ue++)Ht=(Ht|(gr>>ue&1)<<31-ue)>>>0;let vr=Ht.toString(16);return o===1&&vr==="2"&&(vr="6"),{codecString:`hvc1.${ot}${o}.${vr}.${i?"H":"L"}${v}.B0`,params:{general_tier_flag:i,general_profile_idc:o,general_profile_space:s,general_profile_compatibility_flags:[a,l,c,u],general_constraint_indicator_flags:[d,f,h,p,m,g],general_level_idc:v,bit_depth:O+8,bit_depth_luma_minus8:O,bit_depth_chroma_minus8:V,min_spatial_segmentation_idc:F,chroma_format_idc:T,frame_rate:{fixed:Q,fps:te/ee}},width:Be,height:qe,pixelRatio:[$,Y]}}readPPS(e){const t=new Lo(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const s=t.readBoolean(),i=t.readBoolean();let o=1;return i&&s?o=0:i?o=3:s&&(o=2),{parallelismType:o}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Ze=188;class _r{constructor(e,t,r,s){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=s,this.videoParser=null}static probe(e,t){const r=_r.syncOffset(e);return r>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`),r!==-1}static syncOffset(e){const t=e.length;let r=Math.min(Ze*5,t-Ze)+1,s=0;for(;s<r;){let i=!1,o=-1,a=0;for(let l=s;l<t;l+=Ze)if(e[l]===71&&(t-l===Ze||e[l+Ze]===71)){if(a++,o===-1&&(o=l,o!==0&&(r=Math.min(o+Ze*99,e.length-Ze)+1)),i||(i=jf(e,l)===0),i&&a>1&&(o===0&&a>2||l+Ze>r))return o}else{if(a)return-1;break}s++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:wS[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,r,s){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=_r.createTrack("video"),this._videoTrack.duration=s,this._audioTrack=_r.createTrack("audio",s),this._id3Track=_r.createTrack("id3"),this._txtTrack=_r.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,r=!1,s=!1){r||(this.sampleAes=null);let i;const o=this._videoTrack,a=this._audioTrack,l=this._id3Track,c=this._txtTrack;let u=o.pid,d=o.pesData,f=a.pid,h=l.pid,p=a.pesData,m=l.pesData,g=null,v=this.pmtParsed,x=this._pmtId,E=e.length;if(this.remainderData&&(e=en(this.remainderData,e),E=e.length,this.remainderData=null),E<Ze&&!s)return this.remainderData=e,{audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};const T=Math.max(0,_r.syncOffset(e));E-=(E-T)%Ze,E<e.byteLength&&!s&&(this.remainderData=new Uint8Array(e.buffer,E,e.buffer.byteLength-E));let w=0;for(let A=T;A<E;A+=Ze)if(e[A]===71){const R=!!(e[A+1]&64),C=jf(e,A),I=(e[A+3]&48)>>4;let P;if(I>1){if(P=A+5+e[A+4],P===A+Ze)continue}else P=A+4;switch(C){case u:R&&(d&&(i=Hs(d,this.logger))&&(this.readyVideoParser(o.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(o,c,i,!1)),d={data:[],size:0}),d&&(d.data.push(e.subarray(P,A+Ze)),d.size+=A+Ze-P);break;case f:if(R){if(p&&(i=Hs(p,this.logger)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,i);break;case"mp3":this.parseMPEGPES(a,i);break;case"ac3":this.parseAC3PES(a,i);break}p={data:[],size:0}}p&&(p.data.push(e.subarray(P,A+Ze)),p.size+=A+Ze-P);break;case h:R&&(m&&(i=Hs(m,this.logger))&&this.parseID3PES(l,i),m={data:[],size:0}),m&&(m.data.push(e.subarray(P,A+Ze)),m.size+=A+Ze-P);break;case 0:R&&(P+=e[P]+1),x=this._pmtId=ID(e,P);break;case x:{R&&(P+=e[P]+1);const O=RD(e,P,this.typeSupported,r,this.observer,this.logger);u=O.videoPid,u>0&&(o.pid=u,o.segmentCodec=O.segmentVideoCodec),f=O.audioPid,f>0&&(a.pid=f,a.segmentCodec=O.segmentAudioCodec),h=O.id3Pid,h>0&&(l.pid=h),g!==null&&!v&&(this.logger.warn(`MPEG-TS PMT found at ${A} after unknown PID '${g}'. Backtracking to sync byte @${T} to parse all TS packets.`),g=null,A=T-188),v=this.pmtParsed=!0;break}case 17:case 8191:break;default:g=C;break}}else w++;w>0&&Gf(this.observer,new Error(`Found ${w} TS packet/s that do not start with 0x47`),void 0,this.logger),o.pesData=d,a.pesData=p,l.pesData=m;const L={audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};return s&&this.extractRemainingSamples(L),L}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:r,id3Track:s,textTrack:i}=e,o=r.pesData,a=t.pesData,l=s.pesData;let c;if(o&&(c=Hs(o,this.logger))?(this.readyVideoParser(r.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(r,i,c,!0),r.pesData=null)):r.pesData=o,a&&(c=Hs(a,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,c);break;case"mp3":this.parseMPEGPES(t,c);break;case"ac3":this.parseAC3PES(t,c);break}t.pesData=null}else a!=null&&a.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;l&&(c=Hs(l,this.logger))?(this.parseID3PES(s,c),s.pesData=null):s.pesData=l}demuxSampleAes(e,t,r){const s=this.demux(e,r,!0,!this.config.progressive),i=this.sampleAes=new wD(this.observer,this.config,t);return this.decrypt(s,i)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new AD:e==="hevc"&&(this.videoParser=new LD))}decrypt(e,t){return new Promise(r=>{const{audioTrack:s,videoTrack:i}=e;s.samples&&s.segmentCodec==="aac"?t.decryptAacSamples(s.samples,0,()=>{i.samples?t.decryptAvcSamples(i.samples,0,0,()=>{r(e)}):r(e)}):i.samples&&t.decryptAvcSamples(i.samples,0,0,()=>{r(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let r=0;const s=this.aacOverFlow;let i=t.data;if(s){this.aacOverFlow=null;const d=s.missing,f=s.sample.unit.byteLength;if(d===-1)i=en(s.sample.unit,i);else{const h=f-d;s.sample.unit.set(i.subarray(0,d),h),e.samples.push(s.sample),r=s.missing}}let o,a;for(o=r,a=i.length;o<a-1&&!mc(i,o);o++);if(o!==r){let d;const f=o<a-1;if(f?d=`AAC PES did not start with ADTS header,offset:${o}`:d="No ADTS header found in AAC PES",Gf(this.observer,new Error(d),f,this.logger),!f)return}nT(e,this.observer,i,o,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(s){const d=rT(e.samplerate);l=s.sample.pts+d}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let c=0,u;for(;o<a;)if(u=sT(e,i,o,l,c),o+=u.length,u.missing){this.aacOverFlow=u;break}else for(c++;o<a-1&&!mc(i,o);o++);}parseMPEGPES(e,t){const r=t.data,s=r.length;let i=0,o=0;const a=t.pts;if(a===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<s;)if(cT(r,o)){const l=aT(e,r,o,a,i);if(l)o+=l.length,i++;else break}else o++}parseAC3PES(e,t){{const r=t.data,s=t.pts;if(s===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const i=r.length;let o=0,a=0,l;for(;a<i&&(l=fT(e,r,a,s,o++))>0;)a+=l}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const r=Ee({},t,{type:this._videoTrack?Mt.emsg:Mt.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function jf(n,e){return((n[e+1]&31)<<8)+n[e+2]}function ID(n,e){return(n[e+10]&31)<<8|n[e+11]}function RD(n,e,t,r,s,i){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},a=(n[e+1]&15)<<8|n[e+2],l=e+3+a-4,c=(n[e+10]&15)<<8|n[e+11];for(e+=12+c;e<l;){const u=jf(n,e),d=(n[e+3]&15)<<8|n[e+4];switch(n[e]){case 207:if(!r){Ju("ADTS AAC",i);break}case 15:o.audioPid===-1&&(o.audioPid=u);break;case 21:o.id3Pid===-1&&(o.id3Pid=u);break;case 219:if(!r){Ju("H.264",i);break}case 27:o.videoPid===-1&&(o.videoPid=u);break;case 3:case 4:!t.mpeg&&!t.mp3?i.log("MPEG audio found, not supported in this browser"):o.audioPid===-1&&(o.audioPid=u,o.segmentAudioCodec="mp3");break;case 193:if(!r){Ju("AC-3",i);break}case 129:t.ac3?o.audioPid===-1&&(o.audioPid=u,o.segmentAudioCodec="ac3"):i.log("AC-3 audio found, not supported in this browser");break;case 6:if(o.audioPid===-1&&d>0){let f=e+5,h=d;for(;h>2;){switch(n[f]){case 106:t.ac3!==!0?i.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=u,o.segmentAudioCodec="ac3");break}const m=n[f+1]+2;f+=m,h-=m}}break;case 194:case 135:return Gf(s,new Error("Unsupported EC-3 in M2TS found"),void 0,i),o;case 36:o.videoPid===-1&&(o.videoPid=u,o.segmentVideoCodec="hevc",i.log("HEVC in M2TS found"));break}e+=d+5}return o}function Gf(n,e,t,r){r.warn(`parsing error: ${e.message}`),n.emit(S.ERROR,S.ERROR,{type:J.MEDIA_ERROR,details:N.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function Ju(n,e){e.log(`${n} with AES-128-CBC encryption found in unencrypted stream`)}function Hs(n,e){let t=0,r,s,i,o,a;const l=n.data;if(!n||n.size===0)return null;for(;l[0].length<19&&l.length>1;)l[0]=en(l[0],l[1]),l.splice(1,1);if(r=l[0],(r[0]<<16)+(r[1]<<8)+r[2]===1){if(s=(r[4]<<8)+r[5],s&&s>n.size-6)return null;const u=r[7];u&192&&(o=(r[9]&14)*536870912+(r[10]&255)*4194304+(r[11]&254)*16384+(r[12]&255)*128+(r[13]&254)/2,u&64?(a=(r[14]&14)*536870912+(r[15]&255)*4194304+(r[16]&254)*16384+(r[17]&255)*128+(r[18]&254)/2,o-a>60*9e4&&(e.warn(`${Math.round((o-a)/9e4)}s delta between PTS and DTS, align them`),o=a)):a=o),i=r[8];let d=i+9;if(n.size<=d)return null;n.size-=d;const f=new Uint8Array(n.size);for(let h=0,p=l.length;h<p;h++){r=l[h];let m=r.byteLength;if(d)if(d>m){d-=m;continue}else r=r.subarray(d),m-=d,d=0;f.set(r,t),t+=m}return s&&(s-=i+3),{data:f,pts:o,dts:a,len:s}}return null}class CD{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const wr=Math.pow(2,32)-1;class D{static init(){D.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in D.types)D.types.hasOwnProperty(e)&&(D.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);D.HDLR_TYPES={video:t,audio:r};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);D.STTS=D.STSC=D.STCO=i,D.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),D.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),D.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),D.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);D.FTYP=D.box(D.types.ftyp,o,l,o,a),D.DINF=D.box(D.types.dinf,D.box(D.types.dref,s))}static box(e,...t){let r=8,s=t.length;const i=s;for(;s--;)r+=t[s].byteLength;const o=new Uint8Array(r);for(o[0]=r>>24&255,o[1]=r>>16&255,o[2]=r>>8&255,o[3]=r&255,o.set(e,4),s=0,r=8;s<i;s++)o.set(t[s],r),r+=t[s].byteLength;return o}static hdlr(e){return D.box(D.types.hdlr,D.HDLR_TYPES[e])}static mdat(e){return D.box(D.types.mdat,e)}static mdhd(e,t){t*=e;const r=Math.floor(t/(wr+1)),s=Math.floor(t%(wr+1));return D.box(D.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,85,196,0,0]))}static mdia(e){return D.box(D.types.mdia,D.mdhd(e.timescale||0,e.duration||0),D.hdlr(e.type),D.minf(e))}static mfhd(e){return D.box(D.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?D.box(D.types.minf,D.box(D.types.smhd,D.SMHD),D.DINF,D.stbl(e)):D.box(D.types.minf,D.box(D.types.vmhd,D.VMHD),D.DINF,D.stbl(e))}static moof(e,t,r){return D.box(D.types.moof,D.mfhd(e),D.traf(r,t))}static moov(e){let t=e.length;const r=[];for(;t--;)r[t]=D.trak(e[t]);return D.box.apply(null,[D.types.moov,D.mvhd(e[0].timescale||0,e[0].duration||0)].concat(r).concat(D.mvex(e)))}static mvex(e){let t=e.length;const r=[];for(;t--;)r[t]=D.trex(e[t]);return D.box.apply(null,[D.types.mvex,...r])}static mvhd(e,t){t*=e;const r=Math.floor(t/(wr+1)),s=Math.floor(t%(wr+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return D.box(D.types.mvhd,i)}static sdtp(e){const t=e.samples||[],r=new Uint8Array(4+t.length);let s,i;for(s=0;s<t.length;s++)i=t[s].flags,r[s+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return D.box(D.types.sdtp,r)}static stbl(e){return D.box(D.types.stbl,D.stsd(e),D.box(D.types.stts,D.STTS),D.box(D.types.stsc,D.STSC),D.box(D.types.stsz,D.STSZ),D.box(D.types.stco,D.STCO))}static avc1(e){let t=[],r=[],s,i,o;for(s=0;s<e.sps.length;s++)i=e.sps[s],o=i.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(i));for(s=0;s<e.pps.length;s++)i=e.pps[s],o=i.byteLength,r.push(o>>>8&255),r.push(o&255),r=r.concat(Array.prototype.slice.call(i));const a=D.box(D.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(r))),l=e.width,c=e.height,u=e.pixelRatio[0],d=e.pixelRatio[1];return D.box(D.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,c>>8&255,c&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,D.box(D.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),D.box(D.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,u&255,d>>24,d>>16&255,d>>8&255,d&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return D.box(D.types.mp4a,D.audioStsd(e),D.box(D.types.esds,D.esds(e)))}static mp3(e){return D.box(D.types[".mp3"],D.audioStsd(e))}static ac3(e){return D.box(D.types["ac-3"],D.audioStsd(e),D.box(D.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return D.box(D.types.stsd,D.STSD,D.mp4a(e));if(t==="ac3"&&e.config)return D.box(D.types.stsd,D.STSD,D.ac3(e));if(t==="mp3"&&e.codec==="mp3")return D.box(D.types.stsd,D.STSD,D.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return D.box(D.types.stsd,D.STSD,D.avc1(e));if(t==="hevc"&&e.vps)return D.box(D.types.stsd,D.STSD,D.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,r=(e.duration||0)*(e.timescale||0),s=e.width||0,i=e.height||0,o=Math.floor(r/(wr+1)),a=Math.floor(r%(wr+1));return D.box(D.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,a>>24,a>>16&255,a>>8&255,a&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,i>>8&255,i&255,0,0]))}static traf(e,t){const r=D.sdtp(e),s=e.id,i=Math.floor(t/(wr+1)),o=Math.floor(t%(wr+1));return D.box(D.types.traf,D.box(D.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),D.box(D.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,o>>24,o>>16&255,o>>8&255,o&255])),D.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,D.box(D.types.trak,D.tkhd(e),D.mdia(e))}static trex(e){const t=e.id;return D.box(D.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const r=e.samples||[],s=r.length,i=12+16*s,o=new Uint8Array(i);let a,l,c,u,d,f;for(t+=8+i,o.set([e.type==="video"?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),a=0;a<s;a++)l=r[a],c=l.duration,u=l.size,d=l.flags,f=l.cts,o.set([c>>>24&255,c>>>16&255,c>>>8&255,c&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&61440,d.degradPrio&15,f>>>24&255,f>>>16&255,f>>>8&255,f&255],12+16*a);return D.box(D.types.trun,o)}static initSegment(e){D.types||D.init();const t=D.moov(e);return en(D.FTYP,t)}static hvc1(e){const t=e.params,r=[e.vps,e.sps,e.pps],s=4,i=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),s-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),r.length]);let o=i.length;for(let p=0;p<r.length;p+=1){o+=3;for(let m=0;m<r[p].length;m+=1)o+=2+r[p][m].length}const a=new Uint8Array(o);a.set(i,0),o=i.length;const l=r.length-1;for(let p=0;p<r.length;p+=1){a.set(new Uint8Array([32+p|(p===l?128:0),0,r[p].length]),o),o+=3;for(let m=0;m<r[p].length;m+=1)a.set(new Uint8Array([r[p][m].length>>8,r[p][m].length&255]),o),o+=2,a.set(r[p][m],o),o+=r[p][m].length}const c=D.box(D.types.hvcC,a),u=e.width,d=e.height,f=e.pixelRatio[0],h=e.pixelRatio[1];return D.box(D.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,u&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c,D.box(D.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),D.box(D.types.pasp,new Uint8Array([f>>24,f>>16&255,f>>8&255,f&255,h>>24,h>>16&255,h>>8&255,h&255])))}}D.types=void 0;D.HDLR_TYPES=void 0;D.STTS=void 0;D.STSC=void 0;D.STCO=void 0;D.STSZ=void 0;D.VMHD=void 0;D.SMHD=void 0;D.STSD=void 0;D.FTYP=void 0;D.DINF=void 0;const mT=9e4;function Rm(n,e,t=1,r=!1){const s=n*e*t;return r?Math.round(s):s}function kD(n,e,t=1,r=!1){return Rm(n,e,1/t,r)}function ao(n,e=!1){return Rm(n,1e3,1/mT,e)}function _D(n,e=1){return Rm(n,mT,1/e)}const PD=10*1e3,DD=1024,ND=1152,OD=1536;let Ks=null,ed=null;function O0(n,e,t,r){return{duration:e,size:t,cts:r,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:n?2:1,isNonSync:n?0:1}}}class Sl extends tn{constructor(e,t,r,s){if(super("mp4-remuxer",s),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,Ks===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ks=o?parseInt(o[1]):0}if(ed===null){const i=navigator.userAgent.match(/Safari\/(\d+)/i);ed=i?parseInt(i[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.log("initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const r=e[0].pts,s=e.reduce((i,o)=>{let a=o.pts,l=a-i;return l<-4294967296&&(t=!0,a=Wt(a,r),l=a-i),l>0?i:a},r);return t&&this.debug("PTS rollover detected"),s}remux(e,t,r,s,i,o,a,l){let c,u,d,f,h,p,m=i,g=i;const v=e.pid>-1,x=t.pid>-1,E=t.samples.length,T=e.samples.length>0,w=a&&E>0||E>1;if((!v||T)&&(!x||w)||this.ISGenerated||a){if(this.ISGenerated){var A,R,C,I;const B=this.videoTrackConfig;(B&&(t.width!==B.width||t.height!==B.height||((A=t.pixelRatio)==null?void 0:A[0])!==((R=B.pixelRatio)==null?void 0:R[0])||((C=t.pixelRatio)==null?void 0:C[1])!==((I=B.pixelRatio)==null?void 0:I[1]))||!B&&w||this.nextAudioTs===null&&T)&&this.resetInitSegment()}this.ISGenerated||(d=this.generateIS(e,t,i,o));const P=this.isVideoContiguous;let O=-1,V;if(w&&(O=MD(t.samples),!P&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,O>0){this.warn(`Dropped ${O} out of ${E} video samples due to a missing keyframe`);const B=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(O),t.dropped+=O,g+=(t.samples[0].pts-B)/t.inputTimeScale,V=g}else O===-1&&(this.warn(`No keyframe found out of ${E} video samples`),p=!1);if(this.ISGenerated){if(T&&w){const B=this.getVideoStartPts(t.samples),U=(Wt(e.samples[0].pts,B)-B)/t.inputTimeScale;m+=Math.max(0,U),g+=Math.max(0,-U)}if(T){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),d=this.generateIS(e,t,i,o)),u=this.remuxAudio(e,m,this.isAudioContiguous,o,x||w||l===Z.AUDIO?g:void 0),w){const B=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),d=this.generateIS(e,t,i,o)),c=this.remuxVideo(t,g,P,B)}}else w&&(c=this.remuxVideo(t,g,P,0));c&&(c.firstKeyFrame=O,c.independent=O!==-1,c.firstKeyFramePTS=V)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(h=pT(r,i,this._initPTS,this._initDTS)),s.samples.length&&(f=gT(s,i,this._initPTS))),{audio:u,video:c,initSegment:d,independent:p,text:f,id3:h}}generateIS(e,t,r,s){const i=e.samples,o=t.samples,a=this.typeSupported,l={},c=this._initPTS;let u=!c||s,d="audio/mp4",f,h,p,m=-1;if(u&&(f=h=1/0),e.config&&i.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(d="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:d,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&a.mpeg?new Uint8Array(0):D.initSegment([e]),metadata:{channelCount:e.channelCount}},u&&(m=e.id,p=e.inputTimeScale,!c||p!==c.timescale?f=h=i[0].pts-Math.round(p*r):u=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:D.initSegment([t]),metadata:{width:t.width,height:t.height}},u)if(m=t.id,p=t.inputTimeScale,!c||p!==c.timescale){const g=this.getVideoStartPts(o),v=Math.round(p*r);h=Math.min(h,Wt(o[0].dts,g)-v),f=Math.min(f,g-v)}else u=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,u?(c&&this.warn(`Timestamps at playlist time: ${s?"":"~"}${r} ${f/p} != initPTS: ${c.baseTime/c.timescale} (${c.baseTime}/${c.timescale}) trackId: ${c.trackId}`),this.log(`Found initPTS at playlist time: ${r} offset: ${f/p} (${f}/${p}) trackId: ${m}`),this._initPTS={baseTime:f,timescale:p,trackId:m},this._initDTS={baseTime:h,timescale:p,trackId:m}):f=p=void 0,{tracks:l,initPTS:f,timescale:p,trackId:m}}remuxVideo(e,t,r,s){const i=e.inputTimeScale,o=e.samples,a=[],l=o.length,c=this._initPTS,u=c.baseTime*i/c.timescale;let d=this.nextVideoTs,f=8,h=this.videoSampleDuration,p,m,g=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,x=!1;if(!r||d===null){const F=u+t*i,$=o[0].pts-Wt(o[0].dts,o[0].pts);Ks&&d!==null&&Math.abs(F-$-(d+u))<15e3?r=!0:d=F-$-u}const E=d+u;for(let F=0;F<l;F++){const $=o[F];$.pts=Wt($.pts,E),$.dts=Wt($.dts,E),$.dts<o[F>0?F-1:F].dts&&(x=!0)}x&&o.sort(function(F,$){const Y=F.dts-$.dts,Q=F.pts-$.pts;return Y||Q}),p=o[0].dts,m=o[o.length-1].dts;const T=m-p,w=T?Math.round(T/(l-1)):h||e.inputTimeScale/30;if(r){const F=p-E,$=F>w,Y=F<-1;if(($||Y)&&($?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${ao(F,!0)} ms (${F}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${ao(-F,!0)} ms (${F}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!Y||E>=o[0].pts||Ks)){p=E;const Q=o[0].pts-F;if($)o[0].dts=p,o[0].pts=Q;else{let ee=!0;for(let te=0;te<o.length&&!(o[te].dts>Q&&ee);te++){const ne=o[te].pts;if(o[te].dts-=F,o[te].pts-=F,te<o.length-1){const Re=o[te+1].pts,Be=o[te].pts,qe=Re<=Be,ot=Re<=ne;ee=qe==ot}}}this.log(`Video: Initial PTS/DTS adjusted: ${ao(Q,!0)}/${ao(p,!0)}, delta: ${ao(F,!0)} ms`)}}p=Math.max(0,p);let L=0,A=0,R=p;for(let F=0;F<l;F++){const $=o[F],Y=$.units,Q=Y.length;let ee=0;for(let te=0;te<Q;te++)ee+=Y[te].data.length;A+=ee,L+=Q,$.length=ee,$.dts<R?($.dts=R,R+=w/4|0||1):R=$.dts,g=Math.min($.pts,g),v=Math.max($.pts,v)}m=o[l-1].dts;const C=A+4*L+8;let I;try{I=new Uint8Array(C)}catch(F){this.observer.emit(S.ERROR,S.ERROR,{type:J.MUX_ERROR,details:N.REMUX_ALLOC_ERROR,fatal:!1,error:F,bytes:C,reason:`fail allocating video mdat ${C}`});return}const P=new DataView(I.buffer);P.setUint32(0,C),I.set(D.types.mdat,4);let O=!1,V=Number.POSITIVE_INFINITY,B=Number.POSITIVE_INFINITY,K=Number.NEGATIVE_INFINITY,U=Number.NEGATIVE_INFINITY;for(let F=0;F<l;F++){const $=o[F],Y=$.units;let Q=0;for(let ne=0,Re=Y.length;ne<Re;ne++){const Be=Y[ne],qe=Be.data,ot=Be.data.byteLength;P.setUint32(f,ot),f+=4,I.set(qe,f),f+=ot,Q+=4+ot}let ee;if(F<l-1)h=o[F+1].dts-$.dts,ee=o[F+1].pts-$.pts;else{const ne=this.config,Re=F>0?$.dts-o[F-1].dts:w;if(ee=F>0?$.pts-o[F-1].pts:w,ne.stretchShortVideoTrack&&this.nextAudioTs!==null){const Be=Math.floor(ne.maxBufferHole*i),qe=(s?g+s*i:this.nextAudioTs+u)-$.pts;qe>Be?(h=qe-Re,h<0?h=Re:O=!0,this.log(`It is approximately ${qe/90} ms to the next segment; using duration ${h/90} ms for the last video frame.`)):h=Re}else h=Re}const te=Math.round($.pts-$.dts);V=Math.min(V,h),K=Math.max(K,h),B=Math.min(B,ee),U=Math.max(U,ee),a.push(O0($.key,h,Q,te))}if(a.length){if(Ks){if(Ks<70){const F=a[0].flags;F.dependsOn=2,F.isNonSync=0}}else if(ed&&U-B<K-V&&w/K<.025&&a[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let F=p;for(let $=0,Y=a.length;$<Y;$++){const Q=F+a[$].duration,ee=F+a[$].cts;if($<Y-1){const te=Q+a[$+1].cts;a[$].duration=te-ee}else a[$].duration=$?a[$-1].duration:w;a[$].cts=0,F=Q}}}h=O||!h?w:h;const H=m+h;this.nextVideoTs=d=H-u,this.videoSampleDuration=h,this.isVideoContiguous=!0;const M={data1:D.moof(e.sequenceNumber++,p,Ee(e,{samples:a})),data2:I,startPTS:(g-u)/i,endPTS:(v+h-u)/i,startDTS:(p-u)/i,endDTS:d/i,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,M}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return ND;case"ac3":return OD;default:return DD}}remuxAudio(e,t,r,s,i){const o=e.inputTimeScale,a=e.samplerate?e.samplerate:o,l=o/a,c=this.getSamplesPerFrame(e),u=c*l,d=this._initPTS,f=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,h=[],p=i!==void 0;let m=e.samples,g=f?0:8,v=this.nextAudioTs||-1;const x=d.baseTime*o/d.timescale,E=x+t*o;if(this.isAudioContiguous=r=r||m.length&&v>0&&(s&&Math.abs(E-(v+x))<9e3||Math.abs(Wt(m[0].pts,E)-(v+x))<20*u),m.forEach(function(U){U.pts=Wt(U.pts,E)}),!r||v<0){if(m=m.filter(U=>U.pts>=0),!m.length)return;i===0?v=0:s&&!p?v=Math.max(0,E-x):v=m[0].pts-x}if(e.segmentCodec==="aac"){const U=this.config.maxAudioFramesDrift;for(let H=0,_=v+x;H<m.length;H++){const k=m[H],M=k.pts,F=M-_,$=Math.abs(1e3*F/o);if(F<=-U*u&&p)H===0&&(this.warn(`Audio frame @ ${(M/o).toFixed(3)}s overlaps marker by ${Math.round(1e3*F/o)} ms.`),this.nextAudioTs=v=M-x,_=M);else if(F>=U*u&&$<PD&&p){let Y=Math.round(F/u);for(_=M-Y*u;_<0&&Y&&u;)Y--,_+=u;H===0&&(this.nextAudioTs=v=_-x),this.warn(`Injecting ${Y} audio frames @ ${((_-x)/o).toFixed(3)}s due to ${Math.round(1e3*F/o)} ms gap.`);for(let Q=0;Q<Y;Q++){let ee=CD.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);ee||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),ee=k.unit.subarray()),m.splice(H,0,{unit:ee,pts:_}),_+=u,H++}}k.pts=_,_+=u}}let T=null,w=null,L,A=0,R=m.length;for(;R--;)A+=m[R].unit.byteLength;for(let U=0,H=m.length;U<H;U++){const _=m[U],k=_.unit;let M=_.pts;if(w!==null){const $=h[U-1];$.duration=Math.round((M-w)/l)}else if(r&&e.segmentCodec==="aac"&&(M=v+x),T=M,A>0){A+=g;try{L=new Uint8Array(A)}catch($){this.observer.emit(S.ERROR,S.ERROR,{type:J.MUX_ERROR,details:N.REMUX_ALLOC_ERROR,fatal:!1,error:$,bytes:A,reason:`fail allocating audio mdat ${A}`});return}f||(new DataView(L.buffer).setUint32(0,A),L.set(D.types.mdat,4))}else return;L.set(k,g);const F=k.byteLength;g+=F,h.push(O0(!0,c,F,0)),w=M}const C=h.length;if(!C)return;const I=h[h.length-1];v=w-x,this.nextAudioTs=v+l*I.duration;const P=f?new Uint8Array(0):D.moof(e.sequenceNumber++,T/l,Ee({},e,{samples:h}));e.samples=[];const O=(T-x)/o,V=v/o,K={data1:P,data2:L,startPTS:O,endPTS:V,startDTS:O,endDTS:V,type:"audio",hasAudio:!0,hasVideo:!1,nb:C};return this.isAudioContiguous=!0,K}}function Wt(n,e){let t;if(e===null)return n;for(e<n?t=-8589934592:t=8589934592;Math.abs(n-e)>4294967296;)n+=t;return n}function MD(n){for(let e=0;e<n.length;e++)if(n[e].key)return e;return-1}function pT(n,e,t,r){const s=n.samples.length;if(!s)return;const i=n.inputTimeScale;for(let a=0;a<s;a++){const l=n.samples[a];l.pts=Wt(l.pts-t.baseTime*i/t.timescale,e*i)/i,l.dts=Wt(l.dts-r.baseTime*i/r.timescale,e*i)/i}const o=n.samples;return n.samples=[],{samples:o}}function gT(n,e,t){const r=n.samples.length;if(!r)return;const s=n.inputTimeScale;for(let o=0;o<r;o++){const a=n.samples[o];a.pts=Wt(a.pts-t.baseTime*s/t.timescale,e*s)/s}n.samples.sort((o,a)=>o.pts-a.pts);const i=n.samples;return n.samples=[],{samples:i}}class FD extends tn{constructor(e,t,r,s){super("passthrough-remuxer",s),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,r,s){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(e,s),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:r,videoCodec:s}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:i,video:o}=this.initData=IS(e);if(t)A_(e,t);else{const l=i||o;l!=null&&l.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${l.codec}")!`)}i&&(r=M0(i,Se.AUDIO,this)),o&&(s=M0(o,Se.VIDEO,this));const a={};i&&o?a.audiovideo={container:"video/mp4",codec:r+","+s,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:e,id:"main"}:i?a.audio={container:"audio/mp4",codec:r,encrypted:i.encrypted,initSegment:e,id:"audio"}:o?a.video={container:"video/mp4",codec:s,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=a}remux(e,t,r,s,i,o){var a,l;let{initPTS:c,lastEndTime:u}=this;const d={audio:void 0,video:void 0,text:s,id3:r,initSegment:void 0};q(u)||(u=this.lastEndTime=i||0);const f=t.samples;if(!f.length)return d;const h={initPTS:void 0,timescale:void 0,trackId:void 0};let p=this.initData;if((a=p)!=null&&a.length||(this.generateInitSegment(f),p=this.initData),!((l=p)!=null&&l.length))return this.warn("Failed to generate initSegment."),d;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1);const m=L_(f,p,this),g=p.audio?m[p.audio.id]:null,v=p.video?m[p.video.id]:null,x=Ka(v,1/0),E=Ka(g,1/0),T=Ka(v,0,!0),w=Ka(g,0,!0);let L=i,A=0;const R=g&&(!v||!c&&E<x||c&&c.trackId===p.audio.id),C=R?g:v;if(C){const _=C.timescale,k=C.start-i*_,M=R?p.audio.id:p.video.id;L=C.start/_,A=R?w-E:T-x,(o||!c)&&($D(c,L,i,A)||_!==c.timescale)&&(c&&this.warn(`Timestamps at playlist time: ${o?"":"~"}${i} ${k/_} != initPTS: ${c.baseTime/c.timescale} (${c.baseTime}/${c.timescale}) trackId: ${c.trackId}`),this.log(`Found initPTS at playlist time: ${i} offset: ${L-i} (${k}/${_}) trackId: ${M}`),c=null,h.initPTS=k,h.timescale=_,h.trackId=M)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${i}`);c?(h.initPTS=c.baseTime,h.timescale=c.timescale,h.trackId=c.trackId):((!h.timescale||h.trackId===void 0||h.initPTS===void 0)&&(this.warn("Could not set initPTS"),h.initPTS=L,h.timescale=1,h.trackId=-1),this.initPTS=c={baseTime:h.initPTS,timescale:h.timescale,trackId:h.trackId});const I=L-c.baseTime/c.timescale,P=I+A;A>0?this.lastEndTime=P:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const O=!!p.audio,V=!!p.video;let B="";O&&(B+="audio"),V&&(B+="video");const K=(p.audio?p.audio.encrypted:!1)||(p.video?p.video.encrypted:!1),U={data1:f,startPTS:I,startDTS:I,endPTS:P,endDTS:P,type:B,hasAudio:O,hasVideo:V,nb:1,dropped:0,encrypted:K};d.audio=O&&!V?U:void 0,d.video=V?U:void 0;const H=v==null?void 0:v.sampleCount;if(H){const _=v.keyFrameIndex,k=_!==-1;U.nb=H,U.dropped=_===0||this.isVideoContiguous?0:k?_:H,U.independent=k,U.firstKeyFrame=_,k&&v.keyFrameStart&&(U.firstKeyFramePTS=(v.keyFrameStart-c.baseTime)/c.timescale),this.isVideoContiguous||(d.independent=k),this.isVideoContiguous||(this.isVideoContiguous=k),U.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${_}/${H} dropped: ${U.dropped} start: ${U.firstKeyFramePTS||"NA"}`)}return d.initSegment=h,d.id3=pT(r,i,c,c),s.samples.length&&(d.text=gT(s,i,c)),d}}function Ka(n,e,t=!1){return(n==null?void 0:n.start)!==void 0?(n.start+(t?n.duration:0))/n.timescale:e}function $D(n,e,t,r){if(n===null)return!0;const s=Math.max(r,1),i=e-n.baseTime/n.timescale;return Math.abs(i-t)>s}function M0(n,e,t){const r=n.codec;return r&&r.length>4?r:e===Se.AUDIO?r==="ec-3"||r==="ac-3"||r==="alac"?r:r==="fLaC"||r==="Opus"?ac(r,!1):(t.warn(`Unhandled audio codec "${r}" in mp4 MAP`),r||"mp4a"):(t.warn(`Unhandled video codec "${r}" in mp4 MAP`),r||"avc1")}let rr;try{rr=self.performance.now.bind(self.performance)}catch{rr=Date.now}const Tl=[{demux:bD,remux:FD},{demux:_r,remux:Sl},{demux:xD,remux:Sl},{demux:SD,remux:Sl}];Tl.splice(2,0,{demux:ED,remux:Sl});class F0{constructor(e,t,r,s,i,o){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.id=i,this.logger=o}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,s){const i=r.transmuxing;i.executeStart=rr();let o=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:l}=this;s&&(this.currentTransmuxState=s);const{contiguous:c,discontinuity:u,trackSwitch:d,accurateTimeOffset:f,timeOffset:h,initSegmentChange:p}=s||a,{audioCodec:m,videoCodec:g,defaultInitPts:v,duration:x,initSegmentData:E}=l,T=BD(o,t);if(T&&xi(T.method)){const R=this.getDecrypter(),C=xm(T.method);if(R.isSync()){let I=R.softwareDecrypt(o,T.key.buffer,T.iv.buffer,C);if(r.part>-1){const O=R.flush();I=O&&O.buffer}if(!I)return i.executeEnd=rr(),td(r);o=new Uint8Array(I)}else return this.asyncResult=!0,this.decryptionPromise=R.webCryptoDecrypt(o,T.key.buffer,T.iv.buffer,C).then(I=>{const P=this.push(I,null,r);return this.decryptionPromise=null,P}),this.decryptionPromise}const w=this.needsProbing(u,d);if(w){const R=this.configureTransmuxer(o);if(R)return this.logger.warn(`[transmuxer] ${R.message}`),this.observer.emit(S.ERROR,S.ERROR,{type:J.MEDIA_ERROR,details:N.FRAG_PARSING_ERROR,fatal:!1,error:R,reason:R.message}),i.executeEnd=rr(),td(r)}(u||d||p||w)&&this.resetInitSegment(E,m,g,x,t),(u||p||w)&&this.resetInitialTimestamp(v),c||this.resetContiguity();const L=this.transmux(o,T,h,f,r);this.asyncResult=ea(L);const A=this.currentTransmuxState;return A.contiguous=!0,A.discontinuity=!1,A.trackSwitch=!1,i.executeEnd=rr(),L}flush(e){const t=e.transmuxing;t.executeStart=rr();const{decrypter:r,currentTransmuxState:s,decryptionPromise:i}=this;if(i)return this.asyncResult=!0,i.then(()=>this.flush(e));const o=[],{timeOffset:a}=s;if(r){const d=r.flush();d&&o.push(this.push(d.buffer,null,e))}const{demuxer:l,remuxer:c}=this;if(!l||!c){t.executeEnd=rr();const d=[td(e)];return this.asyncResult?Promise.resolve(d):d}const u=l.flush(a);return ea(u)?(this.asyncResult=!0,u.then(d=>(this.flushRemux(o,d,e),o))):(this.flushRemux(o,u,e),this.asyncResult?Promise.resolve(o):o)}flushRemux(e,t,r){const{audioTrack:s,videoTrack:i,id3Track:o,textTrack:a}=t,{accurateTimeOffset:l,timeOffset:c}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${r.sn}${r.part>-1?" part: "+r.part:""} of ${this.id===Z.MAIN?"level":"track"} ${r.level}`);const u=this.remuxer.remux(s,i,o,a,c,l,!0,this.id);e.push({remuxResult:u,chunkMeta:r}),r.transmuxing.executeEnd=rr()}resetInitialTimestamp(e){const{demuxer:t,remuxer:r}=this;!t||!r||(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,s,i){const{demuxer:o,remuxer:a}=this;!o||!a||(o.resetInitSegment(e,t,r,s),a.resetInitSegment(e,t,r,i))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,s,i){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,r,s,i):o=this.transmuxUnencrypted(e,r,s,i),o}transmuxUnencrypted(e,t,r,s){const{audioTrack:i,videoTrack:o,id3Track:a,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(i,o,a,l,t,r,!1,this.id),chunkMeta:s}}transmuxSampleAes(e,t,r,s,i){return this.demuxer.demuxSampleAes(e,t,r).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,r,s,!1,this.id),chunkMeta:i}))}configureTransmuxer(e){const{config:t,observer:r,typeSupported:s}=this;let i;for(let d=0,f=Tl.length;d<f;d++){var o;if((o=Tl[d].demux)!=null&&o.probe(e,this.logger)){i=Tl[d];break}}if(!i)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,l=this.remuxer,c=i.remux,u=i.demux;(!l||!(l instanceof c))&&(this.remuxer=new c(r,t,s,this.logger)),(!a||!(a instanceof u))&&(this.demuxer=new u(r,t,s,this.logger),this.probe=u.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new vm(this.config)),e}}function BD(n,e){let t=null;return n.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const td=n=>({remuxResult:{},chunkMeta:n});function ea(n){return"then"in n&&n.then instanceof Function}class UD{constructor(e,t,r,s,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=s,this.defaultInitPts=i||null}}class jD{constructor(e,t,r,s,i,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=s,this.timeOffset=i,this.initSegmentChange=o}}let $0=0;class vT{constructor(e,t,r,s){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=$0++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=l=>{const c=l.data,u=this.hls;if(!(!u||!(c!=null&&c.event)||c.instanceNo!==this.instanceNo))switch(c.event){case"init":{var d;const f=(d=this.workerContext)==null?void 0:d.objectURL;f&&self.URL.revokeObjectURL(f);break}case"transmuxComplete":{this.handleTransmuxComplete(c.data);break}case"flush":{this.onFlush(c.data);break}case"workerLog":{u.logger[c.data.logType]&&u.logger[c.data.logType](c.data.message);break}default:{c.data=c.data||{},c.data.frag=this.frag,c.data.part=this.part,c.data.id=this.id,u.trigger(c.event,c.data);break}}},this.onWorkerError=l=>{if(!this.hls)return;const c=new Error(`${l.message}  (${l.filename}:${l.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(S.ERROR,{type:J.OTHER_ERROR,details:N.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:c})};const i=e.config;this.hls=e,this.id=t,this.useWorker=!!i.enableWorker,this.onTransmuxComplete=r,this.onFlush=s;const o=(l,c)=>{c=c||{},c.frag=this.frag||void 0,l===S.ERROR&&(c=c,c.parent=this.id,c.part=this.part,this.error=c.error),this.hls.trigger(l,c)};this.observer=new Tm,this.observer.on(S.FRAG_DECRYPTED,o),this.observer.on(S.ERROR,o);const a=t0(i.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const l=this.hls.logger;if(i.workerPath||KP()){try{i.workerPath?(l.log(`loading Web Worker ${i.workerPath} for "${t}"`),this.workerContext=WP(i.workerPath)):(l.log(`injecting Web Worker for "${t}"`),this.workerContext=zP());const{worker:u}=this.workerContext;u.addEventListener("message",this.onWorkerMessage),u.addEventListener("error",this.onWorkerError),u.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:a,id:t,config:Ie(i)})}catch(u){l.warn(`Error setting up "${t}" Web Worker, fallback to inline`,u),this.terminateWorker(),this.error=null,this.transmuxer=new F0(this.observer,a,i,"",t,e.logger)}return}}this.transmuxer=new F0(this.observer,a,i,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=$0++;const t=this.hls.config,r=t0(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:Ie(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),YP(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,r,s,i,o,a,l,c,u){var d,f;c.transmuxing.start=self.performance.now();const{instanceNo:h,transmuxer:p}=this,m=o?o.start:i.start,g=i.decryptdata,v=this.frag,x=!(v&&i.cc===v.cc),E=!(v&&c.level===v.level),T=v?c.sn-v.sn:-1,w=this.part?c.part-this.part.index:-1,L=T===0&&c.id>1&&c.id===(v==null?void 0:v.stats.chunkCount),A=!E&&(T===1||T===0&&(w===1||L&&w<=0)),R=self.performance.now();(E||T||i.stats.parsing.start===0)&&(i.stats.parsing.start=R),o&&(w||!A)&&(o.stats.parsing.start=R);const C=!(v&&((d=i.initSegment)==null?void 0:d.url)===((f=v.initSegment)==null?void 0:f.url)),I=new jD(x,A,l,E,m,C);if(!A||x||C){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${i.type} sn: ${c.sn}${c.part>-1?" part: "+c.part:""} ${this.id===Z.MAIN?"level":"track"}: ${c.level} id: ${c.id}
        discontinuity: ${x}
        trackSwitch: ${E}
        contiguous: ${A}
        accurateTimeOffset: ${l}
        timeOffset: ${m}
        initSegmentChange: ${C}`);const P=new UD(r,s,t,a,u);this.configureTransmuxer(P)}if(this.frag=i,this.part=o,this.workerContext)this.workerContext.worker.postMessage({instanceNo:h,cmd:"demux",data:e,decryptdata:g,chunkMeta:c,state:I},e instanceof ArrayBuffer?[e]:[]);else if(p){const P=p.push(e,g,c,I);ea(P)?P.then(O=>{this.handleTransmuxComplete(O)}).catch(O=>{this.transmuxerError(O,c,"transmuxer-interface push error")}):this.handleTransmuxComplete(P)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:r}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(r){const s=r.flush(e);ea(s)?s.then(i=>{this.handleFlushResult(i,e)}).catch(i=>{this.transmuxerError(i,e,"transmuxer-interface flush error")}):this.handleFlushResult(s,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(S.ERROR,{type:J.MEDIA_ERROR,details:N.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:r}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):r&&r.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const B0=100;class GD extends Sm{constructor(e,t,r){super(e,t,r,"audio-stream-controller",Z.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(S.LEVEL_LOADED,this.onLevelLoaded,this),e.on(S.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(S.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(S.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(S.BUFFER_RESET,this.onBufferReset,this),e.on(S.BUFFER_CREATED,this.onBufferCreated,this),e.on(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(S.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(S.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(S.FRAG_LOADING,this.onFragLoading,this),e.on(S.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(S.LEVEL_LOADED,this.onLevelLoaded,this),e.off(S.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(S.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(S.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(S.BUFFER_RESET,this.onBufferReset,this),e.off(S.BUFFER_CREATED,this.onBufferCreated,this),e.off(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(S.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(S.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(S.FRAG_LOADING,this.onFragLoading,this),e.off(S.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:r,initPTS:s,timescale:i,trackId:o}){if(r===Z.MAIN){const a=t.cc,l=this.fragCurrent;if(this.initPTS[a]={baseTime:s,timescale:i,trackId:o},this.log(`InitPTS for cc: ${a} found from main: ${s/i} (${s}/${i}) trackId: ${o}`),this.mainAnchor=t,this.state===j.WAITING_INIT_PTS){const c=this.waitingData;(!c&&!this.loadingParts||c&&c.frag.cc!==a)&&this.syncWithAnchor(t,c==null?void 0:c.frag)}else!this.hls.hasEnoughToStart&&l&&l.cc!==a?(l.abortRequests(),this.syncWithAnchor(t,l)):this.state===j.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var r;const s=((r=this.mainFragLoading)==null?void 0:r.frag)||null;if(t&&(s==null?void 0:s.cc)===t.cc)return;const i=(s||e).cc,o=this.getLevelDetails(),a=this.getLoadPosition(),l=FS(o,i,a);l&&(this.log(`Syncing with main frag at ${l.start} cc ${l.cc}`),this.startFragRequested=!1,this.nextLoadPosition=l.start,this.resetLoadingState(),this.state===j.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=j.STOPPED;return}const r=this.lastCurrentTime;this.stopLoad(),this.setInterval(B0),r>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r,this.state=j.IDLE):this.state=j.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case j.IDLE:this.doTickIdle();break;case j.WAITING_TRACK:{const{levels:e,trackId:t}=this,r=e==null?void 0:e[t],s=r==null?void 0:r.details;if(s&&!this.waitForLive(r)){if(this.waitForCdnTuneIn(s))break;this.state=j.WAITING_INIT_PTS}break}case j.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case j.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:r,cache:s,complete:i}=e,o=this.mainAnchor;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.state=j.FRAG_LOADING;const a=s.flush().buffer,l={frag:t,part:r,payload:a,networkDetails:null};this._handleFragmentLoadProgress(l),i&&super._handleFragmentLoadComplete(l)}else o&&o.cc!==e.frag.cc&&this.syncWithAnchor(o,e.frag)}else this.state=j.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:r,media:s,trackId:i}=this,o=t.config;if(!this.buffering||!s&&!this.primaryPrefetch&&(this.startFragRequested||!o.startFragPrefetch)||!(r!=null&&r[i]))return;const a=r[i],l=a.details;if(!l||this.waitForLive(a)||this.waitForCdnTuneIn(l)){this.state=j.WAITING_TRACK,this.startFragRequested=!1;return}const c=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&c&&(this.bufferFlushed=!1,this.afterBufferFlushed(c,Se.AUDIO,Z.AUDIO));const u=this.getFwdBufferInfo(c,Z.AUDIO);if(u===null)return;if(!this.switchingTrack&&this._streamEnded(u,l)){t.trigger(S.BUFFER_EOS,{type:"audio"}),this.state=j.ENDED;return}const d=u.len,f=t.maxBufferLength,h=l.fragments,p=h[0].start,m=this.getLoadPosition(),g=this.flushing?m:u.end;if(this.switchingTrack&&s){const E=m;l.PTSKnown&&E<p&&(u.end>p||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=p+.05)}if(d>=f&&!this.switchingTrack&&g<h[h.length-1].start)return;let v=this.getNextFragment(g,l);if(v&&this.isLoopLoading(v,g)&&(v=this.getNextFragmentLoopLoading(v,l,u,Z.MAIN,f)),!v){this.bufferFlushed=!0;return}let x=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&x&&Ge(v)&&!v.endList&&(!l.live||!this.loadingParts&&g<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(x)===ze.OK&&(this.mainFragLoading=x=null),x&&Ge(x))){if(v.start>x.end){const T=this.fragmentTracker.getFragAtPos(g,Z.MAIN);T&&T.end>x.end&&(x=T,this.mainFragLoading={frag:T,targetBufferTime:null})}if(v.start>x.end)return}this.loadFragment(v,a,g)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(r=>new Xo(r))}onAudioTrackSwitching(e,t){const r=!!t.url;this.trackId=t.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),r?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==j.STOPPED&&(this.setInterval(B0),this.state=j.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(S.AUDIO_TRACK_LOADED,r))}onAudioTrackLoaded(e,t){var r;const{levels:s}=this,{details:i,id:o,groupId:a,track:l}=t;if(!s){this.warn(`Audio tracks reset while loading track ${o} "${l.name}" of "${a}"`);return}const c=this.mainDetails;if(!c||i.endCC>c.endCC||c.expired){this.cachedTrackLoadedData=t,this.state!==j.STOPPED&&(this.state=j.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${o} "${l.name}" of "${a}" loaded [${i.startSN},${i.endSN}]${i.lastPartSn?`[part-${i.lastPartSn}-${i.lastPartIndex}]`:""},duration:${i.totalduration}`);const u=s[o];let d=0;if(i.live||(r=u.details)!=null&&r.live){if(this.checkLiveUpdate(i),i.deltaUpdateFailed)return;if(u.details){var f;d=this.alignPlaylists(i,u.details,(f=this.levelLastLoaded)==null?void 0:f.details)}i.alignedSliding||(XS(i,c),i.alignedSliding||hc(i,c),d=i.fragmentStart)}u.details=i,this.levelLastLoaded=u,this.startFragRequested||this.setStartPosition(c,d),this.hls.trigger(S.AUDIO_TRACK_UPDATED,{details:i,id:o,groupId:t.groupId}),this.state===j.WAITING_TRACK&&!this.waitForCdnTuneIn(i)&&(this.state=j.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:s,payload:i}=e,{config:o,trackId:a,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const c=l[a];if(!c){this.warn("Audio track is undefined on fragment load progress");return}const u=c.details;if(!u){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}const d=o.defaultAudioCodec||c.audioCodec||"mp4a.40.2";let f=this.transmuxer;f||(f=this.transmuxer=new vT(this.hls,Z.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const h=this.initPTS[r.cc],p=(t=r.initSegment)==null?void 0:t.data;if(h!==void 0){const g=s?s.index:-1,v=g!==-1,x=new ym(r.level,r.sn,r.stats.chunkCount,i.byteLength,g,v);f.push(i,p,d,"",r,s,u.totalduration,!1,x,h)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${u.startSN} ,${u.endSN}],track ${a}`);const{cache:m}=this.waitingData=this.waitingData||{frag:r,part:s,cache:new ZS,complete:!1};m.push(new Uint8Array(i)),this.state!==j.STOPPED&&(this.state=j.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===Z.MAIN&&Ge(t.frag)&&(this.mainFragLoading=t,this.state===j.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:r,part:s}=t;if(r.type!==Z.AUDIO){!this.audioOnly&&r.type===Z.MAIN&&!r.elementaryStreams.video&&!r.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${s?" p: "+s.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(Ge(r)){this.fragPrevious=r;const i=this.switchingTrack;i&&(this.bufferedTrack=i,this.switchingTrack=null,this.hls.trigger(S.AUDIO_TRACK_SWITCHED,ye({},i)))}this.fragBufferedComplete(r,s),this.media&&this.tick()}onError(e,t){var r;if(t.fatal){this.state=j.ERROR;return}switch(t.details){case N.FRAG_GAP:case N.FRAG_PARSING_ERROR:case N.FRAG_DECRYPT_ERROR:case N.FRAG_LOAD_ERROR:case N.FRAG_LOAD_TIMEOUT:case N.KEY_LOAD_ERROR:case N.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Z.AUDIO,t);break;case N.AUDIO_TRACK_LOAD_ERROR:case N.AUDIO_TRACK_LOAD_TIMEOUT:case N.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===j.WAITING_TRACK&&((r=t.context)==null?void 0:r.type)===ce.AUDIO_TRACK&&(this.state=j.IDLE);break;case N.BUFFER_ADD_CODEC_ERROR:case N.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case N.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case N.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==Se.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==Se.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===j.ENDED&&(this.state=j.IDLE);const r=this.mediaBuffer||this.media;r&&(this.afterBufferFlushed(r,t,Z.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const r="audio",{hls:s}=this,{remuxResult:i,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:c,level:u}=a,{details:d}=u,{audio:f,text:h,id3:p,initSegment:m}=i;if(this.fragContextChanged(l)||!d){this.fragmentTracker.removeFragment(l);return}if(this.state=j.PARSING,this.switchingTrack&&f&&this.completeAudioSwitch(this.switchingTrack),m!=null&&m.tracks){const g=l.initSegment||l;if(this.unhandledEncryptionError(m,l))return;this._bufferInitSegment(u,m.tracks,g,o),s.trigger(S.FRAG_PARSING_INIT_SEGMENT,{frag:g,id:r,tracks:m.tracks})}if(f){const{startPTS:g,endPTS:v,startDTS:x,endDTS:E}=f;c&&(c.elementaryStreams[Se.AUDIO]={startPTS:g,endPTS:v,startDTS:x,endDTS:E}),l.setElementaryStreamInfo(Se.AUDIO,g,v,x,E),this.bufferFragmentData(f,l,c,o)}if(p!=null&&(t=p.samples)!=null&&t.length){const g=Ee({id:r,frag:l,details:d},p);s.trigger(S.FRAG_PARSING_METADATA,g)}if(h){const g=Ee({id:r,frag:l,details:d},h);s.trigger(S.FRAG_PARSING_USERDATA,g)}}_bufferInitSegment(e,t,r,s){if(this.state!==j.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const i=t.audio;i.id=Z.AUDIO;const o=e.audioCodec;this.log(`Init audio buffer, container:${i.container}, codecs[level/parsed]=[${o}/${i.codec}]`),o&&o.split(",").length===1&&(i.levelCodec=o),this.hls.trigger(S.BUFFER_CODECS,t);const a=i.initSegment;if(a!=null&&a.byteLength){const l={type:"audio",frag:r,part:null,chunkMeta:s,parent:r.type,data:a};this.hls.trigger(S.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,t,r){const s=this.fragmentTracker.getState(e);if(this.switchingTrack||s===ze.NOT_LOADED||s===ze.PARTIAL){var i;if(!Ge(e))this._loadInitSegment(e,t);else if((i=t.details)!=null&&i.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=j.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragmentStart!==t.details.fragmentStart&&hc(t.details,o)}else super.loadFragment(e,t,r)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:r,assocLang:s,characteristics:i,audioCodec:o,channels:a}=this.bufferedTrack;Is({name:t,lang:r,assocLang:s,characteristics:i,audioCodec:o,channels:a},e,ps)||(cc(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(S.AUDIO_TRACK_SWITCHED,ye({},e))}}class Cm extends tn{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,r){const s=t==null?void 0:t.renditionReports;if(s){let i=-1;for(let o=0;o<s.length;o++){const a=s[o];let l;try{l=new self.URL(a.URI,t.url).href}catch(c){this.warn(`Could not construct new URL for Rendition Report: ${c}`),l=a.URI||""}if(l===e){i=o;break}else l===e.substring(0,l.length)&&(i=o)}if(i!==-1){const o=s[i],a=parseInt(o["LAST-MSN"])||t.lastPartSn;let l=parseInt(o["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const u=Math.min(t.age-t.partTarget,t.targetduration);l>=0&&u>t.partTarget&&(l+=1)}const c=r&&n0(r);return new r0(a,l>=0?l:void 0,c)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(r){this.warn(`Could not construct new URL with HLS Delivery Directives: ${r}`)}return e}playlistLoaded(e,t,r){const{details:s,stats:i}=t,o=self.performance.now(),a=i.loading.first?Math.max(0,o-i.loading.first):0;s.advancedDateTime=Date.now()-a;const l=this.hls.config.timelineOffset;if(l!==s.appliedTimelineOffset){const u=Math.max(l||0,0);s.appliedTimelineOffset=u,s.fragments.forEach(d=>{d.setStart(d.playlistOffset+u)})}if(s.live||r!=null&&r.live){const u="levelInfo"in t?t.levelInfo:t.track;if(s.reloaded(r),r&&s.fragments.length>0){NP(r,s,this);const x=s.playlistParsingError;if(x){this.warn(x);const E=this.hls;if(!E.config.ignorePlaylistParsingErrors){var c;const{networkDetails:T}=t;E.trigger(S.ERROR,{type:J.NETWORK_ERROR,details:N.LEVEL_PARSING_ERROR,fatal:!1,url:s.url,error:x,reason:x.message,level:t.level||void 0,parent:(c=s.fragments[0])==null?void 0:c.type,networkDetails:T,stats:i});return}s.playlistParsingError=null}}s.requestScheduled===-1&&(s.requestScheduled=i.loading.start);const d=this.hls.mainForwardBufferInfo,f=d?d.end-d.len:0,h=(s.edge-f)*1e3,p=zS(s,h);if(s.requestScheduled+p<o?s.requestScheduled=o:s.requestScheduled+=p,this.log(`live playlist ${e} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),!this.canLoad||!s.live)return;let m,g,v;if(s.canBlockReload&&s.endSN&&s.advanced){const x=this.hls.config.lowLatencyMode,E=s.lastPartSn,T=s.endSN,w=s.lastPartIndex,L=w!==-1,A=E===T;L?A?(g=T+1,v=x?0:w):(g=E,v=x?w+1:s.maxPartIndex):g=T+1;const R=s.age,C=R+s.ageHeader;let I=Math.min(C-s.partTarget,s.targetduration*1.5);if(I>0){if(C>s.targetduration*3)this.log(`Playlist last advanced ${R.toFixed(2)}s ago. Omitting segment and part directives.`),g=void 0,v=void 0;else if(r!=null&&r.tuneInGoal&&C-s.partTarget>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${I} with playlist age: ${s.age}`),I=0;else{const P=Math.floor(I/s.targetduration);if(g+=P,v!==void 0){const O=Math.round(I%s.targetduration/s.partTarget);v+=O}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${R.toFixed(2)}s goal: ${I} skip sn ${P} to part ${v}`)}s.tuneInGoal=I}if(m=this.getDeliveryDirectives(s,t.deliveryDirectives,g,v),x||!A){s.requestScheduled=o,this.loadingPlaylist(u,m);return}}else(s.canBlockReload||s.canSkipUntil)&&(m=this.getDeliveryDirectives(s,t.deliveryDirectives,g,v));m&&g!==void 0&&s.canBlockReload&&(s.requestScheduled=i.loading.first+Math.max(p-a*2,p/2)),this.scheduleLoading(u,m,s)}else this.clearTimer()}scheduleLoading(e,t,r){const s=r||e.details;if(!s){this.loadingPlaylist(e,t);return}const i=self.performance.now(),o=s.requestScheduled;if(i>=o){this.loadingPlaylist(e,t);return}const a=o-i;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(a)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),a)}getDeliveryDirectives(e,t,r,s){let i=n0(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,s=t.part,i=xl.No),new r0(r,s,i)}checkRetry(e){const t=e.details,r=uc(e),s=e.errorAction,{action:i,retryCount:o=0,retryConfig:a}=s||{},l=!!s&&!!a&&(i===rt.RetryRequest||!s.resolved&&i===rt.SendAlternateToPenaltyBox);if(l){var c;if(o>=a.maxNumRetry)return!1;if(r&&(c=e.context)!=null&&c.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const u=gm(a,o);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),u),this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" in ${u}ms`)}e.levelRetry=!0,s.resolved=!0}return l}}function yT(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!ta(n[t].attrs,e[t].attrs))return!1;return!0}function ta(n,e,t){const r=n["STABLE-RENDITION-ID"];return r&&!t?r===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(s=>n[s]!==e[s])}function Vf(n,e){return e.label.toLowerCase()===n.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(n.lang||"").toLowerCase())}class VD extends Cm{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_PARSED,this.onManifestParsed,this),e.on(S.LEVEL_LOADING,this.onLevelLoading,this),e.on(S.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(S.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(S.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_PARSED,this.onManifestParsed,this),e.off(S.LEVEL_LOADING,this.onLevelLoading,this),e.off(S.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(S.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(S.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:r,groupId:s,details:i}=t,o=this.tracksInGroup[r];if(!o||o.groupId!==s){this.warn(`Audio track with id:${r} and group:${s} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Audio track ${r} "${o.name}" lang:${o.lang} group:${s} loaded [${i.startSN}-${i.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.audioGroups||null,s=this.groupIds;let i=this.currentTrack;if(!r||(s==null?void 0:s.length)!==(r==null?void 0:r.length)||r!=null&&r.some(a=>(s==null?void 0:s.indexOf(a))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(f=>!r||r.indexOf(f.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(f=>f.default)&&(this.selectDefaultTrack=!1),a.forEach((f,h)=>{f.id=h});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const l=this.hls.config.audioPreference;if(!i&&l){const f=Bn(l,a,ps);if(f>-1)i=a[f];else{const h=Bn(l,this.tracks);i=this.tracks[h]}}let c=this.findTrackId(i);c===-1&&i&&(c=this.findTrackId(null));const u={audioTracks:a};this.log(`Updating audio tracks, ${a.length} track(s) found in group(s): ${r==null?void 0:r.join(",")}`),this.hls.trigger(S.AUDIO_TRACKS_UPDATED,u);const d=this.trackId;if(c!==-1&&d===-1)this.setAudioTrack(c);else if(a.length&&d===-1){var o;const f=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${a.length}`);this.warn(f.message),this.hls.trigger(S.ERROR,{type:J.MEDIA_ERROR,details:N.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:f})}}}onError(e,t){t.fatal||!t.context||t.context.type===ce.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){const s=this.currentTrack;if(s&&Is(e,s,ps))return s;const i=Bn(e,this.tracksInGroup,ps);if(i>-1){const o=this.tracksInGroup[i];return this.setAudioTrack(i),o}else if(s){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const a=J_(e,t.levels,r,o,ps);if(a===-1)return null;t.nextLoadLevel=a}if(e.channels||e.audioCodec){const o=Bn(e,r);if(o>-1)return r[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,s=t[e],i=s.details&&!s.details.live;if(e===this.trackId&&s===r&&i||(this.log(`Switching to audio-track ${e} "${s.name}" lang:${s.lang} group:${s.groupId} channels:${s.channels}`),this.trackId=e,this.currentTrack=s,this.hls.trigger(S.AUDIO_TRACK_SWITCHING,ye({},s)),i))return;const o=this.switchParams(s.url,r==null?void 0:r.details,s.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const s=t[r];if(!(this.selectDefaultTrack&&!s.default)&&(!e||Is(e,s,ps)))return r}if(e){const{name:r,lang:s,assocLang:i,characteristics:o,audioCodec:a,channels:l}=e;for(let c=0;c<t.length;c++){const u=t[c];if(Is({name:r,lang:s,assocLang:i,characteristics:o,audioCodec:a,channels:l},u,ps))return c}for(let c=0;c<t.length;c++){const u=t[c];if(ta(e.attrs,u.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return c}for(let c=0;c<t.length;c++){const u=t[c];if(ta(e.attrs,u.attrs,["LANGUAGE"]))return c}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&cc(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,s=e.groupId,i=this.getUrlWithDirectives(e.url,t),o=e.details,a=o==null?void 0:o.age;this.log(`Loading audio-track ${r} "${e.name}" lang:${e.lang} group:${s}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${a&&o.live?" age "+a.toFixed(1)+(o.type&&" "+o.type||""):""} ${i}`),this.hls.trigger(S.AUDIO_TRACK_LOADING,{url:i,id:r,groupId:s,deliveryDirectives:t||null,track:e})}}class HD{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,r){if(this.queues===null||this.tracks===null)return;const s=this.queues[t];s.push(e),s.length===1&&!r&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const r={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(r,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const r={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(r)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const r=(t=e[0])==null?void 0:t.label;(r==="async-blocker"||r==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const s=t[0];try{s.execute()}catch(i){var r;if(s.onError(i),this.queues===null||this.tracks===null)return;const o=(r=this.tracks[e])==null?void 0:r.buffer;o!=null&&o.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,r;return(t=this.queues)!=null&&t[e]||(r=this.tracks)!=null&&r[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const r=(t=this.tracks)==null?void 0:t[e],s=r==null?void 0:r.buffer;return s?`SourceBuffer${s.updating?" updating":""}${r.ended?" ended":""}${r.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(r=>r.label).join(", "))||""}}const U0=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,xT="HlsJsTrackRemovedError";class KD extends Error{constructor(e){super(e),this.name=xT}}class zD extends tn{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=r=>{var s;this.hls&&((s=this.mediaSource)==null?void 0:s.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=r=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=r=>{const{media:s,mediaSource:i}=this;r&&this.log("Media source opened"),!(!s||!i)&&(i.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(S.MEDIA_ATTACHED,{media:s,mediaSource:i}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:r,_objectUrl:s}=this;r!==s&&this.error(`Media element src was set while attaching MediaSource (${s} > ${r})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=p_(ts(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_PARSED,this.onManifestParsed,this),e.on(S.BUFFER_RESET,this.onBufferReset,this),e.on(S.BUFFER_APPENDING,this.onBufferAppending,this),e.on(S.BUFFER_CODECS,this.onBufferCodecs,this),e.on(S.BUFFER_EOS,this.onBufferEos,this),e.on(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(S.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(S.FRAG_PARSED,this.onFragParsed,this),e.on(S.FRAG_CHANGED,this.onFragChanged,this),e.on(S.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_PARSED,this.onManifestParsed,this),e.off(S.BUFFER_RESET,this.onBufferReset,this),e.off(S.BUFFER_APPENDING,this.onBufferAppending,this),e.off(S.BUFFER_CODECS,this.onBufferCodecs,this),e.off(S.BUFFER_EOS,this.onBufferEos,this),e.off(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(S.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(S.FRAG_PARSED,this.onFragParsed,this),e.off(S.FRAG_CHANGED,this.onFragChanged,this),e.off(S.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const r={};if(this.operationQueue){const i=this.isUpdating();i||this.operationQueue.removeBlockers();const o=this.isQueued();(i||o)&&this.warn(`Transfering MediaSource with${o?" operations in queue":""}${i?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const s=this.transferData;return!this.sourceBufferCount&&s&&s.mediaSource===t?Ee(r,s.tracks):this.sourceBuffers.forEach(i=>{const[o]=i;o&&(r[o]=Ee({},this.tracks[o]),this.removeBuffer(o)),i[0]=i[1]=null}),{media:e,mediaSource:t,tracks:r}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var r;let s=2;(t.audio&&!t.video||!t.altAudio)&&(s=1),this.bufferCodecEventsTotal=s,this.log(`${s} bufferCodec event(s) expected.`),(r=this.transferData)!=null&&r.mediaSource&&this.sourceBufferCount&&s&&this.bufferCreated()}onMediaAttaching(e,t){const r=this.media=t.media;this.transferData=this.overrides=void 0;const s=ts(this.appendSource);if(s){const i=!!t.mediaSource;(i||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const o=this.mediaSource=t.mediaSource||new s;if(this.assignMediaSource(o),i)this._objectUrl=r.src,this.attachTransferred();else{const a=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{r.removeAttribute("src");const l=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||l&&o instanceof l,j0(r),WD(r,a),r.load()}catch{r.src=a}else r.src=a}r.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,r;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(r=e.constructor)==null?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const r=this.tracks,s=t.tracks,i=s?Object.keys(s):null,o=i?i.length:0,a=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(s&&i&&o){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${Ie(r,(l,c)=>l==="initSegment"?void 0:c)};
transfer tracks: ${Ie(s,(l,c)=>l==="initSegment"?void 0:c)}}`),!ES(s,r)){t.mediaSource=null,t.tracks=void 0;const l=e.currentTime,c=this.details,u=Math.max(l,(c==null?void 0:c.fragments[0].start)||0);if(u-l>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${l} -> ${u}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(s)}"->"${Object.keys(r)}") start time: ${u} currentTime: ${l}`),this.onMediaDetaching(S.MEDIA_DETACHING,{}),this.onMediaAttaching(S.MEDIA_ATTACHING,t),e.currentTime=u;return}this.transferData=void 0,i.forEach(l=>{const c=l,u=s[c];if(u){const d=u.buffer;if(d){const f=this.fragmentTracker,h=u.id;if(f.hasFragments(h)||f.hasParts(h)){const g=se.getBuffered(d);f.detectEvictedFragments(c,g,h,null,!0)}const p=nd(c),m=[c,d];this.sourceBuffers[p]=m,d.updating&&this.operationQueue&&this.operationQueue.prependBlocker(c),this.trackSourceBuffer(c,u)}}}),a(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),a()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const r=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:s,mediaSource:i,_objectUrl:o}=this;if(i){if(this.log(`media source ${r?"transferring":"detaching"}`),r)this.sourceBuffers.forEach(([a])=>{a&&this.removeBuffer(a)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const a=i.readyState==="open";try{const l=i.sourceBuffers;for(let c=l.length;c--;)a&&l[c].abort(),i.removeSourceBuffer(l[c]);a&&i.endOfStream()}catch(l){this.warn(`onMediaDetaching: ${l.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(i.removeEventListener("startstreaming",this._onStartStreaming),i.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}s&&(s.removeEventListener("emptied",this._onMediaEmptied),r||(o&&self.URL.revokeObjectURL(o),this.mediaSrc===o?(s.removeAttribute("src"),this.appendSource&&j0(s),s.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(S.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const r=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),r)try{var s;(s=this.mediaSource)!=null&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(i){this.warn(`onBufferReset ${e}`,i)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[nd(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new HD(this.tracks)}onBufferCodecs(e,t){const r=this.tracks,s=Object.keys(t);this.log(`BUFFER_CODECS: "${s}" (current SB count ${this.sourceBufferCount})`);const i="audiovideo"in t&&(r.audio||r.video)||r.audiovideo&&("audio"in t||"video"in t),o=!i&&this.sourceBufferCount&&this.media&&s.some(a=>!r[a]);if(i||o){this.warn(`Unsupported transition between "${Object.keys(r)}" and "${s}" SourceBuffers`);return}s.forEach(a=>{var l,c;const u=t[a],{id:d,codec:f,levelCodec:h,container:p,metadata:m,supplemental:g}=u;let v=r[a];const x=(l=this.transferData)==null||(l=l.tracks)==null?void 0:l[a],E=x!=null&&x.buffer?x:v,T=(E==null?void 0:E.pendingCodec)||(E==null?void 0:E.codec),w=E==null?void 0:E.levelCodec;v||(v=r[a]={buffer:void 0,listeners:[],codec:f,supplemental:g,container:p,levelCodec:h,metadata:m,id:d});const L=yl(T,w),A=L==null?void 0:L.replace(U0,"$1");let R=yl(f,h);const C=(c=R)==null?void 0:c.replace(U0,"$1");R&&L&&A!==C&&(a.slice(0,5)==="audio"&&(R=ac(R,this.appendSource)),this.log(`switching codec ${T} to ${R}`),R!==(v.pendingCodec||v.codec)&&(v.pendingCodec=R),v.container=p,this.appendChangeType(a,p,R))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const r=this.tracks[t];return e[t]={id:r.id,container:r.container,codec:r.codec,levelCodec:r.levelCodec},e},{})}appendChangeType(e,t,r){const s=`${t};codecs=${r}`,i={label:`change-type=${s}`,execute:()=>{const o=this.tracks[e];if(o){const a=o.buffer;a!=null&&a.changeType&&(this.log(`changing ${e} sourceBuffer type to ${s}`),a.changeType(s),o.codec=r,o.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn(`Failed to change ${e} SourceBuffer type`,o)}};this.append(i,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const r=e.start,s=r+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(r,Z.MAIN))==null?void 0:t.gap)===!0)return;const o={label:"block-audio",execute:()=>{var a;const l=this.tracks.video;(this.lastVideoAppendEnd>s||l!=null&&l.buffer&&se.isBuffered(l.buffer,s)||((a=this.fragmentTracker.getAppendedFrag(s,Z.MAIN))==null?void 0:a.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn("Error executing block-audio operation",a)}};this.blockedAudioAppend={op:o,frag:e},this.append(o,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:r}=this,{data:s,type:i,parent:o,frag:a,part:l,chunkMeta:c,offset:u}=t,d=c.buffering[i],{sn:f,cc:h}=a,p=self.performance.now();d.start=p;const m=a.stats.buffering,g=l?l.stats.buffering:null;m.start===0&&(m.start=p),g&&g.start===0&&(g.start=p);const v=r.audio;let x=!1;i==="audio"&&(v==null?void 0:v.container)==="audio/mpeg"&&(x=!this.lastMpegAudioChunk||c.id===1||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);const E=r.video,T=E==null?void 0:E.buffer;if(T&&f!=="initSegment"){const A=l||a,R=this.blockedAudioAppend;if(i==="audio"&&o!=="main"&&!this.blockedAudioAppend&&!(E.ending||E.ended)){const I=A.start+A.duration*.05,P=T.buffered,O=this.currentOp("video");!P.length&&!O?this.blockAudio(A):!O&&!se.isBuffered(T,I)&&this.lastVideoAppendEnd<I&&this.blockAudio(A)}else if(i==="video"){const C=A.end;if(R){const I=R.frag.start;(C>I||C<this.lastVideoAppendEnd||se.isBuffered(T,I))&&this.unblockAudio()}this.lastVideoAppendEnd=C}}const w=(l||a).start,L={label:`append-${i}`,execute:()=>{var A;d.executeStart=self.performance.now();const R=(A=this.tracks[i])==null?void 0:A.buffer;R&&(x?this.updateTimestampOffset(R,w,.1,i,f,h):u!==void 0&&q(u)&&this.updateTimestampOffset(R,u,1e-6,i,f,h)),this.appendExecutor(s,i)},onStart:()=>{},onComplete:()=>{const A=self.performance.now();d.executeEnd=d.end=A,m.first===0&&(m.first=A),g&&g.first===0&&(g.first=A);const R={};this.sourceBuffers.forEach(([C,I])=>{C&&(R[C]=se.getBuffered(I))}),this.appendErrors[i]=0,i==="audio"||i==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(S.BUFFER_APPENDED,{type:i,frag:a,part:l,chunkMeta:c,parent:a.type,timeRanges:R})},onError:A=>{var R;const C={type:J.MEDIA_ERROR,parent:a.type,details:N.BUFFER_APPEND_ERROR,sourceBufferName:i,frag:a,part:l,chunkMeta:c,error:A,err:A,fatal:!1},I=(R=this.media)==null?void 0:R.error;if(A.code===DOMException.QUOTA_EXCEEDED_ERR||A.name=="QuotaExceededError"||"quota"in A)C.details=N.BUFFER_FULL_ERROR;else if(A.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!I)C.errorAction=yi(!0);else if(A.name===xT&&this.sourceBufferCount===0)C.errorAction=yi(!0);else{const P=++this.appendErrors[i];this.warn(`Failed ${P}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${i}" sourceBuffer (${I||"no media error"})`),(P>=this.hls.config.appendErrorMaxRetry||I)&&(C.fatal=!0)}this.hls.trigger(S.ERROR,C)}};this.append(L,i,this.isPending(this.tracks[i]))}getFlushOp(e,t,r){return this.log(`queuing "${e}" remove ${t}-${r}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,r)},onStart:()=>{},onComplete:()=>{this.hls.trigger(S.BUFFER_FLUSHED,{type:e})},onError:s=>{this.warn(`Failed to remove ${t}-${r} from "${e}" SourceBuffer`,s)}}}onBufferFlushing(e,t){const{type:r,startOffset:s,endOffset:i}=t;r?this.append(this.getFlushOp(r,s,i),r):this.sourceBuffers.forEach(([o])=>{o&&this.append(this.getFlushOp(o,s,i),o)})}onFragParsed(e,t){const{frag:r,part:s}=t,i=[],o=s?s.elementaryStreams:r.elementaryStreams;o[Se.AUDIOVIDEO]?i.push("audiovideo"):(o[Se.AUDIO]&&i.push("audio"),o[Se.VIDEO]&&i.push("video"));const a=()=>{const l=self.performance.now();r.stats.buffering.end=l,s&&(s.stats.buffering.end=l);const c=s?s.stats:r.stats;this.hls.trigger(S.FRAG_BUFFERED,{frag:r,part:s,stats:c,id:r.type})};i.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(a,i).catch(l=>{this.warn(`Fragment buffered callback ${l}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var r;this.sourceBuffers.forEach(([o])=>{if(o){const a=this.tracks[o];(!t.type||t.type===o)&&(a.ending=!0,a.ended||(a.ended=!0,this.log(`${o} buffer reached EOS`)))}});const s=((r=this.overrides)==null?void 0:r.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([o])=>{var a;return o&&!((a=this.tracks[o])!=null&&a.ended)})?s?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:o}=this;if(!o||o.readyState!=="open"){o&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${o.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),o.endOfStream(),this.hls.trigger(S.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(S.BUFFERED_TO_END,void 0)):t.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===N.BUFFER_APPEND_ERROR&&t.frag){var r;const s=(r=t.errorAction)==null?void 0:r.nextAutoLevel;q(s)&&s!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:r}=this;if(!r||t===null||!this.sourceBufferCount)return;const s=e.config,i=r.currentTime,o=t.levelTargetDuration,a=t.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(q(a)&&a>=0){const c=Math.max(a,o),u=Math.floor(i/o)*o-c;this.flushBackBuffer(i,o,u)}const l=s.frontBufferFlushThreshold;if(q(l)&&l>0){const c=Math.max(s.maxBufferLength,l),u=Math.max(c,o),d=Math.floor(i/o)*o+u;this.flushFrontBuffer(i,o,d)}}flushBackBuffer(e,t,r){this.sourceBuffers.forEach(([s,i])=>{if(i){const a=se.getBuffered(i);if(a.length>0&&r>a.start(0)){var o;this.hls.trigger(S.BACK_BUFFER_REACHED,{bufferEnd:r});const l=this.tracks[s];if((o=this.details)!=null&&o.live)this.hls.trigger(S.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(l!=null&&l.ended){this.log(`Cannot flush ${s} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(S.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:s})}}})}flushFrontBuffer(e,t,r){this.sourceBuffers.forEach(([s,i])=>{if(i){const o=se.getBuffered(i),a=o.length;if(a<2)return;const l=o.start(a-1),c=o.end(a-1);if(r>l||e>=l&&e<=c)return;this.hls.trigger(S.BUFFER_FLUSHING,{startOffset:l,endOffset:1/0,type:s})}})}getDurationAndRange(){var e;const{details:t,mediaSource:r}=this;if(!t||!this.media||(r==null?void 0:r.readyState)!=="open")return null;const s=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&r.setLiveSeekableRange){const c=Math.max(0,t.fragmentStart),u=Math.max(c,s);return{duration:1/0,start:c,end:u}}return{duration:1/0}}const i=(e=this.overrides)==null?void 0:e.duration;if(i)return q(i)?{duration:i}:null;const o=this.media.duration,a=q(r.duration)?r.duration:0;return s>a&&s>o||!q(o)?{duration:s}:null}updateMediaSource({duration:e,start:t,end:r}){const s=this.mediaSource;!this.media||!s||s.readyState!=="open"||(s.duration!==e&&(q(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),s.duration=e),t!==void 0&&r!==void 0&&(this.log(`MediaSource duration is set to ${s.duration}. Setting seekable range to ${t}-${r}.`),s.setLiveSeekableRange(t,r)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:r}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${Ie(r)}`),this.tracksReady){var s;const i=(s=this.transferData)==null?void 0:s.tracks;i&&Object.keys(i).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,r])=>{if(t){const s=this.tracks[t];e[t]={buffer:r,container:s.container,codec:s.codec,supplemental:s.supplemental,levelCodec:s.levelCodec,id:s.id,metadata:s.metadata}}}),this.hls.trigger(S.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(S.ERROR,{type:J.MEDIA_ERROR,details:N.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:r}=this;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(const i in e){const o=i,a=e[o];if(this.isPending(a)){const l=this.getTrackCodec(a,o),c=`${a.container};codecs=${l}`;a.codec=l,this.log(`creating sourceBuffer(${c})${this.currentOp(o)?" Queued":""} ${Ie(a)}`);try{const u=r.addSourceBuffer(c),d=nd(o),f=[o,u];t[d]=f,a.buffer=u}catch(u){var s;this.error(`error while trying to add sourceBuffer: ${u.message}`),this.shiftAndExecuteNext(o),(s=this.operationQueue)==null||s.removeBlockers(),delete this.tracks[o],this.hls.trigger(S.ERROR,{type:J.MEDIA_ERROR,details:N.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:u,sourceBufferName:o,mimeType:c,parent:a.id});return}this.trackSourceBuffer(o,a)}}this.bufferCreated()}getTrackCodec(e,t){const r=e.supplemental;let s=e.codec;r&&(t==="video"||t==="audiovideo")&&Df(r,"video")&&(s=N_(s,r));const i=yl(s,e.levelCodec);return i?t.slice(0,5)==="audio"?ac(i,this.appendSource):i:""}trackSourceBuffer(e,t){const r=t.buffer;if(!r)return;const s=this.getTrackCodec(t,e);this.tracks[e]={buffer:r,codec:s,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(i,o)=>{const a=o.removedRanges;a!=null&&a.length&&this.hls.trigger(S.BUFFER_FLUSHED,{type:i})})}get mediaSrc(){var e,t;const r=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return r==null?void 0:r.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var r;const s=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(r=this.mediaSource)==null?void 0:r.readyState}`);this.error(`${s}`,t),this.hls.trigger(S.ERROR,{type:J.MEDIA_ERROR,details:N.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:s,fatal:!1});const i=this.currentOp(e);i&&i.onError(s)}updateTimestampOffset(e,t,r,s,i,o){const a=t-e.timestampOffset;Math.abs(a)>=r&&(this.log(`Updating ${s} SourceBuffer timestampOffset to ${t} (sn: ${i} cc: ${o})`),e.timestampOffset=t)}removeExecutor(e,t,r){const{media:s,mediaSource:i}=this,o=this.tracks[e],a=o==null?void 0:o.buffer;if(!s||!i||!a){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const l=q(s.duration)?s.duration:1/0,c=q(i.duration)?i.duration:1/0,u=Math.max(0,t),d=Math.min(r,l,c);d>u&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${u},${d}] from the ${e} SourceBuffer`),a.remove(u,d)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const r=this.tracks[t],s=r==null?void 0:r.buffer;if(!s)throw new KD(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);r.ending=!1,r.ended=!1,s.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:r}=this,s=t.map(o=>this.appendBlocker(o));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(s).then(o=>{r===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var r;const s=(r=this.tracks[t])==null?void 0:r.buffer;!s||s.updating||this.shiftAndExecuteNext(t)})}append(e,t,r){this.operationQueue&&this.operationQueue.append(e,t,r)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,r){const s=this.tracks[e];if(!s)return;const i=s.buffer;if(!i)return;const o=r.bind(this,e);s.listeners.push({event:t,listener:o}),i.addEventListener(t,o)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const r=t.buffer;r&&(t.listeners.forEach(s=>{r.removeEventListener(s.event,s.listener)}),t.listeners.length=0)}}function j0(n){const e=n.querySelectorAll("source");[].slice.call(e).forEach(t=>{n.removeChild(t)})}function WD(n,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,n.appendChild(t)}function nd(n){return n==="audio"?1:0}class km{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(S.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(S.MANIFEST_PARSED,this.onManifestParsed,this),e.on(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(S.BUFFER_CODECS,this.onBufferCodecs,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(S.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(S.MANIFEST_PARSED,this.onManifestParsed,this),e.off(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(S.BUFFER_CODECS,this.onBufferCodecs,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&q(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${r}: ${e[r].height}p@${e[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=r,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const r=t.filter((s,i)=>this.isLevelAllowed(s)&&i<=e);return this.clientRect=null,km.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,!t.width&&!t.height&&(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(r=>e.bitrate===r.bitrate&&e.width===r.width&&e.height===r.height)}static getMaxLevelByMediaSize(e,t,r){if(!(e!=null&&e.length))return-1;const s=(a,l)=>l?a.width!==l.width||a.height!==l.height:!0;let i=e.length-1;const o=Math.max(t,r);for(let a=0;a<e.length;a+=1){const l=e[a];if((l.width>=o||l.height>=o)&&s(l,e[a+1])){i=a;break}}return i}}const YD={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},Tt=YD,qD={HLS:"h"},QD=qD;class Wn{constructor(e,t){Array.isArray(e)&&(e=e.map(r=>r instanceof Wn?r:new Wn(r))),this.value=e,this.params=t}}const XD="Dict";function ZD(n){return Array.isArray(n)?JSON.stringify(n):n instanceof Map?"Map{}":n instanceof Set?"Set{}":typeof n=="object"?JSON.stringify(n):String(n)}function JD(n,e,t,r){return new Error(`failed to ${n} "${ZD(e)}" as ${t}`,{cause:r})}function Yn(n,e,t){return JD("serialize",n,e,t)}class ET{constructor(e){this.description=e}}const G0="Bare Item",eN="Boolean";function tN(n){if(typeof n!="boolean")throw Yn(n,eN);return n?"?1":"?0"}function nN(n){return btoa(String.fromCharCode(...n))}const rN="Byte Sequence";function sN(n){if(ArrayBuffer.isView(n)===!1)throw Yn(n,rN);return`:${nN(n)}:`}const iN="Integer";function oN(n){return n<-999999999999999||999999999999999<n}function ST(n){if(oN(n))throw Yn(n,iN);return n.toString()}function aN(n){return`@${ST(n.getTime()/1e3)}`}function TT(n,e){if(n<0)return-TT(-n,e);const t=Math.pow(10,e);if(Math.abs(n*t%1-.5)<Number.EPSILON){const s=Math.floor(n*t);return(s%2===0?s:s+1)/t}else return Math.round(n*t)/t}const lN="Decimal";function cN(n){const e=TT(n,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Yn(n,lN);const t=e.toString();return t.includes(".")?t:`${t}.0`}const uN="String",dN=/[\x00-\x1f\x7f]+/;function fN(n){if(dN.test(n))throw Yn(n,uN);return`"${n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function hN(n){return n.description||n.toString().slice(7,-1)}const mN="Token";function V0(n){const e=hN(n);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Yn(e,mN);return e}function Hf(n){switch(typeof n){case"number":if(!q(n))throw Yn(n,G0);return Number.isInteger(n)?ST(n):cN(n);case"string":return fN(n);case"symbol":return V0(n);case"boolean":return tN(n);case"object":if(n instanceof Date)return aN(n);if(n instanceof Uint8Array)return sN(n);if(n instanceof ET)return V0(n);default:throw Yn(n,G0)}}const pN="Key";function Kf(n){if(/^[a-z*][a-z0-9\-_.*]*$/.test(n)===!1)throw Yn(n,pN);return n}function _m(n){return n==null?"":Object.entries(n).map(([e,t])=>t===!0?`;${Kf(e)}`:`;${Kf(e)}=${Hf(t)}`).join("")}function bT(n){return n instanceof Wn?`${Hf(n.value)}${_m(n.params)}`:Hf(n)}function gN(n){return`(${n.value.map(bT).join(" ")})${_m(n.params)}`}function vN(n,e={whitespace:!0}){if(typeof n!="object"||n==null)throw Yn(n,XD);const t=n instanceof Map?n.entries():Object.entries(n),r=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([s,i])=>{i instanceof Wn||(i=new Wn(i));let o=Kf(s);return i.value===!0?o+=_m(i.params):(o+="=",Array.isArray(i.value)?o+=gN(i):o+=bT(i)),o}).join(`,${r}`)}function wT(n,e){return vN(n,e)}const Cn="CMCD-Object",Oe="CMCD-Request",ds="CMCD-Session",Ar="CMCD-Status",yN={br:Cn,ab:Cn,d:Cn,ot:Cn,tb:Cn,tpb:Cn,lb:Cn,tab:Cn,lab:Cn,url:Cn,pb:Oe,bl:Oe,tbl:Oe,dl:Oe,ltc:Oe,mtp:Oe,nor:Oe,nrr:Oe,rc:Oe,sn:Oe,sta:Oe,su:Oe,ttfb:Oe,ttfbb:Oe,ttlb:Oe,cmsdd:Oe,cmsds:Oe,smrt:Oe,df:Oe,cs:Oe,ts:Oe,cid:ds,pr:ds,sf:ds,sid:ds,st:ds,v:ds,msd:ds,bs:Ar,bsd:Ar,cdn:Ar,rtp:Ar,bg:Ar,pt:Ar,ec:Ar,e:Ar},xN={REQUEST:Oe};function EN(n){return Object.keys(n).reduce((e,t)=>{var r;return(r=n[t])===null||r===void 0||r.forEach(s=>e[s]=t),e},{})}function SN(n,e){const t={};if(!n)return t;const r=Object.keys(n),s=e?EN(e):{};return r.reduce((i,o)=>{var a;const l=yN[o]||s[o]||xN.REQUEST,c=(a=i[l])!==null&&a!==void 0?a:i[l]={};return c[o]=n[o],i},t)}function TN(n){return["ot","sf","st","e","sta"].includes(n)}function bN(n){return typeof n=="number"?q(n):n!=null&&n!==""&&n!==!1}const AT="event";function wN(n,e){const t=new URL(n),r=new URL(e);if(t.origin!==r.origin)return n;const s=t.pathname.split("/").slice(1),i=r.pathname.split("/").slice(1,-1);for(;s[0]===i[0];)s.shift(),i.shift();for(;i.length;)i.shift(),s.unshift("..");return s.join("/")+t.search+t.hash}const bl=n=>Math.round(n),zf=(n,e)=>Array.isArray(n)?n.map(t=>zf(t,e)):n instanceof Wn&&typeof n.value=="string"?new Wn(zf(n.value,e),n.params):(e.baseUrl&&(n=wN(n,e.baseUrl)),e.version===1?encodeURIComponent(n):n),za=n=>bl(n/100)*100,AN=(n,e)=>{let t=n;return e.version>=2&&(n instanceof Wn&&typeof n.value=="string"?t=new Wn([n]):typeof n=="string"&&(t=[n])),zf(t,e)},LN={br:bl,d:bl,bl:za,dl:za,mtp:za,nor:AN,rtp:za,tb:bl},LT="request",IT="response",Pm=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],IN=["e"],RN=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Xc(n){return RN.test(n)}function CN(n){return Pm.includes(n)||IN.includes(n)||Xc(n)}const RT=["d","dl","nor","ot","rtp","su"];function kN(n){return Pm.includes(n)||RT.includes(n)||Xc(n)}const _N=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function PN(n){return Pm.includes(n)||RT.includes(n)||_N.includes(n)||Xc(n)}const DN=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function NN(n){return DN.includes(n)||Xc(n)}const ON={[IT]:PN,[AT]:CN,[LT]:kN};function CT(n,e={}){const t={};if(n==null||typeof n!="object")return t;const r=e.version||n.v||1,s=e.reportingMode||LT,i=r===1?NN:ON[s];let o=Object.keys(n).filter(i);const a=e.filter;typeof a=="function"&&(o=o.filter(a));const l=s===IT||s===AT;l&&!o.includes("ts")&&o.push("ts"),r>1&&!o.includes("v")&&o.push("v");const c=Ee({},LN,e.formatters),u={version:r,reportingMode:s,baseUrl:e.baseUrl};return o.sort().forEach(d=>{let f=n[d];const h=c[d];if(typeof h=="function"&&(f=h(f,u)),d==="v"){if(r===1)return;f=r}d=="pr"&&f===1||(l&&d==="ts"&&!q(f)&&(f=Date.now()),bN(f)&&(TN(d)&&typeof f=="string"&&(f=new ET(f)),t[d]=f))}),t}function MN(n,e={}){const t={};if(!n)return t;const r=CT(n,e),s=SN(r,e==null?void 0:e.customHeaderMap);return Object.entries(s).reduce((i,[o,a])=>{const l=wT(a,{whitespace:!1});return l&&(i[o]=l),i},t)}function FN(n,e,t){return Ee(n,MN(e,t))}const $N="CMCD";function BN(n,e={}){return n?wT(CT(n,e),{whitespace:!1}):""}function UN(n,e={}){if(!n)return"";const t=BN(n,e);return encodeURIComponent(t)}function jN(n,e={}){if(!n)return"";const t=UN(n,e);return`${$N}=${t}`}const H0=/CMCD=[^&#]+/;function GN(n,e,t){const r=jN(e,t);if(!r)return n;if(H0.test(n))return n.replace(H0,r);const s=n.includes("?")?"&":"?";return`${n}${s}${r}`}class VN{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=s=>{try{this.apply(s,{ot:Tt.MANIFEST,su:!this.initialized})}catch(i){this.hls.logger.warn("Could not generate manifest CMCD data.",i)}},this.applyFragmentData=s=>{try{const{frag:i,part:o}=s,a=this.hls.levels[i.level],l=this.getObjectType(i),c={d:(o||i).duration*1e3,ot:l};(l===Tt.VIDEO||l===Tt.AUDIO||l==Tt.MUXED)&&(c.br=a.bitrate/1e3,c.tb=this.getTopBandwidth(l)/1e3,c.bl=this.getBufferLength(l));const u=o?this.getNextPart(o):this.getNextFrag(i);u!=null&&u.url&&u.url!==i.url&&(c.nor=u.url),this.apply(s,c)}catch(i){this.hls.logger.warn("Could not generate segment CMCD data.",i)}},this.hls=e;const t=this.config=e.config,{cmcd:r}=t;r!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||e.sessionId,this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.includeKeys=r.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(S.MEDIA_DETACHED,this.onMediaDetached,this),e.on(S.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(S.MEDIA_DETACHED,this.onMediaDetached,this),e.off(S.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,s;this.audioBuffer=(r=t.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(s=t.tracks.video)==null?void 0:s.buffer}createData(){var e;return{v:1,sf:QD.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Ee(t,this.createData());const r=t.ot===Tt.INIT||t.ot===Tt.VIDEO||t.ot===Tt.MUXED;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:s}=this;s&&(t=Object.keys(t).reduce((o,a)=>(s.includes(a)&&(o[a]=t[a]),o),{}));const i={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),FN(e.headers,t,i)):e.url=GN(e.url,t,i)}getNextFrag(e){var t;const r=(t=this.hls.levels[e.level])==null?void 0:t.details;if(r){const s=e.sn-r.startSN;return r.fragments[s+1]}}getNextPart(e){var t;const{index:r,fragment:s}=e,i=(t=this.hls.levels[s.level])==null||(t=t.details)==null?void 0:t.partList;if(i){const{sn:o}=s;for(let a=i.length-1;a>=0;a--){const l=i[a];if(l.index===r&&l.fragment.sn===o)return i[a+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return Tt.TIMED_TEXT;if(e.sn==="initSegment")return Tt.INIT;if(t==="audio")return Tt.AUDIO;if(t==="main")return this.hls.audioTracks.length?Tt.VIDEO:Tt.MUXED}getTopBandwidth(e){let t=0,r;const s=this.hls;if(e===Tt.AUDIO)r=s.audioTracks;else{const i=s.maxAutoLevel,o=i>-1?i+1:s.levels.length;r=s.levels.slice(0,o)}return r.forEach(i=>{i.bitrate>t&&(t=i.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,r=e===Tt.AUDIO?this.audioBuffer:this.videoBuffer;return!r||!t?NaN:se.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new r(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,o,a){t(i),this.loader.load(i,o,a)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new r(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,o,a){t(i),this.loader.load(i,o,a)}}}}const HN=3e5;class KN extends tn{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(S.MANIFEST_PARSED,this.onManifestParsed,this),e.on(S.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(S.MANIFEST_PARSED,this.onManifestParsed,this),e.off(S.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:r}=t;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:r}=t;if((r==null?void 0:r.action)===rt.SendAlternateToPenaltyBox&&r.flags===Pt.MoveAllAlternatesMatchingHost){const s=this.levels;let i=this._pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:a,pathwayId:l,type:c}=t.context;a&&s?o=this.getPathwayForGroupId(a,c,o):l&&(o=l)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!i&&s&&(i=this.pathways()),i&&i.length>1&&(this.updatePathwayPriority(i),r.resolved=this.pathwayId!==o),t.details===N.BUFFER_APPEND_ERROR&&!t.fatal?r.resolved=!0:r.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${s&&s.length} priorities: ${Ie(i)} penalized: ${Ie(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const r=this.penalizedPathways,s=performance.now();Object.keys(r).forEach(i=>{s-r[i]>HN&&delete r[i]});for(let i=0;i<e.length;i++){const o=e[i];if(o in r)continue;if(o===this.pathwayId)return;const a=this.hls.nextLoadLevel,l=this.hls.levels[a];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,qS(t),this.hls.trigger(S.LEVELS_UPDATED,{levels:t});const c=this.hls.levels[a];l&&c&&this.levels&&(c.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&c.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${c.bitrate}`),this.hls.nextLoadLevel=a);break}}}getPathwayForGroupId(e,t,r){const s=this.getLevelsForPathway(r).concat(this.levels||[]);for(let i=0;i<s.length;i++)if(t===ce.AUDIO_TRACK&&s[i].hasAudioGroup(e)||t===ce.SUBTITLE_TRACK&&s[i].hasSubtitleGroup(e))return s[i].pathwayId;return r}clonePathways(e){const t=this.levels;if(!t)return;const r={},s={};e.forEach(i=>{const{ID:o,"BASE-ID":a,"URI-REPLACEMENT":l}=i;if(t.some(u=>u.pathwayId===o))return;const c=this.getLevelsForPathway(a).map(u=>{const d=new _e(u.attrs);d["PATHWAY-ID"]=o;const f=d.AUDIO&&`${d.AUDIO}_clone_${o}`,h=d.SUBTITLES&&`${d.SUBTITLES}_clone_${o}`;f&&(r[d.AUDIO]=f,d.AUDIO=f),h&&(s[d.SUBTITLES]=h,d.SUBTITLES=h);const p=kT(u.uri,d["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),m=new Xo({attrs:d,audioCodec:u.audioCodec,bitrate:u.bitrate,height:u.height,name:u.name,url:p,videoCodec:u.videoCodec,width:u.width});if(u.audioGroups)for(let g=1;g<u.audioGroups.length;g++)m.addGroupId("audio",`${u.audioGroups[g]}_clone_${o}`);if(u.subtitleGroups)for(let g=1;g<u.subtitleGroups.length;g++)m.addGroupId("text",`${u.subtitleGroups[g]}_clone_${o}`);return m});t.push(...c),K0(this.audioTracks,r,l,o),K0(this.subtitleTracks,s,l,o)})}loadSteeringManifest(e){const t=this.hls.config,r=t.loader;this.loader&&this.loader.destroy(),this.loader=new r(t);let s;try{s=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(s.protocol!=="data:"){const u=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+u)}const i={responseType:"json",url:s.href},o=t.steeringManifestLoadPolicy.default,a=o.errorRetry||o.timeoutRetry||{},l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},c={onSuccess:(u,d,f,h)=>{this.log(`Loaded steering manifest: "${s}"`);const p=u.data;if((p==null?void 0:p.VERSION)!==1){this.log(`Steering VERSION ${p.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=p.TTL;const{"RELOAD-URI":m,"PATHWAY-CLONES":g,"PATHWAY-PRIORITY":v}=p;if(m)try{this.uri=new self.URL(m,s).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${m}`);return}this.scheduleRefresh(this.uri||f.url),g&&this.clonePathways(g);const x={steeringManifest:p,url:s.toString()};this.hls.trigger(S.STEERING_MANIFEST_LOADED,x),v&&this.updatePathwayPriority(v)},onError:(u,d,f,h)=>{if(this.log(`Error loading steering manifest: ${u.code} ${u.text} (${d.url})`),this.stopLoad(),u.code===410){this.enabled=!1,this.log(`Steering manifest ${d.url} no longer available`);return}let p=this.timeToLoad*1e3;if(u.code===429){const m=this.loader;if(typeof(m==null?void 0:m.getResponseHeader)=="function"){const g=m.getResponseHeader("Retry-After");g&&(p=parseFloat(g)*1e3)}this.log(`Steering manifest ${d.url} rate limited`);return}this.scheduleRefresh(this.uri||d.url,p)},onTimeout:(u,d,f)=>{this.log(`Timeout loading steering manifest (${d.url})`),this.scheduleRefresh(this.uri||d.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(i,l,c)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var r;const s=(r=this.hls)==null?void 0:r.media;if(s&&!s.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function K0(n,e,t,r){n&&Object.keys(e).forEach(s=>{const i=n.filter(o=>o.groupId===s).map(o=>{const a=Ee({},o);return a.details=void 0,a.attrs=new _e(a.attrs),a.url=a.attrs.URI=kT(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),a.groupId=a.attrs["GROUP-ID"]=e[s],a.attrs["PATHWAY-ID"]=r,a});n.push(...i)})}function kT(n,e,t,r){const{HOST:s,PARAMS:i,[t]:o}=r;let a;e&&(a=o==null?void 0:o[e],a&&(n=a));const l=new self.URL(n);return s&&!a&&(l.host=s),i&&Object.keys(i).sort().forEach(c=>{c&&l.searchParams.set(c,i[c])}),l.href}class Ei extends tn{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Ei.CDMCleanupPromise?[Ei.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:r,initData:s}=t,i=`"${t.type}" event: init data type: "${r}"`;if(this.debug(i),s!==null){if(!this.keyFormatPromise){let o=Object.keys(this.keySystemAccessPromises);o.length||(o=ho(this.config));const a=o.map(Yu).filter(l=>!!l);this.keyFormatPromise=this.getKeyFormatPromise(a)}this.keyFormatPromise.then(o=>{const a=El(o);if(r!=="sinf"||a!==$e.FAIRPLAY){this.log(`Ignoring "${t.type}" event with init data type: "${r}" for selected key-system ${a}`);return}let l;try{const h=He(new Uint8Array(s)),p=Em(JSON.parse(h).sinf),m=RS(p);if(!m)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");l=new Uint8Array(m.subarray(8,24))}catch(h){this.warn(`${i} Failed to parse sinf: ${h}`);return}const c=Nt(l),{keyIdToKeySessionPromise:u,mediaKeySessions:d}=this;let f=u[c];for(let h=0;h<d.length;h++){const p=d[h],m=p.decryptdata;if(!m.keyId)continue;const g=Nt(m.keyId);if(c===g||m.uri.replace(/-/g,"").indexOf(c)!==-1){if(f=u[g],!f)continue;if(m.pssh)break;delete u[g],m.pssh=new Uint8Array(s),m.keyId=l,f=u[c]=f.then(()=>this.generateRequestWithPreferredKeySession(p,r,s,"encrypted-event-key-match")),f.catch(v=>this.handleError(v));break}}f||this.handleError(new Error(`Key ID ${c} not encountered in playlist. Key-system sessions ${d.length}.`))}).catch(o=>this.handleError(o))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(S.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(S.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(S.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(S.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(S.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(S.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(S.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(S.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:r}=this.config,s=t==null?void 0:t[e];if(s)return s.licenseUrl;if(e===$e.WIDEVINE&&r)return r}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,r=t==null?void 0:t[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,r=(o,a,l)=>!!o&&l.indexOf(o)===a,s=t.map(o=>o.audioCodec).filter(r),i=t.map(o=>o.videoCodec).filter(r);return s.length+i.length===0&&i.push("avc1.42e01e"),new Promise((o,a)=>{const l=c=>{const u=c.shift();this.getMediaKeysPromise(u,s,i).then(d=>o({keySystem:u,mediaKeys:d})).catch(d=>{c.length?l(c):d instanceof cn?a(d):a(new cn({type:J.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_NO_ACCESS,error:d,fatal:!0},d.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let s=`Configured requestMediaKeySystemAccess is not a function ${r}`;return GS===null&&self.location.protocol==="http:"&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return r(e,t)}getMediaKeysPromise(e,t,r){var s;const i=AP(e,t,r,this.config.drmSystemOptions||{});let o=this.keySystemAccessPromises[e],a=(s=o)==null?void 0:s.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${Ie(i)}`),a=this.requestMediaKeySystemAccess(e,i);const l=o=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(c=>{this.log(`Failed to obtain access to key-system "${e}": ${c}`)}),a.then(c=>{this.log(`Access for key-system "${c.keySystem}" obtained`);const u=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const d=l.mediaKeys=c.createMediaKeys().then(f=>(this.log(`Media-keys created for "${e}"`),l.hasMediaKeys=!0,u.then(h=>h?this.setMediaKeysServerCertificate(f,e,h):f)));return d.catch(f=>{this.error(`Failed to create media-keys for "${e}"}: ${f}`)}),d})}return a.then(()=>o.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${Nt(e.keyId||[])}`);const s=r.createSession(),i={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const r=this.createMediaKeySessionContext(e),s=this.getKeyIdString(t),i="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(r,i,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Nt(e.keyId)}updateKeySession(e,t){const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyId ${Nt(e.decryptdata.keyId||[])}
      } (data length: ${t.byteLength})`),r.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>Yu(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:r})=>this.attemptSetMediaKeys(t,r))}selectKeySystem(e){return new Promise((t,r)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:s})=>{const i=Yu(s);i?t(i):r(new Error(`Unable to find format for key-system "${s}"`))}).catch(r)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=ho(this.config),r=e.map(El).filter(s=>!!s&&t.indexOf(s)!==-1);return this.selectKeySystem(r)}loadKey(e){const t=e.keyInfo.decryptdata,r=this.getKeyIdString(t),s=this.bannedKeyIds[r];if(s){const a=z0(s,t);return this.handleError(a,e.frag),Promise.reject(a)}const i=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);const o=this.keyIdToKeySessionPromise[r];if(!o){const a=this.getKeySystemForKeyPromise(t).then(({keySystem:l,mediaKeys:c})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(l,c).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:l,mediaKeys:c,decryptdata:t}))))).then(l=>{const c="cenc",u=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(l,c,u,"playlist-key")});return a.catch(l=>this.handleError(l,e.frag)),this.keyIdToKeySessionPromise[r]=a,a}return o}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,t){this.hls&&(this.error(e.message),e instanceof cn?(t&&(e.data.frag=t),this.hls.trigger(S.ERROR,e.data)):this.hls.trigger(S.ERROR,{type:J.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[t];if(!r){const s=El(e.keyFormat),i=s?[s]:ho(this.config);return this.attemptKeySystemAccess(i)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=ho(this.config)),e.length===0)throw new cn({type:J.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${Ie({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const s=Promise.all(r).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(i=>r.indexOf(i)===-1)})}generateRequestWithPreferredKeySession(e,t,r,s){var i;const o=(i=this.config.drmSystems)==null||(i=i[e.keySystem])==null?void 0:i.generateRequest;if(o)try{const f=o.call(this.hls,t,r,e);if(!f)throw new Error("Invalid response from configured generateRequest filter");t=f.initDataType,r=f.initData?f.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null}catch(f){if(this.warn(f.message),this.hls&&this.hls.config.debug)throw f}if(r===null)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(e);const a=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${s}": ${a} (init data type: ${t} length: ${r.byteLength})`);const l=new Tm,c=e._onmessage=f=>{const h=e.mediaKeysSession;if(!h){l.emit("error",new Error("invalid state"));return}const{messageType:p,message:m}=f;this.log(`"${p}" message event for session "${h.sessionId}" message size: ${m.byteLength}`),p==="license-request"||p==="license-renewal"?this.renewLicense(e,m).catch(g=>{l.eventNames().length?l.emit("error",g):this.handleError(g)}):p==="license-release"?e.keySystem===$e.FAIRPLAY&&(this.updateKeySession(e,$f("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${p}"`)},u=e._onkeystatuseschange=f=>{if(!e.mediaKeysSession){l.emit("error",new Error("invalid state"));return}const p=e.keyStatus;this.onKeyStatusChange(e);const m=e.keyStatus;m!==p&&(l.emit("keyStatus",m,e),m==="expired"&&(this.log(`${e.keySystem} expired for key ${a}`),this.renewKeySession(e)))};gt(e.mediaKeysSession,"message",c),gt(e.mediaKeysSession,"keystatuseschange",u);const d=new Promise((f,h)=>{l.on("error",h),l.on("keyStatus",(p,{decryptdata:m})=>{p.startsWith("usable")?f():p==="internal-error"||p==="output-restricted"?h(z0(p,m)):p==="expired"?h(new Error(`key expired while generating request (keyId: ${a})`)):this.warn(`unhandled key status change "${p}" (keyId: ${a})`)})});return e.mediaKeysSession.generateRequest(t,r).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${a}`)}).catch(f=>{throw new cn({type:J.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_NO_SESSION,error:f,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${f}`)}).then(()=>d).catch(f=>{throw l.removeAllListeners(),this.removeSession(e),f}).then(()=>(l.removeAllListeners(),e))}onKeyStatusChange(e){const t=Nt(new Uint8Array(e.decryptdata.keyId||[]));e.mediaKeysSession.keyStatuses.forEach((r,s)=>{if(typeof s=="string"&&typeof r=="object"){const a=s;s=r,r=a}const i=Nt("buffer"in s?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):new Uint8Array(s));r==="internal-error"&&(this.bannedKeyIds[i]=r);const o=i===t;this.log(`${o?"":"un"}matched key status change "${r}" for keyStatuses keyId: ${i} session keyId: ${t} uri: ${e.decryptdata.uri}`),o&&(e.keyStatus=r)})}fetchServerCertificate(e){const t=this.config,r=t.loader,s=new r(t),i=this.getServerCertificateUrl(e);return i?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,a)=>{const l={responseType:"arraybuffer",url:i},c=t.certLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(f,h,p,m)=>{o(f.data)},onError:(f,h,p,m)=>{a(new cn({type:J.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:p,response:ye({url:l.url,data:void 0},f)},`"${e}" certificate request failed (${i}). Status: ${f.code} (${f.text})`))},onTimeout:(f,h,p)=>{a(new cn({type:J.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:p,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${i})`))},onAbort:(f,h,p)=>{a(new Error("aborted"))}};s.load(l,u,d)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise((s,i)=>{e.setServerCertificate(r).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${r.byteLength}) on "${t}"`),s(e)}).catch(o=>{i(new cn({type:J.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(s=>{throw new cn({type:J.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:s,fatal:!1},s.message)}))}unpackPlayReadyKeyMessage(e,t){const r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const s=new DOMParser().parseFromString(r,"application/xml"),i=s.querySelectorAll("HttpHeader");if(i.length>0){let u;for(let d=0,f=i.length;d<f;d++){var o,a;u=i[d];const h=(o=u.querySelector("name"))==null?void 0:o.textContent,p=(a=u.querySelector("value"))==null?void 0:a.textContent;h&&p&&e.setRequestHeader(h,p)}}const l=s.querySelector("Challenge"),c=l==null?void 0:l.textContent;if(!c)throw new Error("Cannot find <Challenge> in key message");return $f(atob(c))}setupLicenseXHR(e,t,r,s){const i=this.config.licenseXhrSetup;return i?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return i.call(this.hls,e,t,r,s)}).catch(o=>{if(!r.decryptdata)throw o;return e.open("POST",t,!0),i.call(this.hls,e,t,r,s)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||s})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:s}))}requestLicense(e,t){const r=this.config.keyLoadPolicy.default;return new Promise((s,i)=>{const o=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${o}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return i(new Error("invalid state"));if(a.readyState===4)if(a.status===200){this._requestLicenseFailureCount=0;let l=a.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const c=this.config.licenseResponseCallback;if(c)try{l=c.call(this.hls,a,o,e)}catch(u){this.error(u)}s(l)}else{const l=r.errorRetry,c=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>c||a.status>=400&&a.status<500)i(new cn({type:J.KEY_SYSTEM_ERROR,details:N.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:a,response:{url:o,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${o}). Status: ${a.status} (${a.statusText})`));else{const u=c-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${u} attempts left`),this.requestLicense(e,t).then(s,i)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,o,e,t).then(({xhr:l,licenseChallenge:c})=>{e.keySystem==$e.PLAYREADY&&(c=this.unpackPlayReadyKeyMessage(l,c)),l.send(c)}).catch(i)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const r=t.media;this.media=r,gt(r,"encrypted",this.onMediaEncrypted),gt(r,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(It(e,"encrypted",this.onMediaEncrypted),It(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const t=this.media,r=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,qc.clearKeyUriToKeyIdMap();const s=r.length;Ei.CDMCleanupPromise=Promise.all(r.map(i=>this.removeSession(i)).concat(t==null||(e=t.setMediaKeys(null))==null?void 0:e.catch(i=>{this.log(`Could not clear media keys: ${i}`),this.hls&&this.hls.trigger(S.ERROR,{type:J.OTHER_ERROR,details:N.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${i}`)})}))).catch(i=>{this.log(`Could not close sessions and clear media keys: ${i}`),this.hls&&this.hls.trigger(S.ERROR,{type:J.OTHER_ERROR,details:N.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${i}`)})}).then(()=>{s&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null,this.bannedKeyIds={}}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const r=t.reduce((s,i)=>(s.indexOf(i.keyFormat)===-1&&s.push(i.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:r,decryptdata:s}=e;if(t){this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${Nt((s==null?void 0:s.keyId)||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);i>-1&&this.mediaKeySessions.splice(i,1);const{drmSystemOptions:o}=this.config;return(IP(o)?new Promise((l,c)=>{self.setTimeout(()=>c(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(l).catch(c)}):Promise.resolve()).catch(l=>{this.log(`Could not remove session: ${l}`),this.hls&&this.hls.trigger(S.ERROR,{type:J.OTHER_ERROR,details:N.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${l}`)})}).then(()=>t.close()).catch(l=>{this.log(`Could not close session: ${l}`),this.hls&&this.hls.trigger(S.ERROR,{type:J.OTHER_ERROR,details:N.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${l}`)})})}}}Ei.CDMCleanupPromise=void 0;class cn extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function z0(n,e){const t=n==="output-restricted",r=t?N.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:N.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new cn({type:J.KEY_SYSTEM_ERROR,details:r,fatal:!1,decryptdata:e},t?"HDCP level output restricted":`key status changed to "${n}"`)}class zN{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(S.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(S.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(S.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(S.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const r=this.hls.config;if(r.capLevelOnFPSDrop){const s=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=s,s&&typeof s.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,r){const s=performance.now();if(t){if(this.lastTime){const i=s-this.lastTime,o=r-this.lastDroppedFrames,a=t-this.lastDecodedFrames,l=1e3*o/i,c=this.hls;if(c.trigger(S.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:r}),l>0&&o>c.config.fpsDroppedMonitoringThreshold*a){let u=c.currentLevel;c.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(c.autoLevelCapping===-1||c.autoLevelCapping>=u)&&(u=u-1,c.trigger(S.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:c.currentLevel}),c.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function _T(n,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=n,e.dispatchEvent(t)}function PT(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){me.debug(`[texttrack-utils]: ${r}`);try{const s=new self.TextTrackCue(e.startTime,e.endTime,e.text);s.id=e.id,n.addCue(s)}catch(s){me.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${s}`)}}t==="disabled"&&(n.mode=t)}function li(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues)for(let r=n.cues.length;r--;)e&&n.cues[r].removeEventListener("enter",e),n.removeCue(n.cues[r]);t==="disabled"&&(n.mode=t)}function Wf(n,e,t,r){const s=n.mode;if(s==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0){const i=YN(n.cues,e,t);for(let o=0;o<i.length;o++)(!r||r(i[o]))&&n.removeCue(i[o])}s==="disabled"&&(n.mode=s)}function WN(n,e){if(e<=n[0].startTime)return 0;const t=n.length-1;if(e>n[t].endTime)return-1;let r=0,s=t,i;for(;r<=s;)if(i=Math.floor((s+r)/2),e<n[i].startTime)s=i-1;else if(e>n[i].startTime&&r<t)r=i+1;else return i;return n[r].startTime-e<e-n[s].startTime?r:s}function YN(n,e,t){const r=[],s=WN(n,e);if(s>-1)for(let i=s,o=n.length;i<o;i++){const a=n[i];if(a.startTime>=e&&a.endTime<=t)r.push(a);else if(a.startTime>t)return r}return r}function wl(n){const e=[];for(let t=0;t<n.length;t++){const r=n[t];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(n[t])}return e}class qN extends Cm{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const r=wl(this.media.textTracks);for(let i=0;i<r.length;i++)if(r[i].mode==="hidden")t=r[i];else if(r[i].mode==="showing"){t=r[i];break}const s=this.findTrackForTextTrack(t);this.subtitleTrack!==s&&this.setSubtitleTrack(s)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_PARSED,this.onManifestParsed,this),e.on(S.LEVEL_LOADING,this.onLevelLoading,this),e.on(S.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(S.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(S.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_PARSED,this.onManifestParsed,this),e.off(S.LEVEL_LOADING,this.onLevelLoading,this),e.off(S.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(S.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(S.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const r=this.media;if(!r)return;const s=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,s)return;wl(r.textTracks).forEach(o=>{li(o)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:r,groupId:s,details:i}=t,o=this.tracksInGroup[r];if(!o||o.groupId!==s){this.warn(`Subtitle track with id:${r} and group:${s} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Subtitle track ${r} "${o.name}" lang:${o.lang} group:${s} loaded [${i.startSN}-${i.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.subtitleGroups||null,s=this.groupIds;let i=this.currentTrack;if(!r||(s==null?void 0:s.length)!==(r==null?void 0:r.length)||r!=null&&r.some(o=>(s==null?void 0:s.indexOf(o))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(u=>!r||r.indexOf(u.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(u=>u.default)&&(this.selectDefaultTrack=!1),o.forEach((u,d)=>{u.id=d});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const a=this.hls.config.subtitlePreference;if(!i&&a){this.selectDefaultTrack=!1;const u=Bn(a,o);if(u>-1)i=o[u];else{const d=Bn(a,this.tracks);i=this.tracks[d]}}let l=this.findTrackId(i);l===-1&&i&&(l=this.findTrackId(null));const c={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${r==null?void 0:r.join(",")}" group-id`),this.hls.trigger(S.SUBTITLE_TRACKS_UPDATED,c),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}}findTrackId(e){const t=this.tracksInGroup,r=this.selectDefaultTrack;for(let s=0;s<t.length;s++){const i=t[s];if(!(r&&!i.default||!r&&!e)&&(!e||Is(i,e)))return s}if(e){for(let s=0;s<t.length;s++){const i=t[s];if(ta(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return s}for(let s=0;s<t.length;s++){const i=t[s];if(ta(e.attrs,i.attrs,["LANGUAGE"]))return s}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const s=t[r];if(Vf(s,e))return r}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===ce.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const r=this.currentTrack;if(r&&Is(e,r))return r;const s=Bn(e,this.tracksInGroup);if(s>-1){const i=this.tracksInGroup[s];return this.setSubtitleTrack(s),i}else{if(r)return null;{const i=Bn(e,t);if(i>-1)return t[i]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,s=e.groupId,i=this.getUrlWithDirectives(e.url,t),o=e.details,a=o==null?void 0:o.age;this.log(`Loading subtitle ${r} "${e.name}" lang:${e.lang} group:${s}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${a&&o.live?" age "+a.toFixed(1)+(o.type&&" "+o.type||""):""} ${i}`),this.hls.trigger(S.SUBTITLE_TRACK_LOADING,{url:i,id:r,groupId:s,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=wl(e.textTracks),r=this.currentTrack;let s;if(r&&(s=t.filter(i=>Vf(r,i))[0],s||this.warn(`Unable to find subtitle TextTrack with name "${r.name}" and language "${r.lang}"`)),[].slice.call(t).forEach(i=>{i.mode!=="disabled"&&i!==s&&(i.mode="disabled")}),s){const i=this.subtitleDisplay?"showing":"hidden";s.mode!==i&&(s.mode=i)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!q(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,s=t[e]||null;if(this.trackId=e,this.currentTrack=s,this.toggleTrackModes(),!s){this.hls.trigger(S.SUBTITLE_TRACK_SWITCH,{id:e});return}const i=!!s.details&&!s.details.live;if(e===this.trackId&&s===r&&i)return;this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:""));const{id:o,groupId:a="",name:l,type:c,url:u}=s;this.hls.trigger(S.SUBTITLE_TRACK_SWITCH,{id:o,groupId:a,name:l,type:c,url:u});const d=this.switchParams(s.url,r==null?void 0:r.details,s.details);this.loadPlaylist(d)}}function QN(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const i=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(s=="x"?i:i&3|8).toString(16)})}}}function Io(n){let e=5381,t=n.length;for(;t;)e=e*33^n.charCodeAt(--t);return(e>>>0).toString()}const Si=.025;let pc=function(n){return n[n.Point=0]="Point",n[n.Range=1]="Range",n}({});function XN(n,e,t){return`${n.identifier}-${t+1}-${Io(e)}`}class ZN{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const r=this.playoutLimit;return e<=0||isNaN(r)?!1:r===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>r}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return rd(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,r=rd(t,e);return t-r<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=q(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return rd(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Si))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?pc.Range:pc.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return JN(this)}}function rd(n,e){return n-e.start<e.duration/2&&!(Math.abs(n-(e.start+e.duration))<Si)?e.start:e.start+e.duration}function DT(n,e,t){const r=new self.URL(n,t);return r.protocol!=="data:"&&r.searchParams.set("_HLS_primary_id",e),r}function sd(n,e){for(;(t=n.assetList[++e])!=null&&t.error;)var t;return e}function JN(n){return`["${n.identifier}" ${n.cue.pre?"<pre>":n.cue.post?"<post>":""}${n.timelineStart.toFixed(2)}-${n.resumeTime.toFixed(2)}]`}function qs(n){const e=n.timelineStart,t=n.duration||0;return`["${n.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class eO{constructor(e,t,r,s){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(S.PLAYOUT_LIMIT_REACHED,{})};const i=this.hls=new e(t);this.interstitial=r,this.assetItem=s;const o=()=>{this.hasDetails=!0};i.once(S.LEVEL_LOADED,o),i.once(S.AUDIO_TRACK_LOADED,o),i.once(S.SUBTITLE_TRACK_LOADED,o),i.on(S.MEDIA_ATTACHING,(a,{media:l})=>{this.removeMediaListeners(),this.mediaAttached=l,this.interstitial.playoutLimit&&(l.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&i.on(S.BUFFER_APPENDED,()=>{const u=this.bufferedEnd;this.reachedPlayout(u)&&(this._bufferedEosTime=u,i.trigger(S.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=DT(t,e.config.primarySessionId||"").href}catch{}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e)return!1;const r=Math.min(this._bufferedEosTime||1/0,this.duration),s=this.timelineOffset,i=se.bufferInfo(e,s,0);return this.getAssetTime(i.end)>=r-.02}reachedPlayout(e){const r=this.interstitial.playoutLimit;return this.startOffset+e>=r}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=se.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const r=t-this.startOffset;if(r>0&&r<e)return r}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const r=e-t;if(Math.abs(r)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,e-t),r)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),(t=this.hls)==null||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=r=>delete r.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,r){var s;(s=this.hls)==null||s.on(e,t)}once(e,t,r){var s;(s=this.hls)==null||s.once(e,t)}off(e,t,r){var s;(s=this.hls)==null||s.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${qs(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const W0=.033;class tO extends tn{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((r,s)=>e<=s.startOffset&&t>s.startOffset?(delete s.error,r+1):r,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);const s=this.items;if(s)for(s[r]||(t===void 0&&(t=e.start),r=this.findItemIndexAtTime(t));r>=0&&(i=s[r])!=null&&i.event;){var i;r--}return r}findItemIndexAtTime(e,t){const r=this.items;if(r)for(let s=0;s<r.length;s++){let i=r[s];if(t&&t!=="primary"&&(i=i[t]),e===i.start||e>i.start&&e<i.end)return s}return-1}findJumpRestrictedIndex(e,t){const r=this.items;if(r)for(let s=e;s<=t&&r[s];s++){const i=r[s].event;if(i!=null&&i.restrictions.jump&&!i.appendInPlace)return s}return-1}findEventIndex(e){const t=this.items;if(t)for(let s=t.length;s--;){var r;if(((r=t[s].event)==null?void 0:r.identifier)===e)return s}return-1}findAssetIndex(e,t){const r=e.assetList,s=r.length;if(s>1)for(let i=0;i<s;i++){const o=r[i];if(!o.error){const a=o.timelineStart;if(t===a||t>a&&(t<a+(o.duration||0)||i===s-1))return i}}return 0}get assetIdAtEnd(){var e;const t=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(t){const r=t.assetList,s=r[r.length-1];if(s)return s.identifier}return null}parseInterstitialDateRanges(e,t){const r=e.main.details,{dateRanges:s}=r,i=this.events,o=this.parseDateRanges(s,{url:r.url},t),a=Object.keys(s),l=i?i.filter(c=>!a.includes(c.identifier)):[];o.length&&o.sort((c,u)=>{const d=c.cue.pre,f=c.cue.post,h=u.cue.pre,p=u.cue.post;if(d&&!h)return-1;if(h&&!d||f&&!p)return 1;if(p&&!f)return-1;if(!d&&!h&&!f&&!p){const m=c.startTime,g=u.startTime;if(m!==g)return m-g}return c.dateRange.tagOrder-u.dateRange.tagOrder}),this.events=o,l.forEach(c=>{this.removeEvent(c)}),this.updateSchedule(e,l)}updateSchedule(e,t=[],r=!1){const s=this.events||[];if(s.length||t.length||this.length<2){const i=this.items,o=this.parseSchedule(s,e);(r||t.length||(i==null?void 0:i.length)!==o.length||o.some((l,c)=>Math.abs(l.playout.start-i[c].playout.start)>.005||Math.abs(l.playout.end-i[c].playout.end)>.005))&&(this.items=o,this.onScheduleUpdate(t,i))}}parseDateRanges(e,t,r){const s=[],i=Object.keys(e);for(let o=0;o<i.length;o++){const a=i[o],l=e[a];if(l.isInterstitial){let c=this.eventMap[a];c?c.setDateRange(l):(c=new ZN(l,t),this.eventMap[a]=c,r===!1&&(c.appendInPlace=r)),s.push(c)}}return s}parseSchedule(e,t){const r=[],s=t.main.details,i=s.live?1/0:s.edge;let o=0;if(e=e.filter(l=>!l.error&&!(l.cue.once&&l.hasPlayed)),e.length){this.resolveOffsets(e,t);let l=0,c=0;if(e.forEach((u,d)=>{const f=u.cue.pre,h=u.cue.post,p=e[d-1]||null,m=u.appendInPlace,g=h?i:u.startOffset,v=u.duration,x=u.timelineOccupancy===pc.Range?v:0,E=u.resumptionOffset,T=(p==null?void 0:p.startTime)===g,w=g+u.cumulativeDuration;let L=m?w+v:g+E;if(f||!h&&g<=0){const R=c;c+=x,u.timelineStart=w;const C=o;o+=v,r.push({event:u,start:w,end:L,playout:{start:C,end:o},integrated:{start:R,end:c}})}else if(g<=i){if(!T){const I=g-l;if(I>W0){const P=l,O=c;c+=I;const V=o;o+=I;const B={previousEvent:e[d-1]||null,nextEvent:u,start:P,end:P+I,playout:{start:V,end:o},integrated:{start:O,end:c}};r.push(B)}else I>0&&p&&(p.cumulativeDuration+=I,r[r.length-1].end=g)}h&&(L=w),u.timelineStart=w;const R=c;c+=x;const C=o;o+=v,r.push({event:u,start:w,end:L,playout:{start:C,end:o},integrated:{start:R,end:c}})}else return;const A=u.resumeTime;h||A>i?l=i:l=A}),l<i){var a;const u=l,d=c,f=i-l;c+=f;const h=o;o+=f,r.push({previousEvent:((a=r[r.length-1])==null?void 0:a.event)||null,nextEvent:null,start:l,end:u+f,playout:{start:h,end:o},integrated:{start:d,end:c}})}this.setDurations(i,o,c)}else r.push({previousEvent:null,nextEvent:null,start:0,end:i,playout:{start:0,end:i},integrated:{start:0,end:i}}),this.setDurations(i,i,i);return r}setDurations(e,t,r){this.durations={primary:e,playout:t,integrated:r}}resolveOffsets(e,t){const r=t.main.details,s=r.live?1/0:r.edge;let i=0,o=-1;e.forEach((a,l)=>{const c=a.cue.pre,u=a.cue.post,d=c?0:u?s:a.startTime;this.updateAssetDurations(a),o===d?a.cumulativeDuration=i:(i=0,o=d),!u&&a.snapOptions.in&&(a.resumeAnchor=Ns(null,r.fragments,a.startOffset+a.resumptionOffset,0,0)||void 0),a.appendInPlace&&!a.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(a,t)||(a.appendInPlace=!1)),!a.appendInPlace&&l+1<e.length&&e[l+1].startTime-e[l].resumeTime<W0&&(e[l+1].appendInPlace=!1,e[l+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${a}`));const h=q(a.resumeOffset)?a.resumeOffset:a.duration;i+=h})}primaryCanResumeInPlaceAt(e,t){const r=e.resumeTime,s=e.startTime+e.resumptionOffset;return Math.abs(r-s)>Si?(this.log(`"${e.identifier}" resumption ${r} not aligned with estimated timeline end ${s}`),!1):!Object.keys(t).some(o=>{const a=t[o].details,l=a.edge;if(r>=l)return this.log(`"${e.identifier}" resumption ${r} past ${o} playlist end ${l}`),!1;const c=Ns(null,a.fragments,r);if(!c)return this.log(`"${e.identifier}" resumption ${r} does not align with any fragments in ${o} playlist (${a.fragStart}-${a.fragmentEnd})`),!0;const u=o==="audio"?.175:0;return Math.abs(c.start-r)<Si+u||Math.abs(c.end-r)<Si+u?!1:(this.log(`"${e.identifier}" resumption ${r} not aligned with ${o} fragment bounds (${c.start}-${c.end} sn: ${c.sn} cc: ${c.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let r=0,s=!1,i=!1;for(let o=0;o<e.assetList.length;o++){const a=e.assetList[o],l=t+r;a.startOffset=r,a.timelineStart=l,s||(s=a.duration===null),i||(i=!!a.error);const c=a.error?0:a.duration||0;r+=c}s&&!i?e.duration=Math.max(r,e.duration):e.duration=r}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function ln(n){return`[${n.event?'"'+n.event.identifier+'"':"primary"}: ${n.start.toFixed(2)}-${n.end.toFixed(2)}]`}class nO{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const r=e.assetListUrl;let s;try{s=DT(r,this.hls.sessionId,e.baseUrl)}catch(f){const h=this.assignAssetListError(e,N.ASSET_LIST_LOAD_ERROR,f,r);this.hls.trigger(S.ERROR,h);return}t&&s.protocol!=="data:"&&s.searchParams.set("_HLS_start_offset",""+t);const i=this.hls.config,o=i.loader,a=new o(i),l={responseType:"json",url:s.href},c=i.interstitialAssetListLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(f,h,p,m)=>{const g=f.data,v=g==null?void 0:g.ASSETS;if(!Array.isArray(v)){const x=this.assignAssetListError(e,N.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),p.url,h,m);this.hls.trigger(S.ERROR,x);return}e.assetListResponse=g,this.hls.trigger(S.ASSET_LIST_LOADED,{event:e,assetListResponse:g,networkDetails:m})},onError:(f,h,p,m)=>{const g=this.assignAssetListError(e,N.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${f.code} ${f.text} (${h.url})`),h.url,m,p);this.hls.trigger(S.ERROR,g)},onTimeout:(f,h,p)=>{const m=this.assignAssetListError(e,N.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${h.url})`),h.url,f,p);this.hls.trigger(S.ERROR,m)}};return a.load(l,u,d),this.hls.trigger(S.ASSET_LIST_LOADING,{event:e}),a}assignAssetListError(e,t,r,s,i,o){return e.error=r,{type:J.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:s,error:r,networkDetails:o,stats:i}}}function Y0(n){n==null||n.play().catch(()=>{})}function Wa(n,e){return`[${n}] Advancing timeline position to ${e}`}class rO extends tn{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled||!this.schedule)return;const s=r-this.timelinePos;if(Math.abs(s)<1/7056e5)return;const o=s<=-.01;this.timelinePos=r,this.bufferedPos=r;const a=this.playingItem;if(!a){this.checkBuffer();return}if(o&&this.schedule.resetErrorsInRange(r,r-s)&&this.updateSchedule(!0),this.checkBuffer(),o&&r<a.start||r>=a.end){var l;const h=this.findItemIndex(a);let p=this.schedule.findItemIndexAtTime(r);if(p===-1&&(p=h+(o?-1:1),this.log(`seeked ${o?"back ":""}to position not covered by schedule ${r} (resolving from ${h} to ${p})`)),!this.isInterstitial(a)&&(l=this.media)!=null&&l.paused&&(this.shouldPlay=!1),!o&&p>h){const m=this.schedule.findJumpRestrictedIndex(h+1,p);if(m>h){this.setSchedulePosition(m);return}}this.setSchedulePosition(p);return}const c=this.playingAsset;if(!c){if(this.playingLastItem&&this.isInterstitial(a)){const h=a.event.assetList[0];h&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(r,h))}return}const u=c.timelineStart,d=c.duration||0;if(o&&r<u||r>=u+d){var f;(f=a.event)!=null&&f.appendInPlace&&(this.clearInterstitial(a.event,a),this.flushFrontBuffer(r)),this.setScheduleToAssetAtTime(r,c)}},this.onTimeupdate=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;if(r>this.timelinePos)this.timelinePos=r,r>this.bufferedPos&&this.checkBuffer();else return;const s=this.playingItem;if(!s||this.playingLastItem)return;if(r>=s.end){this.timelinePos=s.end;const a=this.findItemIndex(s);this.setSchedulePosition(a+1)}const i=this.playingAsset;if(!i)return;const o=i.timelineStart+(i.duration||0);r>=o&&this.setScheduleToAssetAtTime(r,i)},this.onScheduleUpdate=(r,s)=>{const i=this.schedule;if(!i)return;const o=this.playingItem,a=i.events||[],l=i.items||[],c=i.durations,u=r.map(m=>m.identifier),d=!!(a.length||u.length);(d||s)&&this.log(`INTERSTITIALS_UPDATED (${a.length}): ${a}
Schedule: ${l.map(m=>ln(m))} pos: ${this.timelinePos}`),u.length&&this.log(`Removed events ${u}`);let f=null,h=null;o&&(f=this.updateItem(o,this.timelinePos),this.itemsMatch(o,f)?this.playingItem=f:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const p=this.bufferingItem;if(p&&(h=this.updateItem(p,this.bufferedPos),this.itemsMatch(p,h)?this.bufferingItem=h:p.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(p.event,null))),r.forEach(m=>{m.assetList.forEach(g=>{this.clearAssetPlayer(g.identifier,null)})}),this.playerQueue.forEach(m=>{if(m.interstitial.appendInPlace){const g=m.assetItem.timelineStart,v=m.timelineOffset-g;if(v)try{m.timelineOffset=g}catch(x){Math.abs(v)>Si&&this.warn(`${x} ("${m.assetId}" ${m.timelineOffset}->${g})`)}}}),d||s){if(this.hls.trigger(S.INTERSTITIALS_UPDATED,{events:a.slice(0),schedule:l.slice(0),durations:c,removedIds:u}),this.isInterstitial(o)&&u.includes(o.event.identifier)){this.warn(`Interstitial "${o.event.identifier}" removed while playing`),this.primaryFallback(o.event);return}o&&this.trimInPlace(f,o),p&&h!==f&&this.trimInPlace(h,p),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new nO(e),this.schedule=new tO(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(S.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(S.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(S.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(S.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(S.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(S.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(S.BUFFER_APPENDED,this.onBufferAppended,this),e.on(S.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(S.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(S.MEDIA_ENDED,this.onMediaEnded,this),e.on(S.ERROR,this.onError,this),e.on(S.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(S.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(S.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(S.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(S.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(S.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(S.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(S.BUFFER_CODECS,this.onBufferCodecs,this),e.off(S.BUFFER_APPENDED,this.onBufferAppended,this),e.off(S.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(S.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(S.MEDIA_ENDED,this.onMediaEnded,this),e.off(S.ERROR,this.onError,this),e.off(S.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){It(e,"play",this.onPlay),It(e,"pause",this.onPause),It(e,"seeking",this.onSeeking),It(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const r=this.media=t.media;gt(r,"seeking",this.onSeeking),gt(r,"timeupdate",this.onTimeupdate),gt(r,"play",this.onPlay),gt(r,"pause",this.onPause)}onMediaAttached(e,t){const r=this.effectivePlayingItem,s=this.detachedData;if(this.detachedData=null,r===null)this.checkStart();else if(!s){this.clearScheduleState();const i=this.findItemIndex(r);this.setSchedulePosition(i)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const r=!!t.transferMedia,s=this.media;if(this.media=null,!r&&(s&&this.removeMediaListeners(s),this.detachedData)){const i=this.getBufferingPlayer();i&&(this.log(`Removing schedule state for detachedData and ${i}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,i.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,r=d=>d&&e.getAssetPlayer(d.identifier),s=(d,f,h,p,m)=>{if(d){let g=d[f].start;const v=d.event;if(v){if(f==="playout"||v.timelineOccupancy!==pc.Point){const x=r(h);(x==null?void 0:x.interstitial)===v&&(g+=x.assetItem.startOffset+x[m])}}else{const x=p==="bufferedPos"?o():e[p];g+=x-d.start}return g}return 0},i=(d,f)=>{var h;if(d!==0&&f!=="primary"&&(h=e.schedule)!=null&&h.length){var p;const m=e.schedule.findItemIndexAtTime(d),g=(p=e.schedule.items)==null?void 0:p[m];if(g){const v=g[f].start-g.start;return d+v}}return d},o=()=>{const d=e.bufferedPos;return d===Number.MAX_VALUE?a("primary"):Math.max(d,0)},a=d=>{var f,h;return(f=e.primaryDetails)!=null&&f.live?e.primaryDetails.edge:((h=e.schedule)==null?void 0:h.durations[d])||0},l=(d,f)=>{var h,p;const m=e.effectivePlayingItem;if(m!=null&&(h=m.event)!=null&&h.restrictions.skip||!e.schedule)return;e.log(`seek to ${d} "${f}"`);const g=e.effectivePlayingItem,v=e.schedule.findItemIndexAtTime(d,f),x=(p=e.schedule.items)==null?void 0:p[v],E=e.getBufferingPlayer(),T=E==null?void 0:E.interstitial,w=T==null?void 0:T.appendInPlace,L=g&&e.itemsMatch(g,x);if(g&&(w||L)){const A=r(e.playingAsset),R=(A==null?void 0:A.media)||e.primaryMedia;if(R){const C=f==="primary"?R.currentTime:s(g,f,e.playingAsset,"timelinePos","currentTime"),I=d-C,P=(w?C:R.currentTime)+I;if(P>=0&&(!A||w||P<=A.duration)){R.currentTime=P;return}}}if(x){let A=d;if(f!=="primary"){const C=x[f].start,I=d-C;A=x.start+I}const R=!e.isInterstitial(x);if((!e.isInterstitial(g)||g.event.appendInPlace)&&(R||x.event.appendInPlace)){const C=e.media||(w?E==null?void 0:E.media:null);C&&(C.currentTime=A)}else if(g){const C=e.findItemIndex(g);if(v>C){const P=e.schedule.findJumpRestrictedIndex(C+1,v);if(P>C){e.setSchedulePosition(P);return}}let I=0;if(R)e.timelinePos=A,e.checkBuffer();else{const P=x.event.assetList,O=d-(x[f]||x).start;for(let V=P.length;V--;){const B=P[V];if(B.duration&&O>=B.startOffset&&O<B.startOffset+B.duration){I=V;break}}}e.setSchedulePosition(v,I)}}},c=()=>{const d=e.effectivePlayingItem;if(e.isInterstitial(d))return d;const f=t();return e.isInterstitial(f)?f:null},u={get bufferedEnd(){const d=t(),f=e.bufferingItem;if(f&&f===d){var h;return s(f,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-f.playout.start||((h=e.bufferingAsset)==null?void 0:h.startOffset)||0}return 0},get currentTime(){const d=c(),f=e.effectivePlayingItem;return f&&f===d?s(f,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-f.playout.start:0},set currentTime(d){const f=c(),h=e.effectivePlayingItem;h&&h===f&&l(d+h.playout.start,"playout")},get duration(){const d=c();return d?d.playout.end-d.playout.start:0},get assetPlayers(){var d;const f=(d=c())==null?void 0:d.event.assetList;return f?f.map(h=>e.getAssetPlayer(h.identifier)):[]},get playingIndex(){var d;const f=(d=c())==null?void 0:d.event;return f&&e.effectivePlayingAsset?f.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return c()}};return this.manager={get events(){var d;return((d=e.schedule)==null||(d=d.events)==null?void 0:d.slice(0))||[]},get schedule(){var d;return((d=e.schedule)==null||(d=d.items)==null?void 0:d.slice(0))||[]},get interstitialPlayer(){return c()?u:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const d=t();return e.findItemIndex(d)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const d=e.effectivePlayingItem;return e.findItemIndex(d)},primary:{get bufferedEnd(){return o()},get currentTime(){const d=e.timelinePos;return d>0?d:0},set currentTime(d){l(d,"primary")},get duration(){return a("primary")},get seekableStart(){var d;return((d=e.primaryDetails)==null?void 0:d.fragmentStart)||0}},integrated:{get bufferedEnd(){return s(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return s(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(d){l(d,"integrated")},get duration(){return a("integrated")},get seekableStart(){var d;return i(((d=e.primaryDetails)==null?void 0:d.fragmentStart)||0,"integrated")}},skip:()=>{const d=e.effectivePlayingItem,f=d==null?void 0:d.event;if(f&&!f.restrictions.skip){const h=e.findItemIndex(d);if(f.appendInPlace){const p=d.playout.start+d.event.duration;l(p+.001,"playout")}else e.advanceAfterAssetEnded(f,h,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,r=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!r?!1:this.findItemIndex(t)===r.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t;if(this.mediaSelection===null)return;const r=this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&!r.event.appendInPlace)return;let s=this.media;!s&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(s=this.primaryMedia);const i=(t=s)==null?void 0:t.currentTime;if(!(i===void 0||!q(i)))return i}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,t)}transferMediaFromPlayer(e,t){const r=e.interstitial.appendInPlace,s=e.media;if(r&&s===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&s){this.detachedData={media:s};return}const i=e.transferMedia();this.log(`transfer MediaSource from ${e} ${Ie(i)}`),this.detachedData=i}else t&&s&&(this.shouldPlay||(this.shouldPlay=!s.paused))}transferMediaTo(e,t){var r,s;if(e.media===t)return;let i=null;const o=this.hls,a=e!==o,l=a&&e.interstitial.appendInPlace,c=(r=this.detachedData)==null?void 0:r.mediaSource;let u;if(o.media)l&&(i=o.transferMedia(),this.detachedData=i),u="Primary";else if(c){const p=this.getBufferingPlayer();p?(i=p.transferMedia(),u=`${p}`):u="detached MediaSource"}else u="detached media";if(!i){if(c)i=this.detachedData,this.log(`using detachedData: MediaSource ${Ie(i)}`);else if(!this.detachedData||o.media===t){const p=this.playerQueue;p.length>1&&p.forEach(m=>{if(a&&m.interstitial.appendInPlace!==l){const g=m.interstitial;this.clearInterstitial(m.interstitial,null),g.appendInPlace=!1,g.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${g}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const d=i&&"mediaSource"in i&&((s=i.mediaSource)==null?void 0:s.readyState)!=="closed",f=d&&i?i:t;this.log(`${d?"transfering MediaSource":"attaching media"} to ${a?e:"Primary"} from ${u} (media.currentTime: ${t.currentTime})`);const h=this.schedule;if(f===i&&h){const p=a&&e.assetId===h.assetIdAtEnd;f.overrides={duration:h.duration,endOfStream:!a||p,cueRemoval:!a}}e.attachMedia(f)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e==null?void 0:e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const r=this.timelinePos,s=this.effectivePlayingItem;if(r===-1){const i=this.hls.startPosition;if(this.log(Wa("checkStart",i)),this.timelinePos=i,t.length&&t[0].cue.pre){const o=e.findEventIndex(t[0].identifier);this.setSchedulePosition(o)}else if(i>=0||!this.primaryLive){const o=this.timelinePos=i>0?i:0,a=e.findItemIndexAtTime(o);this.setSchedulePosition(a)}}else if(s&&!this.playingItem){const i=e.findItemIndex(s);this.setSchedulePosition(i)}}advanceAssetBuffering(e,t){const r=e.event,s=r.findAssetIndex(t),i=sd(r,s);if(!r.isAssetPastPlayoutLimit(i))this.bufferedToEvent(e,i);else if(this.schedule){var o;const a=(o=this.schedule.items)==null?void 0:o[this.findItemIndex(e)+1];a&&this.bufferedToItem(a)}}advanceAfterAssetEnded(e,t,r){const s=sd(e,r);if(e.isAssetPastPlayoutLimit(s)){if(this.schedule){const i=this.schedule.items;if(i){const o=t+1,a=i.length;if(o>=a){this.setSchedulePosition(-1);return}const l=e.resumeTime;this.timelinePos<l&&(this.log(Wa("advanceAfterAssetEnded",l)),this.timelinePos=l,e.appendInPlace&&this.advanceInPlace(l),this.checkBuffer(this.bufferedPos<l)),this.setSchedulePosition(o)}}}else{if(e.appendInPlace){const i=e.assetList[s];i&&this.advanceInPlace(i.timelineStart)}this.setSchedulePosition(t,s)}}setScheduleToAssetAtTime(e,t){const r=this.schedule;if(!r)return;const s=t.parentIdentifier,i=r.getEvent(s);if(i){const o=r.findEventIndex(s),a=r.findAssetIndex(i,e);this.advanceAfterAssetEnded(i,o,a-1)}}setSchedulePosition(e,t){var r;const s=(r=this.schedule)==null?void 0:r.items;if(!s||this.playbackDisabled)return;const i=e>=0?s[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${i&&ln(i)}) pos: ${this.timelinePos}`);const o=this.waitingItem||this.playingItem,a=this.playingLastItem;if(this.isInterstitial(o)){const u=o.event,d=this.playingAsset,f=d==null?void 0:d.identifier,h=f?this.getAssetPlayer(f):null;if(h&&f&&(!this.eventItemsMatch(o,i)||t!==void 0&&f!==u.assetList[t].identifier)){var l;const p=u.findAssetIndex(d);if(this.log(`INTERSTITIAL_ASSET_ENDED ${p+1}/${u.assetList.length} ${qs(d)}`),this.endedAsset=d,this.playingAsset=null,this.hls.trigger(S.INTERSTITIAL_ASSET_ENDED,{asset:d,assetListIndex:p,event:u,schedule:s.slice(0),scheduleIndex:e,player:h}),o!==this.playingItem){this.itemsMatch(o,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(u,this.findItemIndex(this.playingItem),p);return}this.retreiveMediaSource(f,i),h.media&&!((l=this.detachedData)!=null&&l.mediaSource)&&h.detachMedia()}if(!this.eventItemsMatch(o,i)&&(this.endedItem=o,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${u} ${ln(o)}`),u.hasPlayed=!0,this.hls.trigger(S.INTERSTITIAL_ENDED,{event:u,schedule:s.slice(0),scheduleIndex:e}),u.cue.once)){var c;this.updateSchedule();const p=(c=this.schedule)==null?void 0:c.items;if(i&&p){const m=this.findItemIndex(i);this.advanceSchedule(m,p,t,o,a)}return}}this.advanceSchedule(e,s,t,o,a)}advanceSchedule(e,t,r,s,i){const o=this.schedule;if(!o)return;const a=t[e]||null,l=this.primaryMedia,c=this.playerQueue;if(c.length&&c.forEach(u=>{const d=u.interstitial,f=o.findEventIndex(d.identifier);(f<e||f>e+1)&&this.clearInterstitial(d,a)}),this.isInterstitial(a)){this.timelinePos=Math.min(Math.max(this.timelinePos,a.start),a.end);const u=a.event;if(r===void 0){r=o.findAssetIndex(u,this.timelinePos);const p=sd(u,r-1);if(u.isAssetPastPlayoutLimit(p)||u.appendInPlace&&this.timelinePos===a.end){this.advanceAfterAssetEnded(u,e,r);return}r=p}const d=this.waitingItem;this.assetsBuffered(a,l)||this.setBufferingItem(a);let f=this.preloadAssets(u,r);if(this.eventItemsMatch(a,d||s)||(this.waitingItem=a,this.log(`INTERSTITIAL_STARTED ${ln(a)} ${u.appendInPlace?"append in place":""}`),this.hls.trigger(S.INTERSTITIAL_STARTED,{event:u,schedule:t.slice(0),scheduleIndex:e})),!u.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${u}`);return}if(u.assetListLoader&&(u.assetListLoader.destroy(),u.assetListLoader=void 0),!l){this.log(`Waiting for attachMedia to start Interstitial ${u}`);return}this.waitingItem=this.endedItem=null,this.playingItem=a;const h=u.assetList[r];if(!h){this.advanceAfterAssetEnded(u,e,r||0);return}if(f||(f=this.getAssetPlayer(h.identifier)),f===null||f.destroyed){const p=u.assetList.length;this.warn(`asset ${r+1}/${p} player destroyed ${u}`),f=this.createAssetPlayer(u,h,r),f.loadSource()}if(!this.eventItemsMatch(a,this.bufferingItem)&&u.appendInPlace&&this.isAssetBuffered(h))return;this.startAssetPlayer(f,r,t,e,l),this.shouldPlay&&Y0(f.media)}else a?(this.resumePrimary(a,e,s),this.shouldPlay&&Y0(this.hls.media)):i&&this.isInterstitial(s)&&(this.endedItem=null,this.playingItem=s,s.event.appendInPlace||this.attachPrimary(o.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,r){var s,i;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${ln(e)}`),!((s=this.detachedData)!=null&&s.mediaSource)){let a=this.timelinePos;(a<e.start||a>=e.end)&&(a=this.getPrimaryResumption(e,t),this.log(Wa("resumePrimary",a)),this.timelinePos=a),this.attachPrimary(a,e)}if(!r)return;const o=(i=this.schedule)==null?void 0:i.items;o&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${ln(e)}`),this.hls.trigger(S.INTERSTITIALS_PRIMARY_RESUMED,{schedule:o.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const r=e.start;if(this.primaryLive){const s=this.primaryDetails;if(t===0)return this.hls.startPosition;if(s&&(r<s.fragmentStart||r>s.edge))return this.hls.liveSyncPosition||-1}return r}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:se.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,r){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const s=this.primaryMedia;if(!s)return;const i=this.hls;i.media?this.checkBuffer():(this.transferMediaTo(i,s),r&&this.startLoadingPrimaryAt(e,r)),r||(this.log(Wa("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,r))}startLoadingPrimaryAt(e,t){var r;const s=this.hls;!s.loadingEnabled||!s.media||Math.abs((((r=s.mainForwardBufferInfo)==null?void 0:r.start)||s.media.currentTime)-e)>.5?s.startLoad(e,t):s.bufferingEnabled||s.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(S.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(S.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1||!this.schedule)return;const r=this.hls.levels[t.level],s=ye(ye({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=s,this.schedule.parseInterstitialDateRanges(s,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const r=this.hls.audioTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=ye(ye({},this.altSelection),{},{audio:r});return}const i=ye(ye({},s),{},{audio:r});this.mediaSelection=i}onSubtitleTrackUpdated(e,t){const r=this.hls.subtitleTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=ye(ye({},this.altSelection),{},{subtitles:r});return}const i=ye(ye({},s),{},{subtitles:r});this.mediaSelection=i}onAudioTrackSwitching(e,t){const r=i0(t);this.playerQueue.forEach(({hls:s})=>s&&(s.setAudioOption(t)||s.setAudioOption(r)))}onSubtitleTrackSwitch(e,t){const r=i0(t);this.playerQueue.forEach(({hls:s})=>s&&(s.setSubtitleOption(t)||t.id!==-1&&s.setSubtitleOption(r)))}onBufferCodecs(e,t){const r=t.tracks;r&&(this.requiredTracks=r)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){const s=this.timelinePos;this.bufferedPos=s,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let s=0;s<t.length;s++){const i=t[s];if(i.cue.post){var r;const o=this.schedule.findEventIndex(i.identifier),a=(r=this.schedule.items)==null?void 0:r[o];this.isInterstitial(a)&&this.eventItemsMatch(a,this.bufferingItem)&&this.bufferedToItem(a,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const r=this.findItemIndex(t);this.setSchedulePosition(r+1)}else this.shouldPlay=!1}updateItem(e,t){var r;const s=(r=this.schedule)==null?void 0:r.items;if(e&&s){const i=this.findItemIndex(e,t);return s[i]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((i,o)=>{e.event.isAssetPastPlayoutLimit(o)&&this.clearAssetPlayer(i.identifier,null)});const r=e.end+.25,s=se.bufferInfo(this.primaryMedia,r,0);(s.end>r||(s.nextStart||0)>r)&&(this.log(`trim buffered interstitial ${ln(e)} (was ${ln(t)})`),this.attachPrimary(r,null,!0),this.flushFrontBuffer(r))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var r;return!!t&&(e===t||e.event.identifier===((r=t.event)==null?void 0:r.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;const r=this.mediaSelection;r&&((t=this.schedule)==null||t.updateSchedule(r,[],e))}checkBuffer(e){var t;const r=(t=this.schedule)==null?void 0:t.items;if(!r)return;const s=se.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=s.len<1),this.updateBufferedPos(s.end,r,e)}updateBufferedPos(e,t,r){const s=this.schedule,i=this.bufferingItem;if(this.bufferedPos>e||!s)return;if(t.length===1&&this.itemsMatch(t[0],i)){this.bufferedPos=e;return}const o=this.playingItem,a=this.findItemIndex(o);let l=s.findItemIndexAtTime(e);if(this.bufferedPos<e){var c;const u=this.findItemIndex(i),d=Math.min(u+1,t.length-1),f=t[d];if((l===-1&&i&&e>=i.end||(c=f.event)!=null&&c.appendInPlace&&e+.01>=f.start)&&(l=d),this.isInterstitial(i)){const h=i.event;if(d-a>1&&h.appendInPlace===!1||h.assetList.length===0&&h.assetListLoader)return}if(this.bufferedPos=e,l>u&&l>a)this.bufferedToItem(f);else{const h=this.primaryDetails;this.primaryLive&&h&&e>h.edge-h.targetduration&&f.start<h.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(f)&&this.preloadAssets(f.event,0)}}else r&&o&&!this.itemsMatch(o,i)&&(l===a?this.bufferedToItem(o):l===a+1&&this.bufferedToItem(t[l]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(s=>{const i=this.getAssetPlayer(s.identifier);return!(i!=null&&i.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,r=this.schedule;if(!this.itemsMatch(e,t)&&r){const{items:s,events:i}=r;if(!s||!i)return t;const o=this.isInterstitial(e),a=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const l=a?a.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${ln(e)}`+(t?` (${l.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(o){const c=r.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((u,d)=>{const f=this.getAssetPlayer(u.identifier);f&&(d===c&&f.loadSource(),f.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(c=>c.pauseBuffering());this.hls.trigger(S.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:i.slice(0),schedule:s.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){const r=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(r!==null){this.bufferingAsset=null;const s=this.detachedData;s?s.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),r=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(r)}bufferedToEvent(e,t){const r=e.event,s=r.assetList.length===0&&!r.assetListLoader,i=r.cue.once;if(s||!i){const o=this.preloadAssets(r,t);if(o!=null&&o.interstitial.appendInPlace){const a=this.primaryMedia;a&&this.bufferAssetPlayer(o,a)}}}preloadAssets(e,t){const r=e.assetUrl,s=e.assetList.length,i=s===0&&!e.assetListLoader,o=e.cue.once;if(i){const l=e.timelineStart;if(e.appendInPlace){var a;const f=this.playingItem;!this.isInterstitial(f)&&(f==null||(a=f.nextEvent)==null?void 0:a.identifier)===e.identifier&&this.flushFrontBuffer(l+.25)}let c,u=0;if(!this.playingItem&&this.primaryLive&&(u=this.hls.startPosition,u===-1&&(u=this.hls.liveSyncPosition||0)),u&&!(e.cue.pre||e.cue.post)){const f=u-l;f>0&&(c=Math.round(f*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${r?1:s} ${e}${c?` live-start: ${u} start-offset: ${c}`:""}`),r)return this.createAsset(e,0,0,l,e.duration,r);const d=this.assetListLoader.loadAssetList(e,c);d&&(e.assetListLoader=d)}else if(!o&&s){for(let c=t;c<s;c++){const u=e.assetList[c],d=this.getAssetPlayerQueueIndex(u.identifier);(d===-1||this.playerQueue[d].destroyed)&&!u.error&&this.createAssetPlayer(e,u,c)}const l=e.assetList[t];if(l){const c=this.getAssetPlayer(l.identifier);return c&&c.loadSource(),c}}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(s=>{this.hls.trigger(S.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:s})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let r=0;r<t.length;r++)if(e===t[r].assetId)return r;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let r=0;r<e.length;r++)if(e[r].media===t)return e[r]}return null}createAsset(e,t,r,s,i,o){const a={parentIdentifier:e.identifier,identifier:XN(e,o,t),duration:i,startOffset:r,timelineStart:s,uri:o};return this.createAssetPlayer(e,a,t)}createAssetPlayer(e,t,r){const s=this.hls,i=s.userConfig;let o=i.videoPreference;const a=s.loadLevelObj||s.levels[s.currentLevel];(o||a)&&(o=Ee({},o),a.videoCodec&&(o.videoCodec=a.videoCodec),a.videoRange&&(o.allowedVideoRanges=[a.videoRange]));const l=s.audioTracks[s.audioTrack],c=s.subtitleTracks[s.subtitleTrack];let u=0;if(this.primaryLive||e.appendInPlace){const T=this.timelinePos-t.timelineStart;if(T>1){const w=t.duration;w&&T<w&&(u=T)}}const d=t.identifier,f=ye(ye({},i),{},{maxMaxBufferLength:Math.min(180,s.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:s.sessionId,assetPlayerId:d,abrEwmaDefaultEstimate:s.bandwidthEstimate,interstitialsController:void 0,startPosition:u,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:o,audioPreference:l||i.audioPreference,subtitlePreference:c||i.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(f.timelineOffset=t.timelineStart));const h=f.cmcd;h!=null&&h.sessionId&&h.contentId&&(f.cmcd=Ee({},h,{contentId:Io(t.uri)})),this.getAssetPlayer(d)&&this.warn(`Duplicate date range identifier ${e} and asset ${d}`);const p=new eO(this.HlsPlayerClass,f,e,t);this.playerQueue.push(p),e.assetList[r]=t;let m=!0;const g=T=>{if(T.live){var w;const R=new Error(`Interstitials MUST be VOD assets ${e}`),C={fatal:!0,type:J.OTHER_ERROR,details:N.INTERSTITIAL_ASSET_ITEM_ERROR,error:R},I=((w=this.schedule)==null?void 0:w.findEventIndex(e.identifier))||-1;this.handleAssetItemError(C,e,I,r,R.message);return}const L=T.edge-T.fragmentStart,A=t.duration;(m||A===null||L>A)&&(m=!1,this.log(`Interstitial asset "${d}" duration change ${A} > ${L}`),t.duration=L,this.updateSchedule())};p.on(S.LEVEL_UPDATED,(T,{details:w})=>g(w)),p.on(S.LEVEL_PTS_UPDATED,(T,{details:w})=>g(w)),p.on(S.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const v=(T,w)=>{const L=this.getAssetPlayer(d);if(L&&w.tracks){L.off(S.BUFFER_CODECS,v),L.tracks=w.tracks;const A=this.primaryMedia;this.bufferingAsset===L.assetItem&&A&&!L.media&&this.bufferAssetPlayer(L,A)}};p.on(S.BUFFER_CODECS,v);const x=()=>{var T;const w=this.getAssetPlayer(d);if(this.log(`buffered to end of asset ${w}`),!w||!this.schedule)return;const L=this.schedule.findEventIndex(e.identifier),A=(T=this.schedule.items)==null?void 0:T[L];this.isInterstitial(A)&&this.advanceAssetBuffering(A,t)};p.on(S.BUFFERED_TO_END,x);const E=T=>()=>{if(!this.getAssetPlayer(d)||!this.schedule)return;this.shouldPlay=!0;const L=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,L,T)};return p.once(S.MEDIA_ENDED,E(r)),p.once(S.PLAYOUT_LIMIT_REACHED,E(1/0)),p.on(S.ERROR,(T,w)=>{if(!this.schedule)return;const L=this.getAssetPlayer(d);if(w.details===N.BUFFER_STALLED_ERROR){if(L!=null&&L.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(w,e,this.schedule.findEventIndex(e.identifier),r,`Asset player error ${w.error} ${e}`)}),p.on(S.DESTROYING,()=>{if(!this.getAssetPlayer(d)||!this.schedule)return;const w=new Error(`Asset player destroyed unexpectedly ${d}`),L={fatal:!0,type:J.OTHER_ERROR,details:N.INTERSTITIAL_ASSET_ITEM_ERROR,error:w};this.handleAssetItemError(L,e,this.schedule.findEventIndex(e.identifier),r,w.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${qs(t)}`),this.hls.trigger(S.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:r,event:e,player:p}),p}clearInterstitial(e,t){e.assetList.forEach(r=>{this.clearAssetPlayer(r.identifier,t)}),e.reset()}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const r=this.playerQueue[t];this.transferMediaFromPlayer(r,null),r.resetDetails()}}clearAssetPlayer(e,t){const r=this.getAssetPlayerQueueIndex(e);if(r!==-1){const s=this.playerQueue[r];this.log(`clear ${s} toSegment: ${t&&ln(t)}`),this.transferMediaFromPlayer(s,t),this.playerQueue.splice(r,1),s.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,r,s,i){const{interstitial:o,assetItem:a,assetId:l}=e,c=o.assetList.length,u=this.playingAsset;this.endedAsset=null,this.playingAsset=a,(!u||u.identifier!==l)&&(u&&(this.clearAssetPlayer(u.identifier,r[s]),delete u.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${c} ${qs(a)}`),this.hls.trigger(S.INTERSTITIAL_ASSET_STARTED,{asset:a,assetListIndex:t,event:o,schedule:r.slice(0),scheduleIndex:s,player:e})),this.bufferAssetPlayer(e,i)}bufferAssetPlayer(e,t){var r,s;if(!this.schedule)return;const{interstitial:i,assetItem:o}=e,a=this.schedule.findEventIndex(i.identifier),l=(r=this.schedule.items)==null?void 0:r[a];if(!l)return;e.loadSource(),this.setBufferingItem(l),this.bufferingAsset=o;const c=this.getBufferingPlayer();if(c===e)return;const u=i.appendInPlace;if(u&&(c==null?void 0:c.interstitial.appendInPlace)===!1)return;const d=(c==null?void 0:c.tracks)||((s=this.detachedData)==null?void 0:s.tracks)||this.requiredTracks;if(u&&o!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(d&&!ES(d,e.tracks)){const f=new Error(`Asset ${qs(o)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(d)}')`),h={fatal:!0,type:J.OTHER_ERROR,details:N.INTERSTITIAL_ASSET_ITEM_ERROR,error:f},p=i.findAssetIndex(o);this.handleAssetItemError(h,i,a,p,f.message);return}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,r=this.primaryMedia;if(!t||!r)return;const s=r.currentTime,i=t.findAssetIndex(e,s),o=e.assetList[i];if(o){const a=this.getAssetPlayer(o.identifier);if(a){const l=a.currentTime||s-o.timelineStart,c=a.duration-l;if(this.warn(`Stalled at ${l} of ${l+c} in ${a} ${e} (media.currentTime: ${s})`),l&&(c/r.playbackRate<.5||a.bufferedInPlaceToEnd(r))&&a.hls){const u=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,u,i)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,r,s,i){if(e.details===N.BUFFER_STALLED_ERROR)return;const o=t.assetList[s]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${o&&qs(o)} ${e.error}`),!this.schedule)return;const a=(o==null?void 0:o.identifier)||"",l=this.getAssetPlayerQueueIndex(a),c=this.playerQueue[l]||null,u=this.schedule.items,d=Ee({},e,{fatal:!1,errorAction:yi(!0),asset:o,assetListIndex:s,event:t,schedule:u,scheduleIndex:r,player:c});if(this.hls.trigger(S.INTERSTITIAL_ASSET_ERROR,d),!e.fatal)return;const f=this.playingAsset,h=this.bufferingAsset,p=new Error(i);if(o&&(this.clearAssetPlayer(a,null),o.error=p),!t.assetList.some(m=>!m.error))t.error=p;else for(let m=s;m<t.assetList.length;m++)this.resetAssetPlayer(t.assetList[m].identifier);this.updateSchedule(!0),t.error?this.primaryFallback(t):f&&f.identifier===a?this.advanceAfterAssetEnded(t,r,s):h&&h.identifier===a&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,h)}primaryFallback(e){const t=e.timelineStart,r=this.effectivePlayingItem;if(r){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${ln(r)} error: ${e.error}`);let s=this.timelinePos;s===-1&&(s=this.hls.startPosition);const i=this.updateItem(r,s);if(this.itemsMatch(r,i)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t)),!this.schedule)return;const o=this.schedule.findItemIndexAtTime(s);this.setSchedulePosition(o)}else this.checkStart()}onAssetListLoaded(e,t){var r,s;const i=t.event,o=i.identifier,a=t.assetListResponse.ASSETS;if(!((r=this.schedule)!=null&&r.hasEvent(o)))return;const l=i.timelineStart,c=i.duration;let u=0;a.forEach((m,g)=>{const v=parseFloat(m.DURATION);this.createAsset(i,g,u,l+u,v,m.URI),u+=v}),i.duration=u,this.log(`Loaded asset-list with duration: ${u} (was: ${c}) ${i}`);const d=this.waitingItem,f=(d==null?void 0:d.event.identifier)===o;this.updateSchedule();const h=(s=this.bufferingItem)==null?void 0:s.event;if(f){var p;const m=this.schedule.findEventIndex(o),g=(p=this.schedule.items)==null?void 0:p[m];if(g){if(!this.playingItem&&this.timelinePos>g.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==m){i.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${i}`),this.updateSchedule(!0),this.primaryFallback(i);return}this.setBufferingItem(g)}this.setSchedulePosition(m)}else if((h==null?void 0:h.identifier)===o){const m=i.assetList[0];if(m){const g=this.getAssetPlayer(m.identifier);if(h.appendInPlace){const v=this.primaryMedia;g&&v&&this.bufferAssetPlayer(g,v)}else g&&g.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case N.ASSET_LIST_PARSING_ERROR:case N.ASSET_LIST_LOAD_ERROR:case N.ASSET_LIST_LOAD_TIMEOUT:{const r=t.interstitial;r&&(this.updateSchedule(!0),this.primaryFallback(r));break}case N.BUFFER_STALLED_ERROR:{const r=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&r.event.appendInPlace){this.handleInPlaceStall(r.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const q0=500;class sO extends Sm{constructor(e,t,r){super(e,t,r,"subtitle-stream-controller",Z.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(S.LEVEL_LOADED,this.onLevelLoaded,this),e.on(S.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(S.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(S.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(S.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(S.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(S.LEVEL_LOADED,this.onLevelLoaded,this),e.off(S.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(S.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(S.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(S.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(S.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=j.IDLE,this.setInterval(q0),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:r,success:s}=t;if(this.fragContextChanged(r)||(Ge(r)&&(this.fragPrevious=r),this.state=j.IDLE),!s)return;const i=this.tracksBuffered[this.currentTrackId];if(!i)return;let o;const a=r.start;for(let c=0;c<i.length;c++)if(a>=i[c].start&&a<=i[c].end){o=i[c];break}const l=r.start+r.duration;o?o.end=l:(o={start:a,end:l},i.push(o)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:r,endOffset:s}=t;if(r===0&&s!==Number.POSITIVE_INFINITY){const i=s-1;if(i<=0)return;t.endOffsetSubtitles=Math.max(0,i),this.tracksBuffered.forEach(o=>{for(let a=0;a<o.length;){if(o[a].end<=i){o.shift();continue}else if(o[a].start<i)o[a].start=i;else break;a++}}),this.fragmentTracker.removeFragmentsInRange(r,i,Z.SUBTITLE)}}onError(e,t){const r=t.frag;(r==null?void 0:r.type)===Z.SUBTITLE&&(t.details===N.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==j.STOPPED&&(this.state=j.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&yT(this.levels,t)){this.levels=t.map(r=>new Xo(r));return}this.tracksBuffered=[],this.levels=t.map(r=>{const s=new Xo(r);return this.tracksBuffered[s.id]=[],s}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Z.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var r;if(this.currentTrackId=t.id,!((r=this.levels)!=null&&r.length)||this.currentTrackId===-1){this.clearInterval();return}const s=this.levels[this.currentTrackId];s!=null&&s.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,s&&this.state!==j.STOPPED&&this.setInterval(q0)}onSubtitleTrackLoaded(e,t){var r;const{currentTrackId:s,levels:i}=this,{details:o,id:a}=t;if(!i){this.warn(`Subtitle tracks were reset while loading level ${a}`);return}const l=i[a];if(a>=i.length||!l)return;this.log(`Subtitle track ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let c=0;if(o.live||(r=l.details)!=null&&r.live){if(o.deltaUpdateFailed)return;const d=this.mainDetails;if(!d){this.startFragRequested=!1;return}const f=d.fragments[0];if(!l.details)o.hasProgramDateTime&&d.hasProgramDateTime?(hc(o,d),c=o.fragmentStart):f&&(c=f.start,Uf(o,c));else{var u;c=this.alignPlaylists(o,l.details,(u=this.levelLastLoaded)==null?void 0:u.details),c===0&&f&&(c=f.start,Uf(o,c))}d&&!this.startFragRequested&&this.setStartPosition(d,c)}l.details=o,this.levelLastLoaded=l,a===s&&(this.hls.trigger(S.SUBTITLE_TRACK_UPDATED,{details:o,id:a,groupId:t.groupId}),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===j.IDLE&&(Ns(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:r}=e,s=t.decryptdata,i=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&s!=null&&s.key&&s.iv&&xi(s.method)){const o=performance.now();this.decrypter.decrypt(new Uint8Array(r),s.key.buffer,s.iv.buffer,xm(s.method)).catch(a=>{throw i.trigger(S.ERROR,{type:J.MEDIA_ERROR,details:N.FRAG_DECRYPT_ERROR,fatal:!1,error:a,reason:a.message,frag:t}),a}).then(a=>{const l=performance.now();i.trigger(S.FRAG_DECRYPTED,{frag:t,payload:a,stats:{tstart:o,tdecrypt:l}})}).catch(a=>{this.warn(`${a.name}: ${a.message}`),this.state=j.IDLE})}}doTick(){if(!this.media){this.state=j.IDLE;return}if(this.state===j.IDLE){const{currentTrackId:e,levels:t}=this,r=t==null?void 0:t[e];if(!r||!t.length||!r.details||this.waitForLive(r))return;const{config:s}=this,i=this.getLoadPosition(),o=se.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,s.maxBufferHole),{end:a,len:l}=o,c=r.details,u=this.hls.maxBufferLength+c.levelTargetDuration;if(l>u)return;const d=c.fragments,f=d.length,h=c.edge;let p=null;const m=this.fragPrevious;if(a<h){const x=s.maxFragLookUpTolerance,E=a>h-x?0:x;p=Ns(m,d,Math.max(d[0].start,a),E),!p&&m&&m.start<d[0].start&&(p=d[0])}else p=d[f-1];if(p=this.filterReplacedPrimary(p,r.details),!p)return;const g=p.sn-c.startSN,v=d[g-1];if(v&&v.cc===p.cc&&this.fragmentTracker.getState(v)===ze.NOT_LOADED&&(p=v),this.fragmentTracker.getState(p)===ze.NOT_LOADED){const x=this.mapToInitFragWhenRequired(p);x&&this.loadFragment(x,r,a)}}}loadFragment(e,t,r){Ge(e)?super.loadFragment(e,t,r):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new iO(this.tracksBuffered[this.currentTrackId]||[])}}class iO{constructor(e){this.buffered=void 0;const t=(r,s,i)=>{if(s=s>>>0,s>i-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${s}) is greater than the maximum bound (${i})`);return e[s][r]};this.buffered={get length(){return e.length},end(r){return t("end",r,e.length)},start(r){return t("start",r,e.length)}}}}const oO={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},NT=n=>String.fromCharCode(oO[n]||n),un=15,Jn=100,aO={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},lO={17:2,18:4,21:6,22:8,23:10,19:13,20:15},cO={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},uO={25:2,26:4,29:6,30:8,31:10,27:13,28:15},dO=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class fO{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const r=typeof t=="function"?t():t;me.log(`${this.time} [${e}] ${r}`)}}}const fs=function(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].toString(16));return t};class OT{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){const s=t[r];e.hasOwnProperty(s)&&(this[s]=e[s])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class hO{constructor(){this.uchar=" ",this.penState=new OT}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class mO{constructor(e){this.chars=[],this.pos=0,this.currPenState=new OT,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Jn;t++)this.chars.push(new hO);this.logger=e}equals(e){for(let t=0;t<Jn;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Jn;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Jn;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Jn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Jn)}moveCursor(e){const t=this.pos+e;if(e>1)for(let r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=NT(e);if(this.pos>=Jn){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Jn;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let r=0;r<Jn;r++){const s=this.chars[r].uchar;s!==" "&&(t=!1),e.push(s)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class id{constructor(e){this.rows=[],this.currRow=un-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<un;t++)this.rows.push(new mO(e));this.logger=e}reset(){for(let e=0;e<un;e++)this.rows[e].clear();this.currRow=un-1}equals(e){let t=!0;for(let r=0;r<un;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<un;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<un;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+Ie(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let a=0;a<un;a++)this.rows[a].clear();const i=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const a=o.rows[i].cueStartTime,l=this.logger.time;if(a!==null&&l!==null&&a<l)for(let c=0;c<this.nrRollUpRows;c++)this.rows[t-this.nrRollUpRows+c+1].copy(o.rows[i+c])}}this.currRow=t;const r=this.rows[this.currRow];if(e.indent!==null){const i=e.indent,o=Math.max(i-1,0);r.setCursor(e.indent),e.color=r.chars[o].penState.foreground}const s={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+Ie(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let r="",s=-1;for(let i=0;i<un;i++){const o=this.rows[i].getTextString();o&&(s=i+1,e?t.push("Row "+s+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?r="["+t.join(" | ")+"]":r=t.join(`
`)),r}getTextAndFormat(){return this.rows}}class Q0{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new id(r),this.nonDisplayedMemory=new id(r),this.lastOutputScreen=new id(r),this.currRollUpRow=this.displayedMemory.rows[un-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[un-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const r=Math.floor(e/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=s[r]}this.logger.log(2,"MIDROW: "+Ie(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class X0{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=gO(),this.logger=void 0;const s=this.logger=new fO;this.channels=[null,new Q0(e,t,s),new Q0(e+1,r,s)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let r=0;r<t.length;r+=2){const s=t[r]&127,i=t[r+1]&127;let o=!1,a=null;if(s===0&&i===0)continue;this.logger.log(3,()=>"["+fs([t[r],t[r+1]])+"] -> ("+fs([s,i])+")");const l=this.cmdHistory;if(s>=16&&s<=31){if(pO(s,i,l)){Ya(null,null,l),this.logger.log(3,()=>"Repeated command ("+fs([s,i])+") is dropped");continue}Ya(s,i,this.cmdHistory),o=this.parseCmd(s,i),o||(o=this.parseMidrow(s,i)),o||(o=this.parsePAC(s,i)),o||(o=this.parseBackgroundAttributes(s,i))}else Ya(null,null,l);if(!o&&(a=this.parseChars(s,i),a)){const u=this.currentChannel;u&&u>0?this.channels[u].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!a&&this.logger.log(2,()=>"Couldn't parse cleaned data "+fs([s,i])+" orig: "+fs([t[r],t[r+1]]))}}parseCmd(e,t){const r=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=33&&t<=35;if(!(r||s))return!1;const i=e===20||e===21||e===23?1:2,o=this.channels[i];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=i,!0}parseMidrow(e,t){let r=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?r=1:r=2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[r];return s?(s.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+fs([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let r;const s=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,i=(e===16||e===24)&&t>=64&&t<=95;if(!(s||i))return!1;const o=e<=23?1:2;t>=64&&t<=95?r=o===1?aO[e]:cO[e]:r=o===1?lO[e]:uO[e];const a=this.channels[o];return a?(a.setPAC(this.interpretPAC(r,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let r;const s={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?r=t-96:r=t-64,s.underline=(r&1)===1,r<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(s.italics=!0,s.color="white"):s.indent=Math.floor((r-16)/2)*4,s}parseChars(e,t){let r,s=null,i=null;if(e>=25?(r=2,i=e-8):(r=1,i=e),i>=17&&i<=19){let o;i===17?o=t+80:i===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+NT(o)+"' in channel "+r),s=[o]}else e>=32&&e<=127&&(s=t===0?[e]:[e,t]);return s&&this.logger.log(3,()=>"Char codes =  "+fs(s).join(",")),s}parseBackgroundAttributes(e,t){const r=(e===16||e===24)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=45&&t<=47;if(!(r||s))return!1;let i;const o={};e===16||e===24?(i=Math.floor((t-32)/2),o.background=dO[i],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const a=e<=23?1:2;return this.channels[a].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}Ya(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function Ya(n,e,t){t.a=n,t.b=e}function pO(n,e,t){return t.a===n&&t.b===e}function gO(){return{a:null,b:null}}var Dm=function(){if(fc!=null&&fc.VTTCue)return self.VTTCue;const n=["","lr","rl"],e=["start","middle","end","left","right"];function t(a,l){if(typeof l!="string"||!Array.isArray(a))return!1;const c=l.toLowerCase();return~a.indexOf(c)?c:!1}function r(a){return t(n,a)}function s(a){return t(e,a)}function i(a,...l){let c=1;for(;c<arguments.length;c++){const u=arguments[c];for(const d in u)a[d]=u[d]}return a}function o(a,l,c){const u=this,d={enumerable:!0};u.hasBeenReset=!1;let f="",h=!1,p=a,m=l,g=c,v=null,x="",E=!0,T="auto",w="start",L=50,A="middle",R=50,C="middle";Object.defineProperty(u,"id",i({},d,{get:function(){return f},set:function(I){f=""+I}})),Object.defineProperty(u,"pauseOnExit",i({},d,{get:function(){return h},set:function(I){h=!!I}})),Object.defineProperty(u,"startTime",i({},d,{get:function(){return p},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");p=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"endTime",i({},d,{get:function(){return m},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");m=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"text",i({},d,{get:function(){return g},set:function(I){g=""+I,this.hasBeenReset=!0}})),Object.defineProperty(u,"region",i({},d,{get:function(){return v},set:function(I){v=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"vertical",i({},d,{get:function(){return x},set:function(I){const P=r(I);if(P===!1)throw new SyntaxError("An invalid or illegal string was specified.");x=P,this.hasBeenReset=!0}})),Object.defineProperty(u,"snapToLines",i({},d,{get:function(){return E},set:function(I){E=!!I,this.hasBeenReset=!0}})),Object.defineProperty(u,"line",i({},d,{get:function(){return T},set:function(I){if(typeof I!="number"&&I!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");T=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"lineAlign",i({},d,{get:function(){return w},set:function(I){const P=s(I);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");w=P,this.hasBeenReset=!0}})),Object.defineProperty(u,"position",i({},d,{get:function(){return L},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");L=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"positionAlign",i({},d,{get:function(){return A},set:function(I){const P=s(I);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");A=P,this.hasBeenReset=!0}})),Object.defineProperty(u,"size",i({},d,{get:function(){return R},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");R=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"align",i({},d,{get:function(){return C},set:function(I){const P=s(I);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");C=P,this.hasBeenReset=!0}})),u.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class vO{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function MT(n){function e(r,s,i,o){return(r|0)*3600+(s|0)*60+(i|0)+parseFloat(o||0)}const t=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class yO{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let s=0;s<r.length;++s)if(t===r[s]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function FT(n,e,t,r){const s=r?n.split(r):[n];for(const i in s){if(typeof s[i]!="string")continue;const o=s[i].split(t);if(o.length!==2)continue;const a=o[0],l=o[1];e(a,l)}}const Yf=new Dm(0,0,""),qa=Yf.align==="middle"?"middle":"center";function xO(n,e,t){const r=n;function s(){const a=MT(n);if(a===null)throw new Error("Malformed timestamp: "+r);return n=n.replace(/^[^\sa-zA-Z-]+/,""),a}function i(a,l){const c=new yO;FT(a,function(f,h){let p;switch(f){case"region":for(let m=t.length-1;m>=0;m--)if(t[m].id===h){c.set(f,t[m].region);break}break;case"vertical":c.alt(f,h,["rl","lr"]);break;case"line":p=h.split(","),c.integer(f,p[0]),c.percent(f,p[0])&&c.set("snapToLines",!1),c.alt(f,p[0],["auto"]),p.length===2&&c.alt("lineAlign",p[1],["start",qa,"end"]);break;case"position":p=h.split(","),c.percent(f,p[0]),p.length===2&&c.alt("positionAlign",p[1],["start",qa,"end","line-left","line-right","auto"]);break;case"size":c.percent(f,h);break;case"align":c.alt(f,h,["start",qa,"end","left","right"]);break}},/:/,/\s/),l.region=c.get("region",null),l.vertical=c.get("vertical","");let u=c.get("line","auto");u==="auto"&&Yf.line===-1&&(u=-1),l.line=u,l.lineAlign=c.get("lineAlign","start"),l.snapToLines=c.get("snapToLines",!0),l.size=c.get("size",100),l.align=c.get("align",qa);let d=c.get("position","auto");d==="auto"&&Yf.position===50&&(d=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=d}function o(){n=n.replace(/^\s+/,"")}if(o(),e.startTime=s(),o(),n.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);n=n.slice(3),o(),e.endTime=s(),o(),i(n,e)}function $T(n){return n.replace(/<br(?: \/)?>/gi,`
`)}class EO{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new vO,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function r(){let i=t.buffer,o=0;for(i=$T(i);o<i.length&&i[o]!=="\r"&&i[o]!==`
`;)++o;const a=i.slice(0,o);return i[o]==="\r"&&++o,i[o]===`
`&&++o,t.buffer=i.slice(o),a}function s(i){FT(i,function(o,a){},/:/)}try{let i="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;i=r();const a=i.match(/^()?WEBVTT([ \t].*)?$/);if(!(a!=null&&a[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:i=r(),t.state){case"HEADER":/:/.test(i)?s(i):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new Dm(0,0,""),t.state="CUE",i.indexOf("-->")===-1){t.cue.id=i;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{xO(i,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const a=i.indexOf("-->")!==-1;if(!i||a&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=i}continue;case"BADCUE":i||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const SO=/\r\n|\n\r|\n|\r/g,od=function(e,t,r=0){return e.slice(r,r+t.length)===t},TO=function(e){let t=parseInt(e.slice(-3));const r=parseInt(e.slice(-6,-4)),s=parseInt(e.slice(-9,-7)),i=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!q(t)||!q(r)||!q(s)||!q(i))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*r,t+=60*1e3*s,t+=60*60*1e3*i,t};function Nm(n,e,t){return Io(n.toString())+Io(e.toString())+Io(t)}const bO=function(e,t,r){let s=e[t],i=e[s.prevCC];if(!i||!i.new&&s.new){e.ccOffset=e.presentationOffset=s.start,s.new=!1;return}for(;(o=i)!=null&&o.new;){var o;e.ccOffset+=s.start-i.start,s.new=!1,s=i,i=e[s.prevCC]}e.presentationOffset=r};function wO(n,e,t,r,s,i,o){const a=new EO,l=Ut(new Uint8Array(n)).trim().replace(SO,`
`).split(`
`),c=[],u=e?_D(e.baseTime,e.timescale):0;let d="00:00.000",f=0,h=0,p,m=!0;a.oncue=function(g){const v=t[r];let x=t.ccOffset;const E=(f-u)/9e4;if(v!=null&&v.new&&(h!==void 0?x=t.ccOffset=v.start:bO(t,r,E)),E){if(!e){p=new Error("Missing initPTS for VTT MPEGTS");return}x=E-t.presentationOffset}const T=g.endTime-g.startTime,w=Wt((g.startTime+x-h)*9e4,s*9e4)/9e4;g.startTime=Math.max(w,0),g.endTime=Math.max(w+T,0);const L=g.text.trim();g.text=decodeURIComponent(encodeURIComponent(L)),g.id||(g.id=Nm(g.startTime,g.endTime,L)),g.endTime>0&&c.push(g)},a.onparsingerror=function(g){p=g},a.onflush=function(){if(p){o(p);return}i(c)},l.forEach(g=>{if(m)if(od(g,"X-TIMESTAMP-MAP=")){m=!1,g.slice(16).split(",").forEach(v=>{od(v,"LOCAL:")?d=v.slice(6):od(v,"MPEGTS:")&&(f=parseInt(v.slice(7)))});try{h=TO(d)/1e3}catch(v){p=v}return}else g===""&&(m=!1);a.parse(g+`
`)}),a.flush()}const ad="stpp.ttml.im1t",BT=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,UT=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,AO={left:"start",center:"center",right:"end",start:"start",end:"end"};function Z0(n,e,t,r){const s=le(new Uint8Array(n),["mdat"]);if(s.length===0){r(new Error("Could not parse IMSC1 mdat"));return}const i=s.map(a=>Ut(a)),o=kD(e.baseTime,1,e.timescale);try{i.forEach(a=>t(LO(a,o)))}catch(a){r(a)}}function LO(n,e){const s=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const i={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(i).reduce((d,f)=>(d[f]=s.getAttribute(`ttp:${f}`)||i[f],d),{}),a=s.getAttribute("xml:space")!=="preserve",l=J0(ld(s,"styling","style")),c=J0(ld(s,"layout","region")),u=ld(s,"body","[begin]");return[].map.call(u,d=>{const f=jT(d,a);if(!f||!d.hasAttribute("begin"))return null;const h=ud(d.getAttribute("begin"),o),p=ud(d.getAttribute("dur"),o);let m=ud(d.getAttribute("end"),o);if(h===null)throw ev(d);if(m===null){if(p===null)throw ev(d);m=h+p}const g=new Dm(h-e,m-e,f);g.id=Nm(g.startTime,g.endTime,g.text);const v=c[d.getAttribute("region")],x=l[d.getAttribute("style")],E=IO(v,x,l),{textAlign:T}=E;if(T){const w=AO[T];w&&(g.lineAlign=w),g.align=T}return Ee(g,E),g}).filter(d=>d!==null)}function ld(n,e,t){const r=n.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function J0(n){return n.reduce((e,t)=>{const r=t.getAttribute("xml:id");return r&&(e[r]=t),e},{})}function jT(n,e){return[].slice.call(n.childNodes).reduce((t,r,s)=>{var i;return r.nodeName==="br"&&s?t+`
`:(i=r.childNodes)!=null&&i.length?jT(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}function IO(n,e,t){const r="http://www.w3.org/ns/ttml#styling";let s=null;const i=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=n!=null&&n.hasAttribute("style")?n.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(s=t[o]),i.reduce((a,l)=>{const c=cd(e,r,l)||cd(n,r,l)||cd(s,r,l);return c&&(a[l]=c),a},{})}function cd(n,e,t){return n&&n.hasAttributeNS(e,t)?n.getAttributeNS(e,t):null}function ev(n){return new Error(`Could not parse ttml timestamp ${n}`)}function ud(n,e){if(!n)return null;let t=MT(n);return t===null&&(BT.test(n)?t=RO(n,e):UT.test(n)&&(t=CO(n,e))),t}function RO(n,e){const t=BT.exec(n),r=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+r/e.frameRate}function CO(n,e){const t=UT.exec(n),r=Number(t[1]);switch(t[2]){case"h":return r*3600;case"m":return r*60;case"ms":return r*1e3;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}class Qa{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class kO{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=nv(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(S.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(S.FRAG_LOADING,this.onFragLoading,this),e.on(S.FRAG_LOADED,this.onFragLoaded,this),e.on(S.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(S.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(S.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(S.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(S.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(S.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(S.FRAG_LOADING,this.onFragLoading,this),e.off(S.FRAG_LOADED,this.onFragLoaded,this),e.off(S.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(S.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(S.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(S.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(S.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Qa(this,"textTrack1"),t=new Qa(this,"textTrack2"),r=new Qa(this,"textTrack3"),s=new Qa(this,"textTrack4");this.cea608Parser1=new X0(1,e,t),this.cea608Parser2=new X0(3,r,s)}addCues(e,t,r,s,i){let o=!1;for(let a=i.length;a--;){const l=i[a],c=_O(l[0],l[1],t,r);if(c>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],r),o=!0,c/(r-t)>.5))return}if(o||i.push([t,r]),this.config.renderTextTracksNatively){const a=this.captionsTracks[e];this.Cues.newCue(a,t,r,s)}else{const a=this.Cues.newCue(null,t,r,s);this.hls.trigger(S.CUES_PARSED,{type:"captions",cues:a,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:s,timescale:i,trackId:o}){const{unparsedVttFrags:a}=this;r===Z.MAIN&&(this.initPTS[t.cc]={baseTime:s,timescale:i,trackId:o}),a.length&&(this.unparsedVttFrags=[],a.forEach(l=>{this.initPTS[l.frag.cc]?this.onFragLoaded(S.FRAG_LOADED,l):this.hls.trigger(S.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:r}=this;if(r)for(let s=0;s<r.textTracks.length;s++){const i=r.textTracks[s];if(tv(i,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return i}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:r,media:s}=this,{label:i,languageCode:o}=t[e],a=this.getExistingTrack(i,o);if(a)r[e]=a,li(r[e]),_T(r[e],s);else{const l=this.createTextTrack("captions",i,o);l&&(l[e]=!0,r[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r=t.label,s={_id:e,label:r,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=s,this.hls.trigger(S.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}createTextTrack(e,t,r){const s=this.media;if(s)return s.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const r=!!t.transferMedia;if(this.media=null,r)return;const{captionsTracks:s}=this;Object.keys(s).forEach(i=>{li(s[i]),delete s[i]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=nv(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let r=0;r<t.length;r++)li(t[r])}onSubtitleTracksUpdated(e,t){const r=t.subtitleTracks||[],s=r.some(i=>i.textCodec===ad);if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(yT(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const o=this.media,a=o?wl(o.textTracks):null;if(this.tracks.forEach((l,c)=>{let u;if(a){let d=null;for(let f=0;f<a.length;f++)if(a[f]&&tv(a[f],l)){d=a[f],a[f]=null;break}d&&(u=d)}if(u)li(u);else{const d=GT(l);u=this.createTextTrack(d,l.name,l.lang),u&&(u.mode="disabled")}u&&this.textTracks.push(u)}),a!=null&&a.length){const l=a.filter(c=>c!==null).map(c=>c.label);l.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(a=>({label:a.name,kind:a.type.toLowerCase(),default:a.default,subtitleTrack:a}));this.hls.trigger(S.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(r=>{const s=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!s)return;const i=`textTrack${s[1]}`,o=this.captionsProperties[i];o&&(o.label=r.name,r.lang&&(o.languageCode=r.lang),o.media=r)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Z.MAIN){var r,s;const{cea608Parser1:i,cea608Parser2:o,lastSn:a}=this,{cc:l,sn:c}=t.frag,u=(r=(s=t.part)==null?void 0:s.index)!=null?r:-1;i&&o&&(c!==a+1||c===a&&u!==this.lastPartIndex+1||l!==this.lastCc)&&(i.reset(),o.reset()),this.lastCc=l,this.lastSn=c,this.lastPartIndex=u}}onFragLoaded(e,t){const{frag:r,payload:s}=t;if(r.type===Z.SUBTITLE)if(s.byteLength){const i=r.decryptdata,o="stats"in t;if(i==null||!i.encrypted||o){const a=this.tracks[r.level],l=this.vttCCs;l[r.cc]||(l[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),a&&a.textCodec===ad?this._parseIMSC1(r,s):this._parseVTTs(t)}}else this.hls.trigger(S.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const r=this.hls;Z0(t,this.initPTS[e.cc],s=>{this._appendCues(s,e.level),r.trigger(S.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},s=>{r.logger.log(`Failed to parse IMSC1: ${s}`),r.trigger(S.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:s})})}_parseVTTs(e){var t;const{frag:r,payload:s}=e,{initPTS:i,unparsedVttFrags:o}=this,a=i.length-1;if(!i[r.cc]&&a===-1){o.push(e);return}const l=this.hls,c=(t=r.initSegment)!=null&&t.data?en(r.initSegment.data,new Uint8Array(s)).buffer:s;wO(c,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,u=>{this._appendCues(u,r.level),l.trigger(S.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})},u=>{const d=u.message==="Missing initPTS for VTT MPEGTS";d?o.push(e):this._fallbackToIMSC1(r,s),l.logger.log(`Failed to parse VTT cue: ${u}`),!(d&&a>r.cc)&&l.trigger(S.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:u})})}_fallbackToIMSC1(e,t){const r=this.tracks[e.level];r.textCodec||Z0(t,this.initPTS[e.cc],()=>{r.textCodec=ad,this._parseIMSC1(e,t)},()=>{r.textCodec="wvtt"})}_appendCues(e,t){const r=this.hls;if(this.config.renderTextTracksNatively){const s=this.textTracks[t];if(!s||s.mode==="disabled")return;e.forEach(i=>PT(s,i))}else{const s=this.tracks[t];if(!s)return;const i=s.default?"default":"subtitles"+t;r.trigger(S.CUES_PARSED,{type:"subtitles",cues:e,track:i})}}onFragDecrypted(e,t){const{frag:r}=t;r.type===Z.SUBTITLE&&this.onFragLoaded(S.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:r,samples:s}=t;if(!(r.type===Z.MAIN&&this.closedCaptionsForLevel(r)==="NONE"))for(let i=0;i<s.length;i++){const o=s[i].bytes;if(o){this.cea608Parser1||this.initCea608Parsers();const a=this.extractCea608Data(o);this.cea608Parser1.addData(s[i].pts,a[0]),this.cea608Parser2.addData(s[i].pts,a[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:s,type:i}){const{media:o}=this;if(!(!o||o.currentTime<r)){if(!i||i==="video"){const{captionsTracks:a}=this;Object.keys(a).forEach(l=>Wf(a[l],t,r))}if(this.config.renderTextTracksNatively&&t===0&&s!==void 0){const{textTracks:a}=this;Object.keys(a).forEach(l=>Wf(a[l],t,s))}}}extractCea608Data(e){const t=[[],[]],r=e[0]&31;let s=2;for(let i=0;i<r;i++){const o=e[s++],a=127&e[s++],l=127&e[s++];if(a===0&&l===0)continue;if((4&o)!==0){const u=3&o;(u===0||u===1)&&(t[u].push(a),t[u].push(l))}}return t}}function GT(n){return n.characteristics&&/transcribes-spoken-dialog/gi.test(n.characteristics)&&/describes-music-and-sound/gi.test(n.characteristics)?"captions":"subtitles"}function tv(n,e){return!!n&&n.kind===GT(e)&&Vf(e,n)}function _O(n,e,t,r){return Math.min(e,r)-Math.max(n,t)}function nv(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const PO=/\s/,DO={newCue(n,e,t,r){const s=[];let i,o,a,l,c;const u=self.VTTCue||self.TextTrackCue;for(let f=0;f<r.rows.length;f++)if(i=r.rows[f],a=!0,l=0,c="",!i.isEmpty()){var d;for(let m=0;m<i.chars.length;m++)PO.test(i.chars[m].uchar)&&a?l++:(c+=i.chars[m].uchar,a=!1);i.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const h=$T(c.trim()),p=Nm(e,t,h);n!=null&&(d=n.cues)!=null&&d.getCueById(p)||(o=new u(e,t,h),o.id=p,o.line=f+1,o.align="left",o.position=10+Math.min(80,Math.floor(l*8/32)*10),s.push(o))}return n&&s.length&&(s.sort((f,h)=>f.line==="auto"||h.line==="auto"?0:f.line>8&&h.line>8?h.line-f.line:f.line-h.line),s.forEach(f=>PT(n,f))),s}};function NO(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const OO=/(\d+)-(\d+)\/(\d+)/;class rv{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||BO,this.controller=new self.AbortController,this.stats=new fm}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,r){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const i=MO(e,this.controller.signal),o=e.responseType==="arraybuffer",a=o?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:c}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,i),self.clearTimeout(this.requestTimeout),t.timeout=l&&q(l)?l:c,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},t.timeout),(ea(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(d=>{var f;this.response=this.loader=d;const h=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=c,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},c-(h-s.loading.start)),!d.ok){const{status:m,statusText:g}=d;throw new UO(g||"fetch, bad network response",m,d)}s.loading.first=h,s.total=$O(d.headers)||s.total;const p=(f=this.callbacks)==null?void 0:f.onProgress;return p&&q(t.highWaterMark)?this.loadProgressively(d,s,e,t.highWaterMark,p):o?d.arrayBuffer():e.responseType==="json"?d.json():d.text()}).then(d=>{var f,h;const p=this.response;if(!p)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const m=d[a];m&&(s.loaded=s.total=m);const g={url:p.url,data:d,code:p.status},v=(f=this.callbacks)==null?void 0:f.onProgress;v&&!q(t.highWaterMark)&&v(s,e,d,p),(h=this.callbacks)==null||h.onSuccess(g,s,e,p)}).catch(d=>{var f;if(self.clearTimeout(this.requestTimeout),s.aborted)return;const h=d&&d.code||0,p=d?d.message:null;(f=this.callbacks)==null||f.onError({code:h,text:p},e,d?d.details:null,s)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,r,s=0,i){const o=new ZS,a=e.body.getReader(),l=()=>a.read().then(c=>{if(c.done)return o.dataLength&&i(t,r,o.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const u=c.value,d=u.length;return t.loaded+=d,d<s||o.dataLength?(o.push(u),o.dataLength>=s&&i(t,r,o.flush().buffer,e)):i(t,r,u.buffer,e),l()}).catch(()=>Promise.reject());return l()}}function MO(n,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Ee({},n.headers))};return n.rangeEnd&&t.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),t}function FO(n){const e=OO.exec(n);if(e)return parseInt(e[2])-parseInt(e[1])+1}function $O(n){const e=n.get("Content-Range");if(e){const r=FO(e);if(q(r))return r}const t=n.get("Content-Length");if(t)return parseInt(t)}function BO(n,e){return new self.Request(n.url,e)}class UO extends Error{constructor(e,t,r){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=r}}const jO=/^age:\s*[\d.]+\s*$/im;class VT{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new fm,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const r=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;const i=this.xhrSetup;i?Promise.resolve().then(()=>{if(!(this.loader!==r||this.stats.aborted))return i(r,t.url)}).catch(o=>{if(!(this.loader!==r||this.stats.aborted))return r.open("GET",t.url,!0),i(r,t.url)}).then(()=>{this.loader!==r||this.stats.aborted||this.openAndSendXhr(r,t,e)}).catch(o=>{var a;(a=this.callbacks)==null||a.onError({code:r.status,text:o.message},t,r,s)}):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);const s=t.headers,{maxTimeToFirstByteMs:i,maxLoadTimeMs:o}=r.loadPolicy;if(s)for(const a in s)e.setRequestHeader(a,s[a]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=i&&q(i)?i:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:r}=this;if(!e||!t)return;const s=t.readyState,i=this.config;if(!r.aborted&&s>=2&&(r.loading.first===0&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),i.timeout!==i.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),i.timeout=i.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),s===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const c=t.status,u=t.responseType==="text"?t.responseText:null;if(c>=200&&c<300){const p=u??t.response;if(p!=null){var o,a;r.loading.end=Math.max(self.performance.now(),r.loading.first);const m=t.responseType==="arraybuffer"?p.byteLength:p.length;r.loaded=r.total=m,r.bwEstimate=r.total*8e3/(r.loading.end-r.loading.first);const g=(o=this.callbacks)==null?void 0:o.onProgress;g&&g(r,e,p,t);const v={url:t.responseURL,data:p,code:c};(a=this.callbacks)==null||a.onSuccess(v,r,e,t);return}}const d=i.loadPolicy.errorRetry,f=r.retry,h={url:e.url,data:void 0,code:c};if(dc(d,f,!1,h))this.retry(d);else{var l;me.error(`${c} while loading ${e.url}`),(l=this.callbacks)==null||l.onError({code:c,text:t.statusText},e,t,r)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(dc(e,t,!0))this.retry(e);else{var r;me.warn(`timeout while loading ${(r=this.context)==null?void 0:r.url}`);const s=this.callbacks;s&&(this.abortInternal(),s.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:r}=this;this.retryDelay=gm(e,r.retry),r.retry++,me.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&jO.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const GO={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},VO=ye(ye({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:VT,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:eP,bufferController:zD,capLevelController:km,errorController:iP,fpsController:zN,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:GS,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:GO},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},HO()),{},{subtitleStreamController:sO,subtitleTrackController:qN,timelineController:kO,audioStreamController:GD,audioTrackController:VD,emeController:Ei,cmcdController:VN,contentSteeringController:KN,interstitialsController:rO});function HO(){return{cueHandler:DO,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function KO(n,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const r=qf(n),s=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return s.forEach(o=>{const a=`${o==="level"?"playlist":o}LoadPolicy`,l=e[a]===void 0,c=[];i.forEach(u=>{const d=`${o}Loading${u}`,f=e[d];if(f!==void 0&&l){c.push(d);const h=r[a].default;switch(e[a]={default:h},u){case"TimeOut":h.maxLoadTimeMs=f,h.maxTimeToFirstByteMs=f;break;case"MaxRetry":h.errorRetry.maxNumRetry=f,h.timeoutRetry.maxNumRetry=f;break;case"RetryDelay":h.errorRetry.retryDelayMs=f,h.timeoutRetry.retryDelayMs=f;break;case"MaxRetryTimeout":h.errorRetry.maxRetryDelayMs=f,h.timeoutRetry.maxRetryDelayMs=f;break}}}),c.length&&t.warn(`hls.js config: "${c.join('", "')}" setting(s) are deprecated, use "${a}": ${Ie(e[a])}`)}),ye(ye({},r),e)}function qf(n){return n&&typeof n=="object"?Array.isArray(n)?n.map(qf):Object.keys(n).reduce((e,t)=>(e[t]=qf(n[t]),e),{}):n}function zO(n,e){const t=n.loader;t!==rv&&t!==VT?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):NO()&&(n.loader=rv,n.progressive=!0,n.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const Al=2,WO=.1,YO=.05,qO=100;class QO extends $S{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var r;(r=this.media)!=null&&r.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var r;this.ended=((r=this.media)==null?void 0:r.currentTime)||1,this.hls.trigger(S.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(qO),this.mediaSource=t.mediaSource;const r=this.media=t.media;gt(r,"playing",this.onMediaPlaying),gt(r,"waiting",this.onMediaWaiting),gt(r,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:r}=this;r&&(It(r,"playing",this.onMediaPlaying),It(r,"waiting",this.onMediaWaiting),It(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var r,s;const i=(r=this.hls)==null?void 0:r.config;if(!i)return;const o=this.media;if(!o)return;const{seeking:a}=o,l=this.seeking&&!a,c=!this.seeking&&a,u=o.paused&&!a||o.ended||o.playbackRate===0;if(this.seeking=a,e!==t){t&&(this.ended=0),this.moved=!0,a||(this.nudgeRetry=0,i.nudgeOnVideoHole&&!u&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(c||l){l&&this.stallResolved(e);return}if(u){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&o.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(S.MEDIA_ENDED,{stalled:!1}));return}if(!se.getBuffered(o).length){this.nudgeRetry=0;return}const d=se.bufferInfo(o,e,0),f=d.nextStart||0,h=this.fragmentTracker;if(a&&h&&this.hls){const L=sv(this.hls.inFlightFragments,e),A=d.len>Al,R=!f||L||f-e>Al&&!h.getPartialFragment(e);if(A||R)return;this.moved=!1}const p=(s=this.hls)==null?void 0:s.latestLevelDetails;if(!this.moved&&this.stalled!==null&&h){if(!(d.len>0)&&!f)return;const A=Math.max(f,d.start||0)-e,C=!!(p!=null&&p.live)?p.targetduration*2:Al,I=Xa(e,h);if(A>0&&(A<=C||I)){o.paused||this._trySkipBufferHole(I);return}}const m=i.detectStallWithCurrentTimeMs,g=self.performance.now(),v=this.waiting;let x=this.stalled;if(x===null)if(v>0&&g-v<m)x=this.stalled=v;else{this.stalled=g;return}const E=g-x;if(!a&&(E>=m||v)&&this.hls){var T;if(((T=this.mediaSource)==null?void 0:T.readyState)==="ended"&&!(p!=null&&p.live)&&Math.abs(e-((p==null?void 0:p.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(S.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(d),!this.media||!this.hls)return}const w=se.bufferInfo(o,e,i.maxBufferHole);this._tryFixBufferStall(w,E,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const r=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(r)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(S.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var r;const s=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(r=this.buffered.audio)!=null&&r.length&&s&&s.length>1&&e>s.end(0)){const i=se.bufferedInfo(se.timeRangesToArray(this.buffered.audio),e,0);if(i.len>1&&t>=i.start){const o=se.timeRangesToArray(s),a=se.bufferedInfo(o,t,0).bufferedIndex;if(a>-1&&a<o.length-1){const l=se.bufferedInfo(o,e,0).bufferedIndex,c=o[a].end,u=o[a+1].start;if((l===-1||l>a)&&u-c<1&&e-c<2){const d=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${c} -> ${u} buffered index: ${l}`);this.warn(d.message),this.media.currentTime+=1e-6;let f=Xa(e,this.fragmentTracker);f&&"fragment"in f?f=f.fragment:f||(f=void 0);const h=se.bufferInfo(this.media,e,0);this.hls.trigger(S.ERROR,{type:J.MEDIA_ERROR,details:N.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:d,reason:d.message,frag:f,buffer:h.len,bufferInfo:h})}}}}}_tryFixBufferStall(e,t,r){var s,i;const{fragmentTracker:o,media:a}=this,l=(s=this.hls)==null?void 0:s.config;if(!a||!o||!l)return;const c=(i=this.hls)==null?void 0:i.latestLevelDetails,u=Xa(r,o);if((u||c!=null&&c.live&&r<c.fragmentStart)&&(this._trySkipBufferHole(u)||!this.media))return;const d=e.buffered,f=this.adjacentTraversal(e,r);(d&&d.length>1&&e.len>l.maxBufferHole||e.nextStart&&(e.nextStart-r<l.maxBufferHole||f))&&(t>l.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const r=this.fragmentTracker,s=e.nextStart;if(r&&s){const i=r.getFragAtPos(t,Z.MAIN),o=r.getFragAtPos(s,Z.MAIN);if(i&&o)return o.sn-i.sn<2}return!1}_reportStall(e){const{hls:t,media:r,stallReported:s,stalled:i}=this;if(!s&&i!==null&&r&&t){this.stallReported=!0;const o=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${Ie(e)})`);this.warn(o.message),t.trigger(S.ERROR,{type:J.MEDIA_ERROR,details:N.BUFFER_STALLED_ERROR,fatal:!1,error:o,buffer:e.len,bufferInfo:e,stalled:{start:i}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:r,media:s}=this,i=(t=this.hls)==null?void 0:t.config;if(!s||!r||!i)return 0;const o=s.currentTime,a=se.bufferInfo(s,o,0),l=o<a.start?a.start:a.nextStart;if(l&&this.hls){const u=a.len<=i.maxBufferHole,d=a.len>0&&a.len<1&&s.readyState<3,f=l-o;if(f>0&&(u||d)){if(f>i.maxBufferHole){let p=!1;if(o===0){const m=r.getAppendedFrag(0,Z.MAIN);m&&l<m.end&&(p=!0)}if(!p&&e){var c;if(!((c=this.hls.loadLevelObj)!=null&&c.details)||sv(this.hls.inFlightFragments,l))return 0;let g=!1,v=e.end;for(;v<l;){const x=Xa(v,r);if(x)v+=x.duration;else{g=!0;break}}if(g)return 0}}const h=Math.max(l+YO,o+WO);if(this.warn(`skipping hole, adjusting currentTime from ${o} to ${h}`),this.moved=!0,s.currentTime=h,!(e!=null&&e.gap)){const p=new Error(`fragment loaded with buffer holes, seeking from ${o} to ${h}`),m={type:J.MEDIA_ERROR,details:N.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:p,reason:p.message,buffer:a.len,bufferInfo:a};e&&("fragment"in e?m.part=e:m.frag=e),this.hls.trigger(S.ERROR,m)}return h}}return 0}_tryNudgeBuffer(e){const{hls:t,media:r,nudgeRetry:s}=this,i=t==null?void 0:t.config;if(!r||!i)return 0;const o=r.currentTime;if(this.nudgeRetry++,s<i.nudgeMaxRetry){const a=o+(s+1)*i.nudgeOffset,l=new Error(`Nudging 'currentTime' from ${o} to ${a}`);this.warn(l.message),r.currentTime=a,t.trigger(S.ERROR,{type:J.MEDIA_ERROR,details:N.BUFFER_NUDGE_ON_STALL,error:l,fatal:!1,buffer:e.len,bufferInfo:e})}else{const a=new Error(`Playhead still not moving while enough data buffered @${o} after ${i.nudgeMaxRetry} nudges`);this.error(a.message),t.trigger(S.ERROR,{type:J.MEDIA_ERROR,details:N.BUFFER_STALLED_ERROR,error:a,fatal:!0,buffer:e.len,bufferInfo:e})}}}function sv(n,e){const t=iv(n.main);if(t&&t.start<=e)return t;const r=iv(n.audio);return r&&r.start<=e?r:null}function iv(n){if(!n)return null;switch(n.state){case j.IDLE:case j.STOPPED:case j.ENDED:case j.ERROR:return null}return n.frag}function Xa(n,e){return e.getAppendedFrag(n,Z.MAIN)||e.getPartialFragment(n)}const XO=.25;function Qf(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function dd(n,e,t,r,s){let i=new n(e,t,"");try{i.value=r,s&&(i.type=s)}catch{i=new n(e,t,Ie(s?ye({type:s},r):r))}return i}const Za=(()=>{const n=Qf();try{n&&new n(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class ZO{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(S.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(S.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(S.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(S.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(S.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(S.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(S.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var r;this.media=t.media,((r=t.overrides)==null?void 0:r.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const t=(e=this.hls)==null?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&li(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const r=e[t];if(r.kind==="metadata"&&r.label==="id3")return _T(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:r,enableID3MetadataCues:s}=this.hls.config;if(!r&&!s)return;const{samples:i}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=Qf();if(o)for(let a=0;a<i.length;a++){const l=i[a].type;if(l===Mt.emsg&&!r||!s)continue;const c=iT(i[a].data),u=i[a].pts;let d=u+i[a].duration;d>Za&&(d=Za),d-u<=0&&(d=u+XO);for(let h=0;h<c.length;h++){const p=c[h];if(!oT(p)){this.updateId3CueEnds(u,l);const m=dd(o,u,d,p,l);m&&this.id3Track.addCue(m)}}}}updateId3CueEnds(e,t){var r;const s=(r=this.id3Track)==null?void 0:r.cues;if(s)for(let i=s.length;i--;){const o=s[i];o.type===t&&o.startTime<e&&o.endTime===Za&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:r,type:s}){const{id3Track:i,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:l}}=o;if(i&&(a||l)){let c;s==="audio"?c=u=>u.type===Mt.audioId3&&l:s==="video"?c=u=>u.type===Mt.emsg&&a:c=u=>u.type===Mt.audioId3&&l||u.type===Mt.emsg&&a,Wf(i,t,r,c)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:r,timelineOffset:s,enableDateRangeMetadataCues:i,interstitialsController:o}=this.hls.config;if(!i)return;const a=Qf();if(r&&s&&!o){const{fragmentStart:m,fragmentEnd:g}=e;let v=this.assetCue;v?(v.startTime=m,v.endTime=g):a&&(v=this.assetCue=dd(a,m,g,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),v&&(v.id=r,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(v),v.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:l}=this,{dateRanges:c}=e,u=Object.keys(c);let d=this.dateRangeCuesAppended;if(l&&t){var f;if((f=l.cues)!=null&&f.length){const m=Object.keys(d).filter(g=>!u.includes(g));for(let g=m.length;g--;){var h;const v=m[g],x=(h=d[v])==null?void 0:h.cues;delete d[v],x&&Object.keys(x).forEach(E=>{const T=x[E];if(T){T.removeEventListener("enter",this.onEventCueEnter);try{l.removeCue(T)}catch{}}})}}else d=this.dateRangeCuesAppended={}}const p=e.fragments[e.fragments.length-1];if(!(u.length===0||!q(p==null?void 0:p.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let m=0;m<u.length;m++){const g=u[m],v=c[g],x=v.startTime,E=d[g],T=(E==null?void 0:E.cues)||{};let w=(E==null?void 0:E.durationKnown)||!1,L=Za;const{duration:A,endDate:R}=v;if(R&&A!==null)L=x+A,w=!0;else if(v.endOnNext&&!w){const I=u.reduce((P,O)=>{if(O!==v.id){const V=c[O];if(V.class===v.class&&V.startDate>v.startDate&&(!P||v.startDate<P.startDate))return V}return P},null);I&&(L=I.startTime,w=!0)}const C=Object.keys(v.attr);for(let I=0;I<C.length;I++){const P=C[I];if(!yP(P))continue;const O=T[P];if(O)w&&!(E!=null&&E.durationKnown)?O.endTime=L:Math.abs(O.startTime-x)>.01&&(O.startTime=x,O.endTime=L);else if(a){let V=v.attr[P];xP(P)&&(V=SS(V));const K=dd(a,x,L,{key:P,data:V},Mt.dateRange);K&&(K.id=g,this.id3Track.addCue(K),T[P]=K,o&&(P==="X-ASSET-LIST"||P==="X-ASSET-URL")&&K.addEventListener("enter",this.onEventCueEnter))}}d[g]={cues:T,dateRange:v,durationKnown:w}}}}}class JO{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,r=this.levelDetails;if(!t||!r)return;this.currentTime=t.currentTime;const s=this.computeLatency();if(s===null)return;this._latency=s;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:o}=this.config;if(!i||o===1||!r.live)return;const a=this.targetLatency;if(a===null)return;const l=s-a,c=Math.min(this.maxLatency,a+r.targetduration);if(l<c&&l>.05&&this.forwardBufferLength>1){const d=Math.min(2,Math.max(1,o)),f=Math.round(2/(1+Math.exp(-.75*l-this.edgeStalled))*20)/20,h=Math.min(d,Math.max(1,f));this.changeMediaPlaybackRate(t,h)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:r,targetduration:s}=e,{liveSyncDuration:i,liveSyncDurationCount:o,lowLatencyMode:a}=this.config,l=this.hls.userConfig;let c=a&&r||t;(this._targetLatencyUpdated||l.liveSyncDuration||l.liveSyncDurationCount||c===0)&&(c=i!==void 0?i:o*s);const u=s;return c+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,u)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const r=this.levelDetails;if(r===null)return null;const s=r.edge,i=e-t-this.edgeStalled,o=s-r.totalduration,a=s-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(o,i),a)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(S.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(S.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(S.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(S.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var r;t.details===N.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(r=this.levelDetails)!=null&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var r,s;e.playbackRate!==t&&((r=this.hls)==null||r.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(s=this.targetLatency)==null?void 0:s.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class e2 extends Cm{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(S.LEVEL_LOADED,this.onLevelLoaded,this),e.on(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(S.FRAG_BUFFERED,this.onFragBuffered,this),e.on(S.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(S.LEVEL_LOADED,this.onLevelLoaded,this),e.off(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(S.FRAG_BUFFERED,this.onFragBuffered,this),e.off(S.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const r=this.hls.config.preferManagedMediaSource,s=[],i={},o={};let a=!1,l=!1,c=!1;t.levels.forEach(u=>{const d=u.attrs;let{audioCodec:f,videoCodec:h}=u;f&&(u.audioCodec=f=ac(f,r)||void 0),h&&(h=u.videoCodec=O_(h));const{width:p,height:m,unknownCodecs:g}=u;let v=g?g.length:0;if(g)for(let I=v;I--;){const P=g[I];this.isAudioSupported(P)?(u.audioCodec=f=f?`${f},${P}`:P,v--,Ui.audio[f.substring(0,4)]=2):this.isVideoSupported(P)&&(u.videoCodec=h=h?`${h},${P}`:P,v--,Ui.video[h.substring(0,4)]=2)}if(a||(a=!!(p&&m)),l||(l=!!h),c||(c=!!f),v||f&&!this.isAudioSupported(f)||h&&!this.isVideoSupported(h)){this.log(`Some or all CODECS not supported "${d.CODECS}"`);return}const{CODECS:x,"FRAME-RATE":E,"HDCP-LEVEL":T,"PATHWAY-ID":w,RESOLUTION:L,"VIDEO-RANGE":A}=d,C=`${`${w||"."}-`}${u.bitrate}-${L}-${E}-${x}-${A}-${T}`;if(i[C])if(i[C].uri!==u.url&&!u.attrs["PATHWAY-ID"]){const I=o[C]+=1;u.attrs["PATHWAY-ID"]=new Array(I+1).join(".");const P=this.createLevel(u);i[C]=P,s.push(P)}else i[C].addGroupId("audio",d.AUDIO),i[C].addGroupId("text",d.SUBTITLES);else{const I=this.createLevel(u);i[C]=I,o[C]=1,s.push(I)}}),this.filterAndSortMediaOptions(s,t,a,l,c)}createLevel(e){const t=new Xo(e),r=e.supplemental;if(r!=null&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){const s=new Error(`SUPPLEMENTAL-CODECS not supported "${r.videoCodec}"`);this.log(s.message),t.supportedResult=PS(s,[])}return t}isAudioSupported(e){return Df(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return Df(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,r,s,i){let o=[],a=[],l=e;if((r||s)&&i&&(l=l.filter(({videoCodec:g,videoRange:v,width:x,height:E})=>(!!g||!!(x&&E))&&K_(v))),l.length===0){Promise.resolve().then(()=>{if(this.hls){let g="no level with compatible codecs found in manifest",v=g;t.levels.length&&(v=`one or more CODECS in variant not supported: ${Ie(t.levels.map(E=>E.attrs.CODECS).filter((E,T,w)=>w.indexOf(E)===T))}`,this.warn(v),g+=` (${v})`);const x=new Error(g);this.hls.trigger(S.ERROR,{type:J.MEDIA_ERROR,details:N.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:x,reason:v})}});return}t.audioTracks&&(o=t.audioTracks.filter(g=>!g.audioCodec||this.isAudioSupported(g.audioCodec)),ov(o)),t.subtitles&&(a=t.subtitles,ov(a));const c=l.slice(0);l.sort((g,v)=>{if(g.attrs["HDCP-LEVEL"]!==v.attrs["HDCP-LEVEL"])return(g.attrs["HDCP-LEVEL"]||"")>(v.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&g.height!==v.height)return g.height-v.height;if(g.frameRate!==v.frameRate)return g.frameRate-v.frameRate;if(g.videoRange!==v.videoRange)return lc.indexOf(g.videoRange)-lc.indexOf(v.videoRange);if(g.videoCodec!==v.videoCodec){const x=Jg(g.videoCodec),E=Jg(v.videoCodec);if(x!==E)return E-x}if(g.uri===v.uri&&g.codecSet!==v.codecSet){const x=oc(g.codecSet),E=oc(v.codecSet);if(x!==E)return E-x}return g.averageBitrate!==v.averageBitrate?g.averageBitrate-v.averageBitrate:0});let u=c[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==c.length)){for(let g=0;g<c.length;g++)if(c[g].pathwayId===l[0].pathwayId){u=c[g];break}}this._levels=l;for(let g=0;g<l.length;g++)if(l[g]===u){var d;this._firstLevel=g;const v=u.bitrate,x=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${v}`),((d=this.hls.userConfig)==null?void 0:d.abrEwmaDefaultEstimate)===void 0){const E=Math.min(v,this.hls.config.abrEwmaDefaultEstimateMax);E>x&&x===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=E)}break}const f=i&&!s,h=this.hls.config,p=!!(h.audioStreamController&&h.audioTrackController),m={levels:l,audioTracks:o,subtitleTracks:a,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:i,video:s,altAudio:p&&!f&&o.some(g=>!!g.url)};this.hls.trigger(S.MANIFEST_PARSED,m)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const u=new Error("invalid level idx"),d=e<0;if(this.hls.trigger(S.ERROR,{type:J.OTHER_ERROR,details:N.LEVEL_SWITCH_ERROR,level:e,fatal:d,error:u,reason:u.message}),d)return;e=Math.min(e,t.length-1)}const r=this.currentLevelIndex,s=this.currentLevel,i=s?s.attrs["PATHWAY-ID"]:void 0,o=t[e],a=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,r===e&&s&&i===a)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${a?" with Pathway "+a:""} from level ${r}${i?" with Pathway "+i:""}`);const l={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(S.LEVEL_SWITCHING,l);const c=o.details;if(!c||c.live){const u=this.switchParams(o.uri,s==null?void 0:s.details,c);this.loadPlaylist(u)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),r=e.filter(s=>t.indexOf(s)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=r}}onError(e,t){t.fatal||!t.context||t.context.type===ce.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===Z.MAIN){const r=t.elementaryStreams;if(!Object.keys(r).some(i=>!!r[i]))return;const s=this._levels[t.level];s!=null&&s.loadError&&(this.log(`Resetting level error count of ${s.loadError} on frag buffered`),s.loadError=0)}}onLevelLoaded(e,t){var r;const{level:s,details:i}=t,o=t.levelInfo;if(!o){var a;this.warn(`Invalid level index ${s}`),(a=t.deliveryDirectives)!=null&&a.skip&&(i.deltaUpdateFailed=!0);return}if(o===this.currentLevel||t.withoutMultiVariant){o.fragmentError===0&&(o.loadError=0);let l=o.details;l===t.details&&l.advanced&&(l=void 0),this.playlistLoaded(s,t,l)}else(r=t.deliveryDirectives)!=null&&r.skip&&(i.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=this.getUrlWithDirectives(e.uri,t),s=this.currentLevelIndex,i=e.attrs["PATHWAY-ID"],o=e.details,a=o==null?void 0:o.age;this.log(`Loading level index ${s}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${i?" Pathway "+i:""}${a&&o.live?" age "+a.toFixed(1)+(o.type&&" "+o.type||""):""} ${r}`),this.hls.trigger(S.LEVEL_LOADING,{url:r,level:s,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const r=this._levels.filter((i,o)=>o!==e?!0:(this.steering&&this.steering.removeLevel(i),i===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,i.details&&i.details.fragments.forEach(a=>a.level=-1)),!1));qS(r),this._levels=r,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const s=r.length-1;this._firstLevel=Math.min(this._firstLevel,s),this._startLevel&&(this._startLevel=Math.min(this._startLevel,s)),this.hls.trigger(S.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:r}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(S.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:r}))}}function ov(n){const e={};n.forEach(t=>{const r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++})}function HT(){return self.SourceBuffer||self.WebKitSourceBuffer}function KT(){if(!ts())return!1;const e=HT();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function t2(){if(!KT())return!1;const n=ts();return typeof(n==null?void 0:n.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>n.isTypeSupported(Qo(e,"video")))||["mp4a.40.2","fLaC"].some(e=>n.isTypeSupported(Qo(e,"audio"))))}function n2(){var n;const e=HT();return typeof(e==null||(n=e.prototype)==null?void 0:n.changeType)=="function"}const r2=100;class s2 extends Sm{constructor(e,t,r){super(e,t,r,"stream-controller",Z.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const s=this.media,i=s?s.currentTime:null;if(i===null||!q(i)||(this.log(`Media seeked to ${i.toFixed(3)}`),!this.getBufferedFrag(i)))return;const o=this.getFwdBufferInfoAtPos(s,i,Z.MAIN,0);if(o===null||o.len===0){this.warn(`Main forward buffer length at ${i} on "seeked" event ${o?o.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(S.MANIFEST_PARSED,this.onManifestParsed,this),e.on(S.LEVEL_LOADING,this.onLevelLoading,this),e.on(S.LEVEL_LOADED,this.onLevelLoaded,this),e.on(S.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(S.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(S.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(S.BUFFER_CREATED,this.onBufferCreated,this),e.on(S.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(S.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(S.MANIFEST_PARSED,this.onManifestParsed,this),e.off(S.LEVEL_LOADED,this.onLevelLoaded,this),e.off(S.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(S.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(S.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(S.BUFFER_CREATED,this.onBufferCreated,this),e.off(S.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(S.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(S.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:r,hls:s}=this;if(this.stopLoad(),this.setInterval(r2),this.level=-1,!this.startFragRequested){let i=s.startLevel;i===-1&&(s.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=s.firstAutoLevel),s.nextLoadLevel=i,this.level=s.loadLevel,this._hasEnoughToStart=!!t}r>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r),this.state=j.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=j.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case j.WAITING_LEVEL:{const{levels:e,level:t}=this,r=e==null?void 0:e[t],s=r==null?void 0:r.details;if(s&&(!s.live||this.levelLastLoaded===r&&!this.waitForLive(r))){if(this.waitForCdnTuneIn(s))break;this.state=j.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=j.IDLE;break}break}case j.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===j.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:r,media:s}=this;if(t===null||!s&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const i=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(r!=null&&r[i]))return;const o=r[i],a=this.getMainFwdBufferInfo();if(a===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(a,l)){const m={};this.altAudio===2&&(m.type="video"),this.hls.trigger(S.BUFFER_EOS,m),this.state=j.ENDED;return}if(!this.buffering)return;e.loadLevel!==i&&e.manualLevel===-1&&this.log(`Adapting to level ${i} from level ${this.level}`),this.level=e.nextLoadLevel=i;const c=o.details;if(!c||this.state===j.WAITING_LEVEL||this.waitForLive(o)){this.level=i,this.state=j.WAITING_LEVEL,this.startFragRequested=!1;return}const u=a.len,d=this.getMaxBufferLength(o.maxBitrate);if(u>=d)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const f=this.backtrackFragment?this.backtrackFragment.start:a.end;let h=this.getNextFragment(f,c);if(this.couldBacktrack&&!this.fragPrevious&&h&&Ge(h)&&this.fragmentTracker.getState(h)!==ze.OK){var p;const g=((p=this.backtrackFragment)!=null?p:h).sn-c.startSN,v=c.fragments[g-1];v&&h.cc===v.cc&&(h=v,this.fragmentTracker.removeFragment(v))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(h&&this.isLoopLoading(h,f)){if(!h.gap){const g=this.audioOnly&&!this.altAudio?Se.AUDIO:Se.VIDEO,v=(g===Se.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;v&&this.afterBufferFlushed(v,g,Z.MAIN)}h=this.getNextFragmentLoopLoading(h,c,a,Z.MAIN,d)}h&&(h.initSegment&&!h.initSegment.data&&!this.bitrateTest&&(h=h.initSegment),this.loadFragment(h,o,f))}loadFragment(e,t,r){const s=this.fragmentTracker.getState(e);s===ze.NOT_LOADED||s===ze.PARTIAL?Ge(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,r):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Z.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let r;const s=this.getAppendedFrag(t.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const i=this.getLevelDetails();if(i!=null&&i.live){const a=this.getMainFwdBufferInfo();if(!a||a.len<i.targetduration*2)return}if(!t.paused&&e){const a=this.hls.nextLoadLevel,l=e[a],c=this.fragLastKbps;c&&this.fragCurrent?r=this.fragCurrent.duration*l.maxBitrate/(1e3*c)+1:r=0}else r=0;const o=this.getBufferedFrag(t.currentTime+r);if(o){const a=this.followingBufferedFrag(o);if(a){this.abortCurrentFrag();const l=a.maxStartPTS?a.maxStartPTS:a.start,c=a.duration,u=Math.max(o.end,l+Math.min(Math.max(c-this.config.maxFragLookUpTolerance,c*(this.couldBacktrack?.5:.125)),c*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(u,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case j.KEY_LOADING:case j.FRAG_LOADING:case j.FRAG_LOADING_WAITING_RETRY:case j.PARSING:case j.PARSED:this.state=j.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const r=t.media;gt(r,"playing",this.onMediaPlaying),gt(r,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:r}=this;r&&(It(r,"playing",this.onMediaPlaying),It(r,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(S.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let r=!1,s=!1;for(let i=0;i<t.levels.length;i++){const o=t.levels[i].audioCodec;o&&(r=r||o.indexOf("mp4a.40.2")!==-1,s=s||o.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=r&&s&&!n2(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:r}=this;if(!r||this.state!==j.IDLE)return;const s=t.levelInfo;(!s.details||s.details.live&&(this.levelLastLoaded!==s||s.details.expired)||this.waitForCdnTuneIn(s.details))&&(this.state=j.WAITING_LEVEL)}onLevelLoaded(e,t){var r;const{levels:s,startFragRequested:i}=this,o=t.level,a=t.details,l=a.totalduration;if(!s){this.warn(`Levels were reset while loading level ${o}`);return}this.log(`Level ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${l}`);const c=t.levelInfo,u=this.fragCurrent;u&&(this.state===j.FRAG_LOADING||this.state===j.FRAG_LOADING_WAITING_RETRY)&&u.level!==t.level&&u.loader&&this.abortCurrentFrag();let d=0;if(a.live||(r=c.details)!=null&&r.live){var f;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;d=this.alignPlaylists(a,c.details,(f=this.levelLastLoaded)==null?void 0:f.details)}if(c.details=a,this.levelLastLoaded=c,i||this.setStartPosition(a,d),this.hls.trigger(S.LEVEL_UPDATED,{details:a,level:o}),this.state===j.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=j.IDLE}i&&a.live&&this.synchronizeToLiveEdge(a),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:r}=this;if(!r)return;const s=this.hls.liveSyncPosition,i=this.getLoadPosition(),o=e.fragmentStart,a=e.edge,l=i>=o-t.maxFragLookUpTolerance&&i<=a;if(s!==null&&r.duration>s&&(i<s||!l)){const u=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!l&&r.readyState<4||i<a-u)&&(this._hasEnoughToStart||(this.nextLoadPosition=s),r.readyState))if(this.warn(`Playback: ${i.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${s.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var c;const d=se.bufferInfo(r,s,0);if(!((c=d.buffered)!=null&&c.length)){r.currentTime=s;return}if(d.start<=i){r.currentTime=s;return}const{nextStart:h}=se.bufferedInfo(d.buffered,i,0);h&&(r.currentTime=h)}else r.currentTime=s}}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:s,payload:i}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const a=o[r.level];if(!a){this.warn(`Level ${r.level} not found on progress`);return}const l=a.details;if(!l){this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),this.fragmentTracker.removeFragment(r);return}const c=a.videoCodec,u=l.PTSKnown||!l.live,d=(t=r.initSegment)==null?void 0:t.data,f=this._getAudioCodec(a),h=this.transmuxer=this.transmuxer||new vT(this.hls,Z.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=s?s.index:-1,m=p!==-1,g=new ym(r.level,r.sn,r.stats.chunkCount,i.byteLength,p,m),v=this.initPTS[r.cc];h.push(i,d,f,c,r,s,l.totalduration,u,g,v)}onAudioTrackSwitching(e,t){const r=this.hls,s=this.altAudio===2;if(cc(t.url,r))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(s){this.fragmentTracker.removeAllFragments(),r.once(S.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(S.AUDIO_TRACK_SWITCHED,t)}),r.trigger(S.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}r.trigger(S.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=cc(t.url,this.hls);if(r){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=r?2:0,this.tick()}onBufferCreated(e,t){const r=t.tracks;let s,i,o=!1;for(const a in r){const l=r[a];if(l.id==="main"){if(i=a,s=l,a==="video"){const c=r[a];c&&(this.videoBuffer=c.buffer)}}else o=!0}o&&s?(this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:r,part:s}=t,i=r.type===Z.MAIN;if(i){if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${s?" p: "+s.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),this.state===j.PARSED&&(this.state=j.IDLE);return}const a=s?s.stats:r.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),Ge(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,s)}const o=this.media;o&&(!this._hasEnoughToStart&&se.getBuffered(o).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),i&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var r;if(t.fatal){this.state=j.ERROR;return}switch(t.details){case N.FRAG_GAP:case N.FRAG_PARSING_ERROR:case N.FRAG_DECRYPT_ERROR:case N.FRAG_LOAD_ERROR:case N.FRAG_LOAD_TIMEOUT:case N.KEY_LOAD_ERROR:case N.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Z.MAIN,t);break;case N.LEVEL_LOAD_ERROR:case N.LEVEL_LOAD_TIMEOUT:case N.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===j.WAITING_LEVEL&&((r=t.context)==null?void 0:r.type)===ce.LEVEL&&(this.state=j.IDLE);break;case N.BUFFER_ADD_CODEC_ERROR:case N.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case N.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case N.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=j.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==Se.AUDIO||!this.altAudio){const r=(t===Se.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;r&&(this.afterBufferFlushed(r,t,Z.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let r=this.startPosition;if(r>=0&&t<r){if(e.seeking){this.log(`could not seek to ${r}, already seeking at ${t}`);return}const s=this.timelineOffset;s&&r&&(r+=s);const i=this.getLevelDetails(),o=se.getBuffered(e),a=o.length?o.start(0):0,l=a-r,c=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||l>0&&(l<c||this.loadingParts&&l<2*((i==null?void 0:i.partTarget)||0)))&&(this.log(`adjusting start position by ${l} to match buffer start`),r+=l,this.startPosition=r),t<r&&(this.log(`seek to target start position ${r} from current time ${t} buffer start ${a}`),e.currentTime=r)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(r=>{const{hls:s}=this,i=r==null?void 0:r.frag;if(!i||this.fragContextChanged(i))return;t.fragmentError=0,this.state=j.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const o=i.stats;o.parsing.start=o.parsing.end=o.buffering.start=o.buffering.end=self.performance.now(),s.trigger(S.FRAG_LOADED,r),i.bitrateTest=!1}).catch(r=>{this.state===j.STOPPED||this.state===j.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:r}=this,{remuxResult:s,chunkMeta:i}=e,o=this.getCurrentContext(i);if(!o){this.resetWhenMissingContext(i);return}const{frag:a,part:l,level:c}=o,{video:u,text:d,id3:f,initSegment:h}=s,{details:p}=c,m=this.altAudio?void 0:s.audio;if(this.fragContextChanged(a)){this.fragmentTracker.removeFragment(a);return}if(this.state=j.PARSING,h){const g=h.tracks;if(g){const T=a.initSegment||a;if(this.unhandledEncryptionError(h,a))return;this._bufferInitSegment(c,g,T,i),r.trigger(S.FRAG_PARSING_INIT_SEGMENT,{frag:T,id:t,tracks:g})}const v=h.initPTS,x=h.timescale,E=this.initPTS[a.cc];if(q(v)&&(!E||E.baseTime!==v||E.timescale!==x)){const T=h.trackId;this.initPTS[a.cc]={baseTime:v,timescale:x,trackId:T},r.trigger(S.INIT_PTS_FOUND,{frag:a,id:t,initPTS:v,timescale:x,trackId:T})}}if(u&&p){m&&u.type==="audiovideo"&&this.logMuxedErr(a);const g=p.fragments[a.sn-1-p.startSN],v=a.sn===p.startSN,x=!g||a.cc>g.cc;if(s.independent!==!1){const{startPTS:E,endPTS:T,startDTS:w,endDTS:L}=u;if(l)l.elementaryStreams[u.type]={startPTS:E,endPTS:T,startDTS:w,endDTS:L};else if(u.firstKeyFrame&&u.independent&&i.id===1&&!x&&(this.couldBacktrack=!0),u.dropped&&u.independent){const A=this.getMainFwdBufferInfo(),R=(A?A.end:this.getLoadPosition())+this.config.maxBufferHole,C=u.firstKeyFramePTS?u.firstKeyFramePTS:E;if(!v&&R<C-this.config.maxBufferHole&&!x){this.backtrack(a);return}else x&&(a.gap=!0);a.setElementaryStreamInfo(u.type,a.start,T,a.start,L,!0)}else v&&E-(p.appliedTimelineOffset||0)>Al&&(a.gap=!0);a.setElementaryStreamInfo(u.type,E,T,w,L),this.backtrackFragment&&(this.backtrackFragment=a),this.bufferFragmentData(u,a,l,i,v||x)}else if(v||x)a.gap=!0;else{this.backtrack(a);return}}if(m){const{startPTS:g,endPTS:v,startDTS:x,endDTS:E}=m;l&&(l.elementaryStreams[Se.AUDIO]={startPTS:g,endPTS:v,startDTS:x,endDTS:E}),a.setElementaryStreamInfo(Se.AUDIO,g,v,x,E),this.bufferFragmentData(m,a,l,i)}if(p&&f!=null&&f.samples.length){const g={id:t,frag:a,details:p,samples:f.samples};r.trigger(S.FRAG_PARSING_METADATA,g)}if(p&&d){const g={id:t,frag:a,details:p,samples:d.samples};r.trigger(S.FRAG_PARSING_USERDATA,g)}}logMuxedErr(e){this.warn(`${Ge(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,r,s){if(this.state!==j.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(r));const{audio:i,video:o,audiovideo:a}=t;if(i){const c=e.audioCodec;let u=yl(i.codec,c);u==="mp4a"&&(u="mp4a.40.5");const d=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){u&&(u.indexOf("mp4a.40.5")!==-1?u="mp4a.40.2":u="mp4a.40.5");const f=i.metadata;f&&"channelCount"in f&&(f.channelCount||1)!==1&&d.indexOf("firefox")===-1&&(u="mp4a.40.5")}u&&u.indexOf("mp4a.40.5")!==-1&&d.indexOf("android")!==-1&&i.container!=="audio/mpeg"&&(u="mp4a.40.2",this.log(`Android: force audio codec to ${u}`)),c&&c!==u&&this.log(`Swapping manifest audio codec "${c}" for "${u}"`),i.levelCodec=u,i.id=Z.MAIN,this.log(`Init audio buffer, container:${i.container}, codecs[selected/level/parsed]=[${u||""}/${c||""}/${i.codec}]`),delete t.audiovideo}if(o){o.levelCodec=e.videoCodec,o.id=Z.MAIN;const c=o.codec;if((c==null?void 0:c.length)===4)switch(c){case"hvc1":case"hev1":o.codec="hvc1.1.6.L120.90";break;case"av01":o.codec="av01.0.04M.08";break;case"avc1":o.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${c}]${o.codec!==c?" parsed-corrected="+o.codec:""}${o.supplemental?" supplemental="+o.supplemental:""}`),delete t.audiovideo}a&&(this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),delete t.video,delete t.audio);const l=Object.keys(t);if(l.length){if(this.hls.trigger(S.BUFFER_CODECS,t),!this.hls)return;l.forEach(c=>{const d=t[c].initSegment;d!=null&&d.byteLength&&this.hls.trigger(S.BUFFER_APPENDING,{type:c,data:d,frag:r,part:null,chunkMeta:s,parent:r.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,Z.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,r=e==null?void 0:e[t];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=j.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const r=e.currentTime;if(se.isBuffered(e,r)?t=this.getAppendedFrag(r):se.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;const s=this.fragPlaying,i=t.level;(!s||t.sn!==s.sn||s.level!==i)&&(this.fragPlaying=t,this.hls.trigger(S.FRAG_CHANGED,{frag:t}),(!s||s.level!==i)&&this.hls.trigger(S.LEVEL_SWITCHED,{level:i}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return q(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(q(t)){const r=this.getLevelDetails(),s=this.currentFrag||(r?Ns(null,r.fragments,t):null);if(s){const i=s.programDateTime;if(i!==null){const o=i+(t-s.start)*1e3;return new Date(o)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class i2 extends tn{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const r in this.keyIdToKeyInfo){const s=this.keyIdToKeyInfo[r].loader;if(s){var t;if(e&&e!==((t=s.context)==null?void 0:t.frag.type))return;s.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=N.KEY_LOAD_ERROR,r,s,i){return new nr({type:J.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:i,error:r,networkDetails:s})}loadClear(e,t,r){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let s=0,i=t.length;s<i;s++){const o=t[s];if(e.cc<=o.cc&&(!Ge(e)||!Ge(o)||e.sn<o.sn)||!r&&s==i-1)return this.emeController.selectKeySystemFormat(o).then(a=>{if(!this.emeController)return;o.setKeyFormat(a);const l=El(a);if(l)return this.emeController.getKeySystemAccess([l])})}if(this.config.requireKeySystemAccessOnStart){const s=ho(this.config);if(s.length)return this.emeController.getKeySystemAccess(s)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var r,s;t&&e.setKeyFormat(t);const i=e.decryptdata;if(!i){const u=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,N.KEY_LOAD_ERROR,u))}const o=i.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,N.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));const a=fd(i);let l=this.keyIdToKeyInfo[a];if((r=l)!=null&&r.decryptdata.key)return i.key=l.decryptdata.key,Promise.resolve({frag:e,keyInfo:l});if((s=l)!=null&&s.keyLoadPromise){var c;switch((c=l.mediaKeySessionContext)==null?void 0:c.keyStatus){case"usable":case"usable-in-future":return l.keyLoadPromise.then(d=>{const{keyInfo:f}=d;return i.key=f.decryptdata.key,{frag:e,keyInfo:f}})}}switch(this.log(`Loading key ${Nt(i.keyId||[])} from ${e.type} ${e.level}`),l=this.keyIdToKeyInfo[a]={decryptdata:i,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},i.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return i.keyFormat==="identity"?this.loadKeyHTTP(l,e):this.loadKeyEME(l,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(l,e);default:return Promise.reject(this.createKeyLoadError(e,N.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${i.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const s=this.emeController.loadKey(r);return(e.keyLoadPromise=s.then(i=>(e.mediaKeySessionContext=i,r))).catch(i=>{throw e.keyLoadPromise=null,i.data&&(i.data.frag=t),i})}return Promise.resolve(r)}loadKeyHTTP(e,t){const r=this.config,s=r.loader,i=new s(r);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise((o,a)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},c=r.keyLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(f,h,p,m)=>{const{frag:g,keyInfo:v,url:x}=p,E=fd(v.decryptdata)||x;if(!g.decryptdata||v!==this.keyIdToKeyInfo[E])return a(this.createKeyLoadError(g,N.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),m));v.decryptdata.key=g.decryptdata.key=new Uint8Array(f.data),g.keyLoader=null,v.loader=null,o({frag:g,keyInfo:v})},onError:(f,h,p,m)=>{this.resetLoader(h),a(this.createKeyLoadError(t,N.KEY_LOAD_ERROR,new Error(`HTTP Error ${f.code} loading key ${f.text}`),p,ye({url:l.url,data:void 0},f)))},onTimeout:(f,h,p)=>{this.resetLoader(h),a(this.createKeyLoadError(t,N.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),p))},onAbort:(f,h,p)=>{this.resetLoader(h),a(this.createKeyLoadError(t,N.INTERNAL_ABORTED,new Error("key loading aborted"),p))}};i.load(l,u,d)})}resetLoader(e){const{frag:t,keyInfo:r,url:s}=e,i=r.loader;t.keyLoader===i&&(t.keyLoader=null,r.loader=null);const o=fd(r.decryptdata)||s;delete this.keyIdToKeyInfo[o],i&&i.destroy()}}function fd(n){const e=n.keyId;return e?Nt(e):n.uri}function av(n){const{type:e}=n;switch(e){case ce.AUDIO_TRACK:return Z.AUDIO;case ce.SUBTITLE_TRACK:return Z.SUBTITLE;default:return Z.MAIN}}function hd(n,e){let t=n.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class o2{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(S.MANIFEST_LOADING,this.onManifestLoading,this),e.on(S.LEVEL_LOADING,this.onLevelLoading,this),e.on(S.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(S.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(S.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(S.MANIFEST_LOADING,this.onManifestLoading,this),e.off(S.LEVEL_LOADING,this.onLevelLoading,this),e.off(S.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(S.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(S.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,r=t.pLoader,s=t.loader,i=r||s,o=new i(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:r}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:ce.MANIFEST,url:r,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:r,level:s,pathwayId:i,url:o,deliveryDirectives:a,levelInfo:l}=t;this.load({id:r,level:s,pathwayId:i,responseType:"text",type:ce.LEVEL,url:o,deliveryDirectives:a,levelOrTrack:l})}onAudioTrackLoading(e,t){const{id:r,groupId:s,url:i,deliveryDirectives:o,track:a}=t;this.load({id:r,groupId:s,level:null,responseType:"text",type:ce.AUDIO_TRACK,url:i,deliveryDirectives:o,levelOrTrack:a})}onSubtitleTrackLoading(e,t){const{id:r,groupId:s,url:i,deliveryDirectives:o,track:a}=t;this.load({id:r,groupId:s,level:null,responseType:"text",type:ce.SUBTITLE_TRACK,url:i,deliveryDirectives:o,levelOrTrack:a})}onLevelsUpdated(e,t){const r=this.loaders[ce.LEVEL];if(r){const s=r.context;s&&!t.levels.some(i=>i===s.levelOrTrack)&&(r.abort(),delete this.loaders[ce.LEVEL])}}load(e){var t;const r=this.hls.config;let s=this.getInternalLoader(e);if(s){const c=this.hls.logger,u=s.context;if(u&&u.levelOrTrack===e.levelOrTrack&&(u.url===e.url||u.deliveryDirectives&&!e.deliveryDirectives)){u.url===e.url?c.log(`[playlist-loader]: ignore ${e.url} ongoing request`):c.log(`[playlist-loader]: ignore ${e.url} in favor of ${u.url}`);return}c.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),s.abort()}let i;if(e.type===ce.MANIFEST?i=r.manifestLoadPolicy.default:i=Ee({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(e),q((t=e.deliveryDirectives)==null?void 0:t.part)){let c;if(e.type===ce.LEVEL&&e.level!==null?c=this.hls.levels[e.level].details:e.type===ce.AUDIO_TRACK&&e.id!==null?c=this.hls.audioTracks[e.id].details:e.type===ce.SUBTITLE_TRACK&&e.id!==null&&(c=this.hls.subtitleTracks[e.id].details),c){const u=c.partTarget,d=c.targetduration;if(u&&d){const f=Math.max(u*3,d*.8)*1e3;i=Ee({},i,{maxTimeToFirstByteMs:Math.min(f,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(f,i.maxTimeToFirstByteMs)})}}}const o=i.errorRetry||i.timeoutRetry||{},a={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(c,u,d,f)=>{const h=this.getInternalLoader(d);this.resetInternalLoader(d.type);const p=c.data;if(p.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(c,d,new Error("no EXTM3U delimiter"),f||null,u);return}u.parsing.start=performance.now(),Un.isMediaPlaylist(p)||d.type!==ce.MANIFEST?this.handleTrackOrLevelPlaylist(c,u,d,f||null,h):this.handleMasterPlaylist(c,u,d,f)},onError:(c,u,d,f)=>{this.handleNetworkError(u,d,!1,c,f)},onTimeout:(c,u,d)=>{this.handleNetworkError(u,d,!0,void 0,c)}};s.load(e,a,l)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:r}=this.hls;(e||r)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,r,s){const i=this.hls,o=e.data,a=hd(e,r),l=Un.parseMasterPlaylist(o,a);if(l.playlistParsingError){this.handleManifestParsingError(e,r,l.playlistParsingError,s,t);return}const{contentSteering:c,levels:u,sessionData:d,sessionKeys:f,startTimeOffset:h,variableList:p}=l;this.variableList=p;const{AUDIO:m=[],SUBTITLES:g,"CLOSED-CAPTIONS":v}=Un.parseMasterPlaylistMedia(o,a,l);m.length&&!m.some(E=>!E.url)&&u[0].audioCodec&&!u[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),m.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new _e({}),bitrate:0,url:""})),i.trigger(S.MANIFEST_LOADED,{levels:u,audioTracks:m,subtitles:g,captions:v,contentSteering:c,url:a,stats:t,networkDetails:s,sessionData:d,sessionKeys:f,startTimeOffset:h,variableList:p})}handleTrackOrLevelPlaylist(e,t,r,s,i){const o=this.hls,{id:a,level:l,type:c}=r,u=hd(e,r),d=q(l)?l:q(a)?a:0,f=av(r),h=Un.parseLevelPlaylist(e.data,u,d,f,0,this.variableList);if(c===ce.MANIFEST){const p={attrs:new _e({}),bitrate:0,details:h,name:"",url:u};h.requestScheduled=t.loading.start+zS(h,0),o.trigger(S.MANIFEST_LOADED,{levels:[p],audioTracks:[],url:u,stats:t,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=h,this.handlePlaylistLoaded(h,e,t,r,s,i)}handleManifestParsingError(e,t,r,s,i){this.hls.trigger(S.ERROR,{type:J.NETWORK_ERROR,details:N.MANIFEST_PARSING_ERROR,fatal:t.type===ce.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:s,stats:i})}handleNetworkError(e,t,r=!1,s,i){let o=`A network ${r?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${e.type}`;e.type===ce.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===ce.AUDIO_TRACK||e.type===ce.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(o);this.hls.logger.warn(`[playlist-loader]: ${o}`);let l=N.UNKNOWN,c=!1;const u=this.getInternalLoader(e);switch(e.type){case ce.MANIFEST:l=r?N.MANIFEST_LOAD_TIMEOUT:N.MANIFEST_LOAD_ERROR,c=!0;break;case ce.LEVEL:l=r?N.LEVEL_LOAD_TIMEOUT:N.LEVEL_LOAD_ERROR,c=!1;break;case ce.AUDIO_TRACK:l=r?N.AUDIO_TRACK_LOAD_TIMEOUT:N.AUDIO_TRACK_LOAD_ERROR,c=!1;break;case ce.SUBTITLE_TRACK:l=r?N.SUBTITLE_TRACK_LOAD_TIMEOUT:N.SUBTITLE_LOAD_ERROR,c=!1;break}u&&this.resetInternalLoader(e.type);const d={type:J.NETWORK_ERROR,details:l,fatal:c,url:e.url,loader:u,context:e,error:a,networkDetails:t,stats:i};if(s){const f=(t==null?void 0:t.url)||e.url;d.response=ye({url:f,data:void 0},s)}this.hls.trigger(S.ERROR,d)}handlePlaylistLoaded(e,t,r,s,i,o){const a=this.hls,{type:l,level:c,id:u,groupId:d,deliveryDirectives:f}=s,h=hd(t,s),p=av(s),m=typeof s.level=="number"&&p===Z.MAIN?c:void 0;if(!e.fragments.length){const v=e.playlistParsingError=new Error("No Segments found in Playlist");a.trigger(S.ERROR,{type:J.NETWORK_ERROR,details:N.LEVEL_EMPTY_ERROR,fatal:!1,url:h,error:v,reason:v.message,response:t,context:s,level:m,parent:p,networkDetails:i,stats:r});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const g=e.playlistParsingError;if(g){if(this.hls.logger.warn(`${g} ${e.url}`),!a.config.ignorePlaylistParsingErrors){a.trigger(S.ERROR,{type:J.NETWORK_ERROR,details:N.LEVEL_PARSING_ERROR,fatal:!1,url:h,error:g,reason:g.message,response:t,context:s,level:m,parent:p,networkDetails:i,stats:r});return}e.playlistParsingError=null}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case ce.MANIFEST:case ce.LEVEL:a.trigger(S.LEVEL_LOADED,{details:e,levelInfo:s.levelOrTrack||a.levels[0],level:m||0,id:u||0,stats:r,networkDetails:i,deliveryDirectives:f,withoutMultiVariant:l===ce.MANIFEST});break;case ce.AUDIO_TRACK:a.trigger(S.AUDIO_TRACK_LOADED,{details:e,track:s.levelOrTrack,id:u||0,groupId:d||"",stats:r,networkDetails:i,deliveryDirectives:f});break;case ce.SUBTITLE_TRACK:a.trigger(S.SUBTITLE_TRACK_LOADED,{details:e,track:s.levelOrTrack,id:u||0,groupId:d||"",stats:r,networkDetails:i,deliveryDirectives:f});break}}}class vn{static get version(){return Zo}static isMSESupported(){return KT()}static isSupported(){return t2()}static getMediaSource(){return ts()}static get Events(){return S}static get MetadataSchema(){return Mt}static get ErrorTypes(){return J}static get ErrorDetails(){return N}static get DefaultConfig(){return vn.defaultConfig?vn.defaultConfig:VO}static set DefaultConfig(e){vn.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Tm,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=m_(e.debug||!1,"Hls instance",e.assetPlayerId),r=this.config=KO(vn.DefaultConfig,e,t);this.userConfig=e,r.progressive&&zO(r,t);const{abrController:s,bufferController:i,capLevelController:o,errorController:a,fpsController:l}=r,c=new a(this),u=this.abrController=new s(this),d=new oP(this),f=r.interstitialsController,h=f?this.interstitialsController=new f(this,vn):null,p=this.bufferController=new i(this,d),m=this.capLevelController=new o(this),g=new l(this),v=new o2(this),x=r.contentSteeringController,E=x?new x(this):null,T=this.levelController=new e2(this,E),w=new ZO(this),L=new i2(this.config,this.logger),A=this.streamController=new s2(this,d,L),R=this.gapController=new QO(this,d);m.setStreamController(A),g.setStreamController(A);const C=[v,T,A];h&&C.splice(1,0,h),E&&C.splice(1,0,E),this.networkControllers=C;const I=[u,p,R,m,g,w,d];this.audioTrackController=this.createController(r.audioTrackController,C);const P=r.audioStreamController;P&&C.push(this.audioStreamController=new P(this,d,L)),this.subtitleTrackController=this.createController(r.subtitleTrackController,C);const O=r.subtitleStreamController;O&&C.push(this.subtititleStreamController=new O(this,d,L)),this.createController(r.timelineController,I),L.emeController=this.emeController=this.createController(r.emeController,I),this.cmcdController=this.createController(r.cmcdController,I),this.latencyController=this.createController(JO,I),this.coreComponents=I,C.push(c);const V=c.onErrorOut;typeof V=="function"&&this.on(S.ERROR,V,c),this.on(S.MANIFEST_LOADED,v.onManifestLoaded,v)}createController(e,t){if(e){const r=new e(this);return t&&t.push(r),r}return null}on(e,t,r=this){this._emitter.on(e,t,r)}once(e,t,r=this){this._emitter.once(e,t,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,r=this,s){this._emitter.off(e,t,r,s)}listeners(e){return this._emitter.listeners(e)}emit(e,t,r){return this._emitter.emit(e,t,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(r){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;const s=e===S.ERROR;this.trigger(S.ERROR,{type:J.OTHER_ERROR,details:N.INTERNAL_EXCEPTION,fatal:s,event:e,error:r}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(S.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const i=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(S.ERROR,{type:J.OTHER_ERROR,details:N.ATTACH_MEDIA_ERROR,fatal:!0,error:i});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,r=t?e.media:e,s=t?e:{media:r};this._media=r,this.trigger(S.MEDIA_ATTACHING,s)}detachMedia(){this.logger.log("detachMedia"),this.trigger(S.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(S.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,r=this._url,s=this._url=dm.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${s}`),t&&r&&(r!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(S.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,t),!(!this.started||!this.networkControllers));r++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[Z.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[Z.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[Z.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=QN()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){H_(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const r=e.length;for(let s=0;s<r;s++)if(e[s].maxBitrate>=t)return s;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let s;if(t===-1&&e!=null&&e.length?s=e.length-1:s=t,r)for(let i=s;i--;){const o=e[i].attrs["HDCP-LEVEL"];if(o&&o<=r)return i}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const r=OS(t);return DS(e,r,navigator.mediaCapabilities)}}vn.defaultConfig=void 0;const Ll=b.forwardRef(({className:n,type:e,...t},r)=>y.jsx("input",{type:e,className:be("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),ref:r,...t}));Ll.displayName="Input";var a2="Label",zT=b.forwardRef((n,e)=>y.jsx(ge.label,{...n,ref:e,onMouseDown:t=>{var s;t.target.closest("button, input, select, textarea")||((s=n.onMouseDown)==null||s.call(n,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));zT.displayName=a2;var WT=zT;const l2=Fc("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),YT=b.forwardRef(({className:n,...e},t)=>y.jsx(WT,{ref:t,className:be(l2(),n),...e}));YT.displayName=WT.displayName;function c2(n){const e=b.useRef({value:n,previous:n});return b.useMemo(()=>(e.current.value!==n&&(e.current.previous=e.current.value,e.current.value=n),e.current.previous),[n])}var Zc="Checkbox",[u2,SF]=os(Zc),[d2,Om]=u2(Zc);function f2(n){const{__scopeCheckbox:e,checked:t,children:r,defaultChecked:s,disabled:i,form:o,name:a,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:d}=n,[f,h]=Ki({prop:t,defaultProp:s??!1,onChange:l,caller:Zc}),[p,m]=b.useState(null),[g,v]=b.useState(null),x=b.useRef(!1),E=p?!!o||!!p.closest("form"):!0,T={checked:f,disabled:i,setChecked:h,control:p,setControl:m,name:a,form:o,value:u,hasConsumerStoppedPropagationRef:x,required:c,defaultChecked:Qr(s)?!1:s,isFormControl:E,bubbleInput:g,setBubbleInput:v};return y.jsx(d2,{scope:e,...T,children:h2(d)?d(T):r})}var qT="CheckboxTrigger",QT=b.forwardRef(({__scopeCheckbox:n,onKeyDown:e,onClick:t,...r},s)=>{const{control:i,value:o,disabled:a,checked:l,required:c,setControl:u,setChecked:d,hasConsumerStoppedPropagationRef:f,isFormControl:h,bubbleInput:p}=Om(qT,n),m=Ye(s,u),g=b.useRef(l);return b.useEffect(()=>{const v=i==null?void 0:i.form;if(v){const x=()=>d(g.current);return v.addEventListener("reset",x),()=>v.removeEventListener("reset",x)}},[i,d]),y.jsx(ge.button,{type:"button",role:"checkbox","aria-checked":Qr(l)?"mixed":l,"aria-required":c,"data-state":tb(l),"data-disabled":a?"":void 0,disabled:a,value:o,...r,ref:m,onKeyDown:xe(e,v=>{v.key==="Enter"&&v.preventDefault()}),onClick:xe(t,v=>{d(x=>Qr(x)?!0:!x),p&&h&&(f.current=v.isPropagationStopped(),f.current||v.stopPropagation())})})});QT.displayName=qT;var Mm=b.forwardRef((n,e)=>{const{__scopeCheckbox:t,name:r,checked:s,defaultChecked:i,required:o,disabled:a,value:l,onCheckedChange:c,form:u,...d}=n;return y.jsx(f2,{__scopeCheckbox:t,checked:s,defaultChecked:i,disabled:a,required:o,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:f})=>y.jsxs(y.Fragment,{children:[y.jsx(QT,{...d,ref:e,__scopeCheckbox:t}),f&&y.jsx(eb,{__scopeCheckbox:t})]})})});Mm.displayName=Zc;var XT="CheckboxIndicator",ZT=b.forwardRef((n,e)=>{const{__scopeCheckbox:t,forceMount:r,...s}=n,i=Om(XT,t);return y.jsx(as,{present:r||Qr(i.checked)||i.checked===!0,children:y.jsx(ge.span,{"data-state":tb(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...n.style}})})});ZT.displayName=XT;var JT="CheckboxBubbleInput",eb=b.forwardRef(({__scopeCheckbox:n,...e},t)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:o,required:a,disabled:l,name:c,value:u,form:d,bubbleInput:f,setBubbleInput:h}=Om(JT,n),p=Ye(t,h),m=c2(i),g=BE(r);b.useEffect(()=>{const x=f;if(!x)return;const E=window.HTMLInputElement.prototype,w=Object.getOwnPropertyDescriptor(E,"checked").set,L=!s.current;if(m!==i&&w){const A=new Event("click",{bubbles:L});x.indeterminate=Qr(i),w.call(x,Qr(i)?!1:i),x.dispatchEvent(A)}},[f,m,i,s]);const v=b.useRef(Qr(i)?!1:i);return y.jsx(ge.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??v.current,required:a,disabled:l,name:c,value:u,form:d,...e,tabIndex:-1,ref:p,style:{...e.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});eb.displayName=JT;function h2(n){return typeof n=="function"}function Qr(n){return n==="indeterminate"}function tb(n){return Qr(n)?"indeterminate":n?"checked":"unchecked"}const nb=b.forwardRef(({className:n,...e},t)=>y.jsx(Mm,{ref:t,className:be("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",n),...e,children:y.jsx(ZT,{className:be("flex items-center justify-center text-current"),children:y.jsx(yf,{className:"h-4 w-4"})})}));nb.displayName=Mm.displayName;const m2=({onSubmit:n,onClose:e})=>{const[t,r]=b.useState({name:"",email:"",phone:"",consent:!1}),[s,i]=b.useState({name:"",email:"",phone:"",consent:""}),[o,a]=b.useState({name:!1,email:!1,phone:!1,consent:!1}),l=p=>/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$/i.test(p),c=p=>/^[\+]?[0-9\s\-\(\)]{10,}$/.test(p),u=(p,m)=>{let g="";switch(p){case"name":(!m||typeof m=="string"&&m.trim().length<2)&&(g="Name must be at least 2 characters");break;case"email":m?typeof m=="string"&&!l(m)&&(g="Please enter a valid email address"):g="Email is required";break;case"phone":m?typeof m=="string"&&!c(m)&&(g="Please enter a valid phone number (at least 10 digits)"):g="Phone number is required";break;case"consent":m||(g="You must consent to continue");break}return i(v=>({...v,[p]:g})),g===""},d=p=>{a(m=>({...m,[p]:!0})),u(p,t[p])},f=p=>{p.preventDefault(),a({name:!0,email:!0,phone:!0,consent:!0});const m=u("name",t.name),g=u("email",t.email),v=u("phone",t.phone),x=u("consent",t.consent);m&&g&&v&&x&&n(t)},h=t.name.trim().length>=2&&l(t.email)&&c(t.phone)&&t.consent;return y.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-30 p-2",children:y.jsxs("div",{className:"bg-white rounded-xl p-4 max-w-sm w-full mx-2 relative",children:[y.jsx("button",{onClick:e,className:"absolute top-4 right-4 p-2 hover:bg-gray-100 rounded-full transition-colors",children:y.jsx(zi,{className:"w-5 h-5"})}),y.jsxs("div",{className:"text-center mb-3",children:[y.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"Continue Watching"}),y.jsx("p",{className:"text-xs text-gray-600",children:"Enter your information to unlock the rest of this content"})]}),y.jsxs("form",{onSubmit:f,className:"space-y-2",children:[y.jsxs("div",{children:[y.jsx(Ll,{type:"text",value:t.name,onChange:p=>r({...t,name:p.target.value}),onBlur:()=>d("name"),placeholder:"Full Name *",className:`text-sm ${o.name&&s.name?"border-red-500":""}`}),o.name&&s.name&&y.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.name})]}),y.jsxs("div",{children:[y.jsx(Ll,{type:"email",value:t.email,onChange:p=>r({...t,email:p.target.value}),onBlur:()=>d("email"),placeholder:"Email Address *",className:`text-sm ${o.email&&s.email?"border-red-500":""}`}),o.email&&s.email&&y.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.email})]}),y.jsxs("div",{children:[y.jsx(Ll,{type:"tel",value:t.phone,onChange:p=>r({...t,phone:p.target.value}),onBlur:()=>d("phone"),placeholder:"Phone Number *",className:`text-sm ${o.phone&&s.phone?"border-red-500":""}`}),o.phone&&s.phone&&y.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.phone})]}),y.jsxs("div",{children:[y.jsxs("div",{className:"flex items-start space-x-2 pt-1",children:[y.jsx(nb,{id:"consent",checked:t.consent,onCheckedChange:p=>{r({...t,consent:!!p}),o.consent&&u("consent",!!p)},className:"mt-0.5 flex-shrink-0"}),y.jsx(YT,{htmlFor:"consent",className:`text-xs leading-tight cursor-pointer ${o.consent&&s.consent?"text-red-500":"text-gray-600"}`,onClick:()=>d("consent"),children:"I consent to receive SMS and communications about real estate opportunities *"})]}),o.consent&&s.consent&&y.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.consent})]}),y.jsx(Qi,{type:"submit",disabled:!h,className:"w-full bg-primary hover:bg-primary/90 text-white py-2 text-sm font-semibold mt-3",children:"Continue Watching"})]}),y.jsx("p",{className:"text-xs text-gray-500 text-center mt-2",children:"Your information is secure and never shared"})]})})},Jc=b.forwardRef(({videoUrl:n,autoPlay:e=!1,showControls:t=!0,showUnmuteButton:r=!0,onVideoReady:s,onError:i,className:o="w-screen h-full object-cover",containerClassName:a="relative w-full h-full",unmuteButtonPosition:l="center",componentName:c="HLSVideoPlayer",enableProgressGate:u=!1,progressGatePercentage:d=20,enablePlayheadStorage:f=!1,onProgressGateSubmit:h},p)=>{const m=b.useRef(null),g=b.useRef(null),[v,x]=b.useState(!0),[E,T]=b.useState(!1),[w,L]=b.useState(!1),[A,R]=b.useState(!1),[C,I]=b.useState(!1),[P,O]=b.useState(!1),[V,B]=b.useState(!1);b.useImperativeHandle(p,()=>({play:async()=>m.current?m.current.play():Promise.reject("Video not available"),pause:()=>{m.current&&m.current.pause()},reset:()=>{m.current&&(m.current.currentTime=0,m.current.muted=!0,x(!0),T(!1),R(!1),I(!1),O(!1))},setMuted:k=>{m.current&&(m.current.muted=k,x(k))},getCurrentTime:()=>{var k;return((k=m.current)==null?void 0:k.currentTime)||0},setCurrentTime:k=>{m.current&&(m.current.currentTime=k)},isPlaying:()=>m.current?!m.current.paused:!1,isMuted:()=>m.current?m.current.muted:!0})),b.useEffect(()=>{if(u&&n){const k=`video_form_submitted_${btoa(n)}`,M=localStorage.getItem(k)==="true";B(M),console.log(`${c}: Form submission status:`,M)}},[u,n,c]),b.useEffect(()=>{if(f&&m.current&&n&&w){const k=`video_playhead_${btoa(n)}`,M=localStorage.getItem(k);if(M){const F=parseFloat(M);!isNaN(F)&&F>0&&(m.current.currentTime=F,console.log(`${c}: Restored playhead position:`,F))}}},[f,n,w,c]),b.useEffect(()=>{if(!f||!m.current||!n)return;const k=m.current,M=`video_playhead_${btoa(n)}`,F=()=>{k.currentTime>0&&localStorage.setItem(M,k.currentTime.toString())};return k.addEventListener("timeupdate",F),()=>{k.removeEventListener("timeupdate",F)}},[f,n]),b.useEffect(()=>{if(!u||!m.current||V)return;const k=m.current,M=()=>{if(k.duration>0){const F=k.currentTime/k.duration*100;F>=d&&!C&&!V&&(k.pause(),R(!0),I(!0),O(!0),console.log(`${c}: Progress gate triggered at ${F}%`))}};return k.addEventListener("timeupdate",M),()=>{k.removeEventListener("timeupdate",M)}},[u,d,C,V,c]),b.useEffect(()=>{if(m.current&&n){const k=m.current;if(console.log(`${c}: Starting video initialization`),console.log(`${c}: Video element available:`,!!k),console.log(`${c}: Video URL:`,n),k.currentTime=0,k.muted=!0,x(!0),T(!1),L(!1),R(!1),I(!1),O(!1),g.current&&(console.log(`${c}: Cleaning up existing HLS instance`),g.current.destroy(),g.current=null),vn.isSupported()){console.log(`${c}: Using HLS.js for video playback`);const M=new vn({startLevel:-1,capLevelToPlayerSize:!0,maxBufferLength:30,maxMaxBufferLength:60});g.current=M,M.on(vn.Events.ERROR,(F,$)=>{$.fatal&&(console.error(`${c}: Fatal HLS Error:`,F,$),i==null||i($))}),M.on(vn.Events.MANIFEST_PARSED,()=>{console.log(`${c}: Manifest parsed, video ready`),L(!0),s==null||s(),e&&k.play().catch(F=>{console.error(`${c}: Error auto-playing video:`,F)})}),M.loadSource(n),M.attachMedia(k)}else if(k.canPlayType("application/vnd.apple.mpegurl")){console.log(`${c}: Using native HLS support`),k.src=n;const M=()=>{console.log(`${c}: Video data loaded, ready for playback`),L(!0),s==null||s(),e&&k.play().catch(F=>{console.error(`${c}: Error auto-playing video:`,F)})};return k.addEventListener("loadeddata",M),()=>{k.removeEventListener("loadeddata",M)}}else console.error(`${c}: HLS not supported`),i==null||i({message:"HLS not supported in this browser"})}return()=>{g.current&&(console.log(`${c}: Cleaning up HLS`),g.current.destroy(),g.current=null)}},[n,e,c,s,i]);const K=k=>{if(n){const M=`video_form_submitted_${btoa(n)}`;localStorage.setItem(M,"true"),B(!0)}R(!1),O(!1),h==null||h(k),m.current&&m.current.play().catch(M=>{console.error(`${c}: Error resuming video after form submission:`,M)})},U=()=>{R(!1),O(!1),I(!1),m.current&&(m.current.currentTime=0,m.current.play().catch(k=>{console.error(`${c}: Error restarting video after form close:`,k)}))},H=()=>{if(m.current){const k=v,M=m.current.muted;x(M),k&&!M&&!E&&(T(!0),m.current.currentTime=0)}},_=()=>{m.current&&(m.current.muted=!1,x(!1),E||(T(!0),m.current.currentTime=0))};return y.jsxs("div",{className:a,children:[y.jsx("video",{ref:m,className:o,controls:t&&!v&&!P,muted:!0,loop:!0,playsInline:!0,onVolumeChange:H,children:"Your browser does not support HLS video streaming."}),A&&y.jsx(m2,{onSubmit:K,onClose:U}),r&&v&&w&&y.jsx("div",{className:`absolute cursor-pointer z-20 ${l==="center"?"top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2":"bottom-6 left-6 right-6"}`,onClick:_,children:y.jsxs("div",{className:"flex flex-col items-center",children:[y.jsx(WL,{size:l==="center"?48:32,className:"text-white drop-shadow-2xl mb-2 animate-pulse"}),y.jsxs("div",{className:"relative",children:[y.jsxs("div",{className:"relative bg-black/80 backdrop-blur-sm px-6 py-3 rounded-full border-2 border-white",style:{boxShadow:"0 0 0 1.5px rgba(0, 0, 0, 0.08)"},children:[y.jsx("div",{className:"absolute inset-0 rounded-full pointer-events-none",style:{animation:"pulse-shadow 1.5s infinite ease-out",animationName:"pulse-shadow",animationDuration:"1.5s",animationIterationCount:"infinite",animationTimingFunction:"ease-out"}}),y.jsx("span",{className:"relative text-white font-bold text-lg z-10",children:" Turn On Sound"})]}),y.jsx("style",{dangerouslySetInnerHTML:{__html:`
                  @keyframes pulse-shadow {
                    0% {
                      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7);
                    }
                    70% {
                      box-shadow: 0 0 0 20px rgba(255, 255, 255, 0);
                    }
                    100% {
                      box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);
                    }
                  }
                `}})]})]})})]})});Jc.displayName="HLSVideoPlayer";const rb=({isOpen:n,onClose:e})=>(b.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[n]),n?y.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:y.jsxs("div",{className:"relative bg-background rounded-2xl shadow-2xl w-full max-w-4xl h-[90vh] overflow-hidden",children:[y.jsx("button",{onClick:e,className:"absolute top-4 right-4 z-10 p-2 bg-background/90 hover:bg-muted rounded-full transition-colors shadow-lg",children:y.jsx(zi,{className:"w-6 h-6"})}),y.jsxs("div",{className:"p-6 border-b bg-gradient-primary text-white",children:[y.jsx("h2",{className:"text-2xl font-bold",children:"Book Your Call"}),y.jsx("p",{className:"text-white/90 mt-2",children:"Let's discuss your real estate investment goals and see if it is a fit."})]}),y.jsx("div",{className:"w-full h-[calc(100%-120px)]",children:y.jsx("iframe",{src:"https://equitybuilders.co/turnkey-call/",className:"w-full h-full border-none",title:"Book Your Pre-Qualification Call",allow:"fullscreen"})})]})}):null),p2=({isOpen:n,onClose:e})=>{const[t,r]=b.useState(!1),s=b.useRef(null);if(console.log("ExitIntentModal render - isOpen:",n,"showModal:",t),b.useEffect(()=>(n?(r(!0),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[n]),b.useEffect(()=>{var a;n&&t&&(console.log("ExitIntentModal: Modal opened, resetting video player"),(a=s.current)==null||a.reset())},[n,t]),!t)return null;const i=()=>{r(!1),setTimeout(e,300)},o=a=>{a.target===a.currentTarget&&i()};return y.jsx("div",{className:`fixed inset-0 bg-black/90 backdrop-blur-md z-50 flex items-center justify-center p-2 sm:p-4 transition-opacity duration-300 ${n?"opacity-100":"opacity-0"}`,onClick:o,children:y.jsxs("div",{className:`relative bg-gradient-primary rounded-2xl sm:rounded-3xl shadow-2xl w-full max-w-sm sm:max-w-2xl lg:max-w-4xl xl:max-w-6xl max-h-[95vh] overflow-y-auto transform transition-all duration-300 ${n?"scale-100":"scale-95"}`,onClick:a=>a.stopPropagation(),children:[y.jsx("button",{onClick:i,className:"absolute top-6 right-6 z-10 p-3 bg-white/20 hover:bg-white/30 rounded-full transition-colors shadow-lg backdrop-blur-sm",children:y.jsx(zi,{className:"w-8 h-8 text-white"})}),y.jsxs("div",{className:"p-4 sm:p-6 lg:p-12",children:[y.jsxs("div",{className:"text-center mb-4 sm:mb-8",children:[y.jsxs("h1",{className:"text-2xl sm:text-4xl lg:text-7xl font-black text-white leading-tight mb-2 sm:mb-4",children:["WAIT!",y.jsx("span",{className:"block text-accent drop-shadow-2xl",children:"WATCH THIS"}),y.jsx("span",{className:"block bg-gradient-to-r from-white to-highlight bg-clip-text text-transparent",children:"BEFORE YOU LEAVE"})]}),y.jsx("p",{className:"text-sm sm:text-xl lg:text-2xl text-white/90 font-semibold",children:"See how we transform empty lots into profitable developments in just 90 seconds"})]}),y.jsx("div",{className:"relative bg-black rounded-xl sm:rounded-2xl overflow-hidden shadow-2xl aspect-video max-w-4xl mx-auto",children:y.jsx(Jc,{ref:s,videoUrl:"https://vz-447b6532-fd2.b-cdn.net/114d20b4-b152-48e8-b8d1-0a0e12470326/playlist.m3u8",autoPlay:n&&t,showControls:!0,showUnmuteButton:!0,unmuteButtonPosition:"center",componentName:"ExitIntentModal",className:"w-full h-full object-cover",containerClassName:"w-full h-full",enableProgressGate:!0,progressGatePercentage:20,enablePlayheadStorage:!0,onProgressGateSubmit:a=>{console.log("Progress gate form submitted:",a)}})}),y.jsxs("div",{className:"text-center mt-4 sm:mt-8",children:[y.jsx("button",{onClick:()=>{i();const a=new CustomEvent("openConsultation");window.dispatchEvent(a)},className:"bg-white text-primary hover:bg-accent hover:text-white px-6 sm:px-12 py-3 sm:py-6 rounded-xl sm:rounded-2xl text-lg sm:text-2xl font-bold shadow-2xl transform hover:scale-105 transition-all duration-300",children:" Book Your Free Consultation Now"}),y.jsx("p",{className:"text-white/80 mt-2 sm:mt-4 text-sm sm:text-lg",children:"Limited spots available this month"})]})]})]})})},g2=()=>{const[n,e]=b.useState(!1),[t,r]=b.useState(!1);return b.useEffect(()=>{let o;const a=c=>{console.log("Mouse leave detected:",c.clientY),c.clientY<=0&&!t&&(console.log("Exit intent triggered! Starting timeout..."),o=setTimeout(()=>{console.log("Exit intent modal opening!"),e(!0),r(!0)},100))},l=()=>{o&&(console.log("Mouse re-entered, canceling exit intent"),clearTimeout(o))};return console.log("Exit intent listeners attached"),document.addEventListener("mouseleave",a),document.addEventListener("mouseenter",l),()=>{console.log("Exit intent listeners removed"),document.removeEventListener("mouseleave",a),document.removeEventListener("mouseenter",l),o&&clearTimeout(o)}},[t]),{showExitIntent:n,closeExitIntent:()=>{e(!1)},resetExitIntent:()=>{r(!1),e(!1)},hasShownExitIntent:t}},v2=()=>{const[n,e]=b.useState(!0),[t,r]=b.useState(!1),s=b.useRef(null),{showExitIntent:i,closeExitIntent:o}=g2();b.useEffect(()=>{const c=()=>{r(!0)};return window.addEventListener("openConsultation",c),()=>window.removeEventListener("openConsultation",c)},[]);const a=()=>{e(!0)},l=()=>{var c;e(!1),(c=s.current)==null||c.reset()};return y.jsxs("section",{className:"relative min-h-screen bg-gradient-primary overflow-hidden",children:[y.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[y.jsxs("div",{className:"absolute right-0 top-0 w-3/5 h-full opacity-40",children:[y.jsx("img",{src:"/lovable-uploads/099d43ed-30ee-447a-8302-8f31d970c7b5.png",alt:"TurnKey Development founder and consultant",className:"w-full h-full object-cover object-center"}),y.jsx("div",{className:"absolute inset-0 bg-gradient-to-l from-primary/80 via-primary/60 to-primary"})]}),y.jsxs("div",{className:"absolute left-0 bottom-0 w-2/5 h-2/3 opacity-20",children:[y.jsx("img",{src:"/lovable-uploads/f48a2dc0-af37-42d8-824b-fc482c4ceb7f.png",alt:"Construction project by TurnKey Development",className:"w-full h-full object-cover"}),y.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary to-transparent"})]})]}),y.jsx("div",{className:"hidden lg:block absolute top-20 left-8 w-64 h-64 rounded-2xl overflow-hidden shadow-xl border-4 border-accent/60 rotate-6 transform hover:rotate-3 transition-all duration-500",children:y.jsx("img",{src:"/lovable-uploads/f48a2dc0-af37-42d8-824b-fc482c4ceb7f.png",alt:"Construction project by TurnKey Development",className:"w-full h-full object-cover hover:scale-110 transition-all duration-500"})}),y.jsxs("div",{className:"hidden lg:block absolute bottom-40 left-16 w-72 h-48 rounded-3xl overflow-hidden shadow-2xl border-6 border-white/40 -rotate-3 transform hover:-rotate-1 transition-all duration-700",children:[y.jsx("img",{src:"/lovable-uploads/PedersonExterior.jpg",alt:"Architectural project showcase",className:"w-full h-full object-cover"}),y.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-accent/30"})]}),y.jsxs("div",{className:"hidden lg:block absolute top-16 right-16 w-80 h-80 rounded-3xl overflow-hidden shadow-2xl border-8 border-white/40 rotate-3 transform hover:rotate-1 transition-all duration-700",children:[y.jsx("img",{src:"/lovable-uploads/993aef6a-33f5-465f-8eba-159acc3d0dd8.png",alt:"TurnKey Development business consultant",className:"w-full h-full object-cover"}),y.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-primary/30"})]}),y.jsx("div",{className:"hidden lg:block absolute bottom-32 right-8 w-56 h-56 rounded-2xl overflow-hidden shadow-xl border-4 border-accent/60 -rotate-6 transform hover:-rotate-3 transition-all duration-500",children:y.jsx("img",{src:"/lovable-uploads/4a2cd88c-1e89-4f93-a9e5-ccb59cbce7a6.png",alt:"Architectural project showcase",className:"w-full h-full object-cover hover:scale-110 transition-all duration-500"})}),y.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[y.jsx("div",{className:"absolute top-32 left-16 w-96 h-96 bg-accent/20 rounded-full blur-3xl animate-pulse"}),y.jsx("div",{className:"absolute bottom-16 left-32 w-80 h-80 bg-white/10 rounded-full blur-2xl"}),y.jsx("div",{className:"absolute top-1/2 left-1/3 w-[500px] h-[500px] bg-secondary/15 rounded-full blur-3xl"}),y.jsx("div",{className:"absolute inset-0 opacity-5",children:y.jsx("div",{className:"w-full h-full bg-gradient-to-br from-amber-800/30 via-amber-600/20 to-amber-900/30"})}),y.jsx("div",{className:"absolute inset-0 opacity-10",children:y.jsx("div",{className:"w-full h-full",style:{backgroundImage:`
              linear-gradient(0deg, rgba(255,255,255,0.1) 1px, transparent 1px),
              linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)
            `,backgroundSize:"60px 60px"}})})]}),y.jsxs("div",{className:"container mx-auto px-4 py-20 relative z-10",children:[y.jsx("div",{className:"lg:hidden mb-12",children:y.jsxs("h2",{className:"text-5xl sm:text-6xl font-black leading-none text-white text-center drop-shadow-lg",children:["TURN KEY DEVELOPMENT,",y.jsx("span",{className:"block text-accent drop-shadow-2xl",children:"WE WILL DO"}),y.jsx("span",{className:"block bg-gradient-to-r from-white to-highlight bg-clip-text text-transparent drop-shadow-lg",children:"ALL THE WORK!"})]})}),y.jsxs("div",{className:"lg:hidden mb-8 flex justify-center gap-4",children:[y.jsx("div",{className:"w-32 h-32 rounded-xl overflow-hidden shadow-lg border-2 border-accent/60 rotate-3",children:y.jsx("img",{src:"/lovable-uploads/f48a2dc0-af37-42d8-824b-fc482c4ceb7f.png",alt:"Construction project by TurnKey Development",className:"w-full h-full object-cover"})}),y.jsx("div",{className:"w-32 h-32 rounded-xl overflow-hidden shadow-lg border-2 border-white/40 -rotate-3",children:y.jsx("img",{src:"/lovable-uploads/993aef6a-33f5-465f-8eba-159acc3d0dd8.png",alt:"TurnKey Development business consultant",className:"w-full h-full object-cover"})})]}),y.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-2 gap-8 lg:gap-2 items-center max-w-7xl",children:[y.jsxs("div",{className:"space-y-12 order-2 lg:order-1 text-center lg:text-left",children:[y.jsxs("div",{className:"space-y-6",children:[y.jsx("div",{className:"hidden lg:block",children:y.jsxs("h3",{className:"text-3xl font-black leading-none text-white text-left mb-4 drop-shadow-lg",children:["TURN KEY DEVELOPMENT,",y.jsx("span",{className:"block text-accent drop-shadow-2xl",children:"DONE-FOR-YOU."}),y.jsx("span",{className:"block bg-gradient-to-r from-white to-highlight bg-clip-text text-transparent drop-shadow-lg",children:"WE WILL DO ALL THE WORK!"})]})}),y.jsx("div",{className:"inline-block bg-accent/20 backdrop-blur-sm px-6 py-3 rounded-full border border-white/60",children:y.jsx("span",{className:"text-white drop-shadow-lg font-bold text-sm sm:text-lg",children:"Do You Have Over $100K & NO TIME? This is for you!"})}),y.jsxs("h1",{className:"text-6xl sm:text-5xl lg:text-8xl font-black leading-none text-white drop-shadow-lg",children:["GO FROM AN EMPTY",y.jsx("span",{className:"block text-accent drop-shadow-2xl",children:"LOT TO"}),y.jsx("span",{className:"block bg-gradient-to-r from-white to-highlight bg-clip-text text-transparent drop-shadow-lg",children:"SIX FIGURE"}),y.jsx("span",{className:"block text-white drop-shadow-lg",children:"PROFITS"})]}),y.jsx("div",{className:"bg-white/10 backdrop-blur-sm p-6 rounded-2xl border border-white/20 max-w-2xl mx-auto lg:mx-0",children:y.jsxs("p",{className:"text-lg sm:text-2xl text-white font-semibold leading-relaxed",children:["Are you a busy professional looking to accelerate your retirement goals? ",y.jsx("span",{className:"font-normal text-white/80",children:"You need the benefits of Real Estate and the tax write-offs that come with it to keep more of your money every year."}),y.jsx("br",{}),y.jsx("br",{}),"Lets work together. We will handle every step of the  complex",y.jsx("span",{className:"text-highlight",children:" new construction development process"})," from land search to permits to actual construction."]})})]}),y.jsxs("div",{className:"space-y-6",children:[y.jsx(Qi,{size:"lg",onClick:()=>r(!0),className:"text-lg sm:text-2xl px-8 sm:px-12 py-6 sm:py-8 bg-white text-primary hover:bg-accent hover:text-white shadow-2xl transform hover:scale-105 transition-all duration-300 font-bold",children:" Book Your Pre-Qualification Call Today"}),y.jsxs("div",{className:"flex items-center justify-center lg:justify-start gap-4 text-white/90",children:[y.jsxs("div",{className:"flex -space-x-2",children:[y.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-white bg-accent"}),y.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-white bg-secondary"}),y.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-white bg-primary"})]}),y.jsx("span",{className:"text-lg",children:"Join 100+ successful developers"})]})]}),y.jsx("div",{className:"bg-black/20 backdrop-blur-sm p-8 rounded-3xl border border-white/20",children:y.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:[y.jsxs("div",{className:"text-center space-y-2",children:[y.jsx("div",{className:"text-4xl font-black text-highlight",children:"5+"}),y.jsx("div",{className:"text-white/80 font-medium",children:"Projects Delivered"})]}),y.jsxs("div",{className:"text-center space-y-2",children:[y.jsx("div",{className:"text-4xl font-black text-highlight",children:"100%"}),y.jsx("div",{className:"text-white/80 font-medium",children:"Success Rate"})]}),y.jsxs("div",{className:"text-center space-y-2",children:[y.jsx("div",{className:"text-4xl font-black text-highlight",children:"1.8x+"}),y.jsx("div",{className:"text-white/80 font-medium",children:"ROI Multiples"})]}),y.jsxs("div",{className:"text-center space-y-2",children:[y.jsx("div",{className:"text-4xl font-black text-highlight",children:"5+"}),y.jsx("div",{className:"text-white/80 font-medium",children:"Years of Experience"})]})]})})]}),y.jsx("div",{className:"relative flex justify-center lg:justify-start lg:pl-24",children:y.jsxs("div",{className:"relative w-80 h-[600px] sm:w-80 sm:h-[600px] lg:w-96 lg:h-[800px]",children:[y.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-slate-800 to-slate-900 rounded-[3rem] p-2 shadow-2xl",children:y.jsxs("div",{className:"w-full h-full bg-black rounded-[2.5rem] overflow-hidden relative",children:[y.jsx("div",{className:"absolute top-2 left-1/2 transform -translate-x-1/2 w-20 h-6 sm:w-24 sm:h-6 lg:w-32 lg:h-8 bg-black rounded-full z-20"}),y.jsx("div",{className:"w-full h-full rounded-[2.5rem] overflow-hidden relative",children:n?y.jsxs("div",{className:"w-full h-full bg-black relative",children:[y.jsx(Jc,{ref:s,videoUrl:"https://vz-447b6532-fd2.b-cdn.net/c6b998b8-9763-4324-94ea-1b19b14c3dc1/playlist.m3u8",autoPlay:n,showControls:!0,showUnmuteButton:!0,unmuteButtonPosition:"bottom",componentName:"Hero",className:"w-full h-full object-cover",containerClassName:"w-full h-full"}),y.jsx("button",{onClick:l,className:"absolute top-4 right-4 px-4 py-2 bg-black/60 text-white rounded-lg hover:bg-black/80 transition-colors backdrop-blur-sm z-30",children:" Close"})]}):y.jsxs(y.Fragment,{children:[y.jsx("img",{src:"/lovable-uploads/969dc144-8ea0-45cc-8375-b4bc44dc44c5.png",alt:"Business transformation expert introduction",className:"w-full h-full object-cover"}),y.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center",children:y.jsx("button",{onClick:a,className:"w-28 h-28 bg-white/90 rounded-full flex items-center justify-center hover:bg-white transition-all duration-300 hover:scale-110 shadow-2xl",children:y.jsx(KL,{className:"w-12 h-12 text-primary ml-1",fill:"currentColor"})})}),y.jsxs("div",{className:"absolute bottom-6 left-6 right-6 bg-black/60 backdrop-blur-sm rounded-2xl p-6",children:[y.jsx("p",{className:"text-white font-semibold text-center text-lg",children:" Your Construction Partner"}),y.jsx("p",{className:"text-white/80 text-base text-center mt-2",children:"Tap to see how we build together"})]})]})})]})}),y.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-slate-600/50 to-slate-900/50 rounded-[3rem] blur-xl scale-105 -z-10"})]})})]}),y.jsx("div",{className:"lg:hidden mt-20 flex justify-center",children:y.jsx("div",{className:"w-40 h-24 rounded-xl overflow-hidden shadow-lg border-2 border-accent/60 rotate-2",children:y.jsx("img",{src:"/lovable-uploads/4a2cd88c-1e89-4f93-a9e5-ccb59cbce7a6.png",alt:"Architectural project showcase",className:"w-full h-full object-cover"})})})]}),y.jsx(rb,{isOpen:t,onClose:()=>r(!1)}),y.jsx(p2,{isOpen:i,onClose:o})]})},y2=()=>{const n=["Limited Property Selection","Limited Market Knowledge","You Don't Know What You Don't Know","Lack of Construction Expertise","You Need To Build A Team From Scratch","No Project Management Experience","Inconsistent Quality Control","Prior Experience Required for Financing"],e=["Curated Investment Opportunities","Streamlined Financing Solutions","Complete Market Analysis Provided","Full Permit & Legal Handling","Expert Construction Management","End-to-End Project Oversight","Guaranteed Quality Standards","Six Figures Delivered On A Silver Platter!"];return y.jsxs("section",{className:"w-full py-20 bg-background relative overflow-hidden",children:[y.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[y.jsx("div",{className:"absolute top-16 left-1/4 w-96 h-96 bg-accent/10 rounded-full blur-3xl"}),y.jsx("div",{className:"absolute bottom-16 right-1/4 w-80 h-80 bg-primary/10 rounded-full blur-2xl"})]}),y.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[y.jsxs("div",{className:"text-center mb-16",children:[y.jsx("div",{className:"inline-block bg-accent/10 backdrop-blur-sm px-6 py-2 rounded-full border border-accent/20 mb-6",children:y.jsx("span",{className:"text-accent font-semibold text-sm uppercase tracking-wider",children:"Comparison"})}),y.jsxs("h2",{className:"text-4xl md:text-6xl font-black leading-tight text-foreground mb-6 drop-shadow-lg",children:["What Sets Turn Key",y.jsx("span",{className:"block text-accent drop-shadow-lg",children:"Development Apart"})]}),y.jsxs("p",{className:"text-xl text-muted-foreground max-w-4xl mx-auto leading-relaxed",children:["Discover how our done-for-you approach outperforms traditional real estate investing with superior support, better results, and unmatched ease of investment.",y.jsx("br",{}),y.jsx("br",{})]}),y.jsxs("p",{className:"text-xl text-muted-foreground max-w-4xl mx-auto leading-relaxed",children:["Real Estate is the ONLY asset class in the world that allows you to gain 100% of control and value for just a fraction of the cost. This means that we are able to get over 100% returns on capital invested. Traditional investments in syndications, the stock market do not compare to the tangible security of Real Estate combined with the returns. When you build vs buy investment real estate the margins are huge!",y.jsx("br",{}),y.jsx("br",{})]}),y.jsxs("p",{className:"text-xl text-muted-foreground max-w-4xl mx-auto leading-relaxed",children:['If you want to determine how fast you can multiply your money just divide your expected percentage returns by 72. This will give you the number of years it will take to double your money. This is called the "Rule of 72". The best alternative investments out today may give you a return of 10-15% on the high end. This means it will take you 7.2-4.8 years to double your money. We are doing that in 9-12 months! The best part is that we will do all the heavy lifting for you! You can participate as much or as little as you want.',y.jsx("br",{})]})]}),y.jsxs("div",{className:"max-w-7xl mx-auto",children:[y.jsxs("div",{className:"lg:grid lg:grid-cols-2 lg:gap-12 items-start space-y-8 lg:space-y-0",children:[y.jsx("div",{className:"relative",children:y.jsxs("div",{className:"bg-muted/30 backdrop-blur-sm rounded-3xl p-8 border border-muted/40 relative overflow-hidden",children:[y.jsx("div",{className:"absolute inset-0 opacity-5",children:y.jsx("div",{className:"w-full h-full bg-gradient-to-br from-destructive/20 to-muted/30"})}),y.jsxs("div",{className:"relative z-10",children:[y.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-muted rounded-2xl mb-6 mx-auto",children:y.jsx(gg,{className:"w-8 h-8 text-muted-foreground"})}),y.jsx("h3",{className:"text-2xl font-bold text-center mb-8 text-foreground",children:"Traditional Approaches"}),y.jsx("div",{className:"space-y-4",children:n.map((t,r)=>y.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-xl bg-muted/20 border border-muted/30",children:[y.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-muted flex items-center justify-center mt-0.5 shadow-md border-2 border-muted-foreground/20 hover:scale-110 transition-all duration-300",children:y.jsx(gg,{className:"w-6 h-6 text-muted-foreground",strokeWidth:2.5})}),y.jsx("span",{className:"text-foreground font-medium",children:t})]},r))})]})]})}),y.jsx("div",{className:"flex justify-center lg:hidden",children:y.jsx("div",{className:"w-16 h-16 bg-highlight rounded-full flex items-center justify-center border-4 border-background shadow-xl",children:y.jsx("span",{className:"text-background font-bold text-base",children:"VS"})})}),y.jsx("div",{className:"relative",children:y.jsxs("div",{className:"bg-gradient-primary backdrop-blur-sm rounded-3xl p-8 border border-accent/30 relative overflow-hidden shadow-2xl",children:[y.jsx("div",{className:"absolute inset-0 opacity-10",children:y.jsx("div",{className:"w-full h-full bg-gradient-to-br from-accent/30 to-highlight/20"})}),y.jsxs("div",{className:"relative z-10",children:[y.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-accent/20 backdrop-blur-sm rounded-2xl mb-6 mx-auto border border-accent/30",children:y.jsx(VL,{className:"w-8 h-8 text-white",strokeWidth:2.5})}),y.jsx("h3",{className:"text-2xl font-bold text-center mb-8 text-white",children:"TurnKey Development"}),y.jsx("div",{className:"space-y-4",children:e.map((t,r)=>y.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-xl bg-white/10 backdrop-blur-sm border border-white/20",children:[y.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gradient-accent flex items-center justify-center mt-0.5 shadow-lg border-2 border-white/30 hover:scale-110 transition-all duration-300",children:y.jsx(yf,{className:"w-6 h-6 text-white drop-shadow-md",strokeWidth:3})}),y.jsx("span",{className:"text-white font-medium",children:t})]},r))})]})]})})]}),y.jsx("div",{className:"absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 z-20 hidden lg:block",children:y.jsx("div",{className:"w-20 h-20 bg-highlight rounded-full flex items-center justify-center border-4 border-background shadow-2xl",children:y.jsx("span",{className:"text-background font-bold text-lg",children:"VS"})})})]}),y.jsx("div",{className:"text-center mt-16",children:y.jsxs("div",{className:"bg-accent/10 backdrop-blur-sm rounded-2xl p-8 border border-accent/20 max-w-4xl mx-auto",children:[y.jsx("h3",{className:"text-2xl font-bold text-foreground mb-4",children:"Ready to Experience the TurnKey Difference?"}),y.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Join successful investors who chose the smarter path to real estate wealth building."}),y.jsxs("div",{className:"flex items-center justify-center gap-2 text-accent font-semibold",children:[y.jsx(yf,{className:"w-5 h-5"}),y.jsx("span",{children:"No more hassles. No more guesswork. Just results."})]})]})})]})]})},x2=()=>{const n=[{label:"Equity Builders",assetFileName:"EB_Logo_Icon_Circle_Horizontal.png"},{label:"Multiculture Mortgage",assetFileName:"Multiculture_Mortgage_Stationary_Horizontal_Logo_cropped.png"},{label:"Noval Capital Group",assetFileName:"Noval-Capital-Final_Horizontal.png"},{label:"The American Dream TV",assetFileName:"TheAmericanDreamTV_Logo-1000x252.png"},{label:"House Hacking The American Dream: Maximizing Cash Flow In An Unaffordable America",assetFileName:"HouseHackingTheAmericanDream_Logo-Final_Horizontal.png"}];return y.jsx("section",{className:"w-full bg-primary py-8 overflow-hidden",children:y.jsx("div",{className:"flex items-center",style:{maskImage:"linear-gradient(to right, rgba(0, 0, 0, 0) 0%, rgb(0, 0, 0) 12.5%, rgb(0, 0, 0) 87.5%, rgba(0, 0, 0, 0) 100%)"},children:y.jsxs("div",{className:"flex animate-ticker whitespace-nowrap",children:[n.map((e,t)=>y.jsx("div",{className:"flex-shrink-0 mx-12",children:y.jsx("img",{src:`/lovable-uploads/${e.assetFileName}`,alt:e.label,className:"h-14 w-auto opacity-80 hover:opacity-100 transition-opacity duration-300 brightness-0 invert"})},t)),n.map((e,t)=>y.jsx("div",{className:"flex-shrink-0 mx-12",children:y.jsx("img",{src:`/lovable-uploads/${e.assetFileName}`,alt:e.label,className:"h-14 w-auto opacity-80 hover:opacity-100 transition-opacity duration-300 brightness-0 invert"})},`duplicate-${t}`))]})})})},eu=b.forwardRef(({className:n,...e},t)=>y.jsx("div",{ref:t,className:be("rounded-lg border bg-card text-card-foreground shadow-sm",n),...e}));eu.displayName="Card";const Fm=b.forwardRef(({className:n,...e},t)=>y.jsx("div",{ref:t,className:be("flex flex-col space-y-1.5 p-6",n),...e}));Fm.displayName="CardHeader";const $m=b.forwardRef(({className:n,...e},t)=>y.jsx("h3",{ref:t,className:be("text-2xl font-semibold leading-none tracking-tight",n),...e}));$m.displayName="CardTitle";const E2=b.forwardRef(({className:n,...e},t)=>y.jsx("p",{ref:t,className:be("text-sm text-muted-foreground",n),...e}));E2.displayName="CardDescription";const tu=b.forwardRef(({className:n,...e},t)=>y.jsx("div",{ref:t,className:be("p-6 pt-0",n),...e}));tu.displayName="CardContent";const S2=b.forwardRef(({className:n,...e},t)=>y.jsx("div",{ref:t,className:be("flex items-center p-6 pt-0",n),...e}));S2.displayName="CardFooter";const T2=()=>{const[n,e]=b.useState(!1),t=[{title:"Land Search & Vetting",category:"Our Proven 11-Step Process",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})},{title:"Survey & Soil Reports",category:"Our Proven 11-Step Process",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},{title:"Site Plan Design",category:"Our Proven 11-Step Process",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})})},{title:"Plat Design & Submission",category:"Our Proven 11-Step Process",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},{title:"Civil Drainage Planning",category:"Our Proven 11-Step Process",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})},{title:"Architectural & Floor Plan Design",category:"Our Proven 11-Step Process",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})},{title:"Structural Engineer Plans",category:"Our Proven 11-Step Process",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h.01M19 10a7 7 0 11-14 0 7 7 0 0114 0z"})})},{title:"Budget Creation & Material Selections",category:"Our Proven 11-Step Process",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})},{title:"Project Underwriting & Cashflow Projections",category:"Our Proven 11-Step Process",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},{title:"Construction Loan Submission & Approval",category:"Our Proven 11-Step Process",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})},{title:"City Permit Submission & Approval",category:"Our Proven 11-Step Process",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}],r=[{title:"Comparative Market Analysis",category:"Services Included",icon:y.jsxs("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})},{title:"Builder Selection & Contract Review",category:"Services Included",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})},{title:"Full In-House Construction Services",category:"Services Included",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})},{title:"Entity Structuring & Setup Consulting",category:"Services Included",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})},{title:"Exit & Tax Strategy Consulting",category:"Services Included",icon:y.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7a4 4 0 11-8 0 4 4 0 018 0zM9 14a6 6 0 00-6 6v1h12v-1a6 6 0 00-6-6zM21 12h-6m3-3l3 3-3 3"})})}],s=[...t,...r];return y.jsxs("section",{className:"py-32 bg-gradient-secondary relative overflow-hidden",children:[y.jsxs("div",{className:"absolute inset-0",children:[y.jsxs("div",{className:"absolute left-0 top-0 w-2/5 h-full opacity-30",children:[y.jsx("img",{src:"/lovable-uploads/099d43ed-30ee-447a-8302-8f31d970c7b5.png",alt:"TurnKey Development strategic consultant",className:"w-full h-full object-cover object-center"}),y.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-secondary via-secondary/80 to-transparent"})]}),y.jsxs("div",{className:"absolute right-0 bottom-0 w-3/5 h-2/3 opacity-15",children:[y.jsx("img",{src:"/lovable-uploads/4a2cd88c-1e89-4f93-a9e5-ccb59cbce7a6.png",alt:"Construction project showcasing expertise",className:"w-full h-full object-cover"}),y.jsx("div",{className:"absolute inset-0 bg-gradient-to-l from-secondary/80 to-transparent"})]}),y.jsxs("div",{className:"absolute top-16 left-1/2 transform -translate-x-1/2 lg:left-20 lg:transform-none w-48 h-48 lg:w-80 lg:h-80 rounded-3xl overflow-hidden shadow-2xl border-4 lg:border-8 border-accent/50 -rotate-12 hover:-rotate-6 transition-all duration-700",children:[y.jsx("img",{src:"/lovable-uploads/LavonReebok.png",alt:"Lavon Reebok Shot",className:"w-full h-full object-cover"}),y.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-secondary/40"})]}),y.jsx("div",{className:"hidden lg:block absolute bottom-20 right-32 w-72 h-72 rounded-2xl overflow-hidden shadow-xl border-6 border-white/40 rotate-12",children:y.jsx("img",{src:"/lovable-uploads/1017Calvin_Exterior.jpg",alt:"1017 Calvin Avenue development project",className:"w-full h-full object-cover hover:scale-110 transition-all duration-500"})})]}),y.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[y.jsx("div",{className:"absolute top-20 right-20 w-96 h-96 bg-accent/20 rounded-full blur-3xl animate-pulse"}),y.jsx("div",{className:"absolute bottom-32 left-40 w-80 h-80 bg-white/10 rounded-full blur-2xl"}),y.jsx("div",{className:"absolute top-1/2 right-1/3 w-[500px] h-[500px] bg-primary/10 rounded-full blur-3xl"}),y.jsx("div",{className:"absolute inset-0 opacity-8",children:y.jsx("div",{className:"w-full h-full",style:{backgroundImage:`
              linear-gradient(0deg, rgba(255,255,255,0.05) 1px, transparent 1px),
              linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px)
            `,backgroundSize:"40px 40px"}})}),y.jsx("div",{className:"absolute inset-0 opacity-3",children:y.jsx("div",{className:"w-full h-full bg-gradient-to-br from-amber-700/20 via-amber-500/10 to-amber-800/15"})})]}),y.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[y.jsxs("div",{className:"text-center mb-20 mt-48 lg:mt-0",children:[y.jsx("div",{className:"inline-block bg-white/10 backdrop-blur-sm px-8 py-4 rounded-full border border-white/30 mb-8",children:y.jsx("span",{className:"text-white font-bold text-xl",children:"OUR EXPERT SERVICES"})}),y.jsxs("h2",{className:"text-5xl lg:text-6xl font-black mb-8 text-white drop-shadow-lg",children:["WE WILL TAKE YOU",y.jsx("span",{className:"block text-accent drop-shadow-2xl",children:"FROM A TO Z"})]}),y.jsx("p",{className:"text-2xl text-white/90 max-w-4xl mx-auto leading-relaxed",children:"Use our experience, our team, our vendors, relationships, and take all of our knowledge and processes around developing residential multi-family properties for a flat fee."})]}),y.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:s.map((i,o)=>y.jsxs(eu,{className:"group hover:shadow-2xl transition-all duration-500 hover:-translate-y-4 hover:scale-105 bg-white/95 hover:bg-gradient-accent hover:text-white border-0 backdrop-blur-sm",children:[y.jsxs(Fm,{children:[y.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-2xl flex items-center justify-center text-primary mb-4 group-hover:bg-white/20 group-hover:text-white transition-all duration-300 group-hover:scale-110",children:i.icon}),y.jsx($m,{className:"text-lg group-hover:text-white font-bold",children:i.title}),i.category&&y.jsx("div",{className:"text-xs text-muted-foreground group-hover:text-white/70 bg-primary/5 group-hover:bg-white/10 px-2 py-1 rounded-full w-fit",children:i.category})]}),y.jsx(tu,{children:i.description&&y.jsx("p",{className:"text-muted-foreground group-hover:text-white/90 text-sm leading-relaxed",children:i.description})})]},o))}),y.jsx("div",{className:"text-center mt-20",children:y.jsxs("div",{className:"bg-black/20 backdrop-blur-sm p-8 rounded-3xl border border-white/20 max-w-2xl mx-auto",children:[y.jsx("h3",{className:"text-3xl font-bold text-white mb-4",children:"Working With Us Is Easy!"}),y.jsx("p",{className:"text-white/90 text-xl mb-6",children:"We already have the relationships, the experience, and the processes in place specifically in Houston, Texas."}),y.jsx(Qi,{onClick:()=>e(!0),size:"lg",className:"text-black text-lg font-semibold bg-yellow-400 hover:bg-yellow-500 border border-yellow-500 hover:border-yellow-600 transition-all duration-300 shadow-lg hover:shadow-xl",children:"Book Your Call Today"})]})})]}),y.jsx(rb,{isOpen:n,onClose:()=>e(!1)})]})},b2=()=>{const n=b.useRef(null),e=[{title:"Proven Track Record",description:"Over $1.2M in active construction and $2.4M+ in development in the pipeline.",icon:y.jsx(OL,{className:"w-8 h-8"}),stats:"$5M+",statsLabel:"Pending Developments"},{title:"Experience",description:"From mortgage brokering to property management to development  we cover the full transaction.",icon:y.jsx(ML,{className:"w-8 h-8"}),stats:"Full Stack",statsLabel:"Real Estate Services"},{title:"Barrier Removal",description:"We help new developers overcome the toughest entry challenges, including financing and permitting.",icon:y.jsx(GL,{className:"w-8 h-8"}),stats:"100%",statsLabel:"Permit Success Rate"},{title:"Mentorship Included",description:"We will let you see behind the curtain and process full transparency of actual costs and process.",icon:y.jsx(UL,{className:"w-8 h-8"}),stats:"FULL",statsLabel:"Transparency"}];return y.jsxs(y.Fragment,{children:[y.jsxs("section",{className:"w-full py-32 bg-gradient-to-br from-primary via-primary-dark to-secondary relative overflow-hidden",children:[y.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[y.jsx("div",{className:"absolute top-20 left-20 w-96 h-96 bg-accent/20 rounded-full blur-3xl"}),y.jsx("div",{className:"absolute bottom-32 right-40 w-80 h-80 bg-white/10 rounded-full blur-2xl"}),y.jsx("div",{className:"absolute top-1/2 left-1/3 w-[400px] h-[400px] bg-white/5 rounded-full blur-3xl"})]}),y.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[y.jsxs("div",{className:"text-center mb-20",children:[y.jsx("div",{className:"inline-block bg-white/10 backdrop-blur-sm px-8 py-4 rounded-full border border-white/30 mb-8",children:y.jsx("span",{className:"text-white font-bold text-xl",children:"WHY CHOOSE US"})}),y.jsxs("h2",{className:"text-5xl lg:text-6xl font-black mb-8 text-white drop-shadow-lg",children:["WHY WORK",y.jsx("span",{className:"block text-accent drop-shadow-2xl",children:"WITH US?"})]}),y.jsxs("p",{className:"text-2xl text-white/90 max-w-4xl mx-auto leading-relaxed",children:["We don't just talk about results  we deliver them. We have a proven track record with HUD statements to back it up. You will not find another partner like us that is as vertically integrated from top to bottom. Lavon is a licensed real estate mortgage broker, developer, and builder. He has been in the Real Estate industry for over 20 years with most recent construction experience built up and honed over the last 5 years during probably one of the hardest times to build in the last 50 years with the Covid-19 pandemic. He has been through the trenches and knows what it takes to get a project done.",y.jsx("br",{}),y.jsx("br",{}),"If you want to learn along the way we will also be very transparent and teach you how to fish in this Real Estate development game as an additional benefit."]})]}),y.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8",children:e.map((t,r)=>y.jsxs(eu,{className:"group hover:shadow-2xl transition-all duration-500 hover:-translate-y-6 hover:scale-105 bg-white/95 hover:bg-white border-0 backdrop-blur-sm text-center",children:[y.jsxs(Fm,{className:"pb-4",children:[y.jsx("div",{className:"w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center text-primary mb-6 group-hover:bg-primary group-hover:text-white transition-all duration-300 group-hover:scale-110 mx-auto",children:t.icon}),y.jsxs("div",{className:"mb-4",children:[y.jsx("div",{className:"text-3xl font-black text-primary group-hover:text-primary-dark",children:t.stats}),y.jsx("div",{className:"text-sm text-muted-foreground font-semibold",children:t.statsLabel})]}),y.jsx($m,{className:"text-xl group-hover:text-primary-dark font-bold",children:t.title})]}),y.jsx(tu,{children:y.jsx("p",{className:"text-muted-foreground text-sm leading-relaxed",children:t.description})})]},r))}),y.jsx("div",{className:"text-center mt-20",children:y.jsxs("div",{className:"bg-white/10 backdrop-blur-sm p-12 rounded-3xl border border-white/20 max-w-4xl mx-auto",children:[y.jsx("h3",{className:"text-4xl font-bold text-white mb-6 uppercase drop-shadow-lg",children:"Let's start building up your net-worth"}),y.jsx("p",{className:"text-white/90 text-xl mb-8 leading-relaxed",children:"Join the ranks of successful developers by leveraging our experience and track record to accelerate your path to success. We will do what it takes to get you across the finish line with a return on your investment."}),y.jsx("div",{className:"flex items-center justify-center gap-4 text-yellow-400 text-2xl font-bold uppercase",children:"One Step At A Time..."})]})})]})]}),y.jsx("section",{className:"w-full bg-black",children:y.jsx("div",{className:"w-full",children:y.jsx("div",{className:"w-full",children:y.jsx("div",{className:"relative w-full h-[50vh] md:h-[60vh] lg:h-[70vh]",children:y.jsx(Jc,{ref:n,videoUrl:"https://vz-447b6532-fd2.b-cdn.net/65558fdd-047e-401c-b75c-210360836388/playlist.m3u8",autoPlay:!0,showControls:!0,className:"w-screen h-full object-cover",containerClassName:"relative w-screen h-full"})})})})})]})},w2=()=>{const n=b.useRef(null),[e,t]=b.useState(!1);return b.useEffect(()=>{const r=new IntersectionObserver(s=>{s.forEach(i=>{i.isIntersecting&&t(!0)})},{threshold:.1,rootMargin:"-50px 0px"});return n.current&&r.observe(n.current),()=>{n.current&&r.unobserve(n.current)}},[]),y.jsxs("section",{ref:n,className:"w-full py-20 bg-background relative overflow-hidden",children:[y.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[y.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-primary/5 rounded-full blur-3xl"}),y.jsx("div",{className:"absolute bottom-10 right-10 w-96 h-96 bg-accent/5 rounded-full blur-2xl"})]}),y.jsx("div",{className:"container mx-auto px-4 relative z-10",children:y.jsx("div",{className:`transition-all duration-1000 ease-out ${e?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:y.jsxs("div",{className:"text-center mb-12",children:[y.jsx("div",{className:"inline-block bg-primary/10 backdrop-blur-sm px-8 py-4 rounded-full border border-primary/20 mb-8",children:y.jsx("span",{className:"text-primary font-bold text-xl",children:"OUR FOCUS IS ON THE MISSING MIDDLE"})}),y.jsxs("h2",{className:"text-4xl lg:text-5xl font-black mb-6 text-foreground drop-shadow-lg",children:["THE GAP IN THE MARKET",y.jsx("span",{className:"block text-primary drop-shadow-lg",children:"MISSING MIDDLE HOUSING"})]}),y.jsx("p",{className:"text-xl text-muted-foreground max-w-3xl mx-auto leading-relaxed",children:"The missing middle is the gap in the market with the highest returns and lowest barrier to entry. There is no old boys club, no huge regulatory red tape, or huge capital requirements to get a significant return in a short amount of time. Municipalities all across the country and new lending guidelines are changing at this very moment.Your level of risk goes down when you work with us. We have been where you want to go!"})]})})}),y.jsx("div",{className:"container mx-auto px-4",children:y.jsx("div",{className:`flex justify-center transition-all duration-1200 delay-300 ease-out ${e?"opacity-100 scale-100":"opacity-0 scale-95"}`,children:y.jsx("img",{src:"/images/missing-middle-graphic-new.png",alt:"Missing Middle Density Housing Spectrum - showing progression from ADU, duplex, fourplex, courtyard complex, townhouse, multiplex, live-work housing types",className:"max-w-4xl w-full h-auto object-contain"})})}),y.jsx("div",{className:"container mx-auto px-4 relative z-10",children:y.jsx("div",{className:`text-center mt-12 transition-all duration-1000 delay-600 ease-out ${e?"opacity-100 translate-y-0":"opacity-0 translate-y-5"}`,children:y.jsx("p",{className:"text-lg text-muted-foreground max-w-4xl mx-auto",children:'The "missing middle" represents a crucial gap in housing options between single-family homes and large apartment buildings. These housing types offer opportunities for increased density while maintaining neighborhood character and affordability.'})})})]})},A2=Fc("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function lv({className:n,variant:e,...t}){return y.jsx("div",{className:be(A2({variant:e}),n),...t})}var md="focusScope.autoFocusOnMount",pd="focusScope.autoFocusOnUnmount",cv={bubbles:!1,cancelable:!0},L2="FocusScope",sb=b.forwardRef((n,e)=>{const{loop:t=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=n,[a,l]=b.useState(null),c=Hn(s),u=Hn(i),d=b.useRef(null),f=Ye(e,m=>l(m)),h=b.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;b.useEffect(()=>{if(r){let m=function(E){if(h.paused||!a)return;const T=E.target;a.contains(T)?d.current=T:Ir(d.current,{select:!0})},g=function(E){if(h.paused||!a)return;const T=E.relatedTarget;T!==null&&(a.contains(T)||Ir(d.current,{select:!0}))},v=function(E){if(document.activeElement===document.body)for(const w of E)w.removedNodes.length>0&&Ir(a)};document.addEventListener("focusin",m),document.addEventListener("focusout",g);const x=new MutationObserver(v);return a&&x.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",g),x.disconnect()}}},[r,a,h.paused]),b.useEffect(()=>{if(a){dv.add(h);const m=document.activeElement;if(!a.contains(m)){const v=new CustomEvent(md,cv);a.addEventListener(md,c),a.dispatchEvent(v),v.defaultPrevented||(I2(P2(ib(a)),{select:!0}),document.activeElement===m&&Ir(a))}return()=>{a.removeEventListener(md,c),setTimeout(()=>{const v=new CustomEvent(pd,cv);a.addEventListener(pd,u),a.dispatchEvent(v),v.defaultPrevented||Ir(m??document.body,{select:!0}),a.removeEventListener(pd,u),dv.remove(h)},0)}}},[a,c,u,h]);const p=b.useCallback(m=>{if(!t&&!r||h.paused)return;const g=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,v=document.activeElement;if(g&&v){const x=m.currentTarget,[E,T]=R2(x);E&&T?!m.shiftKey&&v===T?(m.preventDefault(),t&&Ir(E,{select:!0})):m.shiftKey&&v===E&&(m.preventDefault(),t&&Ir(T,{select:!0})):v===x&&m.preventDefault()}},[t,r,h.paused]);return y.jsx(ge.div,{tabIndex:-1,...o,ref:f,onKeyDown:p})});sb.displayName=L2;function I2(n,{select:e=!1}={}){const t=document.activeElement;for(const r of n)if(Ir(r,{select:e}),document.activeElement!==t)return}function R2(n){const e=ib(n),t=uv(e,n),r=uv(e.reverse(),n);return[t,r]}function ib(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function uv(n,e){for(const t of n)if(!C2(t,{upTo:e}))return t}function C2(n,{upTo:e}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(e!==void 0&&n===e)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function k2(n){return n instanceof HTMLInputElement&&"select"in n}function Ir(n,{select:e=!1}={}){if(n&&n.focus){const t=document.activeElement;n.focus({preventScroll:!0}),n!==t&&k2(n)&&e&&n.select()}}var dv=_2();function _2(){let n=[];return{add(e){const t=n[0];e!==t&&(t==null||t.pause()),n=fv(n,e),n.unshift(e)},remove(e){var t;n=fv(n,e),(t=n[0])==null||t.resume()}}}function fv(n,e){const t=[...n],r=t.indexOf(e);return r!==-1&&t.splice(r,1),t}function P2(n){return n.filter(e=>e.tagName!=="A")}var gd=0;function D2(){b.useEffect(()=>{const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",n[0]??hv()),document.body.insertAdjacentElement("beforeend",n[1]??hv()),gd++,()=>{gd===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),gd--}},[])}function hv(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.outline="none",n.style.opacity="0",n.style.position="fixed",n.style.pointerEvents="none",n}var Fn=function(){return Fn=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Fn.apply(this,arguments)};function ob(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function N2(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return n.concat(i||Array.prototype.slice.call(e))}var Il="right-scroll-bar-position",Rl="width-before-scroll-bar",O2="with-scroll-bars-hidden",M2="--removed-body-scroll-bar-size";function vd(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function F2(n,e){var t=b.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(r){var s=t.value;s!==r&&(t.value=r,t.callback(r,s))}}}})[0];return t.callback=e,t.facade}var $2=typeof window<"u"?b.useLayoutEffect:b.useEffect,mv=new WeakMap;function B2(n,e){var t=F2(null,function(r){return n.forEach(function(s){return vd(s,r)})});return $2(function(){var r=mv.get(t);if(r){var s=new Set(r),i=new Set(n),o=t.current;s.forEach(function(a){i.has(a)||vd(a,null)}),i.forEach(function(a){s.has(a)||vd(a,o)})}mv.set(t,n)},[n]),t}function U2(n){return n}function j2(n,e){e===void 0&&(e=U2);var t=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(i){var o=e(i,r);return t.push(o),function(){t=t.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(r=!0;t.length;){var o=t;t=[],o.forEach(i)}t={push:function(a){return i(a)},filter:function(){return t}}},assignMedium:function(i){r=!0;var o=[];if(t.length){var a=t;t=[],a.forEach(i),o=t}var l=function(){var u=o;o=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),t={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),t}}}};return s}function G2(n){n===void 0&&(n={});var e=j2(null);return e.options=Fn({async:!0,ssr:!1},n),e}var ab=function(n){var e=n.sideCar,t=ob(n,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return b.createElement(r,Fn({},t))};ab.isSideCarExport=!0;function V2(n,e){return n.useMedium(e),ab}var lb=G2(),yd=function(){},nu=b.forwardRef(function(n,e){var t=b.useRef(null),r=b.useState({onScrollCapture:yd,onWheelCapture:yd,onTouchMoveCapture:yd}),s=r[0],i=r[1],o=n.forwardProps,a=n.children,l=n.className,c=n.removeScrollBar,u=n.enabled,d=n.shards,f=n.sideCar,h=n.noRelative,p=n.noIsolation,m=n.inert,g=n.allowPinchZoom,v=n.as,x=v===void 0?"div":v,E=n.gapMode,T=ob(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),w=f,L=B2([t,e]),A=Fn(Fn({},T),s);return b.createElement(b.Fragment,null,u&&b.createElement(w,{sideCar:lb,removeScrollBar:c,shards:d,noRelative:h,noIsolation:p,inert:m,setCallbacks:i,allowPinchZoom:!!g,lockRef:t,gapMode:E}),o?b.cloneElement(b.Children.only(a),Fn(Fn({},A),{ref:L})):b.createElement(x,Fn({},A,{className:l,ref:L}),a))});nu.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};nu.classNames={fullWidth:Rl,zeroRight:Il};var H2=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function K2(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var e=H2();return e&&n.setAttribute("nonce",e),n}function z2(n,e){n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}function W2(n){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(n)}var Y2=function(){var n=0,e=null;return{add:function(t){n==0&&(e=K2())&&(z2(e,t),W2(e)),n++},remove:function(){n--,!n&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},q2=function(){var n=Y2();return function(e,t){b.useEffect(function(){return n.add(e),function(){n.remove()}},[e&&t])}},cb=function(){var n=q2(),e=function(t){var r=t.styles,s=t.dynamic;return n(r,s),null};return e},Q2={left:0,top:0,right:0,gap:0},xd=function(n){return parseInt(n||"",10)||0},X2=function(n){var e=window.getComputedStyle(document.body),t=e[n==="padding"?"paddingLeft":"marginLeft"],r=e[n==="padding"?"paddingTop":"marginTop"],s=e[n==="padding"?"paddingRight":"marginRight"];return[xd(t),xd(r),xd(s)]},Z2=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return Q2;var e=X2(n),t=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-t+e[2]-e[0])}},J2=cb(),Ti="data-scroll-locked",eM=function(n,e,t,r){var s=n.left,i=n.top,o=n.right,a=n.gap;return t===void 0&&(t="margin"),`
  .`.concat(O2,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(Ti,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),t==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),t==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Il,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Rl,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Il," .").concat(Il,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Rl," .").concat(Rl,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Ti,`] {
    `).concat(M2,": ").concat(a,`px;
  }
`)},pv=function(){var n=parseInt(document.body.getAttribute(Ti)||"0",10);return isFinite(n)?n:0},tM=function(){b.useEffect(function(){return document.body.setAttribute(Ti,(pv()+1).toString()),function(){var n=pv()-1;n<=0?document.body.removeAttribute(Ti):document.body.setAttribute(Ti,n.toString())}},[])},nM=function(n){var e=n.noRelative,t=n.noImportant,r=n.gapMode,s=r===void 0?"margin":r;tM();var i=b.useMemo(function(){return Z2(s)},[s]);return b.createElement(J2,{styles:eM(i,!e,s,t?"":"!important")})},Xf=!1;if(typeof window<"u")try{var Ja=Object.defineProperty({},"passive",{get:function(){return Xf=!0,!0}});window.addEventListener("test",Ja,Ja),window.removeEventListener("test",Ja,Ja)}catch{Xf=!1}var zs=Xf?{passive:!1}:!1,rM=function(n){return n.tagName==="TEXTAREA"},ub=function(n,e){if(!(n instanceof Element))return!1;var t=window.getComputedStyle(n);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!rM(n)&&t[e]==="visible")},sM=function(n){return ub(n,"overflowY")},iM=function(n){return ub(n,"overflowX")},gv=function(n,e){var t=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=db(n,r);if(s){var i=fb(n,r),o=i[1],a=i[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==t.body);return!1},oM=function(n){var e=n.scrollTop,t=n.scrollHeight,r=n.clientHeight;return[e,t,r]},aM=function(n){var e=n.scrollLeft,t=n.scrollWidth,r=n.clientWidth;return[e,t,r]},db=function(n,e){return n==="v"?sM(e):iM(e)},fb=function(n,e){return n==="v"?oM(e):aM(e)},lM=function(n,e){return n==="h"&&e==="rtl"?-1:1},cM=function(n,e,t,r,s){var i=lM(n,window.getComputedStyle(e).direction),o=i*r,a=t.target,l=e.contains(a),c=!1,u=o>0,d=0,f=0;do{if(!a)break;var h=fb(n,a),p=h[0],m=h[1],g=h[2],v=m-g-i*p;(p||v)&&db(n,a)&&(d+=v,f+=p);var x=a.parentNode;a=x&&x.nodeType===Node.DOCUMENT_FRAGMENT_NODE?x.host:x}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(Math.abs(d)<1||!s)||!u&&(Math.abs(f)<1||!s))&&(c=!0),c},el=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},vv=function(n){return[n.deltaX,n.deltaY]},yv=function(n){return n&&"current"in n?n.current:n},uM=function(n,e){return n[0]===e[0]&&n[1]===e[1]},dM=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},fM=0,Ws=[];function hM(n){var e=b.useRef([]),t=b.useRef([0,0]),r=b.useRef(),s=b.useState(fM++)[0],i=b.useState(cb)[0],o=b.useRef(n);b.useEffect(function(){o.current=n},[n]),b.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(s));var m=N2([n.lockRef.current],(n.shards||[]).map(yv),!0).filter(Boolean);return m.forEach(function(g){return g.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),m.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(s))})}}},[n.inert,n.lockRef.current,n.shards]);var a=b.useCallback(function(m,g){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!o.current.allowPinchZoom;var v=el(m),x=t.current,E="deltaX"in m?m.deltaX:x[0]-v[0],T="deltaY"in m?m.deltaY:x[1]-v[1],w,L=m.target,A=Math.abs(E)>Math.abs(T)?"h":"v";if("touches"in m&&A==="h"&&L.type==="range")return!1;var R=gv(A,L);if(!R)return!0;if(R?w=A:(w=A==="v"?"h":"v",R=gv(A,L)),!R)return!1;if(!r.current&&"changedTouches"in m&&(E||T)&&(r.current=w),!w)return!0;var C=r.current||w;return cM(C,g,m,C==="h"?E:T,!0)},[]),l=b.useCallback(function(m){var g=m;if(!(!Ws.length||Ws[Ws.length-1]!==i)){var v="deltaY"in g?vv(g):el(g),x=e.current.filter(function(w){return w.name===g.type&&(w.target===g.target||g.target===w.shadowParent)&&uM(w.delta,v)})[0];if(x&&x.should){g.cancelable&&g.preventDefault();return}if(!x){var E=(o.current.shards||[]).map(yv).filter(Boolean).filter(function(w){return w.contains(g.target)}),T=E.length>0?a(g,E[0]):!o.current.noIsolation;T&&g.cancelable&&g.preventDefault()}}},[]),c=b.useCallback(function(m,g,v,x){var E={name:m,delta:g,target:v,should:x,shadowParent:mM(v)};e.current.push(E),setTimeout(function(){e.current=e.current.filter(function(T){return T!==E})},1)},[]),u=b.useCallback(function(m){t.current=el(m),r.current=void 0},[]),d=b.useCallback(function(m){c(m.type,vv(m),m.target,a(m,n.lockRef.current))},[]),f=b.useCallback(function(m){c(m.type,el(m),m.target,a(m,n.lockRef.current))},[]);b.useEffect(function(){return Ws.push(i),n.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",l,zs),document.addEventListener("touchmove",l,zs),document.addEventListener("touchstart",u,zs),function(){Ws=Ws.filter(function(m){return m!==i}),document.removeEventListener("wheel",l,zs),document.removeEventListener("touchmove",l,zs),document.removeEventListener("touchstart",u,zs)}},[]);var h=n.removeScrollBar,p=n.inert;return b.createElement(b.Fragment,null,p?b.createElement(i,{styles:dM(s)}):null,h?b.createElement(nM,{noRelative:n.noRelative,gapMode:n.gapMode}):null)}function mM(n){for(var e=null;n!==null;)n instanceof ShadowRoot&&(e=n.host,n=n.host),n=n.parentNode;return e}const pM=V2(lb,hM);var hb=b.forwardRef(function(n,e){return b.createElement(nu,Fn({},n,{ref:e,sideCar:pM}))});hb.classNames=nu.classNames;var gM=function(n){if(typeof document>"u")return null;var e=Array.isArray(n)?n[0]:n;return e.ownerDocument.body},Ys=new WeakMap,tl=new WeakMap,nl={},Ed=0,mb=function(n){return n&&(n.host||mb(n.parentNode))},vM=function(n,e){return e.map(function(t){if(n.contains(t))return t;var r=mb(t);return r&&n.contains(r)?r:(console.error("aria-hidden",t,"in not contained inside",n,". Doing nothing"),null)}).filter(function(t){return!!t})},yM=function(n,e,t,r){var s=vM(e,Array.isArray(n)?n:[n]);nl[t]||(nl[t]=new WeakMap);var i=nl[t],o=[],a=new Set,l=new Set(s),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};s.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(f){if(a.has(f))u(f);else try{var h=f.getAttribute(r),p=h!==null&&h!=="false",m=(Ys.get(f)||0)+1,g=(i.get(f)||0)+1;Ys.set(f,m),i.set(f,g),o.push(f),m===1&&p&&tl.set(f,!0),g===1&&f.setAttribute(t,"true"),p||f.setAttribute(r,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return u(e),a.clear(),Ed++,function(){o.forEach(function(d){var f=Ys.get(d)-1,h=i.get(d)-1;Ys.set(d,f),i.set(d,h),f||(tl.has(d)||d.removeAttribute(r),tl.delete(d)),h||d.removeAttribute(t)}),Ed--,Ed||(Ys=new WeakMap,Ys=new WeakMap,tl=new WeakMap,nl={})}},xM=function(n,e,t){t===void 0&&(t="data-aria-hidden");var r=Array.from(Array.isArray(n)?n:[n]),s=gM(n);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),yM(r,s,t,"aria-hidden")):function(){return null}},ru="Dialog",[pb,TF]=os(ru),[EM,bn]=pb(ru),gb=n=>{const{__scopeDialog:e,children:t,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=n,a=b.useRef(null),l=b.useRef(null),[c,u]=Ki({prop:r,defaultProp:s??!1,onChange:i,caller:ru});return y.jsx(EM,{scope:e,triggerRef:a,contentRef:l,contentId:wo(),titleId:wo(),descriptionId:wo(),open:c,onOpenChange:u,onOpenToggle:b.useCallback(()=>u(d=>!d),[u]),modal:o,children:t})};gb.displayName=ru;var vb="DialogTrigger",SM=b.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=bn(vb,t),i=Ye(e,s.triggerRef);return y.jsx(ge.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":jm(s.open),...r,ref:i,onClick:xe(n.onClick,s.onOpenToggle)})});SM.displayName=vb;var Bm="DialogPortal",[TM,yb]=pb(Bm,{forceMount:void 0}),xb=n=>{const{__scopeDialog:e,forceMount:t,children:r,container:s}=n,i=bn(Bm,e);return y.jsx(TM,{scope:e,forceMount:t,children:b.Children.map(r,o=>y.jsx(as,{present:t||i.open,children:y.jsx(Yh,{asChild:!0,container:s,children:o})}))})};xb.displayName=Bm;var gc="DialogOverlay",Eb=b.forwardRef((n,e)=>{const t=yb(gc,n.__scopeDialog),{forceMount:r=t.forceMount,...s}=n,i=bn(gc,n.__scopeDialog);return i.modal?y.jsx(as,{present:r||i.open,children:y.jsx(wM,{...s,ref:e})}):null});Eb.displayName=gc;var bM=Ko("DialogOverlay.RemoveScroll"),wM=b.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=bn(gc,t);return y.jsx(hb,{as:bM,allowPinchZoom:!0,shards:[s.contentRef],children:y.jsx(ge.div,{"data-state":jm(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Os="DialogContent",Sb=b.forwardRef((n,e)=>{const t=yb(Os,n.__scopeDialog),{forceMount:r=t.forceMount,...s}=n,i=bn(Os,n.__scopeDialog);return y.jsx(as,{present:r||i.open,children:i.modal?y.jsx(AM,{...s,ref:e}):y.jsx(LM,{...s,ref:e})})});Sb.displayName=Os;var AM=b.forwardRef((n,e)=>{const t=bn(Os,n.__scopeDialog),r=b.useRef(null),s=Ye(e,t.contentRef,r);return b.useEffect(()=>{const i=r.current;if(i)return xM(i)},[]),y.jsx(Tb,{...n,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:xe(n.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=t.triggerRef.current)==null||o.focus()}),onPointerDownOutside:xe(n.onPointerDownOutside,i=>{const o=i.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&i.preventDefault()}),onFocusOutside:xe(n.onFocusOutside,i=>i.preventDefault())})}),LM=b.forwardRef((n,e)=>{const t=bn(Os,n.__scopeDialog),r=b.useRef(!1),s=b.useRef(!1);return y.jsx(Tb,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=n.onCloseAutoFocus)==null||o.call(n,i),i.defaultPrevented||(r.current||(a=t.triggerRef.current)==null||a.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=n.onInteractOutside)==null||l.call(n,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((c=t.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),Tb=b.forwardRef((n,e)=>{const{__scopeDialog:t,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=n,a=bn(Os,t),l=b.useRef(null),c=Ye(e,l);return D2(),y.jsxs(y.Fragment,{children:[y.jsx(sb,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:y.jsx(Nc,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":jm(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),y.jsxs(y.Fragment,{children:[y.jsx(IM,{titleId:a.titleId}),y.jsx(CM,{contentRef:l,descriptionId:a.descriptionId})]})]})}),Um="DialogTitle",bb=b.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=bn(Um,t);return y.jsx(ge.h2,{id:s.titleId,...r,ref:e})});bb.displayName=Um;var wb="DialogDescription",Ab=b.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=bn(wb,t);return y.jsx(ge.p,{id:s.descriptionId,...r,ref:e})});Ab.displayName=wb;var Lb="DialogClose",Ib=b.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=bn(Lb,t);return y.jsx(ge.button,{type:"button",...r,ref:e,onClick:xe(n.onClick,()=>s.onOpenChange(!1))})});Ib.displayName=Lb;function jm(n){return n?"open":"closed"}var Rb="DialogTitleWarning",[bF,Cb]=BA(Rb,{contentName:Os,titleName:Um,docsSlug:"dialog"}),IM=({titleId:n})=>{const e=Cb(Rb),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return b.useEffect(()=>{n&&(document.getElementById(n)||console.error(t))},[t,n]),null},RM="DialogDescriptionWarning",CM=({contentRef:n,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Cb(RM).contentName}}.`;return b.useEffect(()=>{var i;const s=(i=n.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,n,e]),null},kM=gb,_M=xb,kb=Eb,_b=Sb,Pb=bb,Db=Ab,PM=Ib;const DM=kM,NM=_M,Nb=b.forwardRef(({className:n,...e},t)=>y.jsx(kb,{ref:t,className:be("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...e}));Nb.displayName=kb.displayName;const Ob=b.forwardRef(({className:n,children:e,...t},r)=>y.jsxs(NM,{children:[y.jsx(Nb,{}),y.jsxs(_b,{ref:r,className:be("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n),...t,children:[e,y.jsxs(PM,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[y.jsx(zi,{className:"h-4 w-4"}),y.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ob.displayName=_b.displayName;const OM=b.forwardRef(({className:n,...e},t)=>y.jsx(Pb,{ref:t,className:be("text-lg font-semibold leading-none tracking-tight",n),...e}));OM.displayName=Pb.displayName;const MM=b.forwardRef(({className:n,...e},t)=>y.jsx(Db,{ref:t,className:be("text-sm text-muted-foreground",n),...e}));MM.displayName=Db.displayName;const FM=()=>{const[n,e]=b.useState(null),[t,r]=b.useState(!1),[s,i]=b.useState([]),[o,a]=b.useState(0),l=[{id:1,title:"Glen Ave Development",location:"Houston, TX",status:"Pending Construction",value:"$1.2M",timeline:"6 months",team:"4 units",images:["/lovable-uploads/4a2cd88c-1e89-4f93-a9e5-ccb59cbce7a6.png","/lovable-uploads/f48a2dc0-af37-42d8-824b-fc482c4ceb7f.png"],story:"From vacant lot to luxury 4-unit, two separate duplex development. This project showcases our end-to-end process from land acquisition through final construction.",highlights:["Zoning Approval in 30 Days","15% Under Budget","Pre-sold 2 Units"]},{id:2,title:"Calhoun Estates Development",location:"Houston, TX",status:"Planning Phase",value:"$800K",timeline:"9 months",team:"4 units",images:["/lovable-uploads/5df938db-8063-4672-9fdb-4bb75420dbc7.png","/lovable-uploads/5df938db-8063-4672-9fdb-4bb75420dbc7.png"],story:"Transforming underutilized riverside property into modern family housing. Complex permitting and environmental considerations successfully navigated.",highlights:["Environmental Clearance","Community Support","Innovative Design"]},{id:3,title:"Downtown Infill Project",location:"Dallas, TX",status:"Completed",value:"$950K",timeline:"6 months",team:"3 units",images:["/lovable-uploads/d9e364d3-b8e5-4fa9-aa0f-abb5fc4965a8.png","/lovable-uploads/EB_Turnkey_LinkThumb.png"],story:"Urban infill success story. Maximized density while respecting neighborhood character. All units sold before completion.",highlights:["100% Pre-sold","Neighborhood Integration","ROI: 28%"]}],c=m=>{switch(m){case"Completed":return"bg-green-500";case"Under Construction":return"bg-yellow-500";case"Planning Phase":return"bg-blue-500";default:return"bg-gray-500"}},u=(m,g=0)=>{i(m),a(g),r(!0)},d=()=>{a(m=>(m+1)%s.length)},f=()=>{a(m=>(m-1+s.length)%s.length)},h=(m,g)=>{m.target.closest(".image-clickable")||e(n===g?null:g)},p=(m,g,v=0)=>{m.stopPropagation(),u(g,v)};return y.jsxs("section",{className:"py-12 bg-gradient-to-br from-background via-background/50 to-secondary/20 relative overflow-hidden",children:[y.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[y.jsx("div",{className:"absolute top-40 right-20 w-96 h-96 bg-primary/10 rounded-full blur-3xl"}),y.jsx("div",{className:"absolute bottom-20 left-40 w-80 h-80 bg-accent/10 rounded-full blur-2xl"})]}),y.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[y.jsxs("div",{className:"text-center mb-20",children:[y.jsx("div",{className:"inline-block bg-primary/10 backdrop-blur-sm px-8 py-4 rounded-full border border-primary/20 mb-8",children:y.jsx("span",{className:"text-primary font-bold text-xl",children:"PROJECT GALLERY"})}),y.jsxs("h2",{className:"text-5xl lg:text-6xl font-black mb-8 text-foreground drop-shadow-lg",children:["CLIENT",y.jsx("span",{className:"block text-primary drop-shadow-lg",children:"SHOWCASE"})]}),y.jsx("p",{className:"text-xl text-muted-foreground max-w-4xl mx-auto leading-relaxed",children:"Real projects, real results. See how we've transformed visions into reality for developers just like you."})]}),y.jsx("div",{className:"grid lg:grid-cols-3 gap-8",children:l.map((m,g)=>y.jsx(eu,{className:`group cursor-pointer transition-all duration-500 hover:shadow-2xl border-2 transform ${n===m.id?"border-green-500 shadow-2xl bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950 dark:to-green-900 -translate-y-6 scale-105":"hover:-translate-y-2 border-border hover:border-primary/50"}`,onClick:v=>h(v,m.id),children:y.jsxs(tu,{className:"p-0",children:[y.jsxs("div",{className:"relative h-64 overflow-hidden rounded-t-lg image-clickable",children:[y.jsxs("div",{className:"flex transition-transform duration-500 ease-in-out cursor-pointer group/image",onClick:v=>p(v,m.images,0),children:[y.jsx("img",{src:m.images[0],alt:`${m.title} - Main view`,className:"w-full h-64 object-cover group-hover:scale-110 transition-transform duration-500"}),y.jsx("div",{className:"absolute inset-0 bg-black/20 opacity-0 group-hover/image:opacity-100 transition-opacity duration-300 flex items-center justify-center",children:y.jsx(pg,{className:"w-12 h-12 text-white animate-pulse"})})]}),y.jsx("div",{className:"absolute top-4 left-4 pointer-events-none",children:y.jsx(lv,{className:`${c(m.status)} text-white font-semibold`,children:m.status})}),y.jsxs("div",{className:"absolute top-4 right-4 bg-black/70 text-white px-3 py-1 rounded-full text-sm flex items-center gap-1 pointer-events-none",children:[y.jsx(jL,{size:14}),m.images.length]})]}),y.jsxs("div",{className:"p-6",children:[y.jsx("h3",{className:"text-xl font-bold mb-2 group-hover:text-primary transition-colors",children:m.title}),y.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4 text-sm text-muted-foreground",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(HL,{size:14,className:"text-primary"}),m.location]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(BL,{size:14,className:"text-primary"}),m.value]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(FL,{size:14,className:"text-primary"}),m.timeline]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(zL,{size:14,className:"text-primary"}),m.team]})]}),n===m.id&&y.jsxs("div",{className:"mt-6 pt-6 border-t border-border animate-in slide-in-from-top-2 duration-300",children:[y.jsx("p",{className:"text-muted-foreground mb-4 leading-relaxed",children:m.story}),y.jsxs("div",{className:"mb-4",children:[y.jsx("h4",{className:"font-semibold mb-2 text-primary",children:"Key Highlights:"}),y.jsx("div",{className:"flex flex-wrap gap-2",children:m.highlights.map((v,x)=>y.jsx(lv,{variant:"secondary",className:"text-xs",children:v},x))})]}),m.images.length>1&&y.jsx("div",{className:"grid grid-cols-2 gap-2",children:m.images.slice(1).map((v,x)=>y.jsxs("div",{className:"relative group/thumb cursor-pointer image-clickable",onClick:E=>p(E,m.images,x+1),children:[y.jsx("img",{src:v,alt:`${m.title} - Additional view ${x+1}`,className:"w-full h-24 object-cover rounded-lg hover:scale-105 transition-transform"}),y.jsx("div",{className:"absolute inset-0 bg-black/20 opacity-0 group-hover/thumb:opacity-100 transition-opacity duration-300 flex items-center justify-center rounded-lg",children:y.jsx(pg,{className:"w-6 h-6 text-white animate-pulse"})})]},x))})]}),y.jsx("div",{className:"mt-4 text-center",children:y.jsx("span",{className:"text-xs text-primary font-medium",children:n===m.id?"Click to collapse":"Click to view details"})})]})]})},m.id))}),y.jsx(DM,{open:t,onOpenChange:r,children:y.jsx(Ob,{className:"max-w-4xl w-full p-0 bg-black/95 border-0",children:y.jsxs("div",{className:"relative",children:[y.jsx("button",{onClick:()=>r(!1),className:"absolute top-4 right-4 z-50 p-2 bg-black/50 hover:bg-black/70 rounded-full text-white transition-colors",children:y.jsx(zi,{size:24})}),y.jsxs("div",{className:"relative flex items-center justify-center min-h-[60vh]",children:[y.jsx("img",{src:s[o],alt:`Enlarged view ${o+1}`,className:"max-w-full max-h-[80vh] object-contain"}),s.length>1&&y.jsxs(y.Fragment,{children:[y.jsx("button",{onClick:f,className:"absolute left-4 top-1/2 -translate-y-1/2 p-3 bg-black/50 hover:bg-black/70 rounded-full text-white transition-colors",children:""}),y.jsx("button",{onClick:d,className:"absolute right-4 top-1/2 -translate-y-1/2 p-3 bg-black/50 hover:bg-black/70 rounded-full text-white transition-colors",children:""})]})]}),s.length>1&&y.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/70 text-white px-4 py-2 rounded-full text-sm",children:[o+1," of ",s.length]})]})})})]})]})},$M=()=>y.jsxs("section",{className:"py-20 bg-gradient-to-br from-accent/20 via-background to-primary/10 relative overflow-hidden",children:[y.jsx("div",{className:"absolute inset-0",children:y.jsxs("div",{className:"absolute inset-0 opacity-30",children:[y.jsx("img",{src:"/lovable-uploads/5df938db-8063-4672-9fdb-4bb75420dbc7.png",alt:"Construction site plan and architectural drawing",className:"w-full h-full object-cover object-center"}),y.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background/20 via-transparent to-background/20"})]})}),y.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[y.jsx("div",{className:"absolute inset-0 opacity-5",children:y.jsx("div",{className:"w-full h-full",style:{backgroundImage:`
              linear-gradient(45deg, rgba(120, 100, 25, 0.1) 25%, transparent 25%),
              linear-gradient(-45deg, rgba(120, 100, 25, 0.1) 25%, transparent 25%),
              linear-gradient(45deg, transparent 75%, rgba(120, 100, 25, 0.1) 75%),
              linear-gradient(-45deg, transparent 75%, rgba(120, 100, 25, 0.1) 75%)
            `,backgroundSize:"30px 30px",backgroundPosition:"0 0, 0 15px, 15px -15px, -15px 0px"}})}),y.jsx("div",{className:"absolute inset-0 opacity-8",children:y.jsx("div",{className:"w-full h-full bg-gradient-to-br from-amber-900/10 via-amber-700/5 to-amber-800/10"})})]}),y.jsx("div",{className:"container mx-auto px-4",children:y.jsxs("div",{className:"grid lg:grid-cols-2 gap-16 items-center",children:[y.jsx("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl p-8 shadow-lg border border-white/20",children:y.jsxs("div",{className:"space-y-8",children:[y.jsxs("div",{className:"space-y-4",children:[y.jsx("h2",{className:"text-4xl font-bold drop-shadow-lg",children:"Why Choose TurnKey Development?"}),y.jsx("p",{className:"text-xl text-muted-foreground",children:"With over 15 years of experience in business consulting, we've helped hundreds of organizations achieve their strategic objectives and overcome complex challenges."})]}),y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"flex items-start space-x-4",children:[y.jsx("div",{className:"w-6 h-6 bg-primary rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:y.jsx("svg",{className:"w-4 h-4 text-primary-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Proven Track Record"}),y.jsx("p",{className:"text-muted-foreground",children:"Successfully delivered 500+ projects with 98% client satisfaction rate."})]})]}),y.jsxs("div",{className:"flex items-start space-x-4",children:[y.jsx("div",{className:"w-6 h-6 bg-primary rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:y.jsx("svg",{className:"w-4 h-4 text-primary-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Industry Expertise"}),y.jsx("p",{className:"text-muted-foreground",children:"Deep knowledge across multiple industries including technology, healthcare, finance, and manufacturing."})]})]}),y.jsxs("div",{className:"flex items-start space-x-4",children:[y.jsx("div",{className:"w-6 h-6 bg-primary rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:y.jsx("svg",{className:"w-4 h-4 text-primary-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Tailored Solutions"}),y.jsx("p",{className:"text-muted-foreground",children:"Custom strategies designed specifically for your unique business challenges and objectives."})]})]})]}),y.jsx(Qi,{size:"lg",className:"text-lg px-8 py-6",children:"Start Your Transformation"})]})}),y.jsx("div",{className:"relative",children:y.jsxs("div",{className:"aspect-[4/5] bg-gradient-primary rounded-2xl overflow-hidden shadow-2xl relative",children:[y.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent"}),y.jsxs("div",{className:"absolute inset-4 rounded-xl overflow-hidden",children:[y.jsx("img",{src:"/lovable-uploads/099d43ed-30ee-447a-8302-8f31d970c7b5.png",alt:"TurnKey Development founder and business consultant",className:"w-full h-full object-cover"}),y.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-primary/60 via-transparent to-transparent"})]}),y.jsx("div",{className:"absolute bottom-4 right-4 w-24 h-24 rounded-xl overflow-hidden border-4 border-white/30",children:y.jsx("img",{src:"/lovable-uploads/4a2cd88c-1e89-4f93-a9e5-ccb59cbce7a6.png",alt:"Construction project showcase",className:"w-full h-full object-cover"})}),y.jsxs("div",{className:"relative z-10 h-full p-8 flex flex-col justify-between",children:[y.jsxs("div",{className:"space-y-4",children:[y.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center border border-white/30",children:y.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),y.jsx("h3",{className:"text-2xl font-bold text-white",children:"Growth-Focused Results"}),y.jsx("p",{className:"text-white/90",children:"Average 40% improvement in operational efficiency within the first 6 months."})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-lg p-4 text-center border border-white/30",children:[y.jsx("div",{className:"text-2xl font-bold text-accent",children:"40%"}),y.jsx("div",{className:"text-sm text-white/80",children:"Efficiency Gain"})]}),y.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-lg p-4 text-center border border-white/30",children:[y.jsx("div",{className:"text-2xl font-bold text-accent",children:"6mo"}),y.jsx("div",{className:"text-sm text-white/80",children:"Avg Timeline"})]})]})]})]})})]})})]});var su="Collapsible",[BM,Mb]=os(su),[UM,Gm]=BM(su),Fb=b.forwardRef((n,e)=>{const{__scopeCollapsible:t,open:r,defaultOpen:s,disabled:i,onOpenChange:o,...a}=n,[l,c]=Ki({prop:r,defaultProp:s??!1,onChange:o,caller:su});return y.jsx(UM,{scope:t,disabled:i,contentId:wo(),open:l,onOpenToggle:b.useCallback(()=>c(u=>!u),[c]),children:y.jsx(ge.div,{"data-state":Hm(l),"data-disabled":i?"":void 0,...a,ref:e})})});Fb.displayName=su;var $b="CollapsibleTrigger",Bb=b.forwardRef((n,e)=>{const{__scopeCollapsible:t,...r}=n,s=Gm($b,t);return y.jsx(ge.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":Hm(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...r,ref:e,onClick:xe(n.onClick,s.onOpenToggle)})});Bb.displayName=$b;var Vm="CollapsibleContent",Ub=b.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=Gm(Vm,n.__scopeCollapsible);return y.jsx(as,{present:t||s.open,children:({present:i})=>y.jsx(jM,{...r,ref:e,present:i})})});Ub.displayName=Vm;var jM=b.forwardRef((n,e)=>{const{__scopeCollapsible:t,present:r,children:s,...i}=n,o=Gm(Vm,t),[a,l]=b.useState(r),c=b.useRef(null),u=Ye(e,c),d=b.useRef(0),f=d.current,h=b.useRef(0),p=h.current,m=o.open||a,g=b.useRef(m),v=b.useRef(void 0);return b.useEffect(()=>{const x=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(x)},[]),Kn(()=>{const x=c.current;if(x){v.current=v.current||{transitionDuration:x.style.transitionDuration,animationName:x.style.animationName},x.style.transitionDuration="0s",x.style.animationName="none";const E=x.getBoundingClientRect();d.current=E.height,h.current=E.width,g.current||(x.style.transitionDuration=v.current.transitionDuration,x.style.animationName=v.current.animationName),l(r)}},[o.open,r]),y.jsx(ge.div,{"data-state":Hm(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!m,...i,ref:u,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":p?`${p}px`:void 0,...n.style},children:m&&s})});function Hm(n){return n?"open":"closed"}var GM=Fb,VM=Bb,HM=Ub,KM=b.createContext(void 0);function zM(n){const e=b.useContext(KM);return n||e||"ltr"}var wn="Accordion",WM=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Km,YM,qM]=Hx(wn),[iu,wF]=os(wn,[qM,Mb]),zm=Mb(),jb=z.forwardRef((n,e)=>{const{type:t,...r}=n,s=r,i=r;return y.jsx(Km.Provider,{scope:n.__scopeAccordion,children:t==="multiple"?y.jsx(JM,{...i,ref:e}):y.jsx(ZM,{...s,ref:e})})});jb.displayName=wn;var[Gb,QM]=iu(wn),[Vb,XM]=iu(wn,{collapsible:!1}),ZM=z.forwardRef((n,e)=>{const{value:t,defaultValue:r,onValueChange:s=()=>{},collapsible:i=!1,...o}=n,[a,l]=Ki({prop:t,defaultProp:r??"",onChange:s,caller:wn});return y.jsx(Gb,{scope:n.__scopeAccordion,value:z.useMemo(()=>a?[a]:[],[a]),onItemOpen:l,onItemClose:z.useCallback(()=>i&&l(""),[i,l]),children:y.jsx(Vb,{scope:n.__scopeAccordion,collapsible:i,children:y.jsx(Hb,{...o,ref:e})})})}),JM=z.forwardRef((n,e)=>{const{value:t,defaultValue:r,onValueChange:s=()=>{},...i}=n,[o,a]=Ki({prop:t,defaultProp:r??[],onChange:s,caller:wn}),l=z.useCallback(u=>a((d=[])=>[...d,u]),[a]),c=z.useCallback(u=>a((d=[])=>d.filter(f=>f!==u)),[a]);return y.jsx(Gb,{scope:n.__scopeAccordion,value:o,onItemOpen:l,onItemClose:c,children:y.jsx(Vb,{scope:n.__scopeAccordion,collapsible:!0,children:y.jsx(Hb,{...i,ref:e})})})}),[eF,ou]=iu(wn),Hb=z.forwardRef((n,e)=>{const{__scopeAccordion:t,disabled:r,dir:s,orientation:i="vertical",...o}=n,a=z.useRef(null),l=Ye(a,e),c=YM(t),d=zM(s)==="ltr",f=xe(n.onKeyDown,h=>{var R;if(!WM.includes(h.key))return;const p=h.target,m=c().filter(C=>{var I;return!((I=C.ref.current)!=null&&I.disabled)}),g=m.findIndex(C=>C.ref.current===p),v=m.length;if(g===-1)return;h.preventDefault();let x=g;const E=0,T=v-1,w=()=>{x=g+1,x>T&&(x=E)},L=()=>{x=g-1,x<E&&(x=T)};switch(h.key){case"Home":x=E;break;case"End":x=T;break;case"ArrowRight":i==="horizontal"&&(d?w():L());break;case"ArrowDown":i==="vertical"&&w();break;case"ArrowLeft":i==="horizontal"&&(d?L():w());break;case"ArrowUp":i==="vertical"&&L();break}const A=x%v;(R=m[A].ref.current)==null||R.focus()});return y.jsx(eF,{scope:t,disabled:r,direction:s,orientation:i,children:y.jsx(Km.Slot,{scope:t,children:y.jsx(ge.div,{...o,"data-orientation":i,ref:l,onKeyDown:r?void 0:f})})})}),vc="AccordionItem",[tF,Wm]=iu(vc),Kb=z.forwardRef((n,e)=>{const{__scopeAccordion:t,value:r,...s}=n,i=ou(vc,t),o=QM(vc,t),a=zm(t),l=wo(),c=r&&o.value.includes(r)||!1,u=i.disabled||n.disabled;return y.jsx(tF,{scope:t,open:c,disabled:u,triggerId:l,children:y.jsx(GM,{"data-orientation":i.orientation,"data-state":Xb(c),...a,...s,ref:e,disabled:u,open:c,onOpenChange:d=>{d?o.onItemOpen(r):o.onItemClose(r)}})})});Kb.displayName=vc;var zb="AccordionHeader",Wb=z.forwardRef((n,e)=>{const{__scopeAccordion:t,...r}=n,s=ou(wn,t),i=Wm(zb,t);return y.jsx(ge.h3,{"data-orientation":s.orientation,"data-state":Xb(i.open),"data-disabled":i.disabled?"":void 0,...r,ref:e})});Wb.displayName=zb;var Zf="AccordionTrigger",Yb=z.forwardRef((n,e)=>{const{__scopeAccordion:t,...r}=n,s=ou(wn,t),i=Wm(Zf,t),o=XM(Zf,t),a=zm(t);return y.jsx(Km.ItemSlot,{scope:t,children:y.jsx(VM,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":s.orientation,id:i.triggerId,...a,...r,ref:e})})});Yb.displayName=Zf;var qb="AccordionContent",Qb=z.forwardRef((n,e)=>{const{__scopeAccordion:t,...r}=n,s=ou(wn,t),i=Wm(qb,t),o=zm(t);return y.jsx(HM,{role:"region","aria-labelledby":i.triggerId,"data-orientation":s.orientation,...o,...r,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...n.style}})});Qb.displayName=qb;function Xb(n){return n?"open":"closed"}var nF=jb,rF=Kb,sF=Wb,Zb=Yb,Jb=Qb;const iF=nF,e1=b.forwardRef(({className:n,...e},t)=>y.jsx(rF,{ref:t,className:be("border-b",n),...e}));e1.displayName="AccordionItem";const t1=b.forwardRef(({className:n,children:e,...t},r)=>y.jsx(sF,{className:"flex",children:y.jsxs(Zb,{ref:r,className:be("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",n),...t,children:[e,y.jsx($L,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));t1.displayName=Zb.displayName;const n1=b.forwardRef(({className:n,children:e,...t},r)=>y.jsx(Jb,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:y.jsx("div",{className:be("pb-4 pt-0",n),children:e})}));n1.displayName=Jb.displayName;const oF=()=>{const n=[{question:"What types of real estate investment opportunities do you offer?",answer:"We specialize in missing middle housing developments, multifamily properties, and strategic real estate investments. Our portfolio includes duplexes, fourplexes, townhouses, and small apartment complexes that provide strong cash flow and appreciation potential."},{question:"How do you ensure profitable returns for investors?",answer:"Our proven track record comes from thorough market analysis, strategic property selection, and professional management. We focus on undervalued properties in growing markets and apply our expertise in development and value-add strategies to maximize returns."},{question:"What is the minimum investment required?",answer:"Investment minimums vary by project and investment structure. We offer opportunities ranging from direct property ownership to partnership arrangements. Contact us to discuss options that align with your investment goals and capital availability."},{question:"Do you provide ongoing property management services?",answer:"Yes, we offer comprehensive property management services including tenant screening, rent collection, maintenance coordination, and regular property inspections. Our goal is to provide passive income opportunities for our investors."},{question:"How do you identify and evaluate potential investment properties?",answer:"We use advanced market analytics, demographic studies, and economic indicators to identify emerging markets. Our evaluation process includes detailed financial modeling, property condition assessments, and neighborhood growth potential analysis."},{question:"What markets do you currently operate in?",answer:"We focus primarily on high-growth suburban and urban markets with strong job growth, population increases, and housing demand. Our current markets include several key metropolitan areas where missing middle housing is in high demand."},{question:"Can I invest in individual properties or only funds?",answer:"We offer both individual property investment opportunities and fund structures. This flexibility allows investors to choose the approach that best fits their investment strategy, risk tolerance, and capital requirements."},{question:"What kind of returns can I expect from investments?",answer:"While past performance doesn't guarantee future results, our properties typically target cash-on-cash returns of 8-12% annually, with additional appreciation upside. Returns vary based on property type, market conditions, and investment structure."}];return y.jsxs("section",{className:"py-32 bg-gradient-accent relative overflow-hidden",children:[y.jsxs("div",{className:"absolute inset-0",children:[y.jsxs("div",{className:"absolute right-0 top-0 w-1/2 h-full opacity-30",children:[y.jsx("img",{src:"/lovable-uploads/993aef6a-33f5-465f-8eba-159acc3d0dd8.png",alt:"Business transformation expert and consultant",className:"w-full h-full object-cover object-center"}),y.jsx("div",{className:"absolute inset-0 bg-gradient-to-l from-accent via-accent/80 to-accent"})]}),y.jsxs("div",{className:"absolute left-0 bottom-0 w-3/5 h-2/3 opacity-20",children:[y.jsx("img",{src:"/lovable-uploads/f48a2dc0-af37-42d8-824b-fc482c4ceb7f.png",alt:"Quality construction and development projects",className:"w-full h-full object-cover"}),y.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-accent to-transparent"})]}),y.jsxs("div",{className:"absolute bottom-20 left-4 lg:left-16 w-48 h-48 lg:w-80 lg:h-80 rounded-2xl overflow-hidden shadow-2xl border-4 lg:border-6 border-white/50 rotate-6 hover:rotate-3 transition-all duration-700",children:[y.jsx("img",{src:"/lovable-uploads/099d43ed-30ee-447a-8302-8f31d970c7b5.png",alt:"Professional business growth expert",className:"w-full h-full object-cover"}),y.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-accent/30"})]}),y.jsx("div",{className:"absolute top-16 left-1/2 transform -translate-x-1/2 lg:top-20 lg:left-auto lg:right-20 lg:transform-none w-48 h-48 lg:w-64 lg:h-64 rounded-2xl overflow-hidden shadow-xl border-4 border-accent/60 -rotate-12",children:y.jsx("img",{src:"/lovable-uploads/9622KinderAve_Exterior.jpg",alt:"9622 Kinder Avenue development expertise",className:"w-full h-full object-cover hover:scale-110 transition-all duration-500"})})]}),y.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[y.jsx("div",{className:"absolute top-20 left-10 w-96 h-96 bg-white/10 rounded-full blur-3xl animate-pulse"}),y.jsx("div",{className:"absolute bottom-10 right-20 w-80 h-80 bg-secondary/20 rounded-full blur-2xl"}),y.jsx("div",{className:"absolute top-1/3 left-1/3 w-[600px] h-[600px] bg-primary/15 rounded-full blur-3xl"}),y.jsx("div",{className:"absolute inset-0 opacity-8",children:y.jsx("div",{className:"w-full h-full",style:{backgroundImage:`
              linear-gradient(0deg, rgba(255,255,255,0.08) 1px, transparent 1px),
              linear-gradient(90deg, rgba(255,255,255,0.08) 1px, transparent 1px)
            `,backgroundSize:"50px 50px"}})}),y.jsx("div",{className:"absolute inset-0 opacity-5",children:y.jsx("div",{className:"w-full h-full bg-gradient-to-br from-amber-800/15 via-amber-600/10 to-amber-900/20"})})]}),y.jsx("div",{className:"container mx-auto px-4 relative z-10 mt-48 lg:mt-0",children:y.jsxs("div",{className:"max-w-4xl mx-auto",children:[y.jsxs("div",{className:"text-center mb-16",children:[y.jsx("div",{className:"inline-block bg-white/20 backdrop-blur-sm px-8 py-4 rounded-full border border-white/30 mb-8",children:y.jsx("span",{className:"text-white font-bold text-xl",children:"FAQs"})}),y.jsx("h2",{className:"text-4xl lg:text-5xl font-black mb-6 text-white leading-tight",children:"Frequently Asked Questions"})]}),y.jsx("div",{className:"mb-16",children:y.jsx(iF,{type:"single",collapsible:!0,className:"space-y-4",children:n.map((e,t)=>y.jsxs(e1,{value:`item-${t}`,className:"border border-white/20 rounded-lg px-6 py-2 bg-white/10 backdrop-blur-lg",children:[y.jsx(t1,{className:"text-left font-semibold text-lg text-white hover:text-white/80 transition-colors py-6",children:e.question}),y.jsx(n1,{className:"text-white/90 text-base leading-relaxed pb-6",children:e.answer})]},t))})}),y.jsx("div",{className:"text-center",children:y.jsxs("div",{className:"bg-black/20 backdrop-blur-sm rounded-2xl p-8 border border-white/20 shadow-lg",children:[y.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Have Questions? We're Here to Help!"}),y.jsx("p",{className:"text-white/90 text-lg mb-6 max-w-2xl mx-auto",children:"Reach out to our support team for any queries or assistance."}),y.jsx(Qi,{size:"lg",className:"px-8 py-3 text-lg bg-white text-primary hover:bg-white/90 font-bold transform hover:scale-105 transition-all duration-300",children:"Contact Us"})]})})]})})]})},aF=()=>y.jsx("section",{className:"w-full bg-emerald-800 py-8 border-t border-emerald-700",children:y.jsx("div",{className:"container mx-auto px-4",children:y.jsxs("div",{className:"flex items-center justify-between max-w-4xl mx-auto",children:[y.jsxs("div",{className:"flex items-center gap-6 justify-right",children:[y.jsx("h2",{className:"text-lg md:text-xl lg:text-2xl font-bold text-white",children:"Looking For Something More Passive?"}),y.jsx(NL,{className:"text-emerald-300",size:32})]}),y.jsx("a",{href:"https://novalcapitalgroup.com/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-4 hover:opacity-80 transition-opacity duration-300 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg px-4 py-3",children:y.jsx("img",{src:"/lovable-uploads/Noval-Capital-Final_Horizontal.png",alt:"Noval Capital Group Logo",className:"h-16 w-auto pr-8 brightness-0 invert justify-left"})})]})})}),lF=()=>y.jsx("footer",{className:"w-full bg-emerald-900 border-t border-emerald-800 py-8",children:y.jsx("div",{className:"container mx-auto px-4",children:y.jsx("div",{className:"text-center",children:y.jsx("p",{className:"text-white text-sm md:text-base",children:"Copyright  2025, Equity Builders Group LLC. All rights reserved."})})})}),cF=()=>y.jsxs("div",{className:"min-h-screen",children:[y.jsx(v2,{}),y.jsx(y2,{}),y.jsx(x2,{}),y.jsx(T2,{}),y.jsx(b2,{}),y.jsx(w2,{}),y.jsx(FM,{}),y.jsx($M,{}),y.jsx(oF,{}),y.jsx(aF,{}),y.jsx(lF,{})]}),uF=()=>{const n=xS();return b.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",n.pathname)},[n.pathname]),y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:y.jsxs("div",{className:"text-center",children:[y.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),y.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),y.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},dF=new vk,fF=()=>y.jsx(xk,{client:dF,children:y.jsxs(WC,{children:[y.jsx(CI,{}),y.jsx(aR,{}),y.jsx(s_,{children:y.jsxs(t_,{children:[y.jsx(Cf,{path:"/",element:y.jsx(cF,{})}),y.jsx(Cf,{path:"*",element:y.jsx(uF,{})})]})})]})});jx(document.getElementById("root")).render(y.jsx(fF,{}));
